clusby commented on Oct 1, 2017
When accessing HTTPS urls via an NTLM proxy, the get request fails with a request.exceptions.ProxyError
I believe this is because the hook to use requests-ntlm isn't dispatched when performing the SSL tunnel. That is, a socket error is thrown when I get a 407 in httplib._tunnel().
Are there any plans to support https queries using a proxy auth extension?
Expected Result
HTTPS NTLM requests should authenticate on the proxy and get the external site.
Actual Result
A request.exceptions.ProxyError is thrown
Reproduction Steps
import requests
from requests_ntlm import HttpNtlmAuth

session = requests.Session()
session.auth = HttpNtlmAuth(user, pass)
session.proxies = {'http': 'http://ntlm-proxy:8080', 'https': 'http://ntlm-proxy:8080'}
resp = session.get('https://httpbin.org/get')

# resp.status_code should = 200, however received 407
System Information
$ python -m requests.help
{
  "chardet": {
    "version": "3.0.4"
  },
  "cryptography": {
    "version": "1.9"
  },
  "implementation": {
    "name": "CPython",
    "version": "2.7.6"
  },
  "platform": {
    "release": "2008ServerR2",
    "system": "Windows",
  },
  "pyOpenSSL": {
    "openssl_version": "1010006f",
    "version": "17.0.0"
  },
  "requests": {
    "version": "2.17.3"
  },
  "system_ssl": {
    "version": "90819f"
  },
  "urllib3": {
    "version": "1.21.1"
  },
  "using_pyopenssl": true
}