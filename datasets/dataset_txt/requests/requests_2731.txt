davidmytton commented on Sep 8, 2011
If an HTTP header is malformed then the headers after it will be ignored.
E.g. the line after the "Server" header is missing a key and value. The "Date" and "Server" headers are stored in r.headers but the "Vary", "Connection" and "Content-Type" headers are not:
wget -S http://www.example.com/
--2011-09-08 08:56:59-- http://www.example.com/
Resolving www.example.com... XX
Connecting to www.example.com|XX|:80... connected.
HTTP request sent, awaiting response... 
HTTP/1.0 200 OK
Date: Thu, 08 Sep 2011 08:57:00 GMT
Server: Apache
: 
Vary: Accept-Encoding,User-Agent
Connection: close
Content-Type: text/html; charset=UTF-8
Length: unspecified [text/html]
Saving to: `index.html'
Request:
>> import requests
>>> r = requests.get("http://www.example.com/")
>>> r.headers
{'date': 'Thu, 08 Sep 2011 08:57:00 GMT', 'server': 'Apache'}