Contributor
moliware commented on Aug 12, 2011
Hi, I've changed python version from 2.6 to 2.7 and I've found this weird error at sending headers.
If I put 'Content-Type' then no content-type is sent :
>>> requests.post('http://httpbin.org/post', '',{'Content-Type' : 'application/json'}).read()
'{"origin": "::ffff:184.73.223.212", "files": {}, "form": {}, "url": "http://httpbin.org/post", "args": {}, "headers": {"Content-Length": "0", "Accept-Encoding": "gzip", "X-Forwarded-For": "::ffff:184.73.223.212", "Connection": "close", "User-Agent": "python-requests.org", "Host": "httpbin.org", "X-Forwarded-Protocol": "", "Content-Type": "application/x-www-form-urlencoded"}, "data": ""}'
But if I put 'Content-type' then it works perfectly:
>>> requests.post('http://httpbin.org/post', '',{'Content-type' : 'application/json'}).read()
'{"origin": "::ffff:184.73.223.212", "files": {}, "form": {}, "url": "http://httpbin.org/post", "args": {}, "headers": {"Content-Length": "0", "Accept-Encoding": "gzip", "X-Forwarded-For": "::ffff:184.73.223.212", "Connection": "close", "User-Agent": "python-requests.org", "Host": "httpbin.org", "X-Forwarded-Protocol": "", "Content-Type": "application/json"}, "data": ""}'
In python 2.6* both examples work well.
For more information, the same example but using urllib2 is working ok.
req = urllib2.Request('http://httpbin.org/post', '',{'Content-Type' : 'application/json'})
>>> urllib2.urlopen(req).read()
'{"origin": "::ffff:184.73.223.212", "files": {}, "form": {}, "url": "http://httpbin.org/post", "args": {}, "headers": {"Content-Length": "0", "Accept-Encoding": "identity", "X-Forwarded-For": "::ffff:184.73.223.212", "Connection": "close", "User-Agent": "Python-urllib/2.7", "Host": "httpbin.org", "X-Forwarded-Protocol": "", "Content-Type": "application/json"}, "data": ""}'