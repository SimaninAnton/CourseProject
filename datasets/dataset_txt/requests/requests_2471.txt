stantonk commented on May 23, 2012
Why does this not retry 3 times?
import time
import logging
import requests
from requests.exceptions import Timeout

logging.basicConfig(**{
    'format': '%(asctime)s - %(name)s - %(levelname)s - %(message)s',
    'level': logging.DEBUG
    })
logger = logging.getLogger()

TIMEOUT = 2
RETRY = 3
start = time.time()
try:
    r = requests.get(
        'http://httpbin.org/delay/5',
        timeout=TIMEOUT,
        config={'max_retries': RETRY}
    )
except Timeout:
    print 'Timed out, sad trombone.'
stop = time.time()
print 'took: {}s'.format(stop - start)
$ python test.py
2012-05-22 16:07:34,023 - requests.packages.urllib3.connectionpool - INFO - Starting new HTTP connection (1): httpbin.org
Timed out, sad trombone.
took: 2.0639898777s