jicahoo commented on Dec 18, 2017 â€¢
edited
Summary.
According to RFC 6066, https://tools.ietf.org/html/rfc6066#section-3,
Literal IPv4 and IPv6 addresses are not permitted in "HostName".
However, when I send requests like resp = s.get('https://192.168.1.140', verify=False), requests will put 192.168.1.140 in SNI.
Expected Result
Not send SNI when URL are based on literal IP address.
Actual Result
In wireshark, I saw the IP address was put in SNI.
Reproduction Steps
Prepare a HTTPS server at port 4443.
Use tcpdump sudo tcpdump -X -S -s 0 -i lo -w wireshark.log to capture the packets.
Use below script
import requests
s = requests.Session()
resp = s.get('https://127.0.0.1:4443', verify=False)
Load wireshare.log to wireshark. You will see the SNI is in SSL request.
Please let me know if need more info.
Thanks