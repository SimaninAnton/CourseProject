Carreau commented on May 21, 2012
Hi,
I'm trying to acces github api v3 through requests, but I get the attached traceback when trying to connect to any https urls.
As I'm behind a proxy, I tried setting the proxy as shown in another issue, but proxy respond to me that it can't get the URL.
I also tried verify=False, which raise Timeout
I'm surely dooing something wrong, so if I can get some clues of what...
Thanks.
( OS X 10.7.3 , http(s)_proxy exported in bash)
Without setting proxies
In [43]: requests.__version__
Out[43]: '0.12.1'

In [32]: c = requests.get('https://api.github.com/')
---------------------------------------------------------------------------
SSLError                                  Traceback (most recent call last)
/Users/matthiasbussonnier/ipython/<ipython-input-32-f476e1ab2b17> in <module>()
----> 1 c = requests.get('https://api.github.com/')

/usr/local/Cellar/python/2.7.2/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/requests-0.12.1-py2.7.egg/requests/api.pyc in get(url, **kwargs)
     51     kwargs.setdefault('allow_redirects', True)
---> 52     return request('get', url, **kwargs)


/usr/.../requests/api.pyc in request(method, url, **kwargs)
     39     s = kwargs.pop('session') if 'session' in kwargs else sessions.session()
---> 40     return s.request(method=method, url=url, **kwargs)

/usr/.../requests/sessions.pyc in request(self, method, url, params, data, headers, cookies, files, auth, timeout, allow_redirects, proxies, hooks, return_response, config, prefetch, verify, cert)
    228         # Send the HTTP Request.
--> 229         r.send(prefetch=prefetch)

/usr/.../requests/models.pyc in send(self, anyway, prefetch)
    607                 except (_SSLError, _HTTPError) as e:
    608                     if self.verify and isinstance(e, _SSLError):
--> 609                         raise SSLError(e)

SSLError: [Errno 1] _ssl.c:503: error:140770FC:SSL routines:SSL23_GET_SERVER_HELLO:unknown protocol
with setting proxy
In [33]: PROXY_LIST = {                                                    
      'https':'www-cache:3128'
}

In [36]: c = requests.get('https://api.github.com/pulls',proxies=PROXY_LIST)

In [37]: print c.content # translated by me from french
[...]
Error :
Don't support this combinaison of methods and protocol for following URL
https://api.github.com/pulls

Squid does not allow all methods for all URLs, for example, you can't use POST in a GOPHER request.
[...]