borisnieuwenhuis commented on Oct 25, 2013
It seems new version broke proxy with authentication when using proxy_url of the form http://username:password@proxy_url
test script output from version 1.2.3
INFO:requests.packages.urllib3.connectionpool:Starting new HTTP connection (1): obproxy.telegraaf.net
send: 'GET http://nu.nl HTTP/1.1\r\nHost: www.cleafs.nl\r\nProxy-Authorization: Basic 34hdsfhkjhs95jfsdkljf\r\nAccept-Encoding: gzip, deflate, compress\r\nAccept: /\r\nUser-Agent: python-requests/1.2.3 CPython/2.7.3
while exactly same script in requests 2.0 doesnt send basic auth header and gets a request denied from proxy
INFO:requests.packages.urllib3.connectionpool:Starting new HTTP connection (1):
PROXY Url(scheme='http', auth='username:password', host='obproxy.telegraaf.net', port=3128, path=None, query=None, fragment=None)
INFO:requests.packages.urllib3.connectionpool:Starting new HTTP connection (1): obproxy.telegraaf.net
send: 'GET http://www.nu.nl/ HTTP/1.1\r\nHost: www.nu.nl\r\nAccept-Encoding: gzip, deflate, compress\r\nAccept: /\r\nUser-Agent: python-requests/2.0.0 CPython/2.7.3 Linux/3.7.2-vs2.3.5.5-d64-i7\r\n\r\n'
DEBUG:requests.packages.urllib3.connectionpool:Setting read timeout to <object object at 0x7feaa083b0e0>
reply: 'HTTP/1.0 407 Proxy Authentication Required\r\n'