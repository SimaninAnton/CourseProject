jacksontj commented on May 23, 2014
Requests automatically adds a host header if the user didn't specify one. That header is not set in the request object. Example:
>>> import requests
>>> ret = requests.get('http://www.google.com')
>>> ret.request.headers['host']
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/usr/lib/python2.7/site-packages/requests/structures.py", line 77, in __getitem__
    return self._store[key.lower()][1]
KeyError: 'host'
This means that the headers in this object do not actually match what was sent on the wire, which is magic. Inside of poolmanager in _set_proxy_headers the accept and host headers are set, is there some way to make them set in that request object as well?