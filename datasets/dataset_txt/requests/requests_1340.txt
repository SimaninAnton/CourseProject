Contributor
jayvdb commented on Aug 5, 2015
The link header for http://ws-dl-05.cs.odu.edu/demo/index.php/Tyrion_Lannister is not being parsed correctly by parse_header_links, and that function doesnt look completely RFC 5988 compliant.
>>> r = requests.get('http://ws-dl-05.cs.odu.edu/demo/index.php/Tyrion_Lannister')
>>> r.headers['link']
'<http://ws-dl-05.cs.odu.edu/demo/index.php/Tyrion_Lannister>; rel="original latest-version",<http://ws-dl-05.cs.odu.edu/demo/index.php/Special:TimeGate/Tyrion_Lannister>; rel="timegate",<http://ws-dl-05.cs.odu.edu/demo/index.php/Special:TimeMap/Tyrion_Lannister>; rel="timemap"; type="application/link-format"; from="Mon, 23 Apr 2007 20:26:15 GMT"; until="Fri, 06 Sep 2013 17:19:06 GMT",<http://ws-dl-05.cs.odu.edu/demo/index.php?title=Tyrion_Lannister&oldid=1714>; rel="first memento"; datetime="Mon, 23 Apr 2007 20:26:15 GMT",<http://ws-dl-05.cs.odu.edu/demo/index.php?title=Tyrion_Lannister&oldid=107222>; rel="last memento"; datetime="Fri, 06 Sep 2013 17:19:06 GMT"'

>>> pp = pprint.PrettyPrinter(indent=4)
>>> pp.pprint(r.links)
{   '06 Sep 2013 17:19:06 GMT': {   'url': '06 Sep 2013 17:19:06 GMT'},
    '23 Apr 2007 20:26:15 GMT': {   'url': '23 Apr 2007 20:26:15 GMT'},
    'first memento': {   'datetime': 'Mon',
                         'rel': 'first memento',
                         'url': 'http://ws-dl-05.cs.odu.edu/demo/index.php?title=Tyrion_Lannister&oldid=1714'},
    'last memento': {   'datetime': 'Fri',
                        'rel': 'last memento',
                        'url': 'http://ws-dl-05.cs.odu.edu/demo/index.php?title=Tyrion_Lannister&oldid=107222'},
    'original latest-version': {   'rel': 'original latest-version',
                                   'url': 'http://ws-dl-05.cs.odu.edu/demo/index.php/Tyrion_Lannister'},
    'timegate': {   'rel': 'timegate',
                    'url': 'http://ws-dl-05.cs.odu.edu/demo/index.php/Special:TimeGate/Tyrion_Lannister'},
    'timemap': {   'from': 'Mon',
                   'rel': 'timemap',
                   'type': 'application/link-format',
                   'url': 'http://ws-dl-05.cs.odu.edu/demo/index.php/Special:TimeMap/Tyrion_Lannister'}}
Oddly this was the subject of #2250, as it appears the comma's are still causing the problem, so it may be that some corner cases still need to be handled better, and some unit tests written to confirm the problem is actually solved. Happy to help with either.