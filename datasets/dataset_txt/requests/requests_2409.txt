deadbeef404 commented on Aug 6, 2012
When we provide a file and a long-type parameter through to the request functions, we get an exception thrown.
urllib3 seems to turn integer types into strings, but doesn't convert python long types.
The exception is raised by urllib3's encode_multipart_formdata function.
Not sure if this is a urllib3 issue as in their function, "# Backwards compatibility" is written next to their int conversion code.
As that might be removed at some point, maybe integer/long conversions should not be relied upon within that library.
import requests
import tempfile

filename = tempfile.mkstemp()[1]
file1 = open(filename, 'w')
file1.write('test')
file1.close()
file1 = open(filename, 'rb')

response = requests.post(
        url='http://www.google.com',
        data={'aparam1': 12L},
        files={testfile': file1,}
        )