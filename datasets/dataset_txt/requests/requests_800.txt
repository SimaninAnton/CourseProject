dofine commented on Jan 14, 2017 â€¢
edited
Requests version: 2.11.1
Python: 2.7.12
We've got a server providing .txt files, basically some log files growing over time. When I use urllib2 to send GET to the server r = urllib2.urlopen('http://example.com') , the headers of the response would be:
    Date: XXX
    Server: Apache
    Last-Modified: XXX
    Accept-Ranges: bytes
    Content-Length: 12345678
    Vary: Accept-Encoding
    Connection: close
    Content-Type: text/plain
While if r = requests.get('http://example.com'):
    Content-Encoding: gzip
    Accept-Ranges: bytes
    Vary: Accept-Encoding
    Keep-alive: timeout=5, max=128
    Last-Modified: XXX
    Connection: Keep-Alive
    ETag: xxxxxxxxx
    Content-Type: text/plain
The second response is the same with what I get using chrome develop tools. So why the two are different? I need the Content-Length header to determine how many bytes I need to download every time, becasue the file could grow really big.
Using httpbin.org/get to test:
urllib2 response:
    {u'args': {},
     u'headers': {u'Accept-Encoding': u'identity',
                  u'Host': u'httpbin.org',
                  u'User-Agent': u'Python-urllib/2.7'},
     u'origin': u'ip',
     u'url': u'http://httpbin.org/get'}
response headers:
    Server: nginx
    Date: Sat, 14 Jan 2017 07:41:16 GMT
    Content-Type: application/json
    Content-Length: 207
    Connection: close
    Access-Control-Allow-Origin: *
    Access-Control-Allow-Credentials: true
requests response:
    {u'args': {},
     u'headers': {u'Accept': u'*/*',
                  u'Accept-Encoding': u'gzip, deflate',
                  u'Host': u'httpbin.org',
                  u'User-Agent': u'python-requests/2.11.1'},
     u'origin': u'ip',
     u'url': u'http://httpbin.org/get'}
response headers:
    Server : nginx
    Date : Sat, 14 Jan 2017 07:42:39 GMT
    Content-Type : application/json
    Content-Length : 239
    Connection : keep-alive
    Access-Control-Allow-Origin : *
    Access-Control-Allow-Credentials : true