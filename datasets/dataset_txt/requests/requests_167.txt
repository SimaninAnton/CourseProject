davisjam commented on Oct 24, 2018 â€¢
edited
I am using requests to query a website.
If I query with timeout, it behaves like I want (well, kind of).
If I query without timeout, the request hangs.
This behavior seems to be specific to this website. My code works fine against other websites.
Expected Result
The request does not hang.
Actual Result
Without timeout, the request hangs.
With timeout, the request takes the full timeout window before returning successfully.
Reproduction Steps
#!/usr/bin/env python3

import requests

# Works -- but takes the full timeout before the call returns
print('Try 1')
r = requests.get('https://repo.packagist.org/p/jrodella/payment-form-api.json', timeout=5)

# Hangs
print('Try 2')
r = requests.get('https://repo.packagist.org/p/jrodella/payment-form-api.json')
If I add in logging, the hang occurs after the log statement:
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): repo.packagist.org
System Information
$ python -m requests.help
(13:21:07) jamie@woody ~/Desktop/EcosystemRegexps/ecosystems $ python3 -m requests.help
{
  "chardet": {
    "version": "3.0.4"
  },
  "cryptography": {
    "version": "1.9"
  },
  "implementation": {
    "name": "CPython",
    "version": "3.5.2"
  },
  "platform": {
    "release": "4.15.0-33-generic",
    "system": "Linux"
  },
  "pyOpenSSL": {
    "openssl_version": "1000207f",
    "version": "17.3.0"
  },
  "requests": {
    "version": "2.18.1"
  },
  "system_ssl": {
    "version": "1000207f"
  },
  "urllib3": {
    "version": "1.21.1"
  },
  "using_pyopenssl": true
}