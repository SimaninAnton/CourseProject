dvogel commented on Feb 28, 2012
utils.requote_path passes safe=b"" into urllib.quote, which causes some characters to be encoded that don't have to be. This is allowed by the RFC, however there is some ambiguity in the RFC as to whether the encoded characters have the same meaning as their unencoded representations. This ambiguity allows some web servers to consider /a,b and /a%2Cb to refer to different resources. I think we should only encode characters that must be encoded, as that should lead to the widest compatibility. This would mean passing safe=b"$+!*'()," to urllib.quote. Alternatively, Request could acccept a parameter to pass on as the safe argument to urllib.quote.