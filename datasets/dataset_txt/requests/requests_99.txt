ghost commented on Mar 4, 2019
import requests

r = requests

def my_decorator(func):
    def wrapper(*args):
        print(func.hostname)
        print('sdasdas')
    return wrapper

say_wee = my_decorator(r.sessions.urlparse('http://google.com'))
print(type(say_wee))
r.sessions.urlparse = say_wee
r.get('http://google.com')
I want to add some actions to the default sessions.urlparse. I get error:
Traceback (most recent call last):
  File "res.py", line 14, in <module>
    r.get('http://google.com')
  File "/Library/Python/2.7/site-packages/requests/api.py", line 75, in get
    return request('get', url, params=params, **kwargs)
  File "/Library/Python/2.7/site-packages/requests/api.py", line 60, in request
    return session.request(method=method, url=url, **kwargs)
  File "/Library/Python/2.7/site-packages/requests/sessions.py", line 533, in request
    resp = self.send(prep, **send_kwargs)
  File "/Library/Python/2.7/site-packages/requests/sessions.py", line 668, in send
    history = [resp for resp in gen] if allow_redirects else []
  File "/Library/Python/2.7/site-packages/requests/sessions.py", line 150, in resolve_redirects
    previous_fragment = urlparse(req.url).fragment
AttributeError: 'NoneType' object has no attribute 'fragment'