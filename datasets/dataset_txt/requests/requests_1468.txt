jribbens commented on Mar 21, 2015
Firstly, please note I have already read issues #1289 and #1915.
Secondly, please note that I am fully aware that the problem is that the underlying URL fetch failed due to a problem that is outside Requests' control, i.e. a network problem or failure of the remote web server.
My problem is not that an exception is raised - my problem is that the wrong exception is raised. According to the Requests documentation, in this circumstance a ReadTimeout exception should be raised, and in any event the exception should be a subclass of RequestException. Instead, a TypeError is being raised. This is fatal for my application, which needs to know why the request failed and to be sure that it was indeed a network failure and not a bug in the application or Requests itself. As far as I can see, this is indeed a bug in Requests.
I am using Requests 2.5.3 on Python 3.4.0 on Ubuntu 14.04.2.
Traceback (most recent call last):                                                                                                                                                   
  File "/home/jribbens/src/bitatawa/lib/python3.4/site-packages/requests/packages/urllib3/connectionpool.py", line 372, in _make_request                                             
    httplib_response = conn.getresponse(buffering=True)                                                                                                                              
TypeError: getresponse() got an unexpected keyword argument 'buffering'                                                                                                              

During handling of the above exception, another exception occurred:                                                                                                                  

Traceback (most recent call last):                                                                                                                                                   
  File "/home/jribbens/src/bitatawa/lib/python3.4/site-packages/requests/packages/urllib3/connectionpool.py", line 374, in _make_request                                             
    httplib_response = conn.getresponse()                                                                                                                                            
  File "/usr/lib/python3.4/http/client.py", line 1147, in getresponse                                                                                                                
    response.begin()                                                                                                                                                                 
  File "/usr/lib/python3.4/http/client.py", line 351, in begin                                                                                                                       
    version, status, reason = self._read_status()                                                                                                                                    
  File "/usr/lib/python3.4/http/client.py", line 313, in _read_status                                                                                                                
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")                                                                                                                         
  File "/usr/lib/python3.4/socket.py", line 371, in readinto                                                                                                                         
    return self._sock.recv_into(b)                                                                                                                                                   
socket.timeout: timed out                                                                                                                                                            

During handling of the above exception, another exception occurred:                                                                                                                  

Traceback (most recent call last):                                                                                                                                                   
  File "/home/jribbens/src/bitatawa/lib/python3.4/site-packages/requests/adapters.py", line 370, in send                                                                             
    timeout=timeout                                                                                                                                                                  
  File "/home/jribbens/src/bitatawa/lib/python3.4/site-packages/requests/packages/urllib3/connectionpool.py", line 597, in urlopen                                                   
    _stacktrace=sys.exc_info()[2])                                                                                                                                                   
  File "/home/jribbens/src/bitatawa/lib/python3.4/site-packages/requests/packages/urllib3/util/retry.py", line 245, in increment                                                     
    raise six.reraise(type(error), error, _stacktrace)                                                                                                                               
  File "/home/jribbens/src/bitatawa/lib/python3.4/site-packages/requests/packages/urllib3/packages/six.py", line 310, in reraise                                                     
    raise value                                                                                                                                                                      
  File "/home/jribbens/src/bitatawa/lib/python3.4/site-packages/requests/packages/urllib3/connectionpool.py", line 544, in urlopen                                                   
    body=body, headers=headers)                                                                                                                                                      
  File "/home/jribbens/src/bitatawa/lib/python3.4/site-packages/requests/packages/urllib3/connectionpool.py", line 376, in _make_request                                             
    self._raise_timeout(err=e, url=url, timeout_value=read_timeout)                                                                                                                  
  File "/home/jribbens/src/bitatawa/lib/python3.4/site-packages/requests/packages/urllib3/connectionpool.py", line 304, in _raise_timeout                                            
    raise ReadTimeoutError(self, url, "Read timed out. (read timeout=%s)" % timeout_value)                                                                                           
requests.packages.urllib3.exceptions.ReadTimeoutError: HTTPConnectionPool(host='www.libraryofbirmingham.com', port=80): Read timed out. (read timeout=30)                            

During handling of the above exception, another exception occurred:                                                                                                                  

Traceback (most recent call last):                                                                                                                                                   
  File "./bitatawa-client.py", line 231, in check                                                                                                                                    
    timeout=settings.getint("check-timeout", 30))                                                                                                                                    
  File "/home/jribbens/src/bitatawa/lib/python3.4/site-packages/requests/api.py", line 65, in get                                                                                    
    return request('get', url, **kwargs)                                                                                                                                             
  File "/home/jribbens/src/bitatawa/lib/python3.4/site-packages/requests/api.py", line 49, in request                                                                                
    response = session.request(method=method, url=url, **kwargs)                                                                                                                     
  File "/home/jribbens/src/bitatawa/lib/python3.4/site-packages/requests/sessions.py", line 461, in request                                                                          
    resp = self.send(prep, **send_kwargs)                                                                                                                                            
  File "/home/jribbens/src/bitatawa/lib/python3.4/site-packages/requests/sessions.py", line 573, in send                                                                             
    r = adapter.send(request, **kwargs)                                                                                                                                              
  File "/home/jribbens/src/bitatawa/lib/python3.4/site-packages/requests/adapters.py", line 433, in send                                                                             
    raise ReadTimeout(e, request=request)                                                                                                                                            
requests.exceptions.ReadTimeout: HTTPConnectionPool(host='www.libraryofbirmingham.com', port=80): Read timed out. (read timeout=30)                                                  