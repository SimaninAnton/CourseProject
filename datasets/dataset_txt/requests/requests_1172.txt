Contributor
schlamar commented on Feb 1, 2016
Requests uses urlib.proxy_bypass to check if the proxy should be bypassed. This uses socket.gethostbyaddr to check if the provided IP matches a hostname entered in the proxy bypass list. In some cases, gethostbyaddr takes up to 4.5 seconds on Windows (e.g. when the IP is found but the primary DNS doesn't recognize it).
Currently, the proxy bypass detection is done for every request, making it pretty unusable when the conditions are met where gethostbyaddr is this slow.
A reasonable solution might be caching the results from urlib.proxy_bypass.