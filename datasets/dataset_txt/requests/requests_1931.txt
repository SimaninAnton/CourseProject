drsm79 commented on Oct 24, 2013
If I make a prepared request like:
prepped = requests.Request('GET', my_url, params={}).prepare()
It doesn't have certain attributes set (cookies, auth, files, data, params from experiment...). If I then pass this prepared request in to a session.prepare_request() it fails because those attributes aren't in the PreparedRequest instance:
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/usr/local/lib/python2.6/dist-packages/requests-2.0.0-py2.6.egg/requests/sessions.py", line 261, in prepare_request
    params=merge_setting(request.params, self.params),
AttributeError: 'PreparedRequest' object has no attribute 'params'
I think either requests.Request().prepare() needs to set all the attributes as None, or session.prepare_request() needs to be more cautious about how it merges the incoming request (e.g. things like sessions.py#L238 should be:
 getattr(req, 'cookies', {})
That said, it's early in the morning and I've not had a coffee yet, so I could be missing how this stuff should be wired up.