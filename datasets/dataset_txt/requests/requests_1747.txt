espdev commented on May 8, 2014
Requests does not work if I try to use it in a corporate network with Microsoft ISA Server when I use ISA Firewal Clent. I do not set any proxy settings, but requests despite it have looked proxy. This behavior has been defined by default for trust_env in the module sessions in the line range 423-427 (https://github.com/kennethreitz/requests/blob/master/requests/sessions.py#L423).
proxies = proxies or {}

        # Gather clues from the surrounding environment.
        if self.trust_env:
            # Set environment's proxies.
            env_proxies = get_environ_proxies(url) or {}
            for (k, v) in env_proxies.items():
                proxies.setdefault(k, v)
In my network function get_environ_proxies returns a list of proxy servers, and it does not work for me. For correct work via ISA Firewal Clent, dict of proxies must be empty always.
For example, this behavior prevents to use pip (see pypa/pip#1182 (comment)).