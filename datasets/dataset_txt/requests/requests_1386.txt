xEtherealx commented on Jun 11, 2015
I'm doing something like
headers = {'a dict':'test'}
body = 'some string'
http_resp = HTTPResponse(body=body,
                         headers=headers,
                         status=202,
                         version=0,
                         reason='Ok',
                         decode_content=False)

response = Response()

# Fallback to None if there's no status_code, for whatever reason.
response.status_code = getattr(http_resp, 'status', None)
response.encoding = get_encoding_from_headers(headers)
response.raw = http_resp
response.reason = response.raw.reason
response.url = url
# Hack to avoid ValueError on fp check (bug?)
response._content = response.raw._body

print response.content
The hack portion is required because I get a ValueError otherwise in the stream method:
while not is_fp_closed(self._fp)
Seems like there needs to be an exit on a stringish body.