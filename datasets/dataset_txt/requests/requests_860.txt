aseering commented on Nov 22, 2016
As of requests==2.12.1, requests[security] depends on cryptography>=1.3.4. That's fine. However, requests (without [security]) crashes if cryptography==1.0.2 is installed. This is a perfectly valid configuration of packages according to pip; as a user, I would expect it to behave as if I had not specified [security] (because I didn't specify it).
The specific failure is discussed a bit more here:
http://discuss.flexget.com/t/unhandled-error-in-plugin-configure-series-solved/2900
The crash was resolved, also as described at the above link, by running:
pip install --upgrade cryptography
Uninstalling cryptography would probably have worked fine too.
The crash appears to be caused because requests internally tests for [security] by importing a thing which imports its bundled pyopenssl which imports cryptography; if that succeeds, the extra is used. But with a too-old version of cryptography, it imports just fine but it constructs objects that are missing required fields.
I can think of a couple approaches here:
Catch this failure and print an error message that more-helpfully explains that your cryptography package needs updating
Validate the version/functionality of the cryptographypackage more carefully, and don't enable the [security] extra's features if an old version happens to be installed
I'd be happy to post a PR for either approach. Right now I'm looking for feedback on whether it's worth addressing this (I'd certainly appreciate it) and on what approach you'd prefer.