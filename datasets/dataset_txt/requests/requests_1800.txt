Contributor
zackw commented on Mar 13, 2014
Session.resolve_redirects requires you to pass in both the initial response, and the PreparedRequest that produced that response, even though the latter is available as the .request property of the former. If you pass in a different PreparedRequest object, the redirection information in the response is merged with the PreparedRequest you supplied. This cannot cause you to be sent to the wrong URL, because the original URL is taken from the response, but it may cause you to supply the wrong X-headers, HTTP method, or anything else drawn directly from the request.
I suggest that Session.resolve_redirects should continue to accept the req argument for backward compatibility, but it should be made optional (i.e. req=None in the signature) and should be ignored in favor of resp.request.