Lawouach commented on May 19, 2014
Using the simple following snippet:
>>> files = {'myfile': ('filename.zip', file('some.zip', 'rb'), 'application/octet-stream')}
>>> r = requests.Request('POST', URL, files=files).prepare()
>>> r.headers
{'Content-Length': u'395', 'Content-Type': 'multipart/form-data; boundary=ec38bda3760c46aea548602228efdd47'}
This is an issue because httplib will consider it must decode the body as well before sending it (at least in Python 2.7.1, I assume with 3.x it's all bytes anyway). This fails when content is binary.
Massaging the Content-Length to revert it to a byte string does work well.
This was with requests 1.1.0.