ivankoster commented on Nov 15, 2014
Hello,
When I try to retrieve the text attribute from a request, i get the following error:
Traceback (most recent call last):
File ".\sublime_plugin.py", line 175, in on_load
File ".\sublime_plugin.py", line 154, in run_timed_function
File ".\sublime_plugin.py", line 174, in
File ".\SublimeYouCompleteMe.py", line 244, in on_load
File ".\plugin\ycmd_request.py", line 136, in send
File ".\plugin\ycmd_request.py", line 43, in post_data_to_handler
File ".\plugin\ycmd_request.py", line 109, in json_from_response
File ".\requests\models.py", line 756, in text
encoding = self.apparent_encoding
File ".\requests\models.py", line 637, in apparent_encoding
return chardet.detect(self.content)['encoding']
File ".\requests\packages\chardet\detect.py", line 11, in detect
ImportError: cannot import name universaldetector
On python 2.7.8
I think this is an error in chardet's detect function in init.py, which does an import on function level instead of module level.
The import is "from . import universaldetector" and since it is called from requests/models.py it searches in the requests folder for universaldetector, which obviously fails.
I confirmed this by changing the line to "from packages.chardet import universaldetector" which hilariously solves the problem.
But I wonder if this bug is down to my specific configuration, because it seems like a bug that would affect a lot of people?