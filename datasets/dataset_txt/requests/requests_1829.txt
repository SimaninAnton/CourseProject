gholms commented on Jan 31, 2014
I need to use a PUT request to upload sys.stdin to Amazon S3, but since S3 does not support chunked transfer encoding I have to supply a Content-Length header myself. Doing so seemed to successfully prevent HTTPAdapter.send from trying to do chunking, but S3 rejected the request anyway because PreparedRequest.prepare_body noticed that the body was iterable and set a Transfer-Encoding header on its own. A user-supplied Content-Length should prevent the latter from happening as well.