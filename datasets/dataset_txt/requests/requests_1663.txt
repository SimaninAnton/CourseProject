joneskoo commented on Aug 27, 2014
My code
                r = requests.get(url, stream=True)
                for chunk in r.iter_content(chunk_size=16*1024):
                    if chunk: # filter out keep-alive new chunks
                        f.write(chunk)
                        f.flush()
raises an exception socket.error; I would expect it to be mapped to requests.exceptions instead.
    for chunk in r.iter_content(chunk_size=16*1024):
  File "/usr/lib/python2.7/dist-packages/requests/models.py", line 616, in generate
    decode_content=True):
  File "/usr/lib/python2.7/dist-packages/urllib3/response.py", line 225, in stream
    data = self.read(amt=amt, decode_content=decode_content)
  File "/usr/lib/python2.7/dist-packages/urllib3/response.py", line 174, in read
    data = self._fp.read(amt)
  File "/usr/lib/python2.7/httplib.py", line 567, in read
    s = self.fp.read(amt)
  File "/usr/lib/python2.7/socket.py", line 380, in read
    data = self._sock.recv(left)
  File "/usr/lib/python2.7/ssl.py", line 341, in recv
    return self.read(buflen)
  File "/usr/lib/python2.7/ssl.py", line 260, in read
    return self._sslobj.read(len)
error: [Errno 104] Connection reset by peer
@Lukasa, since you fixed another exception handling issue already, would you care to take a look at some point? Easy enough to work around but should be fixed to maintain a human API.