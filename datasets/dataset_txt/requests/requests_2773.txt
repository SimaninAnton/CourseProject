lsemel commented on Jun 24, 2011
This may or may not be correct HTTP behavior, but when using a URL with a hash (#) character, response.url chops off the URL at the hash character. I would have expected the full URL. (For redirects, I can retrieve it from the location header in the history.)
>>> import requests
>>> url = 'http://twitter.com/#!/charliesheen/status/42731720402931712'
>>> shortened = 'http://bit.ly/fxDgIl'
>>> response = requests.get(url)
>>> response.url
'http://twitter.com/'
>>> response = requests.get(shortened)
>>> response.url
'http://twitter.com/'
>>> response.history[0].headers['location']
'http://twitter.com/#!/charliesheen/status/42731720402931712'