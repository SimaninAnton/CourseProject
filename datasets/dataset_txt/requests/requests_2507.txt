Polygraph commented on Apr 17, 2012
When using iter_content, in some instances it would be beneficial to have the ability to interrupt the request. If you take the Twitter streaming API as an example, there is no current way to exit cleanly as iter_content will continuously block. For example, in the following code:
for line in self.conn.req_content(self.ITER_BYTES):
                self.status += line
                if line.endswith(self.DIVIDER) and self.status.strip():
                    print self.status
                    self.status = ""
The only way to I can stop the stream connection is by either running it in a separate thread and joining or by manually setting the raw property of the request to None (and catch the AttributeError that subsequently gets thrown):
self.req.raw = None
I understand that currently only the Twitter streaming API makes this issue relevant but going forward I'm sure more streaming APIs will emerge and it'd be useful if there was a nicer way to unblock.