pcsysen commented on Oct 27, 2015
Hi, we are using slumber to setup a smoke test against our server(django + uwsgi). We started to see this "connection reset by peer" error after we added the "content-length" in the response header. It only happens occasionally. However it never happens when we don't include content-length in the response header, at least based on our experiences. I see some similar questions about they all seem to related to ssl. We are just using http. Could anyone help? Thanks.
url: POST to http://127.0.0.1:8080/api/v1....
Traceback (most recent call last):
  File "./smoke_test_driver.py", line 936, 
    _pre_run_apis(host, cpe_mac, api_prefix, webpa_gateway, current_environment)
  File "./smoke_test_driver.py", line 790, in _pre_run_apis
    cpe.device_class.put({'xpc_model_class': device_class})
  File "/usr/local/lib/python2.7/site-packages/slumber/__init__.py", line 175, in put
    resp = self._request("PUT", data=data, files=files, params=kwargs)
  File "/usr/local/lib/python2.7/site-packages/slumber/__init__.py", line 97, in _request
    resp = self._store["session"].request(method, url, data=data, params=params, files=files, headers=headers)
  File "/usr/local/lib/python2.7/site-packages/requests/sessions.py", line 465, in request
    resp = self.send(prep, **send_kwargs)
  File "/usr/local/lib/python2.7/site-packages/requests/sessions.py", line 573, in send
    r = adapter.send(request, **kwargs)
  File "/usr/local/lib/python2.7/site-packages/requests/adapters.py", line 415, in send
    raise ConnectionError(err, request=request)
requests.exceptions.ConnectionError: ('Connection aborted.', error(104, 'Connection reset by peer'))