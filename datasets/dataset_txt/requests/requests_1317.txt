hxzhao527 commented on Aug 27, 2015
Situation:POST or GET a adress which will redirect an adress which the host adress in header is different with the last request.
I write a small script to simulate login my school account.But the exception,
requests.exceptions.ConnectionError: ('Connection aborted.', error(10054, ''))
is always happening.
I try to print the information of every request.So in session.py class SessionRedirectMixin function resolve_redirects ,I print the header information before a real request.
I find during redirecting,the header information is just copied from its last request.So if a request is redirected to an adress which the host adress in header is different with the last request,it will failed.
I try to solve this problem.
I add these lines in function resolve_redirects at 172th line in session.py before send the request.
if headers.get("Host"):
    headers["Host"] = urlparse(url).hostname
And it worked for me.
more information:
import requests
print request.__version__
'2.7.0'