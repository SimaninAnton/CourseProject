geancarlo commented on Dec 17, 2012
Hello,
I have tried the following sample code from http://docs.python-requests.org/en/latest/user/advanced/ with requests 0.14.2:
import requests
s = requests.session()
s.get('http://httpbin.org/cookies/set/sessioncookie/123456789')
r = s.get("http://httpbin.org/cookies")
print r.text
which yields the following output on wireshark http://imgur.com/a/aCwKN#0.
As you can see in the 3rd capture, the sessioncookie is not being sent and consequently the reply's content has no cookie data
Also this code:
import requests
r = requests.get("http://httpbin.org/cookies", cookies = {"sessioncookie":"123456789"})
print r.text
causes an error:
Traceback (most recent call last):
File "C:\Users\geancarlo\Documents\Visual Studio 2010\Projects\woonro-vote\woo
nro-vote\test.py", line 2, in
r = requests.get("http://httpbin.org/cookies", cookies = {"sessioncookie":"1
23456789"})
File "C:\Python27\lib\site-packages\requests-0.14.2-py2.7.egg\requests\api.py"
, line 60, in get
return request('get', url, *_kwargs)
File "C:\Python27\lib\site-packages\requests-0.14.2-py2.7.egg\requests\api.py"
, line 49, in request
return session.request(method=method, url=url, *_kwargs)
File "C:\Python27\lib\site-packages\requests-0.14.2-py2.7.egg\requests\session
s.py", line 165, in request
prep = req.prepare()
File "C:\Python27\lib\site-packages\requests-0.14.2-py2.7.egg\requests\models.
py", line 193, in prepare
p.prepare_cookies(self.cookies)
File "C:\Python27\lib\site-packages\requests-0.14.2-py2.7.egg\requests\models.
py", line 358, in prepare_cookies
cookie_header = get_cookie_header(cookies, self)
File "C:\Python27\lib\site-packages\requests-0.14.2-py2.7.egg\requests\cookies
.py", line 116, in get_cookie_header
jar.add_cookie_header(r)
File "C:\Python27\lib\cookielib.py", line 1324, in add_cookie_header
cookies = self._cookies_for_request(request)
File "C:\Python27\lib\cookielib.py", line 1250, in _cookies_for_request
cookies.extend(self._cookies_for_domain(domain, request))
File "C:\Python27\lib\cookielib.py", line 1230, in _cookies_for_domain
if not self._policy.domain_return_ok(domain, request):
File "C:\Python27\lib\cookielib.py", line 1147, in domain_return_ok
req_host, erhn = eff_request_host(request)
File "C:\Python27\lib\cookielib.py", line 604, in eff_request_host
erhn = req_host = request_host(request)
File "C:\Python27\lib\cookielib.py", line 589, in request_host
url = request.get_full_url()
File "C:\Python27\lib\site-packages\requests-0.14.2-py2.7.egg\requests\cookies
.py", line 51, in get_full_url
return self._r.full_url
AttributeError: 'PreparedRequest' object has no attribute 'full_url'
Press any key to continue . . .