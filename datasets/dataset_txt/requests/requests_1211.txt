JKulakofsky commented on Dec 8, 2015
I am writing a program that will POST a file to a website that is making me go through a few steps to get the file properly uploaded. In the first step, I perform a simple POST which alerts the site that a file will be uploaded and returns a URL to an S3 bucket, along with some more response content. The next step is to POST the file to the URL returned in step one, and this is where things break. An abbreviated version of my code is as follows:
url = 'https://myurl.s3.amazonaws.com/'
payload = {all of the content returned from step one, minus the URL}
file = {'file': open('C:\...\file_name.imscc', 'rb')}
r = requests.post(url, data=payload, files=file)
At this point the code waits for about 15-20 seconds and then gives back a 403 error. My initial thought was that the file was too large (about 18.58MB) so I tried to use the Multipart Encoder from the Requests Toolbelt. When I ran this code:
m = MultipartEncoder(fileds={the same values as above, 'file': (files[0], open('C:\Users\jonathan.kulakofsky\Documents\Code\Downloads\\' + files[0], 'rb'))})
I got a Traceback Error that ended with 'Connection aborted.', error(10054, 'An existing connection was forcibly closed by the remote host').
As far as I can tell, I am passing the proper authentication key back to Amazon with the rest of the fields in the payload. Does anyone have any ideas why I'm getting these errors?