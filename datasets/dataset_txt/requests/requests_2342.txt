Contributor
tiran commented on Oct 28, 2012
The function generate_nonce() of the module requests.packages.oauthlib.common uses random.getrandbits() to create the nounce. The global mersenne twister PRNG instance should not be used for the task. For example the instance isn't reseeded on fork() which results in a very high probability of collisions in a forking server environment. Python's tempfile module contains an implementation that avoid the issue.
I suggest that you use os.urandom() for the job. It's available on all major platforms. The platform's CPRNG makes it inherently secure, too.