groutr commented on Dec 1, 2016 â€¢
edited
I noticed this issue building conda recipes. Conda uses requests to download files from the internet.
The file that is being fetched is: https://dakota.sandia.gov/sites/default/files/distributions/public/dakota-6.5-public.src.tar.gz
(link found here: https://dakota.sandia.gov/download.html)
Downloading with curl -O
filesize: 78MB
md5: 02c46e904d40bba6b308065db34c1ad7
Downloading with urllib2 (from the standard library):
filesize: 78MB
md5: 02c46e904d40bba6b308065db34c1ad7
Downloading with requests-2.12.1 (supplied with conda)
filesize: 248MB
md5: 41e4268140d850756812510512d8eee8
tar -tf doesn't indicate any corruption.
I'm not sure what is different with this particular URL, but the other files I tried with requests worked. I don't know where the extra 170MB is coming from?
code used to download files:
def download_file(url, fn):
    r = requests.get(url, stream=True)
    with open(fn, 'wb') as f:
        for chunk in r.iter_content(chunk_size=1024): 
            if chunk:
                f.write(chunk)

def download_urllib2(url, fn):
    f = urllib2.urlopen(url)
    with open(fn, 'wb') as fh:
        for x in iter(lambda: f.read(1024), b''):
            fh.write(x)