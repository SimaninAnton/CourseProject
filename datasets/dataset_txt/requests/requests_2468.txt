Contributor
acdha commented on May 25, 2012
I found a logic error while doing something experimental:
If you call requests.post(data="urlencoded string"), everything works.
If you call requests.post(data="urlencoded string", files=<dict>), requests will raise a ValueError in _encode_files:
https://github.com/kennethreitz/requests/blob/develop/requests/models.py#L349
By that time str in the local scope is actually unicode, so the isinstance check fails. It seems like this should either be isinstance(self.data, basestring) or simply raise something like TypeError to indicate that attempting to send both a pre-encoded string and files is pointless and should not be done.