DenverJ commented on Apr 4, 2018
A requests session cannot be pickled when using DigestAuth and Python3.6 because of this bug with Python3 - https://bugs.python.org/issue28967 and the referenced issue in that issue - https://bugs.python.org/issue22995 (Tested working with Python3.5.4).
Expected Result
Pickle call succeeds.
Actual Result
Exception.
C:\Dev\virtual_envs\play_3\Scripts\python.exe C:/Dev/play/requestspickle.py
Traceback (most recent call last):
  File "C:/Dev/play/requestspickle.py", line 7, in <module>
    session_pickle = pickle.dumps(session)
TypeError: can't pickle _thread._local objects
Reproduction Steps
import pickle
import requests
from requests.auth import HTTPDigestAuth

session = requests.Session()
session.auth = HTTPDigestAuth('user', 'passwd')
pickle.dumps(session)
System Information
$ python -m requests.help
{                                  
  "chardet": {                     
    "version": "3.0.4"             
  },                               
  "cryptography": {                
    "version": ""                  
  },                               
  "idna": {                        
    "version": "2.6"               
  },                               
  "implementation": {              
    "name": "CPython",             
    "version": "3.6.3"             
  },                               
  "platform": {                    
    "release": "7",                
    "system": "Windows"            
  },                               
  "pyOpenSSL": {                   
    "openssl_version": "",         
    "version": null                
  },                               
  "requests": {                    
    "version": "2.18.4"            
  },                               
  "system_ssl": {                  
    "version": "100020bf"          
  },                               
  "urllib3": {                     
    "version": "1.22"              
  },                               
  "using_pyopenssl": false         
}                                  