jamielennox commented on Nov 9, 2015
HI,
I'm writing an auth plugin in which I want to manipulate the cookies set by a response. Specifically in this case I need to use cookies for the auth exchange but i don't want them added to the session. When the response hooks and similar are finished the response is returned, the history examined and cookies merged into the cookie jar using the _original_response.msg httpmessage that urllib3 sets. This means there is no public way for me to manipulate the headers to prevent these cookies being added to the session.
From a quick examination my guess to address this would be to regenerate the httpmessage header list from the response.headers.
My solution for now is going to be not include the intermediate requests in the history so that the cookies don't get picked up. I'm also going to look into a cookie policy that simply denies everything.