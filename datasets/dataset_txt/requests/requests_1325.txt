samv commented on Aug 19, 2015
Hi there,
The pyopenssl.py under requests/packages/urllib3/contrib/pyopenssl.py is using select.select without trapping the exception raised when the underlying select(2) system call returns EINTR. This results in an exception:
    response = session.request(method, full_url, params=params, timeout=TIMEOUT, headers=HTTP_HEADERS)
  File ".../.virtualenv/local/lib/python2.7/site-packages/requests/sessions.py", line 465, in request
    resp = self.send(prep, **send_kwargs)
  File ".../.virtualenv/local/lib/python2.7/site-packages/requests/sessions.py", line 573, in send
    r = adapter.send(request, **kwargs)
  File ".../.virtualenv/local/lib/python2.7/site-packages/requests/adapters.py", line 370, in send
    timeout=timeout
  File ".../.virtualenv/local/lib/python2.7/site-packages/requests/packages/urllib3/connectionpool.py", line 544, in urlopen
    body=body, headers=headers)
  File ".../.virtualenv/local/lib/python2.7/site-packages/requests/packages/urllib3/connectionpool.py", line 372, in _make_request
    httplib_response = conn.getresponse(buffering=True)
  File "/usr/lib/python2.7/httplib.py", line 1127, in getresponse
    response.begin()
  File "/usr/lib/python2.7/httplib.py", line 453, in begin
    version, status, reason = self._read_status()
  File "/usr/lib/python2.7/httplib.py", line 409, in _read_status
    line = self.fp.readline(_MAXLINE + 1)
  File "/usr/lib/python2.7/socket.py", line 480, in readline
    data = self._sock.recv(self._rbufsize)
  File ".../.virtualenv/local/lib/python2.7/site-packages/requests/packages/urllib3/contrib/pyopenssl.py", line 184, in recv
    [self.socket], [], [], self.socket.gettimeout())
select.error: Interrupted system call
Current versions of pyopenssl don't make these calls; perhaps this can be fixed by updating the internal dependency?