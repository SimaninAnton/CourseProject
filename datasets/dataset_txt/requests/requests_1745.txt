clem2 commented on May 13, 2014
On Windows 7 64bit, uploading a file using requests via python-onedrive does not complete, to be more precise, only the first few bytes/kilobytes are uploaded.
Modified models.py for debugging as follows:
 def prepare(self, method=None, url=None, headers=None, files=None,
        data=None, params=None, auth=None, cookies=None, hooks=None):
    """Prepares the entire request with the given parameters."""

    ### ADDED FOR DEBUGGING
    with open(r'C:\Python\requests_debug.log', 'ab') as log:
      for k, file_tuple in files.viewitems():
        log.write('BEFORE: Key: {}, File tuple: {}, position: {}\n'.format(k, file_tuple, file_tuple[1].tell()))
    ### END

    self.prepare_method(method)
    self.prepare_url(url, params)
    self.prepare_headers(headers)
    self.prepare_cookies(cookies)
    self.prepare_body(data, files)
    self.prepare_auth(auth, url)
    # Note that prepare_auth must be last to enable authentication schemes
    # such as OAuth to work on a fully prepared request.

    # This MUST go after prepare_auth. Authenticators could add a hook
    self.prepare_hooks(hooks)

    ### ADDED FOR DEBUGGING
    with open(r'C:\Python\requests_debug.log', 'ab') as log:
      for k, file_tuple in files.viewitems():
        pos = file_tuple[1].tell()
        file_tuple[1].seek(0, os.SEEK_END)
        log.write('AFTER: Key: {}, position: {}, size: {}\n'.format(k, pos, file_tuple[1].tell()))
      log.write('Body size: {}\n'.format(len(self.body)))
    ### END
Here's an example log:
BEFORE: Key: file, File tuple: (u'nv2-pc.zip', <open file u'nv2-pc.zip', mode 'r' at 0x028B4EE8>, u'application/octet-stream'), position: 0
AFTER: Key: file, position: 4784128, size: 4787658
Body size: 522
As you can see, the body size is much smaller than the size indicated in AFTER.