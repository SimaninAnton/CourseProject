jgatkinsn commented on Mar 20, 2014
I have a problem where I'm trying to create a python script to test a single-threaded web server on an embedded device. I was having performance problems until I realized that I could only support one connection per session. When I made my own HTTP adapter to only use one connection with pool_block equal to True, one request got sent, then the script hung trying to send the next request.
If I comment out line 533 (the "if release_conn:") in request/package/urllib3/connectionpool.py, my problems go away. The script performances super duper fast as expected compared against a cURL bash script.
However, I'm not sure this is the proper fix for the problem, since I'm a special case. I need a way to configure this to run this single connection from the top-level api without getting blocked.
BTW, if I turn blocking off (pool_block == False), I get the same horrible performance. Basically, it has to do retries and slows down, because the web server can only handle one connection at a time.