Contributor
eriol commented on Jun 9, 2016
Hello,
I would like to bring this issue to your attention: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=801506
The problem shows in requests 2.10.0.
This is my test script:
import requests

URL = 'https://contributors.debian.org/contributors/test_post'
FILE = 'test.json.xz'
# FILE = 'test-small.json.xz' # This works

if __name__ == '__main__':

    payload = {'source': 'bugs.debian.org', 'data_compression': 'xz'}

    with open(FILE, 'rb') as f:
        r = requests.post(URL, files={'data': f}, data=payload)

    print(r.text)
test-small.json.xz is the same of test.json.xz only smaller: in my test I used only 10 objs.
curl is able to post correctly:
curl https://contributors.debian.org/contributors/test_post -F source=bugs.debian.org -F data=@test.json.xz -F data_compression=xz
github doesn't allow to upload a .xz so please take it from Debian BTS: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=801506;filename=test.json.xz;att=1;msg=15
Any suggestions?