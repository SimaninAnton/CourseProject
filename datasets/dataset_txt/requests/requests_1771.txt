steven-shi commented on Apr 14, 2014
Hi, I would like to have a gentle way to shutdown the Thread by hooking SIGINT, but noticed once Requests been used in Thread, it will void Signal handler. Please test following example, and you will notice you cannot shut down by CTRL+C even the SIGINT has been hooked.
import requests
import signal
import time
from threading import Thread
import sys

def shutdownHandler(signal, frame):
    print "Shutting down..."
    sys.exit(0)

def test_load():
    x=requests.get('http://www.google.com')
    x.close()
    time.sleep(200000)


if __name__ == '__main__':
    signal.signal(signal.SIGINT, shutdownHandler)
    t=Thread(target = test_load)
    t.start()
    signal.pause()
    t.join()
If you comment out
x=requests.get('http://www.google.com')
x.close()
Then run again, and press Ctrl+C, the process will be shutting down.
Any idea what's going in Requests?
Thanks a lot