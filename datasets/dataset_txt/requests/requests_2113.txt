Contributor
Kwpolska commented on May 23, 2013
I recently upgraded to Python 3.3.2 (from Arch Linux packages). With it, a script of mine broke. The script worked fine with 3.3.1 and still works fine with 2.7.5. Full traceback (s = requests.Session(); starturl = 'http://example.com' (okay, not exactly that, but you donâ€™t need nor want to know the actual URL))
  File "req.py", line 43, in <module>
    orig = s.get(starturl).text
  File "/usr/lib/python3.3/site-packages/requests/sessions.py", line 369, in get
    return self.request('GET', url, **kwargs)
  File "/usr/lib/python3.3/site-packages/requests/sessions.py", line 354, in request
    resp = self.send(prep, **send_kwargs)
  File "/usr/lib/python3.3/site-packages/requests/sessions.py", line 460, in send
    r = adapter.send(request, **kwargs)
  File "/usr/lib/python3.3/site-packages/requests/adapters.py", line 256, in send
    r = self.build_response(request, resp)
  File "/usr/lib/python3.3/site-packages/requests/adapters.py", line 125, in build_response
    extract_cookies_to_jar(response.cookies, req, resp)
  File "/usr/lib/python3.3/site-packages/requests/cookies.py", line 105, in extract_cookies_to_jar
    jar.extract_cookies(res, req)
  File "/usr/lib/python3.3/http/cookiejar.py", line 1647, in extract_cookies
    if self._policy.set_ok(cookie, request):
  File "/usr/lib/python3.3/http/cookiejar.py", line 931, in set_ok
    if not fn(cookie, request):
  File "/usr/lib/python3.3/http/cookiejar.py", line 952, in set_ok_verifiability
    if request.unverifiable and is_third_party(request):
  File "/usr/lib/python3.3/http/cookiejar.py", line 707, in is_third_party
    if not domain_match(req_host, reach(request.origin_req_host)):
AttributeError: 'MockRequest' object has no attribute 'origin_req_host'