andrewshokhin commented on Apr 27, 2018
I don't know who to blame (requests or urllib3), but though you guys can be interested:
Python 3.6.4 (v3.6.4:d48ecebad5, Dec 18 2017, 21:07:28) 
[GCC 4.2.1 (Apple Inc. build 5666) (dot 3)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
>>> import requests
>>> requests.get('http://imodules.com/')
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): imodules.com
DEBUG:urllib3.connectionpool:http://imodules.com:80 "GET / HTTP/1.1" 301 0
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): www.imodules.com
DEBUG:urllib3.connectionpool:http://www.imodules.com:80 "GET / HTTP/1.1" 302 None
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/Users/ashokhin/.venv/adstxt/lib/python3.6/site-packages/requests/api.py", line 72, in get
    return request('get', url, params=params, **kwargs)
  File "/Users/ashokhin/.venv/adstxt/lib/python3.6/site-packages/requests/api.py", line 58, in request
    return session.request(method=method, url=url, **kwargs)
  File "/Users/ashokhin/.venv/adstxt/lib/python3.6/site-packages/requests/sessions.py", line 508, in request
    resp = self.send(prep, **send_kwargs)
  File "/Users/ashokhin/.venv/adstxt/lib/python3.6/site-packages/requests/sessions.py", line 640, in send
    history = [resp for resp in gen] if allow_redirects else []
  File "/Users/ashokhin/.venv/adstxt/lib/python3.6/site-packages/requests/sessions.py", line 640, in <listcomp>
    history = [resp for resp in gen] if allow_redirects else []
  File "/Users/ashokhin/.venv/adstxt/lib/python3.6/site-packages/requests/sessions.py", line 218, in resolve_redirects
    **adapter_kwargs
  File "/Users/ashokhin/.venv/adstxt/lib/python3.6/site-packages/requests/sessions.py", line 658, in send
    r.content
  File "/Users/ashokhin/.venv/adstxt/lib/python3.6/site-packages/requests/models.py", line 823, in content
    self._content = bytes().join(self.iter_content(CONTENT_CHUNK_SIZE)) or bytes()
  File "/Users/ashokhin/.venv/adstxt/lib/python3.6/site-packages/requests/models.py", line 745, in generate
    for chunk in self.raw.stream(chunk_size, decode_content=True):
  File "/Users/ashokhin/.venv/adstxt/lib/python3.6/site-packages/urllib3/response.py", line 432, in stream
    for line in self.read_chunked(amt, decode_content=decode_content):
  File "/Users/ashokhin/.venv/adstxt/lib/python3.6/site-packages/urllib3/response.py", line 598, in read_chunked
    self._update_chunk_length()
  File "/Users/ashokhin/.venv/adstxt/lib/python3.6/site-packages/urllib3/response.py", line 540, in _update_chunk_length
    line = self._fp.fp.readline()
AttributeError: 'NoneType' object has no attribute 'readline'
$ python -m requests.help
{
  "chardet": {
    "version": "3.0.4"
  },
  "cryptography": {
    "version": ""
  },
  "idna": {
    "version": "2.6"
  },
  "implementation": {
    "name": "CPython",
    "version": "3.6.4"
  },
  "platform": {
    "release": "17.5.0",
    "system": "Darwin"
  },
  "pyOpenSSL": {
    "openssl_version": "",
    "version": null
  },
  "requests": {
    "version": "2.18.4"
  },
  "system_ssl": {
    "version": "100020df"
  },
  "urllib3": {
    "version": "1.22"
  },
  "using_pyopenssl": false
}