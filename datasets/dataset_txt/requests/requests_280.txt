Contributor
Stevoisiak commented on May 11, 2018 â€¢
edited
After sending a request, there should be an exception if the response Content-Type does not match the request Content-Type. (ie: text/xml vs text/html)
(For backwards compatibility, this could be configurable with with an optional boolean argument)
Expected Result
An Exception should be raised if the response Content-Type does not match the request.
Actual Result
The request will proceed without any warning, even if the response Content-Type does not match.
Reproduction Steps
import requests

url = "http://www.example.com"
xml_data = "<Request Object='System' Action='Ping'/>"
headers = {"Content-Type": "text/xml"}
response = requests.post(url, headers=headers, data=xml_data)
print(response.headers)  # {'Content-Type': 'text/html'}
System Information
{
  "chardet": {
    "version": "3.0.4"
  },
  "cryptography": {
    "version": ""
  },
  "idna": {
    "version": "2.6"
  },
  "implementation": {
    "name": "CPython",
    "version": "3.6.4"
  },
  "platform": {
    "release": "7",
    "system": "Windows"
  },
  "pyOpenSSL": {
    "openssl_version": "",
    "version": null
  },
  "requests": {
    "version": "2.18.4"
  },
  "system_ssl": {
    "version": "100020bf"
  },
  "urllib3": {
    "version": "1.22"
  },
  "using_pyopenssl": false
}