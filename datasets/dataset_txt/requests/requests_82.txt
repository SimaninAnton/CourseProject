mohammedgameel commented on May 16, 2019
I am trying to upload a file to wunderlist through their API
According to their documentation:
https://developer.wunderlist.com/documentation/endpoints/upload
I have succeeded in the first step which is to create the upload as follows:
(I am using python requests library)
headers = {'X-Access-Token': access_token, 'X-Client-ID': client_id, 'Content-Type': 'application/json'}
params = {'content_type':'application/json' , 'file_name': 'abc.txt','file_size':18}
params = json.dumps(params)
uploaded_r= requests.post('https://a.wunderlist.com/api/v1/uploads', headers=headers, data=params)
and got the response with the authorization of the first part of upload
'{"id":243803653,"user_id":84497133,"state":"new","type":"upload","expires_at":"2019-05-16T08:18:02.331Z","part":{"url":"https://upload.wunderlist.io/592d3140-59e0-0137-6b42-22000a5207ef-1557994382-276676?partNumber=1&uploadId=dzmW8CIfAN0v2dUWPNYcL9QOhaCRMpYDm4Wgho2zhxOz91Z946vWraJIYkdg4ivV8kpazt08X5ubU2ddaySy3ObrorqsbTNNg01rj3GqTOzzz39gTJc9AymGyxSu2vEW","date":"Thu, 16 May 2019 08:18:02 UTC +00:00","authorization":"AWS AKIAJEN6W4AO3LJODOAA:E1h8SD6kstwOX3ID2RHs6jyHvGY="}}'
The problem is:
I am trying to use the authorization and date to upload the file but I keep getting (SignatureDoesNotMatch) error
upload_url = ast.literal_eval(uploaded_r.text)['part']['url']
auth = ast.literal_eval(uploaded_r.text)['part']['authorization']
x_date = ast.literal_eval(uploaded_r.text)['part']['date']
upload_id = ast.literal_eval(uploaded_r.text)['id']
I have tried the following:
headers = {'Content-Type': '','Authorization': auth,'x-amz-date':x_date}
final_upload= requests.post(upload_url, data =open('abc.txt','rb') ,headers=headers)
headers = {'Content-Type': '','Authorization': auth,'x-amz-date':x_date}
files = {'file':open('abc.txt','rb').read()}
final_upload= requests.post(upload_url, files=files ,headers=headers)
headers = {'Content-Type': 'application/octet-stream','Authorization': auth,'x-amz-date':x_date}
files = {'file':open('abc.txt','rb').read()}
final_upload= requests.post(upload_url, files =open('abc.txt','rb') ,headers=headers)
I have tried also the put command:
headers = {'Content-Type': '','Authorization': auth,'x-amz-date':x_date}
files = {'file':open('abc.txt','rb').read()}
final_upload= requests.put(upload_url, data =open('abc.txt','rb') ,headers=headers)
but I get empty response and the next step which is mark the upload as finished returns (bad request) error