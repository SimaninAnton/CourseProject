oinopion commented on Feb 19, 2014
To reproduce:
>>> import requests
>>> requests.get('http://example.com', auth=(u'żółty', u'jaźń'))
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/home/paczkowski/.virtualenvs/tmp-8a0b7916bbc9fce4/local/lib/python2.7/site-packages/requests/api.py", line 55, in get
    return request('get', url, **kwargs)
  File "/home/paczkowski/.virtualenvs/tmp-8a0b7916bbc9fce4/local/lib/python2.7/site-packages/requests/api.py", line 44, in request
    return session.request(method=method, url=url, **kwargs)
  File "/home/paczkowski/.virtualenvs/tmp-8a0b7916bbc9fce4/local/lib/python2.7/site-packages/requests/sessions.py", line 349, in request
    prep = self.prepare_request(req)
  File "/home/paczkowski/.virtualenvs/tmp-8a0b7916bbc9fce4/local/lib/python2.7/site-packages/requests/sessions.py", line 287, in prepare_request
    hooks=merge_hooks(request.hooks, self.hooks),
  File "/home/paczkowski/.virtualenvs/tmp-8a0b7916bbc9fce4/local/lib/python2.7/site-packages/requests/models.py", line 291, in prepare
    self.prepare_auth(auth, url)
  File "/home/paczkowski/.virtualenvs/tmp-8a0b7916bbc9fce4/local/lib/python2.7/site-packages/requests/models.py", line 470, in prepare_auth
    r = auth(self)
  File "/home/paczkowski/.virtualenvs/tmp-8a0b7916bbc9fce4/local/lib/python2.7/site-packages/requests/auth.py", line 48, in __call__
    r.headers['Authorization'] = _basic_auth_str(self.username, self.password)
  File "/home/paczkowski/.virtualenvs/tmp-8a0b7916bbc9fce4/local/lib/python2.7/site-packages/requests/auth.py", line 31, in _basic_auth_str
    return 'Basic ' + b64encode(('%s:%s' % (username, password)).encode('latin1')).strip().decode('latin1')
UnicodeEncodeError: 'latin-1' codec can't encode character u'\u017c' in position 0: ordinal not in range(256)
I am not sure what behaviour is correct here, but rising UnicodeEncodeError is probably not the best.