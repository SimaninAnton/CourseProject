foxx commented on Apr 21, 2015
It would be nice to be able to prefix session URLs to avoid repetitive code.
Consider the following code;
from requests import Session
class MyTestCase(LiveServerTestCase):
    def test_url(self):
        s = Session()
        s.get("{}/api/people'.format(self.server_url))
        s.get("{}/api/cats'.format(self.server_url))
This could look a lot prettier by doing;
from requests import Session
class MyTestCase(LiveServerTestCase):
    def test_url(self):
        s = Session(prefix_url='http://example.com')
        s.get('/api/people')
        s.get('/api/cats')
In the mean time, I was able to achieve this by using a subclass;
class Session(requests.Session):
    """Helpers for performing API queries"""
    def __init__(self, *args, **kwargs):
        self.prefix_url = kwargs.get('prefix_url', None)
        super(Session, self).__init__(*args, **kwargs)

    def request(self, method, url, *args, **kwargs):
        if self.prefix_url:
            url = "{}{}".format(self.prefix_url, url)
        return super(Session, self).request(method, url, *args, **kwargs)
@kennethreitz would such a PR be accepted? Or does anyone know of a better way this could be done?