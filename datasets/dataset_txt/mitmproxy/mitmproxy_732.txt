laurmurclar commented on 7 Mar 2017
Steps to reproduce the problem:
Run mitmproxy --nonanonymous
Set up the proxy in System Preferences. Enter a username and password (here I used laura and pass respectively).
Navigate to a HTTP site. Verify that you can see the proxyauth credentials in the Detail tab when viewing the request in mitmproxy. See image below:
4. Navigate to a HTTPS site. Verify that the proxyauth credentials are not visible in the `Detail` tab. Example:
Any other comments? What have you tried so far?
The proxyauth metadata is not present in the request method of inline scripts either. It is present when the request is HTTP. I have not checked other events. Adding
mitmproxy.ctx.log(f.request.pretty_host + "- Adding credientials to metadata")
to line 109 of the proxyauth addon, and using a simple inline script:
def request(self, flow):
        ctx.log("Request recieved: " + flow.request.pretty_host + ". Metadata: " + str(flow.metadata))
I get the following output in the event log:
System information
Mitmproxy version: 3.0.0 (1.0.1dev0299-0x37c1c55)
Python version: 3.6.0
Platform: Darwin-15.6.0-x86_64-i386-64bit
SSL version: OpenSSL 1.0.2k 26 Jan 2017
Mac version: 10.11.6 ('', '', '') x86_64