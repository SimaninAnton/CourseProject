eltone commented on 13 Dec 2016
Steps to reproduce the problem:
Start mitmproxy with no flags
curl -v -u testuser:testpass --proxy localhost:8080 http://httpbin.org/basic-auth/testuser/testpass
curl -v --proxy localhost:8080 http://httpbin.org/get
Expected Outcome
The second request does not contain an authorization header.
Actual Outcome
The second request does contain an authorization header.
Any other comments? What have you tried so far?
This is causing issues when proxying requests to a domain where the auth type changes (context switching). The behaviour observed above does not occur when running curl without the proxy.
System information
Mitmproxy version: 0.18.2
Python version: 2.7.12
Platform: Darwin-14.5.0-x86_64-i386-64bit
SSL version: OpenSSL 1.0.2j 26 Sep 2016
Mac version: 10.10.5 ('', '', '') x86_64