novemberborn commented on 19 Jul 2011
Trying to view a JSON response, content type application/json, crashes with the following stacktrace:
Traceback (most recent call last):
  File "./mitmproxy", line 68, in <module>
    m.run()
  File "/Users/mark/Code/mitmproxy/libmproxy/console.py", line 1145, in run
    self.ui.run_wrapper(self.loop)
  File "/usr/local/Cellar/python/2.7.1/lib/python2.7/site-packages/urwid/raw_display.py", line 234, in run_wrapper
    return fn()
  File "/Users/mark/Code/mitmproxy/libmproxy/console.py", line 1605, in loop
    self.view.keypress(size, k)
  File "/usr/local/Cellar/python/2.7.1/lib/python2.7/site-packages/urwid/container.py", line 614, in keypress
    return self.body.keypress( (maxcol, remaining), key )
  File "/Users/mark/Code/mitmproxy/libmproxy/console.py", line 454, in keypress
    self.view_response()
  File "/Users/mark/Code/mitmproxy/libmproxy/console.py", line 343, in view_response
    self.state.view_body_mode
  File "/Users/mark/Code/mitmproxy/libmproxy/console.py", line 323, in _conn_text
    viewmode
  File "/Users/mark/Code/mitmproxy/libmproxy/utils.py", line 503, in wrap
    ret = f(self, *args)
  File "/Users/mark/Code/mitmproxy/libmproxy/console.py", line 1030, in _cached_conn_text
    txt.extend(self._find_pretty_view(content, hdrItems))
  File "/Users/mark/Code/mitmproxy/libmproxy/console.py", line 1001, in _find_pretty_view
    return self._view_conn_json(lines)
TypeError: _view_conn_json() takes exactly 3 arguments (2 given)