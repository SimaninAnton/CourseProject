ja8zyjits commented on 28 Dec 2016
Steps to reproduce the problem:
Copy this script from the examples
# This scripts demonstrates how mitmproxy can switch to a second/different upstream proxy
# in upstream proxy mode.
#
# Usage: mitmdump -U http://default-upstream-proxy.local:8080/ -s change_upstream_proxy.py
#
# If you want to change the target server, you should modify flow.request.host and flow.request.port


def proxy_address(flow):
   return ("username:password@localhost", 8081)


def request(flow):
    if flow.request.method == "CONNECT":
        # If the decision is done by domain, one could also modify the server address here.
        # We do it after CONNECT here to have the request data available as well.
        return
    address = proxy_address(flow)
    if flow.live:
        flow.live.change_upstream_proxy_server(address)
2] Run the above script.
Any other comments? What have you tried so far?
1] Iam trying to authenticate my proxy upstream server, but iam getting this error
$mitmdump -s mitmproxy_tool/update_mitmproxy.py -U http://127.0.0.1:8085 --no-http2
Loading script: mitmproxy_tool/update_mitmproxy.py
Proxy server listening at http://0.0.0.0:8080
127.0.0.1:37582: clientconnect
127.0.0.1:37582: GET http://www.httpbin.org/ip
 << Server connection to 127.0.0.1:8081 failed: Error connecting to "127.0.0.1:8081": [Errno -2] Name or service not known
2] any help could be really great
System information
Mitmproxy version: 0.18.2
Python version: 2.7.12
Platform: Linux-4.4.0-51-generic-x86_64-with-Ubuntu-16.04-xenial
SSL version: OpenSSL 1.0.2g 1 Mar 2016
Linux distro: Ubuntu 16.04 xenial