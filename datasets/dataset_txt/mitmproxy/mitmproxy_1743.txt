fjcaetano commented on 27 Nov 2013
Hey guys,
I'm having a problem when I try to intercept connections filtering by host:
Command Intercepts?
google.com NO
~h "Host: google.com" YES
~h "Host: .*\.google\.com" YES
~d google.com NO
~d "google.com" NO
The NO cases, nothing happens. No request/response is intercepted. When I try filtering the header host I succeed.
I checked the code and I see that the ~d pattern tries to find the regex within the host, but it's not working for some reason:
class FDomain(_Rex):
    code = "d"
    help = "Domain"
    def __call__(self, f):
        return bool(re.search(self.expr, f.request.host, re.IGNORECASE))
Can you guys help me? Am I doing something wrong? It's really annoying have to filter by host everytime.
Thanks in advance