brunowowk commented on 15 Feb 2017
Steps to reproduce the problem:
Create a mitmproxy.yml with:
ssl_insecure: true
Run mitmdump (using docker) with said config:
docker run -p 8080:8080 -v $(pwd):/config mitmproxy/mitmproxy:1.0.2 mitmdump --conf /config/mitmproxy.yml
Try accessing a site with invalid ssl certificate through the proxy:
https_proxy=localhost:8080 curl -k https://wrong.host.badssl.com/
Expected result:
Certificate Verification Error for wrong.host.badssl.com: hostname 'wrong.host.badssl.com' doesn't match either of '*.badssl.com', 'badssl.com'
Ignoring server verification error, continuing with connection
GET https://wrong.host.badssl.com/
               << 200 OK 475b
Actual result:
CONNECT wrong.host.badssl.com:443
 << Certificate Verification Error for wrong.host.badssl.com: hostname 'wrong.host.badssl.com' doesn't match either of '*.badssl.com', 'badssl.com'
Any other comments? What have you tried so far?
Running with --insecure flag works as expected:
docker run -p 8080:8080 -v $(pwd):/config mitmproxy/mitmproxy:1.0.2 mitmdump --insecure
System information
mitmdump 1.0.2
Using the docker hub image mitmproxy/mitmproxy:1.0.2