odessky commented on 28 Jun 2014
I try run transparent mode and get this error on client side:
Bad HTTP request line: 'GET http://google.com/ HTTP/1.0\r\n'
Settings on server side:
export http_proxy="http://serverip:80"
On server side:
Event log myip:33025: connect
myip:33025: transparent to serverip:80
myip:33025: 400: Bad HTTP request line: 'GET http://google.com/ HTTP/1.0\r\n'
myip:33025: disconnect
Srver settings:
iptables-save
Generated by iptables-save v1.4.7 on Fri Jun 27 17:39:47 2014
*nat
:PREROUTING ACCEPT [440:21502]
:POSTROUTING ACCEPT [2701:189122]
:OUTPUT ACCEPT [2701:189122]
-A PREROUTING -i eth0 -p tcp -m tcp --dport 80 -j REDIRECT --to-ports 8080
-A PREROUTING -i eth0 -p tcp -m tcp --dport 443 -j REDIRECT --to-ports 8080
COMMIT
Completed on Fri Jun 27 17:39:47 2014
sysctl net.ipv4.ip_forward
net.ipv4.ip_forward = 1
I think mitmproxy transparent was broken