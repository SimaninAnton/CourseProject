Contributor
jlhonora commented on 8 Jul 2015
I'm facing an issue when trying to view the details of a multipart POST request using mitmproxy.
Steps to reproduce the problem:
mitmproxy --port 8888
Make the request:
curl -F filename=597fee54-2682-42c1-a87f-9ae55b1bf402.zip \
       -F 597fee54-2682-42c1-a87f-9ae55b1bf402.zip=@597fee54-2682-42c1-a87f-9ae55b1bf402.zip \
       --proxy 192.168.2.92:8888 http://192.168.2.92:3000/api/v1/upload
The zip file can be found here. Sorry, can't expose the backend but I guess it is not really necessary.
The request is correctly processed in mitmproxy:
>> POST http://192.168.2.92:3000/api/v1/upload
        ‚Üê 200 application/json 29B 114ms
Press enter key to see the request's info and contents
What is the expected behavior?
mitmproxy shouldn't hang and it should display the request's contents.
What went wrong?
The process gets stuck, eating most of the CPU:
PID    COMMAND      %CPU
25376  python       95.8 
Any other comments?
I browsed the source code for a bit, tried to get the stacktrace with lldb, search for log files but didn't get much far. If anyone can point me in the right direction to debug this I'd be glad to help.
mitmproxy version: mitmproxy 0.12.1
Operating System: Darwin [edited].local 14.3.0 Darwin Kernel Version 14.3.0: Mon Mar 23 11:59:05 PDT 2015; root:xnu-2782.20.48~5/RELEASE_X86_64 x86_64