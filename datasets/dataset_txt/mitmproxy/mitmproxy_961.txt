Contributor
Schamper commented on 1 Sep 2016
Steps to reproduce the problem:
In [15]: from netlib import encoding

In [16]: encoding.decode('', 'deflate')
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-16-074267748746> in <module>()
----> 1 encoding.decode('', 'deflate')

/home/ames/dev/mitmproxy/netlib/encoding.pyc in decode(encoded, encoding, errors)
     54             type(e).__name__,
     55             repr(encoded)[:10],
---> 56             repr(encoding),
     57         ))
     58 

ValueError: error when decoding '' with 'deflate'
What is the expected behavior?
Return an empty string. gzip works as expected:
In [18]: encoding.decode('', 'gzip')
Out[18]: ''
What went wrong?
deflate and br are unable to decode empty strings.
Any other comments? What have you tried so far?
Not sure what the preferred way of solving this is. Possibly a check to return an empty string if an empty string is attempted to be decoded?
Mitmproxy Version: master (0.18)
Operating System: Ubuntu 16.04