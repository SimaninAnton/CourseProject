Member
mhils commented on 22 Jun 2016
mitmproxy.filt is one of the more tricky modules when it comes to porting. After discussing this briefly (https://mitmproxy.slack.com/archives/general/p1466578830000675), it looks like we want to match on bytes instead of unicode. The general battle plan looks as follows:
In mitmproxy.filt._Rex, convert to bytes in using escaped_str_to_bytes.
Convert all filters to match on bytes instead of str. In most cases, this can be accomplished by using the HTTP message's .data, e.g. f.request.method -> f.request.data.method
Replace _check_content_type with an implementation that manually iterates over headers.fields
Write weird tests involving bytes
@dufferzafar, how does that sound?