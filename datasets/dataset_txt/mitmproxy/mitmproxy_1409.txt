kuza55 commented on 23 Jun 2015
I spent a little bit of time looking at how redsocks supports transparent proxying of all TCP to a SOCKS proxy, and the code is really quite straight forward: https://github.com/darkk/redsocks/blob/2e3f648809e27cc19cb7a8702f19b553a7ef9a81/base.c#L102
I was hoping this could be integrated into mitmproxy to allow better transparent proxying.
I'm looking to use mitmproxy to see/alter the data that malware running inside a VM gets (with the MITM script being different for each of my 25 VMs) and at the moment the only real way I can do this is to setup 25 separate ip tables, run 25 instances of redsocks and 25 instances of mitmproxy.
This is all doable, but I would much rather configure 1 iptable, run 1 instance of mitmproxy and have a script that alters its behaviour based on the source IP.
I'm happy to write the patch myself is anyone has any pointers on how to integrate it with the existing codebase.