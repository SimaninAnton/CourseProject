jsoref commented on 29 May 2018
Steps to reproduce the problem:
install ubuntu-bionic (server)
apt install mitmproxy
mitmproxy
Any other comments? What have you tried so far?
$ /usr/bin/mitmproxy
pkg_resources.ContextualVersionConflict: (urwid 2.0.1 (/usr/lib/python3/dist-packages), Requirement.parse('urwid<1.4,>=1.3.1'), {'mitmproxy'})
# vi /usr/lib/python3/dist-packages/mitmproxy-2.0.2.egg-info/requires.txt
$ mitmproxy
pkg_resources.DistributionNotFound: The 'setuptools!=29.0.0,>=11.3' distribution was not found and is required by mitmproxy
# apt install -y python3-setuptools
$ mitmproxy
pkg_resources.DistributionNotFound: The 'ruamel.yaml<0.14,>=0.13.2' distribution was not found and is required by mitmproxy
# vi /usr/lib/python3/dist-packages/mitmproxy-2.0.2.egg-info/requires.txt
$ mitmproxy
pkg_resources.DistributionNotFound: The 'pyperclip<1.6,>=1.5.22' distribution was not found and is required by mitmproxy
# vi /usr/lib/python3/dist-packages/mitmproxy-2.0.2.egg-info/requires.txt
$ mitmproxy
pkg_resources.DistributionNotFound: The 'pyasn1<0.3,>=0.1.9' distribution was not found and is required by mitmproxy
# vi /usr/lib/python3/dist-packages/mitmproxy-2.0.2.egg-info/requires.txt
$ mitmproxy
pkg_resources.DistributionNotFound: The 'pyOpenSSL<17.0,>=16.0' distribution was not found and is required by mitmproxy
# vi /usr/lib/python3/dist-packages/mitmproxy-2.0.2.egg-info/requires.txt
$ mitmproxy
pkg_resources.DistributionNotFound: The 'html2text<=2016.9.19,>=2016.1.8' distribution was not found and is required by mitmproxy
# vi /usr/lib/python3/dist-packages/mitmproxy-2.0.2.egg-info/requires.txt
$ mitmproxy
...
pkg_resources.DistributionNotFound: The 'brotli<0.7,>=0.5.1' distribution was not found and is required by mitmproxy
# vi /usr/lib/python3/dist-packages/mitmproxy-2.0.2.egg-info/requires.txt
$ mitmproxy
System information
Mitmproxy version: 2.0.2 (release version)
Python version: 3.6.5
Platform: Linux-4.15.0-22-generic-x86_64-with-Ubuntu-18.04-bionic
SSL version: OpenSSL 1.1.0g  2 Nov 2017
Linux distro: Ubuntu 18.04 bionic
Fwiw, here's what I ended up doing:
apt install -y python3-setuptools
I picked these random versions (roughly replacing the first digit with a 9):
# egrep $(egrep 'ContextualVersionConflict|DistributionNotFound' /tmp/09 |sed -e "s/' .*//;s/.* '//;s/[<!=].*//;s/.*'//"|tr "\n" '|'|sed -e 's/.$//') /usr/lib/python3/dist-packages/mitmproxy-2.0.2.egg-info/requires.txt
brotli<9.7,>=0.5.1
html2text<=9016.9.19,>=2016.1.8
pyOpenSSL<97.0,>=16.0
pyasn1<9.3,>=0.1.9
pyperclip<9.6,>=1.5.22
ruamel.yaml<9.14,>=0.13.2
setuptools!=29.0.0,>=11.3
urwid<9.4,>=1.3.1
This might be better suited as a bug against debian/ubuntu, but, this is where I as a user came looking, and #868 was filed here...
Offhand, if setuptools is needed by the app, then it should be a dependency. As for the versions (or why making them arbitrarily large made things work)...
1