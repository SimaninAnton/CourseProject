laurentdinclaux commented on 12 Feb 2017 â€¢
edited
Steps to reproduce the problem:
I created a systemd startup file:
[Unit]
Description=Mitmproxy
After=network.target

[Service]
#Type=simple
Type=idle
EnvironmentFile=/etc/default/mitmproxy
User=mitmproxy
Group=mitmproxy
LimitNOFILE=32768
ExecStart=/usr/local/bin/mitmdump $DAEMON_ARGS --conf=$CONFFILE --cadir=/etc/mitmproxy

[Install]
WantedBy=multi-user.target
Whenever I reboot my ubuntu 16.04 VM, mitmdump runs, but throw error for SSL websites:
Cannot establish TLS with 216.58.204.104:443 (sni: ssl.google-analytics.com): TlsException("SSL handshake error: Error([('', 'osrandom_rand_bytes', 'getrandom() initialization failed.')],)",)
If I log into ssh and restart the service manually it then runs fine.
System information
Ubuntu 16.04 - mitmproxy 1.0.2