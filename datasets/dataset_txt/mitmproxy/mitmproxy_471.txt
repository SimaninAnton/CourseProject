Contributor
kajojify commented on 1 Jan 2018 â€¢
edited
Steps to reproduce the problem:
Open mitmproxy.
Press - to open two pane layout.
Start intercepting something.
Choose any flow to see Flow details.
Change focus on other tab by pressing Shift+Tab.
Click on "Request" or "Response" by pressing left button of mouse.
I am getting:
Traceback (most recent call last):
  File "mitmproxy/tools/console/master.py", line 216, in run
  File "site-packages/urwid/main_loop.py", line 278, in run
  File "site-packages/urwid/main_loop.py", line 376, in _run
  File "site-packages/urwid/main_loop.py", line 682, in run
  File "site-packages/urwid/main_loop.py", line 719, in _loop
  File "site-packages/urwid/raw_display.py", line 393, in <lambda>
  File "site-packages/urwid/raw_display.py", line 493, in parse_input
  File "site-packages/urwid/main_loop.py", line 403, in _update
  File "site-packages/urwid/main_loop.py", line 500, in process_input
  File "mitmproxy/tools/console/window.py", line 277, in mouse_event
  File "site-packages/urwid/container.py", line 1169, in mouse_event
  File "site-packages/urwid/container.py", line 1687, in mouse_event
  File "site-packages/urwid/container.py", line 1169, in mouse_event
  File "site-packages/urwid/container.py", line 1169, in mouse_event
  File "site-packages/urwid/container.py", line 1148, in mouse_event
  File "site-packages/urwid/container.py", line 2201, in mouse_event
  File "mitmproxy/tools/console/tabs.py", line 19, in mouse_event
  File "mitmproxy/tools/console/tabs.py", line 34, in change_tab
  File "mitmproxy/tools/console/tabs.py", line 73, in show
  File "mitmproxy/tools/console/flowview.py", line 86, in view_response
  File "mitmproxy/tools/console/flowview.py", line 160, in conn_text
  File "mitmproxy/command.py", line 221, in call
  File "mitmproxy/command.py", line 212, in call_args
  File "mitmproxy/command.py", line 101, in call
  File "mitmproxy/command.py", line 251, in wrapper
  File "mitmproxy/tools/console/consoleaddons.py", line 514, in flowview_mode
mitmproxy.exceptions.CommandError: Not viewing a flow.
Any other comments? What have you tried so far?
I think the problem is mitmproxy lets us to interact with other tab, when focusing on other.
So, we can click on different stuff in not focused tab by pressing left button of mouse.
It is possible due to https://github.com/mitmproxy/mitmproxy/blob/master/mitmproxy/tools/console/tabs.py
(in particular https://github.com/mitmproxy/mitmproxy/blob/master/mitmproxy/tools/console/tabs.py#L17).
tabs.Tabs is the superclass for HelpView and FlowDetails classes, so the problem is relevant to "Flow details" and "Help" tabs. Continue to work on it.
System information
Mitmproxy: 3.0.0.dev1101 (commit d9d4d15) binary
Python: 3.5.2
OpenSSL: OpenSSL 1.1.0g 2 Nov 2017
Platform: Linux-4.4.0-104-generic-x86_64-with-debian-stretch-sid