ncoleman commented on 10 May 2013
New install, this happens with both 0.8 and latest pull from git. I also pulled latest netlib from git, and I updated urwid to latest 1.1.1.
On first use, mitmproxy opens ok and displays help ok. When I set browser to use mitm as proxy, mitmproxy immediately crashes with backtrace:
Traceback (most recent call last): File "/usr/bin/mitmproxy", line 67, in <module> m.run() File "/usr/lib/python2.7/site-packages/libmproxy/console/__init__.py", line 595, in run self.ui.run_wrapper(self.loop) File "/usr/lib/python2.7/site-packages/urwid/raw_display.py", line 242, in run_wrapper return fn() File "/usr/lib/python2.7/site-packages/libmproxy/console/__init__.py", line 804, in loop size = self.drawscreen() .... File "/usr/lib/python2.7/site-packages/urwid/widget.py", line 1008, in render return apply_text_layout(text, attr, trans, maxcol) File "/usr/lib/python2.7/site-packages/urwid/canvas.py", line 1291, in apply_text_layout text[s.offs:s.end]) File "/usr/lib/python2.7/site-packages/urwid/util.py", line 121, in apply_target_encoding s = s.encode( _target_encoding ) UnicodeEncodeError: 'latin-1' codec can't encode character u'\u2190' in position 0: ordinal not in range(256)
This happens with 0.8 and 0.9 pulled from git. I wonder if this question in StackOverflow provides an answer: http://stackoverflow.com/questions/3942888/unicodeencodeerror-latin-1-codec-cant-encode-character
The bt makes it look like it is a bug in urwid, but why is this (apparently, since no one else is reporting it) happening only to me?. Firefox is set to auto detect encoding, and the crash happens on any random page I request. My LANG environment is xxxx.UTF-8.