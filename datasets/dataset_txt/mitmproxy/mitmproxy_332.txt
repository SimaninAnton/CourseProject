samiux commented on 6 Apr 2018
The mitmproxy version is 3.0.4
The python version is 3.6
The iptable rule :
sudo iptables -t nat -A PREROUTING -i eth0 -p tcp --match multiport --dport 80,443 -j REDIRECT --to-port 8080
The command to run :
mitmdump -p 8080 -s /etc/myscript/myscript.py -m transparent -q -k --certs *.mysite.com=/etc/mycert/mysite.pem --set spoof_source_address=true
The result :
502 Bad Gateway
ProtocolException('Server connection to ('192.168.20.100', 443) failed: Error connecting to "192.168.20.100": [Errno 99] Cannot assign requested address',)
The findings :
When "spoof_source_address" is used alone, it will crash with the captioned error.
When "spoof_source_address" used with "upstream_bind_address" and "upstream_bind_address" not blanks, it will running smoothly.
If "upstream_bind_address" is blanked with "spoof_source_address", it will also crash with the captioned error.
Can "spoof_source_address" work alone? In my understanding, "spoof_source_address" will show the original source client IP address. Am I right?