Member
cortesi commented on 5 Sep 2016
We need to handle invalid hostnames more gracefully. See the discussion here:
https://discourse.mitmproxy.org/t/mitmproxy-not-working-with-urls-which-have-under-scores/
Steps to reproduce the problem:
mitmdump -vv
env http_proxy=http://localhost:8080 curl "http://foo_bar.com"
My inclination here is to make the host matching more liberal, and pass this sort of error upstream. Basically, if I'm using mitmproxy in an analysis situation, and the client is exhibiting this behaviour, I want to see what the server does with it rather than see an error.
Either way, we certainly shouldn't be spewing a user-visible traceback to the logs for this kind of protocol error.