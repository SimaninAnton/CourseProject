mkonecny commented on 19 Feb 2015
Having a really strange issue. We have an app written for both Android and iOS.
I set mitmproxy to listen on port 443, and forward all requests to our nginx server on port 80. The following command is used:
sudo mitmproxy -R https2http://localhost:80/ -p 443 --cert cert.pem
Android requests are forwarded just fine. They are simple POST/GET requests. The equivalent requests in iOS do not work if mitmproxy is in the middle - and work fine otherwise.
Here is what I see:
a) in mitmproxy, the request is red, with reason
HttpError("Invalid server response: '<head><title>400 Bad Request</title></head>\\r\\n'",)
b) in nginx access.log, I see random hex values where I would normally see the HTTP verb and path. Example:
127.0.0.1 - - [19/Feb/2015:02:03:46 +0000] "\x16\x03\x01\x01L\x01\x00\x01H\x03\x03\x88#\xCE\x0F?\xD1\xC9\xBF\x8C\x0C:|*\x92{-\x96\x92\x8CM*\xA2\xF7)o\xBF\x9Cl\xDB\x953\xDA\x00\x00\x92\xC00\xC0,\xC0(\xC0$\xC0\x14\xC0" 400 166 "-" "-"
Any hints on where I should start poking around?