muralisr commented on 13 Nov 2016
Steps to reproduce the problem:
Run mitmdump with a simple inline script that changes the host to one capable of h2.
Open https://holmusk.com (any website that only supports http1.1) via Chrome connected to proxy server
Observe mitmdump stdout for error like below -
Any other comments? What have you tried so far?
Here is the script I am using to change the host -
Changing host to a server that supports HTTP1.1 only helps to bypass the issue. So does passing in the disable http2 flag when starting mitmdump. Also force setting scheme and port to http and 80 helps to mask the issue (since h2 works on https only).
I have already created an AWS CloudFront distribution that is capable of h2. flow.request.host = 'dvmu1lzlfqifb.cloudfront.net'. Please pass in the original website hostname as a request header flow.request.headers['Dex-Client-Domain'] = 'https://holmusk.com/' if you want to use my distribution.
System information
Mitmproxy version: 0.19
Python version: 3.5.2
Platform: Linux-4.4.0-45-generic-x86_64-with-Ubuntu-16.04-xenial
SSL version: OpenSSL 1.0.2g 1 Mar 2016
Linux distro: Ubuntu 16.04 xenial