tysonnorris commented on 8 Jul 2014
I am attempting to reverse proxy requests to an https server via:
$ mitmproxy -p 9090 -e -v -v -v -v -v -R https://
However, when I issue requests to localhost:9090, I get incorrect responses which vary based on using http/https in my client:
$ curl -k -v http://localhost:9090 -> 502 NetLibError("SSL handshake error: [('SSL routines', 'SSL23_GET_CLIENT_HELLO', 'http request')]",)
$ curl -k -v https://localhost:9090 -> 404
I thought I should be able to use http in curl, and allow proxy request to happen via ssl?
event log for my example using https://www.gmail.com:
127.0.0.1:58831: clientconnect
127.0.0.1:58831: Set new server address: www.gmail.com:443
127.0.0.1:58831: serverconnect
-> www.gmail.com:443
127.0.0.1:58831: Establish SSL
-> with client
-> with server (sni: None)
127.0.0.1:58831: error: NetLibError("SSL handshake error: [('SSL routines', 'SSL23_GET_CLIENT_HELLO', 'http request')]",)
127.0.0.1:58831: serverdisconnect
-> www.gmail.com:443
127.0.0.1:58831: clientdisconnect
127.0.0.1:58848: clientconnect
127.0.0.1:58848: Set new server address: www.gmail.com:443
127.0.0.1:58848: serverconnect
-> www.gmail.com:443
127.0.0.1:58848: Establish SSL
-> with client
-> with server (sni: None)
127.0.0.1:58848: request
-> GET / HTTP/1.1
127.0.0.1:58848: response
-> HTTP/1.1 404 Not Found
127.0.0.1:58848: error: NetLibDisconnect()
127.0.0.1:58848: serverdisconnect
-> www.gmail.com:443
127.0.0.1:58848: clientdisconnect