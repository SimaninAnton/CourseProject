chumaitoe commented on 5 Nov 2015
(this is a companion to #817, HTTPS whitelist based on SNI)
I have a transparent proxy interposed between an android device and the internet, such that all traffic runs through the proxy. I want to sort the traffic such that connections to our servers (i.e. from our app) go through the proxy (i.e., display), while other traffic (from the device) goes through a RawTCPLayer so that they are not shown in the proxy display.
I would like to have a flag that would take a list of domains, each of which would be compared to the value of the Host header. Requests that match would be sent through the proxy, while those that do not match can go through a RawTCPLayer so they do not display.
The potential sticky bit is that the bytes with the Host header may not have arrived yet when the flow is being examined for routing... I did not quite get a clear enough picture of the internals to know either way.