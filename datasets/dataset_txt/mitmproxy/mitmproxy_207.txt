wuhengzhi commented on 19 Sep 2018 â€¢
edited
Steps to reproduce the problem:
./mitmdump -b 127.0.0.1 -p 8000 -s "mitm.py" -U http://192.168.1.100:8001
chrome --proxy-server=http://127.0.0.1:8000
open video page: http://v.pptv.com/show/IxoEg8c0LmzPTbU.html?&rcc_src=B3&spm=v_show_web.0.1.3.1.0.0.5.0.0.0.0
Note: In "mitm.py", there is no special operation for "response()".
From the output of mitmdump, there are some tips:
GET http://122.143.10.155/0/11343872/0/2b9f90009f74b959a772d5b65173aab4.mp4?fpp.ver=1.3.0.23&key=cbcfea3666fecc72c526e905281ec847&k=e9cb6c7327d7556a30ae542141209680-a8f6-1537374975%26bppcataid%3D9&type=web.fpp&vvid=b84822b8-e010-b294-3811-f1d4b9ff5a03 << 206 Partial Content [content missing] 887ms
or
127.0.0.1:56546: GET http://122.143.10.155/0/11343872/0/2b9f90009f74b959a772d5b65173aab4.mp4?fpp.ver=1.3.0.23&key=cbcfea3666fecc72c526e905281ec847&k=e9cb6c7327d7556a30ae542141209680-a8f6-1537374975%26bppcataid%3D9&type=web.fpp&vvid=b84822b8-e010-b294-3811-f1d4b9ff5a03 << 206 Partial Content 8.66m 127.0.0.1:56546: Error in HTTP connection: TcpDisconnect('[Errno 32] Broken pipe',)
This will lead to the request status to "canceled" in chrome.
Note: This video link is breakpoint continuingly.
Any other comments? What have you tried so far?
For other links, no problem.
Without upstream proxy, no problem.
I have also tried mitmproxy 4.0.1, and added the options, like "--stream" and "--body-limit-size", but have the same issue.
I have read the series issues in #1764, and tried the method in #856 to set response.stream=True, but also failed.
System information
Ubuntu 16.04
mitmdump version: 2.0.2 and 4.0.1
Is this a bug or something need to set? Thanks.