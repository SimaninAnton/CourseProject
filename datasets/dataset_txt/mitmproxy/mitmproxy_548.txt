sikmir commented on 27 Sep 2017
Steps to reproduce the problem
$ docker pull docker pull mitmproxy/mitmproxy:2.0.2
$ cat << 'EOF' > docker-compose.yml
version: '3'
services:
  mitmproxy:
    image: mitmproxy/mitmproxy:2.0.2
    container_name: mitmproxy
    ports:
      - 8080:8080
    volumes:
      - ~/.mitmproxy:/home/mitmproxy/.mitmproxy
EOF
$ docker-compose up -d mitmproxy
$ docker-compose logs mitmproxy
Attaching to mitmproxy
mitmproxy    | Traceback (most recent call last):
mitmproxy    |   File "/usr/lib/python3.5/site-packages/mitmproxy/tools/console/master.py", line 281, in run
mitmproxy    |     self.loop.run()
mitmproxy    |   File "/usr/lib/python3.5/site-packages/urwid/main_loop.py", line 278, in run
mitmproxy    |     self._run()
mitmproxy    |   File "/usr/lib/python3.5/site-packages/urwid/main_loop.py", line 376, in _run
mitmproxy    |     self.event_loop.run()
mitmproxy    |   File "/usr/lib/python3.5/site-packages/urwid/main_loop.py", line 682, in run
mitmproxy    |     self._loop()
mitmproxy    |   File "/usr/lib/python3.5/site-packages/urwid/main_loop.py", line 719, in _loop
mitmproxy    |     self._watch_files[fd]()
mitmproxy    |   File "/usr/lib/python3.5/site-packages/urwid/raw_display.py", line 393, in <lambda>
mitmproxy    |     event_loop, callback, self.get_available_raw_input())
mitmproxy    |   File "/usr/lib/python3.5/site-packages/urwid/raw_display.py", line 427, in get_available_raw_input
mitmproxy    |     codes = self._get_gpm_codes() + self._get_keyboard_codes()
mitmproxy    |   File "/usr/lib/python3.5/site-packages/urwid/raw_display.py", line 501, in _get_keyboard_codes
mitmproxy    |     code = self._getch_nodelay()
mitmproxy    |   File "/usr/lib/python3.5/site-packages/urwid/raw_display.py", line 635, in _getch_nodelay
mitmproxy    |     return self._getch(0)
mitmproxy    |   File "/usr/lib/python3.5/site-packages/urwid/raw_display.py", line 545, in _getch
mitmproxy    |     return ord(os.read(self._term_input_file.fileno(), 1))
mitmproxy    | TypeError: ord() expected a character, but string of length 0 found
mitmproxy    |
mitmproxy    | mitmproxy has crashed!
mitmproxy    | Please lodge a bug report at:
mitmproxy    |  https://github.com/mitmproxy/mitmproxy
mitmproxy    | Shutting down...
The same problem with latest tag.