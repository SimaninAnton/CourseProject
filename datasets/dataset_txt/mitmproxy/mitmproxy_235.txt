Contributor
muffl0n commented on 31 Jul 2018
Steps to reproduce the problem:
Install Chrome 68
Start mitmproxy, add mitmproxy-ca to your cert-store
Open any site via https
Chrome shows NET::ERR_CERT_VALIDITY_TOO_LONG error
Any other comments? What have you tried so far?
In #815 the validity of the certificates was reduced to three years which was enough for Chrome's "not valid longer than 39 month". It seems like Chrome 68 changed this to a shorter value though I haven't found any evidence in the code yet.
After tinkering around I found that the value "71107200" (around 27 month) for DEFAULT_EXP is the greatest value that is accepted by Chrome.
I know that I'm not using the most recent version of mitmproxy but the value for DEFAULT_EXP is the same in the current version so I assume the problem is still the same.
Suggesting to just reduce the validity to something really short, like Let's Encrypt's three month. Should not be a problem and saves us from further reduction in Chrome.
System information
-> % mitmproxy --version
Mitmproxy: 3.0.3
Python: 3.6.6
OpenSSL: OpenSSL 1.1.0h 27 Mar 2018
Platform: Linux-4.17.8-1-ARCH-x86_64-with-arch