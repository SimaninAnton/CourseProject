loretoparisi commented on 11 Dec 2015 â€¢
edited
I have tried the read_dumpfile example like this
mitmproxy -p 11112 -s script/res_save.py
where the script does:
# Store persistent cache
def storePersistentCache(data, key):
        html_file = open(key + ".cbx", "w")
        html_file.write( data )
        html_file.close()

def request(context, flow):
        req = flow.request;
        if flow.request.pretty_host(hostheader=True).endswith("mydomain.com"):
                try:
                        out = req.assemble();
                        storePersistentCache( out,  flow.request.pretty_host(hostheader=True) );
                except Exception as ee:
                        pass

def response(context, flow):
        if flow.request.pretty_host(hostheader=True).endswith("mydomain.com"):
                res = flow.response;
                try:
                        #print res.assemble();
                        if res.content:
                                size = len(res.content);
                                size  = min(size, 20);
                                #if res.content[0:size] != res.get_decoded_content()[0:size]:
                                        #print("\n\n");
                                        #print res.get_decoded_content()
                except Exception as ee:
                        pass
and then
macbookproloreto:mitmproxy admin$ python examples/read_dumpfile mydomain.com cbx 
Flow file corrupted. Stopped loading.
macbookproloreto:mitmproxy admin$ 