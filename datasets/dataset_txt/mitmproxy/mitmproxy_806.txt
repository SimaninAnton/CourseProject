azixMcAze commented on 3 Jan 2017 •
edited
I use mitmweb as a reverse proxy.
I get an error message in the terminal console when the reason of the server's response contains an accent : "201 Crée"
Messages in the terminal console:
192.168.1.46:56261: clientconnect
ERROR:root:Error sending message
Traceback (most recent call last):
File "/usr/local/Cellar/mitmproxy/1.0.2/libexec/lib/python3.6/site-packages/mitmproxy/tools/web/app.py", line 192, in broadcast
conn.write_message(message)
File "/usr/local/Cellar/mitmproxy/1.0.2/libexec/lib/python3.6/site-packages/tornado/websocket.py", line 213, in write_message
return self.ws_connection.write_message(message, binary=binary)
File "/usr/local/Cellar/mitmproxy/1.0.2/libexec/lib/python3.6/site-packages/tornado/websocket.py", line 681, in write_message
message = tornado.escape.utf8(message)
File "/usr/local/Cellar/mitmproxy/1.0.2/libexec/lib/python3.6/site-packages/tornado/escape.py", line 200, in utf8
return value.encode("utf-8")
UnicodeEncodeError: 'utf-8' codec can't encode character '\udce9' in position 126: surrogates not allowed
Messages in the event log in the browser:
192.168.1.46:56261: clientconnect
192.168.1.46:56261: request
-> Request(POST /XXXX)
192.168.1.46:56261: serverconnect
-> 10.1.1.1:8080
192.168.1.46:56261: response
-> Response(201 Cr�e, application/json, 369b)
The request is visible in the webpage, it looks like a minor issue.
It is the same server that caused #1849
On a sidenote, the accent is not displayed correctly neither in the response tab nor in the event log (it displays an unicode error box <?>)
I have not checked if the server's response's reason is in utf8 or in another charset
System information
Mitmproxy version: 1.0.2
Python version: 3.6.0
Platform: Darwin-14.5.0-x86_64-i386-64bit
SSL version: OpenSSL 1.1.0c 10 Nov 2016
Mac version: 10.10.5 ('', '', '') x86_64
OSX in French