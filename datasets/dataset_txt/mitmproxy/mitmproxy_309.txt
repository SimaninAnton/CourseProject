BlackHoleFox commented on 10 May 2018
I'm currently trying to figure out how my Honeywell IoT thermostat talks home and I setup a MITMProxy instance to run all its traffic through, though all that ever appears are console errors saying
HTTP Protocol error in client request: Bad HTTP request line: b&#x27;CBKPPR\\x05PB\\x00&amp;\\x00\\x00\\x00\\x00\\xd0-3\\xc1`a^\\xcdOF\\x93\\xe9\\x93\\xbf/\\xadTE\\xd4M\\xca&lt;\\xeb\\x97\\xe4\\xd7B^i}\\x05\\xbf\\xdf\\x85\\xd
It works fine off the proxy, and I have tried the proxy in both transparent and regular mode. I have the Thermostat's default gateway set to the IP of the MITMInstance. Wireshark analysis shows that Honeywell's server is returning a "Bad Request" and also a "Bad Gateway" to the IP of my Thermostat.
If anyone can shine some light on this topic, it would be greatly appreciated. (Don't you just love IoT?)
System information
Mitmproxy: 3.0.4 binary
Python: 3.6.3
OpenSSL: OpenSSL 1.1.0h 27 Mar 2018
Platform: Linux-4.13.0-41-generic-x86_64-with-debian-stretch-sid