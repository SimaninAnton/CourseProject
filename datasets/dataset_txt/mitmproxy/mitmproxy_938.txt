christypriory commented on 21 Sep 2016
Steps to reproduce the problem:
Testing samsung swiftkey exploit here https://github.com/nowsecure/samsung-ime-rce-poc/
Execute mitmproxy --ignore swiftkey.net --host -s samsung_keyboard_mitmproxy_exploit.py -p 8080
Configure the Android device proxy with IP and Port 8080.
Visit http://apple.com
Crash Log
Traceback (most recent call last):
  File "/usr/lib/python2.7/dist-packages/mitmproxy/proxy/server.py", line 121, in handle
    root_layer()
  File "/usr/lib/python2.7/dist-packages/mitmproxy/proxy/modes/http_proxy.py", line 11, in __call__
    layer()
  File "/usr/lib/python2.7/dist-packages/mitmproxy/protocol/tls.py", line 358, in __call__
    layer()
  File "/usr/lib/python2.7/dist-packages/mitmproxy/protocol/http1.py", line 67, in __call__
    layer()
  File "/usr/lib/python2.7/dist-packages/mitmproxy/protocol/http.py", line 204, in __call__
    self.send_response_to_client(flow)
  File "/usr/lib/python2.7/dist-packages/mitmproxy/protocol/http.py", line 274, in send_response_to_client
    self.send_response(flow.response)
  File "/usr/lib/python2.7/dist-packages/mitmproxy/protocol/http.py", line 55, in send_response
    self.send_response_headers(response)
  File "/usr/lib/python2.7/dist-packages/mitmproxy/protocol/http1.py", line 37, in send_response_headers
    raw = http1.assemble_response_head(response)
  File "/usr/lib/python2.7/dist-packages/netlib/http/http1/assemble.py", line 31, in assemble_response_head
    headers = _assemble_response_headers(response.data)
  File "/usr/lib/python2.7/dist-packages/netlib/http/http1/assemble.py", line 102, in _assemble_response_headers
    return bytes(response.headers)
  File "/usr/lib/python2.7/dist-packages/netlib/http/headers.py", line 107, in __bytes__
    return b"\r\n".join(b": ".join(field) for field in self.fields) + b"\r\n"
  File "/usr/lib/python2.7/dist-packages/netlib/http/headers.py", line 107, in <genexpr>
    return b"\r\n".join(b": ".join(field) for field in self.fields) + b"\r\n"
TypeError: sequence item 1: expected string, list found

mitmproxy has crashed!
Please lodge a bug report at: https://github.com/mitmproxy/mitmproxy
Mitmproxy Version: 0.17.1
Operating System: Kali Linux