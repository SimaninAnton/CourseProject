raulsiles commented on 25 Jan 2018
Steps to reproduce the problem:
I'm trying to run mitmproxy in transparent mode with an upstream proxy.
# mitmproxy -T --host -U http://127.0.0.1:8081
mitmproxy: Transparent, SOCKS5, reverse and upstream proxy mode are mutually exclusive. Read the docs on proxy modes to understand why.
The error message specifies both modes are mutually exclusive, although the documentation does not talk specifically about this scenario, where these two modes are combined:
http://docs.mitmproxy.org/en/stable/modes.html
I think there are scenarios where this setup might work, and could be required. Why are they mutually exclusive?
Any other comments? What have you tried so far?
Several other previous mitmproxy GitHub issues already reference chaining proxies. The idea is to intercept all the traffic (both HTTP and HTTPS) from a non-aware proxy client in transparent mode, via mitmproxy, and redirect all its traffic to Burp, as an upstream proxy:
client <---> mitmproxy <---> Burp <---> Internet <---> server
This could also be a very common scenario if you need to use mitmproxy in transparent mode, but you are forced to get out to the Internet through a corporate proxy:
client <---> mitmproxy <---> Corporate proxy <---> Internet <---> server
System information
Mitmproxy version: 2.0.2 (release version)
Python version: 3.6.4
Platform: Linux-4.14.0-kali3-amd64-x86_64-with-Kali-kali-rolling-kali-rolling
SSL version: OpenSSL 1.1.0g 2 Nov 2017
Linux distro: Kali kali-rolling kali-rolling
1