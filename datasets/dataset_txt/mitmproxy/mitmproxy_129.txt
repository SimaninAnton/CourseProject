KOLANICH commented on 28 May 2019 â€¢
edited
Wireshark has a feature called extcap. There is an extcap dir in Wireshark dir. In this dir binaries reside. These binaries have the same command line interface. Wireshark introspects their capabilities and configures and calls them via CLI. They output a pcap stream into the pipe they get as a CLI arg.
It may make sense to have a mode of mitmproxy, which doesn't start a web interface, but works like an extcap, but Wireshark is used as a visualizing and analysing app.
Here is an example of extcap: https://github.com/wireshark/wireshark/blob/master/doc/extcap_example.py