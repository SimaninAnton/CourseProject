pauldraper commented on 10 Jun 2019 â€¢
edited
How can I use MITM proxy as an HTTPS proxy in front of an HTTP proxy?
So https_proxy=http://mitmproxy curl https://example.com would CONNECT to mitmproxy, and mitmproxy would send a GET Host: example.com to a configured upstream server, which would send GET Host: example.com to example.com.
My current solution:
Regular mode
Disable HTTP2
Addon
def http_connect(flow):
    flow.request.host = <upstream_proxy_host>
    flow.request.port = <upsteam_proxy_port>
Disable mitmproxy SSL checks
Add SSL proxy upsteam.
Is there a better way?