voider1 commented on 29 Nov 2017
def start():
    parser = argparse.ArgumentParser()
    parser.add_argument('--fake', type=str)
    args = parser.parse_args()
    return Replacer(args.fake)


class Replacer:
    def __init__(self, fake):
        self.fake = fake

    def request(self, flow):
             ctx.log.info("HOST {}".format(flow.request.host))


    def response(self, flow):
        if flow.request.host == self.fake:
            ctx.log.info("HOST: {}".format(flow.request.host))
            ctx.log.info("PATH: {}".format(flow.request.path))
            ctx.log.info("REQUEST RAW_CONTENT: {}".format(flow.request.raw_content))
            ctx.log("RESPONSE: {}".format(flow.response.content))
For some reason this script doesn't print the HOST at every request. Any ideas?