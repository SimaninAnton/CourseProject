ldelossa commented on 27 Jul 2018 â€¢
edited by mhils
Steps to reproduce the problem:
Intermittent
Any other comments? What have you tried so far?
Followed directions in issue and opened bug report.
System information
Issue:
rror: [::1]:57274: Traceback (most recent call last):(more in eventlog)Traceback (most recent call last):
  File "/usr/local/Cellar/mitmproxy/4.0.3_1/libexec/lib/python3.7/site-packages/mitmproxy/proxy/modes/http_proxy.py", line 9, in __call__
    layer()
  File "/usr/local/Cellar/mitmproxy/4.0.3_1/libexec/lib/python3.7/site-packages/mitmproxy/proxy/protocol/tls.py", line 286, in __call__
    layer()
  File "/usr/local/Cellar/mitmproxy/4.0.3_1/libexec/lib/python3.7/site-packages/mitmproxy/proxy/protocol/http1.py", line 83, in __call__
    layer()
  File "/usr/local/Cellar/mitmproxy/4.0.3_1/libexec/lib/python3.7/site-packages/mitmproxy/proxy/protocol/http.py", line 188, in __call__
    if not self._process_flow(flow):
  File "/usr/local/Cellar/mitmproxy/4.0.3_1/libexec/lib/python3.7/site-packages/mitmproxy/proxy/protocol/http.py", line 260, in _process_flow
    return self.handle_regular_connect(f)
  File "/usr/local/Cellar/mitmproxy/4.0.3_1/libexec/lib/python3.7/site-packages/mitmproxy/proxy/protocol/http.py", line 206, in handle_regular_connect
    layer()
  File "/usr/local/Cellar/mitmproxy/4.0.3_1/libexec/lib/python3.7/site-packages/mitmproxy/proxy/protocol/tls.py", line 279, in __call__
    self._establish_tls_with_client_and_server()
  File "/usr/local/Cellar/mitmproxy/4.0.3_1/libexec/lib/python3.7/site-packages/mitmproxy/proxy/protocol/tls.py", line 354, in _establish_tls_with_client_and_server
    self.ctx.connect()
  File "/usr/local/Cellar/mitmproxy/4.0.3_1/libexec/lib/python3.7/site-packages/mitmproxy/proxy/protocol/tls.py", line 300, in connect
    self.ctx.connect()
  File "/usr/local/Cellar/mitmproxy/4.0.3_1/libexec/lib/python3.7/site-packages/mitmproxy/proxy/protocol/base.py", line 166, in connect
    self.server_conn.connect()
  File "/usr/local/Cellar/mitmproxy/4.0.3_1/libexec/lib/python3.7/site-packages/mitmproxy/connections.py", line 267, in connect
    tcp.TCPClient.connect(self)
  File "/usr/local/Cellar/mitmproxy/4.0.3_1/libexec/lib/python3.7/site-packages/mitmproxy/net/tcp.py", line 463, in connect
    self.ip_address = connection.getpeername()
OSError: [Errno 22] Invalid argument

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/Cellar/mitmproxy/4.0.3_1/libexec/lib/python3.7/site-packages/mitmproxy/proxy/server.py", line 121, in handle
    root_layer()
  File "/usr/local/Cellar/mitmproxy/4.0.3_1/libexec/lib/python3.7/site-packages/mitmproxy/proxy/modes/http_proxy.py", line 12, in __call__
    self.disconnect()
  File "/usr/local/Cellar/mitmproxy/4.0.3_1/libexec/lib/python3.7/site-packages/mitmproxy/proxy/protocol/base.py", line 147, in disconnect
    self.server_conn.finish()
  File "/usr/local/Cellar/mitmproxy/4.0.3_1/libexec/lib/python3.7/site-packages/mitmproxy/connections.py", line 299, in finish
    tcp.TCPClient.finish(self)
  File "/usr/local/Cellar/mitmproxy/4.0.3_1/libexec/lib/python3.7/site-packages/mitmproxy/net/tcp.py", line 324, in finish
    self.wfile.flush()
AttributeError: 'NoneType' object has no attribute 'flush'

mitmproxy has crashed!
Please lodge a bug report at: https://github.com/mitmproxy/mitmproxy