javixeneize commented on 18 Dec 2018
Hi
I am trying to extract the headers from the traffic captured in mitmproxy. I have noticed that, when in the response there are two set-cookie directives as in https://github.com, it does display only the first one
data = io.FlowReader(file)
print (item.request.headers.fields)
Set-cookie should be returned as a list
I faced the same problem in another application, and i solved it getting that set-cookie value with response.raw.headers.getlist('Set-Cookie')