Contributor
felixonmars commented on 11 Aug 2018
Steps to reproduce the problem:
python setup.py pytest
=================================== FAILURES ===================================
_______________________ TestScripts.test_iframe_injector _______________________

self = <test.examples.test_examples.TestScripts object at 0x7fb3ba0db940>
tdata = <mitmproxy.utils.data.Data object at 0x7fb3ba0dbe48>

    def test_iframe_injector(self, tdata):
        with taddons.context() as tctx:
            sc = tctx.script(tdata.path("../examples/simple/modify_body_inject_iframe.py"))
            tctx.configure(
                sc,
>               iframe = "http://example.org/evil_iframe"
            )

test/examples/test_examples.py:30:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
mitmproxy/test/taddons.py:105: in configure
    self.options.update(**kwargs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = mitmproxy.options.Options({
    'add_upstream_certs_to_client_chain': False [<class 'bool'>],
    'body_size_limit': N..._bind_address':  [<class 'str'>],
    'upstream_cert': True [<class 'bool'>],
    'websocket': True [<class 'bool'>]
})
kwargs = {'iframe': 'http://example.org/evil_iframe'}
u = {'iframe': 'http://example.org/evil_iframe'}

    def update(self, **kwargs):
        u = self.update_known(**kwargs)
        if u:
>           raise KeyError("Unknown options: %s" % ", ".join(u.keys()))
E           KeyError: 'Unknown options: iframe'

mitmproxy/optmanager.py:227: KeyError
=============================== warnings summary ===============================
test/mitmproxy/utils/test_debug.py::test_dump_info
  /build/mitmproxy/src/mitmproxy-4.0.4/mitmproxy/utils/debug.py:70: RuntimeWarning: coroutine 'Script.watcher' was never awaited
    gc.collect()

-- Docs: http://doc.pytest.org/en/latest/warnings.html
============== 1 failed, 1392 passed, 1 warnings in 84.15 seconds ==============
System information
Not yet installed version of mitmproxy 4.0.4 with Python 3.7.0.