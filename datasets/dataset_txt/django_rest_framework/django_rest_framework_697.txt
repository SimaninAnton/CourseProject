stanislavkozlovski commented on 9 Aug 2017 â€¢
edited
As nobody answered me in the discussion group, I'm taking my question here.
This thing completely threw me off when I was trying to figure out why the boolean values I passed through the test client came out as strings (integers as well).
# other stuff omitted
class LessonEditViewTests(APITestCase):
    def test_xx(self):
        resp = self.client.patch(f'/education/course/{self.course.id}/lesson/{self.lesson.id}',
                                 HTTP_AUTHORIZATION=self.teacher_auth_token,
                                 data={
                                     "is_under_construction": False
                                 })
Using this, the view receives a is_under_construction key in the request.data dict with a string value of 'False'
This seems counter-intuitive to me and as such took me some time to figure out the problem.
To combat this, I needed to re-structure the call like this
# other stuff omitted
class LessonEditViewTests(APITestCase):
    def test_xx(self):
        resp = self.client.patch(f'/education/course/{self.course.id}/lesson/{self.lesson.id}',
                                 HTTP_AUTHORIZATION=self.teacher_auth_token,
                                 data=json.dumps({
                                     "is_under_construction": False
                                 }), content_type='application/json')
In my opinion, this should be the default behavior of the APITestCase. Is there any specific reason why this is not the way I'm suggesting?