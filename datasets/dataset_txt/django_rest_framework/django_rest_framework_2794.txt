gtaylor commented on 28 Jun 2013
Django==1.4.3
djangorestframework==2.3.5
I've been calling some of my APIView sub-classes directly in tests, but noticed I'm running into CSRF protection for POST calls. Here's what one of these cycles looks like:
        factory = RequestFactory()
        request = factory.post(url, data=data)
        request.user = some_user
        view = MyAPIViewClass.as_view()
        return view(request, **kwargs)
However, I'm getting an HTTP 403 and the following message:
{u'detail': u'CSRF Failed: CSRF token missing or incorrect.'}
This makes sense, since I haven't set a CSRF token anywhere in there. Does anyone have any pointers on either disabling CSRF during tests or setting the token? I removed Django's CSRF middleware during the testing process, but the error remained.