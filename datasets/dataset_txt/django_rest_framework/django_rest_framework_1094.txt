ilovetogetspamed commented on 17 Aug 2016
Checklist
I have verified that that issue exists against the master branch of Django REST framework.
I have searched for similar issues in both open and closed tickets and cannot find a duplicate.
This is not a usage question. (Those should be directed to the discussion group instead.)
This cannot be dealt with as a third party library. (We prefer new functionality to be in the form of third party libraries where possible.)
I have reduced the issue to the simplest possible case.
I have included a failing test as a pull request. (If you are unable to do so we can still accept the issue.)
Django==1.10
djangorestframework==3.4.4
httpie==0.9.6
Pygments==2.1.3
requests==2.11.0
Python 2.7.10 (v2.7.10:15c95b7d81dc, May 23 2015, 09:33:12)
[GCC 4.2.1 (Apple Inc. build 5666) (dot 3)] on darwin
Darwin localhost.example.com 15.6.0 Darwin Kernel Version 15.6.0: Thu Jun 23 18:25:34 PDT 2016; root:xnu-3248.60.10~1/RELEASE_X86_64 x86_64
Steps to reproduce
I followed all of tutorial part four and everything worked as described in the text except for the very last example:
$ http -a tom:password123 POST http://127.0.0.1:8000/snippets/ code="print 789"
NOTE: I got the expected behavior by adding "owner='1'" to the command line above (see below).
$ http -a tom:password123 POST http://127.0.0.1:8000/snippets/ code="print 789" owner='1'
of course this is contradictory to what I was reading in the tutorial. I thought the POST would auto-magically add the owner id of the authenticated user. In this case tom. Which in my DB actually has the id of three, not one. which is what I passed on the command line.
So it also looks like no validation was done on the POST as far as that goes too. This is just an observation, not a criticism BTW.
My code is attached. I'd really like to know if I missed something, because I checked twice.
Thank you
Chris
tutorial4.tar.gz
Expected behavior
HTTP/1.0 201 Created
Allow: GET, POST, HEAD, OPTIONS
Content-Type: application/json
Date: Tue, 16 Aug 2016 20:44:48 GMT
Server: WSGIServer/0.1 Python/2.7.10
Vary: Accept, Cookie
X-Frame-Options: SAMEORIGIN
{
    "code": "print 789", 
    "id": 4, 
    "language": "python", 
    "linenos": false, 
    "owner": 3, 
    "style": "friendly", 
    "title": ""
}
Actual behavior
HTTP/1.0 400 Bad Request
Allow: GET, POST, HEAD, OPTIONS
Content-Type: application/json
Date: Tue, 16 Aug 2016 20:43:47 GMT
Server: WSGIServer/0.1 Python/2.7.10
Vary: Accept, Cookie
X-Frame-Options: SAMEORIGIN
{
    "owner": [
        "This field is required."
    ]
}