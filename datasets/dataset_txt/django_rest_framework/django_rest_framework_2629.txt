relict007 commented on 10 Jan 2014
I am using DRF with django-filters to provide a small shopping related API. It works fine all the time except when some special characters in the url are encoded.
For example, this url works
/esa/wallpapers/?ordering=-modified
but this throws a 404
/esa/wallpapers/%3Fordering%3D-modified/
I am using Django's development web server at the moment.
These are my middle ware classes
MIDDLEWARE_CLASSES = (
    'django.middleware.common.CommonMiddleware',
    'django.contrib.sessions.middleware.SessionMiddleware',
    #'django.middleware.csrf.CsrfViewMiddleware',
    'django.contrib.auth.middleware.AuthenticationMiddleware',
    'django.contrib.messages.middleware.MessageMiddleware',
    # Uncomment the next line for simple clickjacking protection:
    # 'django.middleware.clickjacking.XFrameOptionsMiddleware',
)
There are installed apps
INSTALLED_APPS = (
'django.contrib.auth',
'django.contrib.contenttypes',
'django.contrib.sessions',
'django.contrib.sites',
'django.contrib.messages',
'django.contrib.staticfiles',
# Uncomment the next line to enable the admin:
'django.contrib.admin',
# Uncomment the next line to enable admin documentation:
# 'django.contrib.admindocs',
'rest_framework',
'social.apps.django_app.default',
'esa',
'rest_framework.authtoken',
'django_filters',
'south',
'django_extensions',
)
This is rest framework settings
REST_FRAMEWORK = {
'PAGINATE_BY': 10,
'PAGINATE_BY_PARAM': 'page_size',
'MAX_PAGINATE_BY': 100,
# Use hyperlinked styles by default.
# Only used if the `serializer_class` attribute is not set on a view.
'DEFAULT_MODEL_SERIALIZER_CLASS':
'rest_framework.serializers.ModelSerializer',
# Use Django's standard `django.contrib.auth` permissions,
# or allow read-only access for unauthenticated users.
'DEFAULT_PERMISSION_CLASSES': [
    'rest_framework.permissions.IsAuthenticatedOrReadOnly',
    #'rest_framework.permissions.DjangoModelPermissions',
],
'DEFAULT_AUTHENTICATION_CLASSES': (
    'rest_framework.authentication.TokenAuthentication',
    ),
'DEFAULT_FILTER_BACKENDS':  (
    'rest_framework.filters.DjangoFilterBackend',
    'rest_framework.filters.SearchFilter',
    'rest_framework.filters.OrderingFilter',
    ),
}
This is my top level urls.py
from django.conf.urls import patterns, include, url

 # Uncomment the next two lines to enable the admin:
from django.contrib import admin
admin.autodiscover()

urlpatterns = patterns('',

url(r'^admin/', include(admin.site.urls)),
url(r'^esa/', include('esa.urls')),
url('', include('social.apps.django_app.urls', namespace='social')),
url(r'^api/', include('rest_framework.urls', namespace='rest_framework')),
)
And this is my app's (i.e. esa) urls.py
from django.conf.urls import patterns, include, url
from rest_framework.urlpatterns import format_suffix_patterns
from esa import views
from esa.views.loginview import ObtainAuthToken
from esa.views.categoryview import CategoryViewSet
from esa.views.userview import UserViewSet
from esa.views.userprofileview import UserProfileViewSet
from esa.views.wallpaperview import WallpaperViewSet
from esa.views.purchaseview import PurchaseViewSet
from rest_framework.routers import DefaultRouter
from esa.views.onlineresourceview import OnlineResourceViewSet
from esa.views.subcategoryview import SubCategoryViewSet
from esa.views.themeview import ThemeViewSet
from esa.views.commentview import CommentViewSet
from esa.views.usercategoryview import UserCategoryViewSet
from esa.views.commentrwview import CommentRWViewSet
from esa.views.purchaserwview import PurchaseRWViewSet
from esa.views.wallpaperrwview import WallpaperRWViewSet



router = DefaultRouter()
router.register(r'userprofiles', UserProfileViewSet)
router.register(r'wallpapers', WallpaperViewSet)
router.register(r'purchases', PurchaseViewSet)
router.register(r'onlineresources', OnlineResourceViewSet)
router.register(r'themes', ThemeViewSet)
router.register(r'subcategories', SubCategoryViewSet)
router.register(r'comments', CommentViewSet)
router.register(r'categories', CategoryViewSet)
router.register(r'users', UserViewSet)
router.register(r'write/comments', CommentRWViewSet)
router.register(r'write/purchases', PurchaseRWViewSet)
router.register(r'write/wallpapers', WallpaperRWViewSet)




urlpatterns = patterns('',
    url(r'^login/$', ObtainAuthToken.as_view()),
    url(r'^', include(router.urls)),
)