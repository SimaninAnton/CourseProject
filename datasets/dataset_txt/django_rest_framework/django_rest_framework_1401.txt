sylflo commented on 3 Dec 2015
DRF: 3.2.4
django-rest-auth: 0.5.0
Django: 1.8.4
PostgreSQL: 9.4.5
Python: 2.7.10
os: ArchLinux -x64
I'm using ArrayField with EmailField so users can have several emails.
I've made a custom user and I'm using django Rest Auth.
models.py
secondary_emails = ArrayField(models.EmailField(unique=True), null=True)
serializers.py
secondary_emails = serializers.ListField(child=serializers.EmailField())
When I try to access the endpoint Django sent me this
Environment:


Request Method: GET
Request URL: http://localhost:8000/api/v1/rest-auth/user/

Django Version: 1.8.4
Python Version: 3.5.0
Installed Applications:
('django.contrib.admin',
 'django.contrib.auth',
 'django.contrib.contenttypes',
 'django.contrib.sessions',
 'django.contrib.messages',
 'django.contrib.staticfiles',
 'django.contrib.sites',
 'django_jenkins',
 'corsheaders',
 'rest_framework',
 'rest_framework.authtoken',
 'allauth',
 'allauth.account',
 'allauth.socialaccount',
 'allauth.socialaccount.providers.facebook',
 'allauth.socialaccount.providers.google',
 'allauth.socialaccount.providers.twitter',
 'rest_auth',
 'rest_auth.registration',
 'rest_framework_swagger',
 'API',
 'tests')
Installed Middleware:
('django.contrib.sessions.middleware.SessionMiddleware',
 'django.middleware.common.CommonMiddleware',
 'django.middleware.csrf.CsrfViewMiddleware',
 'django.contrib.auth.middleware.AuthenticationMiddleware',
 'django.contrib.auth.middleware.SessionAuthenticationMiddleware',
 'django.contrib.messages.middleware.MessageMiddleware',
 'django.middleware.clickjacking.XFrameOptionsMiddleware',
 'django.middleware.security.SecurityMiddleware',
 'corsheaders.middleware.CorsMiddleware',
 'django.middleware.common.CommonMiddleware')


Traceback:
File "/home/sylflo/.virtualenvs/locsAppNew/lib/python3.5/site-packages/django/core/handlers/base.py" in get_response
  132.                     response = wrapped_callback(request, *callback_args, **callback_kwargs)
File "/home/sylflo/.virtualenvs/locsAppNew/lib/python3.5/site-packages/django/views/decorators/csrf.py" in wrapped_view
  58.         return view_func(*args, **kwargs)
File "/home/sylflo/.virtualenvs/locsAppNew/lib/python3.5/site-packages/django/views/generic/base.py" in view
  71.             return self.dispatch(request, *args, **kwargs)
File "/home/sylflo/.virtualenvs/locsAppNew/lib/python3.5/site-packages/rest_framework/views.py" in dispatch
  466.             response = self.handle_exception(exc)
File "/home/sylflo/.virtualenvs/locsAppNew/lib/python3.5/site-packages/rest_framework/views.py" in dispatch
  463.             response = handler(request, *args, **kwargs)
File "/home/sylflo/.virtualenvs/locsAppNew/lib/python3.5/site-packages/rest_framework/generics.py" in get
  256.         return self.retrieve(request, *args, **kwargs)
File "/home/sylflo/.virtualenvs/locsAppNew/lib/python3.5/site-packages/rest_framework/mixins.py" in retrieve
  58.         return Response(serializer.data)
File "/home/sylflo/.virtualenvs/locsAppNew/lib/python3.5/site-packages/rest_framework/serializers.py" in data
  492.         ret = super(Serializer, self).data
File "/home/sylflo/.virtualenvs/locsAppNew/lib/python3.5/site-packages/rest_framework/serializers.py" in data
  228.                 self._data = self.to_representation(self.instance)
File "/home/sylflo/.virtualenvs/locsAppNew/lib/python3.5/site-packages/rest_framework/serializers.py" in to_representation
  448.         fields = self._readable_fields
File "/home/sylflo/.virtualenvs/locsAppNew/lib/python3.5/site-packages/django/utils/functional.py" in __get__
  60.         res = instance.__dict__[self.name] = self.func(instance)
File "/home/sylflo/.virtualenvs/locsAppNew/lib/python3.5/site-packages/rest_framework/serializers.py" in _readable_fields
  342.             field for field in self.fields.values()
File "/home/sylflo/.virtualenvs/locsAppNew/lib/python3.5/site-packages/rest_framework/serializers.py" in fields
  328.             for key, value in self.get_fields().items():
File "/home/sylflo/.virtualenvs/locsAppNew/lib/python3.5/site-packages/rest_framework/serializers.py" in get_fields
  922.                 field_name, info, model, depth
File "/home/sylflo/.virtualenvs/locsAppNew/lib/python3.5/site-packages/rest_framework/serializers.py" in build_field
  1030.             return self.build_standard_field(field_name, model_field)
File "/home/sylflo/.virtualenvs/locsAppNew/lib/python3.5/site-packages/rest_framework/serializers.py" in build_standard_field
  1089.                 'child', child_model_field
File "/home/sylflo/.virtualenvs/locsAppNew/lib/python3.5/site-packages/rest_framework/serializers.py" in build_standard_field
  1054.         field_kwargs = get_field_kwargs(field_name, model_field)
File "/home/sylflo/.virtualenvs/locsAppNew/lib/python3.5/site-packages/rest_framework/utils/field_mapping.py" in get_field_kwargs
  196.         validator = UniqueValidator(queryset=model_field.model._default_manager)

Exception Type: AttributeError at /api/v1/rest-auth/user/
Exception Value: 'EmailField' object has no attribute 'model'
And when I use this line
secondary_emails = ArrayField(models.EmailField(unique=False), null=True)
in my models.py, I can access my endpoint.
I also tried to use unique=True in other model fields but I've got the same error when I'm using an ArrayField.