umutbozkurt commented on 21 Jan 2015
On renderers.py, get_raw_data_form() raises assertion error with following message:
When a serializer is passed a data keyword argument you must call .is_valid() before attempting to > access the serialized .data representation.
You should either call .is_valid() first, or access .initial_data instead.
Which is raised by .data property of serializer. This breaks the browsable API.
On get_raw_data_form() L:626, serializer is initialized with no initial data, and on line 633 serializer.data is called, which raises an assertion error.
Versions effected 3.0.2, 3.0.3.
Further details:
class UserList(ListCreateAPIView):
    serializer_class = UserSerializer
    queryset = User.objects.all()
class UserSerializer(DocumentSerializer):
    class Meta:
        model = User
        depth = 2
Request: GET
Environment:


Request Method: GET
Request URL: http://127.0.0.1:8000/users/

Django Version: 1.7
Python Version: 2.7.6
Installed Applications:
('django.contrib.admin',
 'django.contrib.auth',
 'django.contrib.contenttypes',
 'django.contrib.sessions',
 'django.contrib.messages',
 'django.contrib.staticfiles',
 'rest_framework',
 'rest_framework_mongoengine',
 'BlogApp')
Installed Middleware:
('django.contrib.sessions.middleware.SessionMiddleware',
 'django.middleware.common.CommonMiddleware',
 'django.middleware.csrf.CsrfViewMiddleware',
 'django.contrib.auth.middleware.AuthenticationMiddleware',
 'django.contrib.messages.middleware.MessageMiddleware',
 'django.middleware.clickjacking.XFrameOptionsMiddleware')


Traceback:
File "/Library/Python/2.7/site-packages/django/core/handlers/base.py" in get_response
  137.                 response = response.render()
File "/Library/Python/2.7/site-packages/django/template/response.py" in render
  103.             self.content = self.rendered_content
File "/Library/Python/2.7/site-packages/rest_framework/response.py" in rendered_content
  59.         ret = renderer.render(self.data, media_type, context)
File "/Library/Python/2.7/site-packages/rest_framework/renderers.py" in render
  733.         context = self.get_context(data, accepted_media_type, renderer_context)
File "/Library/Python/2.7/site-packages/rest_framework/renderers.py" in get_context
  683.         raw_data_post_form = self.get_raw_data_form(data, view, 'POST', request)
File "/Library/Python/2.7/site-packages/rest_framework/renderers.py" in get_raw_data_form
  633.                 content = renderer.render(serializer.data, accepted, context)
File "/Library/Python/2.7/site-packages/rest_framework/serializers.py" in data
  463.         ret = super(Serializer, self).data
File "/Library/Python/2.7/site-packages/rest_framework/serializers.py" in data
  208.             raise AssertionError(msg)

Exception Type: AssertionError at /users/
Exception Value: When a serializer is passed a `data` keyword argument you must call `.is_valid()` before attempting to access the serialized `.data` representation.
You should either call `.is_valid()` first, or access `.initial_data` instead.