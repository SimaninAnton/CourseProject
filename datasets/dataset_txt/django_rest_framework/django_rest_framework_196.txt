Contributor
Lucidiot commented on 25 Mar 2019
Checklist
I have verified that that issue exists against the master branch of Django REST framework.
I have searched for similar issues in both open and closed tickets and cannot find a duplicate.
This is not a usage question. (Those should be directed to the discussion group instead.)
This cannot be dealt with as a third party library. (We prefer new functionality to be in the form of third party libraries where possible.)
I have reduced the issue to the simplest possible case.
I have included a failing test as a pull request. (If you are unable to do so we can still accept the issue.)
Steps to reproduce
I have made a quick test project to diagnose the problem : https://github.com/Lucidiot/testdrf. Cloning the repo and installing DRF should be all you need. The project has two API views which are held in different URL patterns, which are then included into the root urlconf with two different namespaces.
Expected behavior
./manage.py generateschema should give YAML output holding the paths to all the API endpoints in all namespaces.
Actual behavior
./manage.py generateschema gives a YAML output with zero endpoints ; however using --format corejson, it gives a valid CoreJSON file with all the API endpoints. It seems I am not alone.
I do not know much about DRF's internals but judging from some quick source code reading and REPL experiments, it seems the SchemaGenerator gives a coreapi.Document with no links (an empty OrderedDict) but with data. The OpenAPIRenderer then does not deal well with this case and simply returns an empty paths dict in the YAML output.