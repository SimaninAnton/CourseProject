0x8DEADF00D commented on 25 Jun 2015
I have a DietPlanViewSet representing a DietPlan that can be shared among Account objects:
class DietPlanSerializer(serializers.HyperlinkedModelSerializer):
    class Meta:
        model = DietPlan

class DietPlanViewSet(ViewSetBase):
    queryset = DietPlan.objects.all()
    serializer_class = DietPlanSerializer

    @detail_route(methods=['patch'])
    def share(self, request, pk):
        dietplan = self.get_object()


class DietPlan(models.Model):
    ...
    shared_with = models.ManyToManyField(Account, related_name='public_dietplans')
    ...
I want the share function to receive an account (or list of accounts) that should be added to the dietplan.shared_with field which is a ManyToMany relation between DietPlan and Account.
The PATCH request is as follows:
   response = self.client.patch('/dietplans/1/share/', {
            "account": "/accounts/1/"    
    })
But unfortunately I don't know how to let the framework deserialize the Account object based on that hyperlink. Well I could get my hands on some RegEx but I think this is not the correct way to achieve what I want.
I also tried to deserialize that request using the corresponding AccountSerializer but that didn't work either:
target_account = AccountSerializer(data=request.data['account'],partial=True)
May you please help me on this one?