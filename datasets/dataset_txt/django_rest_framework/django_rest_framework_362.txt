vigasin commented on 25 Jul 2018
Steps to reproduce
In a viewset set queryset to have annotated field:
class MyViewSet()
queryset = MyModel.objects.all().annotate(new_field=..)
search_fields = ('new_field',)
Perform a search using new_field.
Expected behavior
Return the result filtered by new_field.
Actual behavior
Exception. MyModel doesn't have field new_field.
....
File "/usr/local/lib/python3.6/site-packages/rest_framework/filters.py" in must_call_distinct
  79.                 field = opts.get_field(part)
....
The reason is SearchFilter.must_call_distinct uses model._meta to look up for the fields.
Worked fine before. The bug was introduced in v3.4.0.
4