unformatt commented on 20 Oct 2014
django 1.6
DRF 2.3.13
from django.contrib.auth.models import User
from django.core.urlresolvers import reverse
from rest_framework import status
from rest_framework.test import APITestCase, APIClient

class UserProfileTests(APITestCase):

    @classmethod
    def setUpClass(cls):
        client = APIClient()
        client.force_authenticate(user=User.objects.filter(is_active=1)[0])
        cls.client = client

    @classmethod
    def tearDownClass(cls):
        cls.client = None

    def test_userprofile(self):
        url = reverse('update-user-profile',args=['default'])
        data = {'nickname': 'foo'}
        response = self.client.put(url, data, format='json')
        self.assertEqual(response.status_code, status.HTTP_201_CREATED)
returns a 403
{"detail": "Authentication credentials were not provided."}
If I init the APIClient in test_userprofile(), then it works.