brianmay commented on 28 Jun 2017 â€¢
edited
Serializer inheritance doesn't appear to work as documented:
Steps to reproduce
class SerializerMixin:
    details_url = serializers.SerializerMethodField()

     def get_details_url(self, obj):
        return "http://example.org/mary/had/a/little/lamb/"

class RouteSerializer(SerializerMixin, serializers.ModelSerializer):
    """Serializer for Route model."""

    class Meta:
        model = Route
        fields = [
            'details_url',
        ]
Expected behavior
I expected the RouteSerializer class would pick up the details_url from the SerializerMixin class, and everything should work.
Actual behavior
File "/Users/brianmay/.virtualenvs/myro/myrocc/lib/python3.6/site-packages/django/core/handlers/exception.py" in inner
  41.             response = get_response(request)

File "/Users/brianmay/.virtualenvs/myro/myrocc/lib/python3.6/site-packages/django/core/handlers/base.py" in _get_response
  187.                 response = self.process_exception_by_middleware(e, request)

File "/Users/brianmay/.virtualenvs/myro/myrocc/lib/python3.6/site-packages/channels/handler.py" in process_exception_by_middleware
  243.             return super(AsgiHandler, self).process_exception_by_middleware(exception, request)

File "/Users/brianmay/.virtualenvs/myro/myrocc/lib/python3.6/site-packages/django/core/handlers/base.py" in _get_response
  185.                 response = wrapped_callback(request, *callback_args, **callback_kwargs)

File "/usr/local/Cellar/python3/3.6.1/Frameworks/Python.framework/Versions/3.6/lib/python3.6/contextlib.py" in inner
  53.                 return func(*args, **kwds)

File "/Users/brianmay/.virtualenvs/myro/myrocc/lib/python3.6/site-packages/django/views/decorators/csrf.py" in wrapped_view
  58.         return view_func(*args, **kwargs)

File "/Users/brianmay/.virtualenvs/myro/myrocc/lib/python3.6/site-packages/rest_framework/viewsets.py" in view
  86.             return self.dispatch(request, *args, **kwargs)

File "/Users/brianmay/.virtualenvs/myro/myrocc/lib/python3.6/site-packages/rest_framework/views.py" in dispatch
  489.             response = self.handle_exception(exc)

File "/Users/brianmay/.virtualenvs/myro/myrocc/lib/python3.6/site-packages/rest_framework/views.py" in handle_exception
  449.             self.raise_uncaught_exception(exc)

File "/Users/brianmay/.virtualenvs/myro/myrocc/lib/python3.6/site-packages/rest_framework/views.py" in dispatch
  486.             response = handler(request, *args, **kwargs)

File "/Users/brianmay/.virtualenvs/myro/myrocc/lib/python3.6/site-packages/rest_framework/mixins.py" in retrieve
  58.         return Response(serializer.data)

File "/Users/brianmay/.virtualenvs/myro/myrocc/lib/python3.6/site-packages/rest_framework/serializers.py" in data
  534.         ret = super(Serializer, self).data

File "/Users/brianmay/.virtualenvs/myro/myrocc/lib/python3.6/site-packages/rest_framework/serializers.py" in data
  263.                 self._data = self.to_representation(self.instance)

File "/Users/brianmay/.virtualenvs/myro/myrocc/lib/python3.6/site-packages/rest_framework/serializers.py" in to_representation
  484.         fields = self._readable_fields

File "/Users/brianmay/.virtualenvs/myro/myrocc/lib/python3.6/site-packages/django/utils/functional.py" in __get__
  35.         res = instance.__dict__[self.name] = self.func(instance)

File "/Users/brianmay/.virtualenvs/myro/myrocc/lib/python3.6/site-packages/rest_framework/serializers.py" in _readable_fields
  378.             field for field in self.fields.values()

File "/Users/brianmay/.virtualenvs/myro/myrocc/lib/python3.6/site-packages/rest_framework/serializers.py" in fields
  364.             for key, value in self.get_fields().items():

File "/Users/brianmay/.virtualenvs/myro/myrocc/lib/python3.6/site-packages/rest_framework/serializers.py" in get_fields
  1017.                 source, info, model, depth

File "/Users/brianmay/.virtualenvs/myro/myrocc/lib/python3.6/site-packages/rest_framework/serializers.py" in build_field
  1151.         return self.build_unknown_field(field_name, model_class)

File "/Users/brianmay/.virtualenvs/myro/myrocc/lib/python3.6/site-packages/rest_framework/serializers.py" in build_unknown_field
  1258.             (field_name, model_class.__name__)

Exception Type: ImproperlyConfigured at /api/internal/routes/3/
Exception Value: Field name `details_url` is not valid for model `Route`.
If I copy the details_url value from the parent class to the RouteSerializer class, then it works.
If I change the SerializerMixin class to inherit from serializers.ModelSerializer and change the serializers.ModelSerializer class to inherit only from SerializerMixin - then it works.
class SerializerMixin(serializers.ModelSerializer):
    details_url = serializers.SerializerMethodField()

     def get_details_url(self, obj):
        return "http://example.org/mary/had/a/little/calf/"

class RouteSerializer(SerializerMixin):
    """Serializer for Route model."""

    class Meta:
        model = Route
        fields = [
            'details_url',
        ]