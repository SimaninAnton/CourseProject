jole78 commented on 18 Aug 2016
class UserViewSet(mixins.RetrieveModelMixin, viewsets.GenericViewSet):
.....
@detail_route(methods=['get'], permission_classes=[IsCurrentUser])
def permissions(self, request, pk=None, format=None):
user = self.get_object()
serializer = UserPermissionsSerializer(user)
return Response(serializer.data)
If I test this view from the browser or PostMan the permission_classes are honored and I get a 403 back if IÂ´m not the current user (i.e. trying to view permissions for someone else)
If I write a test using APIRequestFactory and run this I get a 200 response.
I debugged and the permission class is not even executed.
However, if I add the permission at class level (permission_classes = [IsCurrentUser,]) inside the ViewSet instead of as a decorator I get a 403 back.