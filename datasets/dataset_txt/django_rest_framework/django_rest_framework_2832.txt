Contributor
Neamar commented on 22 May 2013
A simple use-case fail to render.
When using many=True, the serializer.data attempts to access an all() method on the dictionary.
Here it is, boiled down to minimum code:
from rest_framework import serializers, generics
from django.contrib.auth.models import User

class UploadSerializer(serializers.Serializer):
    user_set = serializers.HyperlinkedRelatedField(view_name='user-detail', queryset=User.objects.all(), many=True)

    def save_object(self, obj, **kwargs):
        pass

class CreationInterface(generics.CreateAPIView):
    serializer_class = UploadSerializer
Expected: nothing, this is minimal code. The selected users should be displayed with a 201 CREATED status (this works when many=False).
Got:
Internal Server Error: /documents/add/
Traceback (most recent call last):
  File "{path}/.v_env/local/lib/python2.7/site-packages/django/core/handlers/base.py", line 115, in get_response
    response = callback(request, *callback_args, **callback_kwargs)
  File "{path}/.v_env/local/lib/python2.7/site-packages/django/views/generic/base.py", line 68, in view
    return self.dispatch(request, *args, **kwargs)
  File "{path}/.v_env/local/lib/python2.7/site-packages/django/views/decorators/csrf.py", line 77, in wrapped_view
    return view_func(*args, **kwargs)
  File "{path}/.v_env/local/lib/python2.7/site-packages/rest_framework/views.py", line 410, in dispatch
    response = self.handle_exception(exc)
  File "{path}/.v_env/local/lib/python2.7/site-packages/rest_framework/views.py", line 407, in dispatch
    response = handler(request, *args, **kwargs)
  File "{path}/.v_env/local/lib/python2.7/site-packages/rest_framework/generics.py", line 150, in post
    return self.create(request, *args, **kwargs)
  File "{path}/.v_env/local/lib/python2.7/site-packages/rest_framework/mixins.py", line 49, in create
    headers = self.get_success_headers(serializer.data)
  File "{path}/.v_env/local/lib/python2.7/site-packages/rest_framework/serializers.py", line 496, in data
    self._data = self.to_native(obj)
  File "{path}/.v_env/local/lib/python2.7/site-packages/rest_framework/serializers.py", line 306, in to_native
    value = field.field_to_native(obj, field_name)
  File "{path}/.v_env/local/lib/python2.7/site-packages/rest_framework/relations.py", line 136, in field_to_native
    return [self.to_native(item) for item in value.all()]
AttributeError: 'list' object has no attribute 'all'

Local vars
Variable    Value
field_name  'user_set'
self     <rest_framework.relations.PrimaryKeyRelatedField object at 0x7f8c2841c6d0>
obj      {'user_set': [<User: matthieu@host.com>]}