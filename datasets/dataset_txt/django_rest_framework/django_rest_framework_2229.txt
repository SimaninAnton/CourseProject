brianmay commented on 26 Nov 2014
Hello,
If I have in my ModelViewSet:
class PhotoViewSet(viewsets.ModelViewSet):
    parser_classes = (parsers.FileUploadParser,)
And I try to submit a PATCH request without any files (I believe this should be Ok and is the point of PATCH - I just want to update some of the meta data not the entire object), I get AttributeErrors:
'WSGIRequest' object has no attribute 'data'
This comes from rest_framework/mixins.py in update. It is somewhat confusing because there is a 'data' attribute as part of the Request, however this gets skipped because it returns AttributeError. Hence the getattr method gets called, and the original error starts getting confused.
The original error that causes this problem is:
Traceback (most recent call last):
  File "/home/brian/tree/django/django-rest-framework/django-rest-framework/rest_framework/request.py", line 425, in _parse
    parsed = parser.parse(stream, media_type, self.parser_context)
  File "/home/brian/tree/django/django-rest-framework/django-rest-framework/rest_framework/parsers.py", line 275, in parse
    file_obj = handler.file_complete(counters[i])
  File "/usr/lib/python2.7/dist-packages/django/core/files/uploadhandler.py", line 151, in file_complete
    self.file.seek(0)
AttributeError: 'TemporaryFileUploadHandler' object has no attribute 'file'
I thought of disabling FileUploadParser for PATCH, however this doesn't appear to be as easy as I hoped. Besides I feel it should crash in such a manner anyway.
I had this problem with 2.3.14, and this traceback was with the latest git version.
Thanks