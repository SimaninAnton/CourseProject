HenrikOssipoff commented on 15 May 2014
Some browsers, namely Internet Explorer 11 that I've come across, sends unicode like æøå in raw format when a request is executed. If you send a request towards an APIView, and the request contains a query string with one of these characters (for example, "?q=pø"), it will break with a UnicodeDecodeError (only tested on Django 1.7 and Python 3.4 as of now, though - with the latest version of DRF through PyPI).
While the error raises in Django http module, it appears to only fail if the request has passed through DRF views, negotiation and request. Django itself handles it just fine.
Traceback (most recent call last):
  File "/Users/henrik/Development/VirtualEnvironment/pim.env/lib/python3.4/site-packages/django/core/handlers/base.py", line 113, in get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "/Users/henrik/Development/VirtualEnvironment/pim.env/lib/python3.4/site-packages/django/views/generic/base.py", line 69, in view
    return self.dispatch(request, *args, **kwargs)
  File "/Users/henrik/Development/VirtualEnvironment/pim.env/lib/python3.4/site-packages/django/views/decorators/csrf.py", line 57, in wrapped_view
    return view_func(*args, **kwargs)
  File "/Users/henrik/Development/VirtualEnvironment/pim.env/lib/python3.4/site-packages/rest_framework/views.py", line 400, in dispatch
    response = self.handle_exception(exc)
  File "/Users/henrik/Development/VirtualEnvironment/pim.env/lib/python3.4/site-packages/rest_framework/views.py", line 388, in dispatch
    self.initial(request, *args, **kwargs)
  File "/Users/henrik/Development/VirtualEnvironment/pim.env/lib/python3.4/site-packages/rest_framework/views.py", line 322, in initial
    neg = self.perform_content_negotiation(request)
  File "/Users/henrik/Development/VirtualEnvironment/pim.env/lib/python3.4/site-packages/rest_framework/views.py", line 253, in perform_content_negotiation
    return conneg.select_renderer(request, renderers, self.format_kwarg)
  File "/Users/henrik/Development/VirtualEnvironment/pim.env/lib/python3.4/site-packages/rest_framework/negotiation.py", line 41, in select_renderer
    format = format_suffix or request.QUERY_PARAMS.get(format_query_param)
  File "/Users/henrik/Development/VirtualEnvironment/pim.env/lib/python3.4/site-packages/rest_framework/request.py", line 186, in QUERY_PARAMS
    return self._request.GET
  File "/Users/henrik/Development/VirtualEnvironment/pim.env/lib/python3.4/site-packages/django/utils/functional.py", line 55, in __get__
    res = instance.__dict__[self.func.__name__] = self.func(instance)
  File "/Users/henrik/Development/VirtualEnvironment/pim.env/lib/python3.4/site-packages/django/core/handlers/wsgi.py", line 131, in GET
    return http.QueryDict(raw_query_string, encoding=self._encoding)
  File "/Users/henrik/Development/VirtualEnvironment/pim.env/lib/python3.4/site-packages/django/http/request.py", line 304, in __init__
    query_string = query_string.decode()
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 3: invalid start byte