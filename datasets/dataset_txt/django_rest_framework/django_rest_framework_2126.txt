Contributor
radyz commented on 22 Dec 2014
Using: DFR v3.0.0
I followed the tutorial at: DFR in order to get bulk updates working. Then on my view I have:
serializer = self.get_serializer(
    self.filter_queryset(self.get_queryset()),
    data=request.data,
    many=True
)

serializer.is_valid(raise_exception=True)
That validation call however fails with the following error trace:
 File "/home/vagrant/.virtualenvs/backlink/lib/python3.4/site-packages/rest_framework/serializers.py", line 158, in is_valid
    self._validated_data = self.run_validation(self._initial_data)
  File "/home/vagrant/.virtualenvs/backlink/lib/python3.4/site-packages/rest_framework/fields.py", line 322, in run_validation
    value = self.to_internal_value(data)
  File "/home/vagrant/.virtualenvs/backlink/lib/python3.4/site-packages/rest_framework/serializers.py", line 482, in to_internal_value
    validated = self.child.run_validation(item)
  File "/home/vagrant/.virtualenvs/backlink/lib/python3.4/site-packages/rest_framework/serializers.py", line 315, in run_validation
    self.run_validators(value)
  File "/home/vagrant/.virtualenvs/backlink/lib/python3.4/site-packages/rest_framework/fields.py", line 337, in run_validators
    validator(value)
  File "/home/vagrant/.virtualenvs/backlink/lib/python3.4/site-packages/rest_framework/validators.py", line 138, in __call__
    queryset = self.exclude_current_instance(attrs, queryset)
  File "/home/vagrant/.virtualenvs/backlink/lib/python3.4/site-packages/rest_framework/validators.py", line 131, in exclude_current_instance
    return queryset.exclude(pk=self.instance.pk)
AttributeError: 'QuerySet' object has no attribute 'pk'
I tracked it down and it seems that if an instance is passed and then validations are run, it will not check if it's a QuerySet. Not sure what the best way to move forward is from here.