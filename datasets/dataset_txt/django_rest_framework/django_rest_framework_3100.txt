Contributor
max-arnold commented on 25 Mar 2012
I tried to make XMLRenderer default, but this affects documentation browser (no docstrings, only xml):
class View(ViewOrig):
    renderers = (XMLRenderer, JSONRenderer, DocumentingHTMLRenderer, DocumentingXHTMLRenderer, DocumentingPlainTextRenderer, )
Firefox sends the following Accept header:
Accept  text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
and mediatypes.order_by_precedence returns the following list:
[[], ['text/html', 'application/xhtml+xml', 'application/xml;q=0.9'], [], ['*/*;q=0.8']]
It looks like application/xml;q=0.9 is preferred over text/html and XMLRenderer is being selected. Expected behavior is to assign quality factor q=1 to text/html and use it for prioritization (for example, see django.utils.translation.trans_real.parse_accept_lang_header)
So, I have two questions:
How to fix that without duplicating lots of code? ResponseMixin._determine_renderer is private and monolithic, and I do not want to copy-paste it
How to inject fixed ResponseMixin everywhere? Do I need to duplicate code again and make my own ModelView, InstanceModelView, ListModelView, ListOrCreateModelView etc?