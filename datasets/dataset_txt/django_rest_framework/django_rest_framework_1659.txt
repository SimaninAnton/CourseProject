Contributor
kumar303 commented on 7 Aug 2015
With a view set that looks roughly like this:
class TransactionViewSet(mixins.RetrieveModelMixin, GenericViewSet):
    queryset = Transaction.objects.all()
    filter_fields = ('some_field')
I see this traceback when making a GET request:
Traceback (most recent call last):
  File "/opt/rh/python27/root/usr/lib64/python2.7/wsgiref/handlers.py", line 85, in run
    self.result = application(self.environ, self.start_response)
  File "/opt/rh/python27/root/usr/lib/python2.7/site-packages/django/core/handlers/wsgi.py", line 189, in __call__
    response = self.get_response(request)
  ...
  File "/opt/rh/python27/root/usr/lib/python2.7/site-packages/rest_framework/generics.py", line 179, in filter_queryset
    queryset = backend().filter_queryset(self.request, queryset, self)
  File "/srv/solitude/solitude/filter.py", line 22, in filter_queryset
    .filter_queryset(request, queryset, view))
  File "/opt/rh/python27/root/usr/lib/python2.7/site-packages/rest_framework/filters.py", line 62, in filter_queryset
    filter_class = self.get_filter_class(view, queryset)
  File "/opt/rh/python27/root/usr/lib/python2.7/site-packages/rest_framework/filters.py", line 52, in get_filter_class
    class AutoFilterSet(self.default_filter_set):
  File "/opt/rh/python27/root/usr/lib/python2.7/site-packages/django_filters/filterset.py", line 171, in __new__
    raise TypeError("Meta.fields contains a field that isn't defined "
TypeError: Meta.fields contains a field that isn't defined on this FilterSet
The error is that the tuple was coded wrong. It should be filter_fields = ('some_field',) or it should be a list.
I know this is a common mistake in Python but the error message is pretty confusing and didn't help me at all during the embarrassing amount of time I spent tracking it down. A string is still iterable but it wouldn't be sane to pass in a string for this value. I think it would be a quick win to check if filter_fields is a list or tuple and show a more meaningful error to help developers track down the problem.