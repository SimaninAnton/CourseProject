ajbuitragom commented on 7 Jan 2013
Hi
The objects I'm trying to serialize implements iter (I'm working witn mongoengie and the object I'm talking about is of type Document).
The method to_native (https://github.com/tomchristie/django-rest-framework/blob/master/rest_framework/serializers.py#L274) of the class BaseSerializer, checks if the passed object is a unique object or a list and for this purpose it uses the line hasattr(obj,'iter).
For my particular case this method don't work because the implementation of iter in my native objects (mongoengine Document).
I rewrote the function in my serializer as:
def to_native(self, obj):
"""
Serialize objects -> primitives.
"""
if obj.class == QuerySet:
return [self.convert_object(item) for item in obj]
return self.convert_object(obj)
This is very specific for mongoengine.
Is there maybe other way to do this in a more general elegant way?
Thank you