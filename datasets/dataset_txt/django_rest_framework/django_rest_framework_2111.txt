lijax commented on 30 Dec 2014
Hi, all.
I'm writing some inherited models, serializers and viewsets like these.
class Parent(models.Model):
    name = models.CharField(max_length=255, blank=False, null=False)
    description = models.TextField(blank=True, null=True)

class Child(Parent):
    filed1 = models.CharField(max_length=255, blank=True, null=True)
    filed2 = models.CharField(max_length=255, blank=True, null=True)


class ParentSerializer(serializers.ModelSerializer):
    class Meta:
        model = Parent
        fields = ('id', 'name', 'description',)


class ChildSerializer(ParentSerializer):
    class Meta(ParentSerializer.Meta):
        model = Child
        fields = ParentSerializer.Meta.fields + ('filed1', 'filed2',)


class ParentViewSet(viewsets.ModelViewSet):
    queryset = Parent.objects.all()
    serializer_class = ParentSerializer
    permission_classes = (permissions.IsAuthenticatedOrReadOnly,)


class ChildViewSet(ParentViewSet):
    queryset = Child.objects.all()
    serializer_class = ChildSerializer
    permission_classes = (permissions.IsAuthenticatedOrReadOnly,)
When I create Child through the api, it always says "name": "This field cannot be blank.".
It used to be working two weeks ago. After I reinstalled my developing environment, every api like this got this problem. Bu I did not change any version of Django or DRF.
So I try to debug where the problem with pdb. When I traced to these lines in BaseSerializer, I got this error. But still don't know how it came out.
self.context = context or {}
import pdb; pdb.set_trace()
self.init_data = data
self.init_files = files
self.object = instance
self.fields = self.get_fields()
self._data = None
self._files = None
self._errors = None
> /home/yeyanbo/biogiga_env/local/lib/python2.7/site-packages/rest_framework/serializers.py(202)__init__()
-> self._files = None
(Pdb) n
> /home/yeyanbo/biogiga_env/local/lib/python2.7/site-packages/rest_framework/serializers.py(203)__init__()
-> self._errors = None
(Pdb) p self.errors
[]
(Pdb) p self._errors
[]
(Pdb) n
> /home/yeyanbo/biogiga_env/local/lib/python2.7/site-packages/rest_framework/serializers.py(205)__init__()
-> if many and instance is not None and not hasattr(instance, '__iter__'):
(Pdb) p self.errors
{'name': [u'This field cannot be blank.']}
(Pdb) p self._errors
{'name': [u'This field cannot be blank.']}
(Pdb) 
Can anyone help me?