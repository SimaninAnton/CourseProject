mingchen commented on 1 Jul 2013
I have a model with a foreign key reference itself:
class Category(models.Model):
name = models.CharField(max_length=100,
unique=True)
parent = models.ForeignKey('self',
                           null=True,
                           blank=True)
I define serializer as:
class CategorySerializer(serializers.ModelSerializer):
class Meta:
model = Category
fields = ('id', 'name')
the view definition as:
class CategoryListView(generics.ListAPIView):
serializer_class = CategorySerializer
model = Category
filter_fields = ('id', 'name', 'parent')
search_fields = ('name',)
In urls.py,
url(r'^categories$', views.CategoryListView.as_view()),
Now I can use parent as filter in request, such as:
categories?parent=1
The problem comes if parent is not found in Category, it will return all the records. I expect is return as a empty set.
I monitor the SQL history, if the parent is not found, the filter will not apply to second query.
Could you please fix this issue ï¼Ÿ
Thanks.