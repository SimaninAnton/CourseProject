Contributor
awwester commented on 25 Jul 2016 â€¢
edited
I'm having issues with setting pagination_class on a single viewset based off of ModelViewSet. When I set the default pagination class in the settings, it works as expected. But I only want pagination on one viewset, and that is not working for me with a very simple example.
I'm surprised I haven't found anyone else that has reported this because I'm seeing it with a very simple example. Maybe I'm missing something or doing something wrong, but according to the docs I should be able to just add the pagination_class property to any class based off of GenericAPIView and it should just work(tm).
EDIT/UPDATE
After going through the source code this definitely seems like a bug to me. The problem is that PageNumberPagination.get_page_size() was returning None. At the top of the PageNumberPagination class is page_size = api_settings.PAGE_SIZE and for whatever reason, it's not getting overridden when defining on my ClipViewSet class.
I then set just the PAGE_SIZE in settings and then setting pagination_class on my class works.
# need to set PAGE_SIZE for paginating to work on viewset
REST_FRAMEWORK = {
    # 'DEFAULT_PAGINATION_CLASS': 'rest_framework.pagination.PageNumberPagination',
    'PAGE_SIZE': '10'
}
If we can confirm this is a bug I'll get a PR going but need confirmation I'm not doing something dumb!
Steps to reproduce
Create viewset based off of ModelViewSet using rest_framework 3.4.0 and django 1.9.7
Add pagination_class = PageNumberPagination to the class.
class ClipViewSet(ModelViewSet):
    serializer_class = ClipSerializer
    queryset = Clip.objects.all()
    pagination_class = PageNumberPagination
    page_size = 10
Expected behavior
The response should contain the paginated results
"count": 542,
"next": null,
"previous": null,
"results": [ ... ]
Actual behavior
Returns response that is not paginated.
Checklist
I have verified that that issue exists against the master branch of Django REST framework.
I have searched for similar issues in both open and closed tickets and cannot find a duplicate.
This is not a usage question. (Those should be directed to the discussion group instead.)
This cannot be dealt with as a third party library. (We prefer new functionality to be in the form of third party libraries where possible.)
I have reduced the issue to the simplest possible case.
I have included a failing test as a pull request. (If you are unable to do so we can still accept the issue.)