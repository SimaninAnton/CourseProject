Checking request's auth success makes it impossible to have custom permissions