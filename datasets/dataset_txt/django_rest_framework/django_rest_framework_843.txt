shillankisten commented on 3 Apr 2017 â€¢
edited by rpkilby
Hi All,
I am using Django, Python and the tables2 plugin on MAC
I am using the tables2 class and i pass in a list of dicts to the class, however i seem to be getting an error around the primary key (pk)
Any assistance would be greatly appreciated
This last line of the trace:
AttributeError: 'dict' object has no attribute 'pk'`
Code components as follows
The function view i call the table "pTable" from:
def quoteDetail(request, args):
    c = getCompanySession(request)
    q = Quote.objects.get(id=args)
    #table = SupplierTable(Supplier.objects.filter(company_id=c.id))
    products = Product.objects.filter(company_id=c.id)
    prodList = []
    for p in products:
        prodList.append({'product_id':p.id,'code':p.code,'description':p.description,'uom':p.uom,'quote':q.id})
    pTable = ProductSearchTable(prodList)
    table = QuoteItemTable(QuoteItem.objects.filter(quote_id=q.id))
    print "tabie is ", table
    return render(request, 'myapp/quoteDetail.html', {'quote':q, 'table':table, 'pTable':pTable})
The table class itself for ProductSearchTable:
class ProductSearchTable(tables.Table):
    Select = tables.Column(verbose_name = 'Select' )
    id = tables.Column()
    code = tables.Column(verbose_name = 'Code' )
    description = tables.Column(verbose_name = 'Description' )
    uom = tables.Column(verbose_name = 'UOM' )
    quote = tables.Column(verbose_name = 'Quote' )

    class Meta:
        attrs = {'class': 'paleblue','width':'80%'}
        #exclude = ('createdAt', 'priceDate', 'company', 'analysis', 'price', 'comments', 'other')
        fields = ("id","code", "description","quote")
        row_attrs = {
            'data-id': lambda record: record.pk
        }

    Select  = tables.LinkColumn('selectProduct', text='+ add product', args=[A('pk')])`
Snippet of the Error log as follows:
...
File "venv/lib/python2.7/site-packages/django/template/defaulttags.py", line 220, in render
  nodelist.append(node.render_annotated(context))
File "venv/lib/python2.7/site-packages/django/template/base.py", line 959, in render_annotated
  return self.render(context)
File "venv/lib/python2.7/site-packages/django/template/loader_tags.py", line 60, in render
  result = self.nodelist.render(context)
File "venv/lib/python2.7/site-packages/django/template/base.py", line 992, in render
  bit = node.render_annotated(context)
File "venv/lib/python2.7/site-packages/django/template/base.py", line 959, in render_annotated
  return self.render(context)
File "venv/lib/python2.7/site-packages/django/template/base.py", line 1043, in render
  output = self.filter_expression.resolve(context)
File "venv/lib/python2.7/site-packages/django/template/base.py", line 709, in resolve
  obj = self.var.resolve(context)
File "venv/lib/python2.7/site-packages/django/template/base.py", line 850, in resolve
  value = self._resolve_lookup(context)
File "venv/lib/python2.7/site-packages/django/template/base.py", line 891, in _resolve_lookup
  current = getattr(current, bit)
File "venv/lib/python2.7/site-packages/django_tables2/rows.py", line 77, in attrs
  row_attrs = computed_values(self._table.row_attrs, self._record)
File "venv/lib/python2.7/site-packages/django_tables2/utils.py", line 545, in computed_values
  v = v(*args, **kwargs)
File "sProduct/myapp/tables.py", line 40, in <lambda>
  'data-id': lambda record: record.pk
AttributeError: 'dict' object has no attribute 'pk'