ghost commented on 9 Jul 2018 â€¢
edited by ghost
Checklist
I have verified that that issue exists against the master branch of Django REST framework.
I have searched for similar issues in both open and closed tickets and cannot find a duplicate.
This is not a usage question. (Those should be directed to the discussion group instead.)
This cannot be dealt with as a third party library. (We prefer new functionality to be in the form of third party libraries where possible.)
I have reduced the issue to the simplest possible case.
I have included a failing test as a pull request. (If you are unable to do so we can still accept the issue.)
Steps to reproduce
django.urls.exceptions.NoReverseMatch: Reverse for 'endpoint-list' with keyword arguments '{'myparam': 'foo/bar'}' not found. 2 pattern(s) tried: ['v1/endpoint/(?P<myparam>[^/]+)\\.(?P<format>[a-z0-9]+)/?$', 'v1/endpoint/(?P<myparam>[^/]+)$']
Expected behavior
Encoded like https://code.djangoproject.com/ticket/22223
Actual behavior
  File "/venv-dev/lib/python3.4/site-packages/rest_framework/relations.py", line 376, in to_representation
    url = self.get_url(value, self.view_name, request, format)
  File "/venv-dev/lib/python3.4/site-packages/rest_framework/relations.py", line 314, in get_url
    return self.reverse(view_name, kwargs=kwargs, request=request, format=format)
  File "/venv-dev/lib/python3.4/site-packages/rest_framework/reverse.py", line 48, in reverse
    url = _reverse(viewname, args, kwargs, request, format, **extra)
  File "/venv-dev/lib/python3.4/site-packages/rest_framework/reverse.py", line 63, in _reverse
    url = django_reverse(viewname, args=args, kwargs=kwargs, **extra)
  File "/venv-dev/lib/python3.4/site-packages/django/urls/base.py", line 91, in reverse
    return force_text(iri_to_uri(resolver._reverse_with_prefix(view, prefix, *args, **kwargs)))
  File "/venv-dev/lib/python3.4/site-packages/django/urls/resolvers.py", line 497, in _reverse_with_prefix
    raise NoReverseMatch(msg)
django.urls.exceptions.NoReverseMatch: Reverse for 'endpoint-list' with keyword arguments '{'myparam': 'foo/bar'}' not found. 2 pattern(s) tried: ['v1/endpoint/(?P<myparam>[^/]+)\\.(?P<format>[a-z0-9]+)/?$', 'v1/endpoint/(?P<myparam>[^/]+)$']
Django handle that properly in admin panel, why DRF is failing?
Django==1.11.14
djangorestframework==3.8.2