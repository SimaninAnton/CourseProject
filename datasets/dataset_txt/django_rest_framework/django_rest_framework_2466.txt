srkama commented on 24 Jul 2014
I have created a model serializer and i want to remove few fields while sending the data. I have added the Meta options. but Its not working properly as expected. I have did this in past and worked properly.
But now it working, I'm pasting the code here,
I'm using rest-framework version 2.3.13
Models
class CreatedUpdatedMixin(models.Model):
"""
a Mixin to Capture Created and Updated by and Time
"""
created_by = models.ForeignKey(User,
                               related_name="%(app_label)s_%(class)s_adder",
                               on_delete=models.PROTECT)
created_date = models.DateTimeField(auto_now_add=True, editable=False)
modified_by = models.ForeignKey(User,
                                related_name="%(app_label)s_%("
                                             "class)s_editor",
                                on_delete=models.PROTECT)
modified_date = models.DateTimeField(auto_now=True, auto_now_add=True,
                                     editable=False)

class Meta:
    abstract = True

class BillTransaction(generic.CreatedUpdatedMixin):
    bill = models.ForeignKey(GeneratedBill)
    mode_of_pay = models.IntegerField(
        choices=choices_config.TRANSACTION_CHOICES)
    reference_number = models.CharField(max_length=100)
    amount = models.DecimalField(decimal_places=2, max_digits=10)
Serializer
class BillTransactionSerializer(serializers.ModelSerializer):
random = serializers.Field('get_random')
    class Meta:
        model = BillTransaction
        exclude = ('created_by', )
API
class TransactionViewSet(viewsets.ModelViewSet):
    model = BillTransaction
    serializers_class = BillTransactionSerializer

    def pre_save(self, obj):
        if self.request.method == 'POST':
            obj.created_by = self.request.user
        obj.modified_by = self.request.user