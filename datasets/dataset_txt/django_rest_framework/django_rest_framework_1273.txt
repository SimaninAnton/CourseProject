edilio commented on 25 Feb 2016
Checklist
In fields.py we find:
class CreateOnlyDefault(object): ...
    def __call__(self):
        if self.is_update:
            raise SkipField()
        if callable(self.default):
            return self.default()
        return self.default
Steps to reproduce
If we use swagger (django-rest-swagger==0.3.2) with any models with created_date = models.DateTimeField(auto_now_add=True, blank=True, db_index=True)
Swagger code will brake:
def get_default_value(field):
    default_value = getattr(field, 'default', None)
    if rest_framework.VERSION >= '3.0.0':
        from rest_framework.fields import empty
        if default_value == empty:
            default_value = None
    if callable(default_value):
        default_value = default_value()
    return default_value
Just because is_updated has not been set previously to the call but it we just use hasattr we have a safer code.
Expected behavior
class CreateOnlyDefault(object): ...
    def __call__(self):
        if hasattr(self, 'is_update') and self.is_update:
            raise SkipField()
        if callable(self.default):
            return self.default()
        return self.default
Actual behavior
Return 500 error when using swagger. Of course swagger could be safer too