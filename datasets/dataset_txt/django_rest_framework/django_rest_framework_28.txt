xuxinwen commented on 13 Nov 2019
In ModelSerializer i have this config
extra_kwargs = {
            'update_by': {'default': CurrentUserNameDefault()}
}
read_only_fields = ('update_by',)
update_by is my model field, I want it to be set by backend, so i set it to read_ony and default .
But default do not work.
So , i read the source code
In djangorestframework==3.6.2 rest_framework/serializers.py I find
@cached_property
def _writable_fields(self):
    return [
        field for field in self.fields.values()
        if (not field.read_only) or (field.default is not empty)
    ]
But in djangorestframework==3.10.3 rest_framework/serializers.py I find
    @property
    def _writable_fields(self):
        for field in self.fields.values():
            if not field.read_only:
                yield field