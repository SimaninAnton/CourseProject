Contributor
atlefren commented on 22 Mar 2013
Excuse me if this is a known issue (couldn't find it) or due to me being stupid. But I do think I've found an error with the OAuthAuthentication
I'm using django-rest-framework v. 2.2.4 with oauth2 v .1.5
EDIT: this is Python 2.6
Steps to reproduce:
set up django-rest-framework with rest_framework.authentication.OAuthAuthentication as DEFAULT_AUTHENTICATION_CLASSES
make a request to an api endpoint without any oauth credentials whatsoever
observe that you get a TypeError: "argument of type 'NoneType' is not iterable" in rest_framework/authentication.py in , line 209
I've dug a bit and it seems to me that oauth2 Request.from_request returns None if no parameters is found. This means that oauth_request on line 192 in authentication.py is None, and that the comprehension in 209 fails.
An easy fix seems to be to add
if not oauth_request:
return None
after the try-except to get oauth_request
this modification means that django-rest-framework will return a 401 with "detail": "Authentication credentials were not provided."