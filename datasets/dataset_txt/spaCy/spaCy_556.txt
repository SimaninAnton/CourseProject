louismartin commented on 8 Jul 2019 â€¢
edited
Hi,
When downloading a model using spacy.cli.download and then directly using spacy.load (in the same interpreter), it raises an OSError because spacy.utils.is_package returns False:
spaCy/spacy/util.py
Lines 133 to 134 in a7fd42d
 if is_package(name):  # installed as package 
     return load_model_from_package(name, **overrides) 

We currently need to start a new interpreter for the list of packages to be updated with the newly installed model.
Is this the expected behaviour?
Is there a way to download a model at run time and using it directly? (I'd like my package to download the model lazily only when needed and without having to execute the script twice).
Thanks,
How to reproduce the behaviour
$ pip uninstall -y en_core_web_sm; python -c "import spacy; spacy.cli.download('en_core_web_sm'); spacy.load('en_core_web_sm')"

OSError: [E050] Can't find model 'en_core_web_sm'. It doesn't seem to be a shortcut link, a Python package or a valid path to a data directory.
Your Environment
Operating System: Ubuntu 18.04
Python Version Used: 3.7.3
spaCy Version Used: 2.1.3
Environment Information: