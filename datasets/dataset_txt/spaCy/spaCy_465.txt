Member
svlandeg commented on 1 Aug 2019
How to reproduce the behaviour
Previously, I saved en_core_web_lg to file, creating a vocab subdirectory, and its meta.json which reads (among other things)
"lang":"en",
"name":"core_web_lg"
Now, I'm attempting to use the vocab subdir as source for a blank model:
vocab = Vocab().from_disk(vocab_dir)
nlp = spacy.blank("en", vocab=vocab)
print(nlp("This is a test sentence"))
nlp.to_disk(output_dir)
nlp2 = spacy.load(output_dir)
print(nlp2("This is another test sentence"))
Which fails, giving the error ValueError: [E054] No valid 'lang' setting found in model meta.json.
And indeed, the meta.json of the new nlp object reads
"lang":""
Is this expected behaviour? When I run this in a unit test and replace the second line with
nlp = spacy.blank("en", vocab=en_vocab)
it does work correctly.
Your Environment
spaCy version: 2.1.6
Platform: Windows-10-10.0.17763-SP0
Python version: 3.6.7