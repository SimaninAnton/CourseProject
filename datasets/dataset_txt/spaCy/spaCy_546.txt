pratapaprasanna commented on 10 Jul 2019 â€¢
edited
Hi all,
I have trained a NER model with CPU and i could see that the NER loss decreasing but when i try to use the same code but add add spacy.require_gpu() and try using my GPU the NER loss was stagnate after few epochs
But my loss was decreasing when i ran my training on CPU
    spacy.require_gpu()
    nlp = spacy.blank('en')
    ner = nlp.create_pipe('ner')
    sbd = nlp.create_pipe('sentencizer')
    nlp.add_pipe(sbd)
    nlp.add_pipe(ner, last=True)
    output_dir = config['TRAIN']['model_save_path']
    for _, annotations in train_data:
        for ent in annotations.get('entities'):
            ner.add_label(ent[2])
    other_pipes = [pipe for pipe in nlp.pipe_names if pipe != 'ner']
    with nlp.disable_pipes(*other_pipes):
        n_iter = int(config['TRAIN']['num_epochs'])
        optimizer = nlp.begin_training(n_threads=8, device=0)
        for itn in range(n_iter):
            if config['TRAIN']["shuffle_data"]:
                random.shuffle(train_data)
            losses = {}
            batches = minibatch(train_data, size=2048)
Did i miss anything and is there any approach to speed-up my training
Any help would be off great use
Thanks in advance.
Your Environment
Operating System: 18.04
Python Version Used: 3.6.8
spaCy Version Used: spacy 2.1.4
Environment Information: