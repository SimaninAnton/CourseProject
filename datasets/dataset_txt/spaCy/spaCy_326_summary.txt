Extract recurrent patterns using rule-based matching