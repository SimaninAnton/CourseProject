miguelwon commented on 30 Oct 2019
I have two sets of data one to train a pos-tagger and a different one to train a ner model. Using the train from CLI, I trained first the tagger only. Now I want to add in this model pipeline a ner system. I used the following command to train the ner and used the model-best from the previous tagger trained process:
python -m spacy train pt_M /50gb_disk/paper_jorge_bruno_perguntas/train_models/ner_models data/spacy_jsons/train_cintil_all_comb_para_harem.json data/spacy_jsons/test_cintil_all_comb_para_harem.json -b /50gb_disk/paper_jorge_bruno_perguntas/train_models/pos_models/model-best --pipeline "ner" -v pt_models_init -g 1 -G -n 2
and got this error that complains that I have not initiated the "ner".
Training pipeline: ['ner']
Starting with base model
'/50gb_disk/paper_jorge_bruno_perguntas/train_models/pos_models/model-best'
Loading vector from model 'pt_models_init'
Counting training words (limit=0)

Itn    Dep Loss    NER Loss      UAS    NER P    NER R    NER F    Tag %  Token %  CPU WPS  GPU WPS
---  ----------  ----------  -------  -------  -------  -------  -------  -------  -------  -------
Traceback (most recent call last):                                                                                                                                                                                                               
  File "/disk2/paper_jorge_bruno_perguntas/env/lib/python3.6/site-packages/spacy/cli/train.py", line 257, in train
    losses=losses,
  File "/disk2/paper_jorge_bruno_perguntas/env/lib/python3.6/site-packages/spacy/language.py", line 475, in update
    proc.update(docs, golds, sgd=get_grads, losses=losses, **kwargs)
  File "nn_parser.pyx", line 392, in spacy.syntax.nn_parser.Parser.update
  File "nn_parser.pyx", line 236, in spacy.syntax.nn_parser.Parser.require_model
ValueError: [E109] Model for component 'ner' not initialized. Did you forget to load a model, or forget to call begin_training()?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.6/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.6/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/disk2/paper_jorge_bruno_perguntas/env/lib/python3.6/site-packages/spacy/__main__.py", line 35, in <module>
    plac.call(commands[command], sys.argv[1:])
  File "/disk2/paper_jorge_bruno_perguntas/env/lib/python3.6/site-packages/plac_core.py", line 328, in call
    cmd, result = parser.consume(arglist)
  File "/disk2/paper_jorge_bruno_perguntas/env/lib/python3.6/site-packages/plac_core.py", line 207, in consume
    return cmd, self.func(*(args + varargs + extraopts), **kwargs)
  File "/disk2/paper_jorge_bruno_perguntas/env/lib/python3.6/site-packages/spacy/cli/train.py", line 363, in train
    with nlp.use_params(optimizer.averages):
  File "/usr/lib/python3.6/contextlib.py", line 81, in __enter__
    return next(self.gen)
  File "/disk2/paper_jorge_bruno_perguntas/env/lib/python3.6/site-packages/spacy/language.py", line 675, in use_params
    next(context)
  File "nn_parser.pyx", line 194, in use_params
AttributeError: 'bool' object has no attribute 'use_params'
Info about spaCy
spaCy version: 2.1.9
Platform: Linux-4.4.0-140-generic-x86_64-with-Ubuntu-16.04-xenial
Python version: 3.6.7