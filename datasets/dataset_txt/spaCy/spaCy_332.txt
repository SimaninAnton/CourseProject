leimao commented on 14 Sep 2019 â€¢
edited
How to reproduce the problem
To download the Spacy language model in Dockerfile, an error occurs:
Step 5/7 : RUN python -m spacy download en
 ---> Running in d872921ac8e2
Traceback (most recent call last):
  File "/usr/lib/python3.5/runpy.py", line 174, in _run_module_as_main
    mod_name, mod_spec, code = _get_module_details(mod_name, _Error)
  File "/usr/lib/python3.5/runpy.py", line 133, in _get_module_details
    return _get_module_details(pkg_main_name, error)
  File "/usr/lib/python3.5/runpy.py", line 109, in _get_module_details
    __import__(pkg_name)
  File "/usr/local/lib/python3.5/dist-packages/spacy/__init__.py", line 10, in <module>
    from thinc.neural.util import prefer_gpu, require_gpu
  File "/usr/local/lib/python3.5/dist-packages/thinc/neural/__init__.py", line 4, in <module>
    from ._classes.model import Model  # noqa: F401
  File "/usr/local/lib/python3.5/dist-packages/thinc/neural/_classes/model.py", line 11, in <module>
    from ..train import Trainer
  File "/usr/local/lib/python3.5/dist-packages/thinc/neural/train.py", line 7, in <module>
    from .optimizers import Adam, linear_decay
  File "optimizers.pyx", line 13, in init thinc.neural.optimizers
  File "ops.pyx", line 40, in init thinc.neural.ops
  File "/usr/local/lib/python3.5/dist-packages/cupy/__init__.py", line 11, in <module>
    from cupy import core  # NOQA
  File "/usr/local/lib/python3.5/dist-packages/cupy/core/__init__.py", line 1, in <module>
    from cupy.core import core  # NOQA
  File "cupy/core/carray.pxi", line 50, in init cupy.core.core
AttributeError: type object 'cupy.core.core.Indexer' has no attribute '__reduce_cython__'
However, without downloading en in the Dockerfile, the image could be created successfully. Then I could download the en without problem.
Your Environment
Platform: Linux-5.0.0-27-generic-x86_64-with-Ubuntu-16.04-xenial
Python version: 3.5.2
spaCy version: 2.1.8