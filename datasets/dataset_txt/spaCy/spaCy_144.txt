samuelhoenle commented on 15 Nov 2019
I'm using TextCategizer to train spaCy to categorize whole paragraphs. After training the model, I want to save it to disk using to_disk(). During that process, a segmentation fault occurs.
The stack trace:
Fatal Python error: Segmentation fault

Current thread 0x0000000105128dc0 (most recent call first):
  File "/usr/local/lib/python3.7/site-packages/srsly/_json_api.py", line 26 in json_dumps
  File "/usr/local/lib/python3.7/site-packages/srsly/_json_api.py", line 74 in write_json
  File "/usr/local/lib/python3.7/site-packages/spacy/util.py", line 627 in to_disk
  File "/usr/local/lib/python3.7/site-packages/spacy/language.py", line 798 in <lambda>
  File "/usr/local/lib/python3.7/site-packages/spacy/util.py", line 627 in to_disk
  File "/usr/local/lib/python3.7/site-packages/spacy/language.py", line 800 in to_disk
How to reproduce the behaviour
The labels being added to the textcat pipe is of the type numpy.int64. (A cast solves the problem.)
Your Environment
Operating System: macOS Catalina 10.15.1
spaCy version: 2.1.8
Platform: Darwin-19.0.0-x86_64-i386-64bit
Python version: 3.7.5
Models: en