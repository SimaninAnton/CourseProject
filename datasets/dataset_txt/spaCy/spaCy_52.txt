kormilitzin commented on 22 Dec 2019 â€¢
edited
I am CLI-training a NER model, however, after 3-4 epochs, it crashes with the following error:
Traceback (most recent call last): File "/usr/lib/python3.6/runpy.py", line 193, in _run_module_as_main "main", mod_spec)
File "/usr/lib/python3.6/runpy.py", line 85, in _run_code exec(code, run_globals)
File "/mnt/sdf/andrey_work/spacy/lib/python3.6/site-packages/spacy/main.py", line 33, in plac.call(commands[command], sys.argv[1:])
File "/mnt/sdf/andrey_work/spacy/lib/python3.6/site-packages/plac_core.py", line 367, in call cmd, result = parser.consume(arglist)
File "/mnt/sdf/andrey_work/spacy/lib/python3.6/site-packages/plac_core.py", line 232, in consume return cmd, self.func(*(args + varargs + extraopts), **kwargs)
File "/mnt/sdf/andrey_work/spacy/lib/python3.6/site-packages/spacy/cli/train.py", line 368, in train losses=losses,
File "/mnt/sdf/andrey_work/spacy/lib/python3.6/site-packages/spacy/language.py", line 515, in update proc.update(docs, golds, sgd=get_grads, losses=losses, **kwargs)
File "nn_parser.pyx", line 456, in spacy.syntax.nn_parser.Parser.update File "nn_parser.pyx", line 587, in spacy.syntax.nn_parser.Parser.get_batch_loss File "transition_system.pyx", line 156, in spacy.syntax.transition_system.TransitionSystem.set_costs
ValueError: [E024] Could not find an optimal move to supervise the parser. Usually, this means that the model can't be updated in a way that's valid and satisfies the correct annotations specified in the GoldParse. For example, are all labels added to the model? If you're training a named entity recognizer, also make sure that none of your annotated entity spans have leading or trailing whitespace. You can also use the experimental debug-data command to validate your JSON-formatted training data. For details, run: python -m spacy debug-data --help
I've run debug-data, and no problems were occurred with NER model (no white spaces). Moreover, Parser is not being trained, but only ner. It is also a bit strange, as it crashes after several successful epochs, so the model is capable of learning from data, but then something is happening and then it crashes. Very strange. Thanks in advance.
Your Environment
Info about spaCy
spaCy version: 2.2.3
Platform: Linux-4.15.0-70-generic-x86_64-with-Ubuntu-18.04-bionic
Python version: 3.6.8
Models: en