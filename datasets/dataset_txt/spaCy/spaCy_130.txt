Niels-Dekker commented on 20 Nov 2019
I am trying to convert IOB tags from another NER model to the spaCy Span format.
Consider the following example sentence:
The merger of Hema and Bijenkorf B.V. takes place on monday the 10th of august.
The IOB output from my model looks like this:
['O', 'O', 'O', 'B-ORG', 'O', 'B-ORG', 'I-ORG', 'I-ORG', 'I-ORG', 'I-ORG', 'O', 'O', 'O', 'O', 'B-DATE', 'I-DATE', 'I-DATE', 'I-DATE', 'O']
I can correctly transform this to BILUO using spacy.gold's iob_to_biluo:
['O', 'O', 'O', 'U-ORG', 'O', 'B-ORG', 'I-ORG', 'I-ORG', 'I-ORG', 'L-ORG', 'O', 'O', 'O', 'O', 'B-DATE', 'I-DATE', 'I-DATE', 'L-DATE', 'O']
I used to be able to use offsets_from_biluo_tags to transform this to the required offsets. However, when used now, I get:
IndexError: [E035] Error creating span with start 14 and end 18 for Doc of length 16.
I suspect that it has to do with the periods in 'B.V.', because running the same steps for this text works just fine:
The merger of Hema and Bijenkorf takes place on monday the 10th of august.
This issue breaks both the offsets_from_biluo_tags and the spans_from_biluo_tags from spacy.gold.
Info about spaCy
spaCy version: 2.2.2
Platform: Darwin-18.6.0-x86_64-i386-64bit
Python version: 3.7.0