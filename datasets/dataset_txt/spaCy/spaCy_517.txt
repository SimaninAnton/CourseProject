DeltaSierra4 commented on 18 Jul 2019 â€¢
edited
The full error log I get is below:
Traceback (most recent call last):
  File "classify.py", line 461, in <module>
    plac.call(main)
  File "/usr/local/lib/python3.7/dist-packages/plac_core.py", line 328, in call
    cmd, result = parser.consume(arglist)
  File "/usr/local/lib/python3.7/dist-packages/plac_core.py", line 207, in consume
    return cmd, self.func(*(args + varargs + extraopts), **kwargs)
  File "classify.py", line 193, in main
    textcat.model.tok2vec.from_bytes(file_.read())
  File "/usr/local/lib/python3.7/dist-packages/thinc/neural/_classes/model.py", line 375, in from_bytes
    dest = getattr(layer, name)
AttributeError: 'FunctionLayer' object has no attribute 'G'
How to reproduce the behaviour
I obtained several .bin files from running the following line:
python3 -m spacy pretrain data.jsonl en_vectors_web_lg binaries
then I used the .bin file for a text classifier with the -t2v command line argument:
python3 classify.py -t2v binaries/model100.bin [...other optional arguments...]
(classify.py is basically the sample code that is presented in the textcat section of the documentation) It loads the en model and initializes the pipelines correctly, but when it reaches the line where it is trying to read in the .bin file it crashes with the error log above.
Retraining with a different version (2.1.4) or using python 2.7 or Python 3.6 instead of python 3.7.3 didn't work. Following the suggestions on issue #3668 (i.e. setting --use-vectors during pretraining) didn't work either.
Your Environment
Operating System: Linux Ubuntu 18.04.2 LTS
Python Version Used: 3.7.3
spaCy Version Used: 2.1.6