Contributor
phiedulxp commented on 5 Aug 2019 â€¢
edited
How to reproduce the behaviour
python -m spacy train en train.json dev.json
    with skip some ill GoldParse:
            spacy\syntax\nn_parser.pyx
                begin_training
                    try:
                        gold_sample.append(GoldParse(doc_sample[-1], words=words, tags=tags,
                                                    heads=heads, deps=deps, ents=ents))
                    except Exception as e:
                        doc_sample.pop()
still error:
Traceback (most recent call last):
  File "spacy\cli\train.py", line 248, in train
    for batch in util.minibatch_by_words(train_docs, size=batch_sizes):
  File "spacy\util.py", line 532, in minibatch_by_words
    doc, gold = next(items)
  File "gold.pyx", line 217, in train_docs
  File "gold.pyx", line 233, in iter_gold_docs
  File "gold.pyx", line 253, in spacy.gold.GoldCorpus._make_golds
  File "gold.pyx", line 451, in spacy.gold.GoldParse.from_annot_tuples
  File "gold.pyx", line 599, in spacy.gold.GoldParse.__init__
ValueError: [E069] Invalid gold-standard parse tree. Found cycle between word IDs: {1362, 1363}
It seams that gold_sample handle sentence level, as Found cycle between word IDs: {0, 1} etc.
and spacy.gold.GoldParse.from_annot_tuples handle doc level, as Found cycle between word IDs: {1362, 1363}
Your Environment
Info about spaCy
spaCy version: 2.1.7
Platform: Windows-10-10.0.17134-SP0
Python version: 3.7.3