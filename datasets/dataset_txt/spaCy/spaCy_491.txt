Contributor
yanaiela commented on 24 Jul 2019
I'm running spacy on large amounts of text, and wanted to persist the annotations to the disk.
To speed things up, I started using gpus, but then got the following error:
TypeError: can not serialize 'cupy.core.core.ndarray' object
I'm persisting the annotations using pickle.
When running on the cpus it works fine.
Is there a method to transfer all the cupy objects into numpy or something similar?
How to reproduce the behaviour
import spacy
import pickle

spacy.prefer_gpu()
nlp = spacy.load('en_core_web_sm')
s = nlp("Hello World")
pickle.dump(s, open('temp.pickle', "wb"))
Your Environment
Operating System: CentOS Linux v.7
Python Version Used: 3.7.3
spaCy Version Used: 2.1.6
Environment Information: