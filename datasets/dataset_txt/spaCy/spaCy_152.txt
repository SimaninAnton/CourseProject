yishairasowsky commented on 13 Nov 2019
I try to train a model using a trainin set and validation set. But when I write in the command line
spacy train etc then i get an error
i can show you what i did. first my python script is this...
import spacy
from spacy import load 
from spacy.gold import docs_to_json
nlp = load("en_core_web_sm")
f = open('train.txt')
docs = [] # initialize a list to be populated wih strings
lines = f.readlines()  # returns a list of srings from the txt file
for line in lines:
    # print(line[:]) # display the sentence from that line
    doc = nlp(line) # convert string into a spacy doc object using nlp
    docs.append(doc) # add new doc to the list of docs
json_data = docs_to_json(docs) # convert doc into a json file

import json
with open('train.json', 'w+') as outfile:
    json.dump(json_data, outfile)
then later in the command line i wrote
python -m spacy train en models train.json validation.json
then i get this error
Yishai@LAPTOP-92TPUB0A MINGW64 ~/Documents/GitHub/spaCy/examples/training (master)
$ python -m spacy train en models train.json validation.json
C:\Users\Yishai\AppData\Local\Programs\Python\Python37\lib\runpy.py:193: UserWarning: [W022] Training a new part-of-speech tagger using a model with no lemmatization rules or data. This means that the trained model may not be able to lemmatize correctly. If this is intentional or the language you're using doesn't have lemmatization data, you can ignore this warning by setting SPACY_WARNING_IGNORE=W022. If this is surprising, make sure you have the spacy-lookups-data package installed.
  "__main__", mod_spec)
                  [!] Output directory is not empty
This can lead to unintended side effects when saving the model. Please use an
empty directory or a different path instead. If the specified output path
doesn't exist, the directory will be created for you.
Training pipeline: ['tagger', 'parser', 'ner']
Starting with blank model 'en'
Counting training words (limit=0)

Itn  Tag Loss    Tag %    Dep Loss    UAS     LAS    NER Loss   NER P   NER R   NER F   Token %  CPU WPS
---  ---------  --------  ---------  ------  ------  ---------  ------  ------  ------  -------  -------
[+] Saved model to output directory
models\model-final
Traceback (most recent call last):
  File "C:\Users\Yishai\AppData\Local\Programs\Python\Python37\lib\site-packages\spacy\cli\train.py", line 397, in train
    scorer = nlp_loaded.evaluate(dev_docs, verbose=verbose)
  File "C:\Users\Yishai\AppData\Local\Programs\Python\Python37\lib\site-packages\spacy\language.py", line 672, in evaluate
    docs, golds = zip(*docs_golds)
ValueError: not enough values to unpack (expected 2, got 0)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Yishai\AppData\Local\Programs\Python\Python37\lib\runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "C:\Users\Yishai\AppData\Local\Programs\Python\Python37\lib\runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "C:\Users\Yishai\AppData\Local\Programs\Python\Python37\lib\site-packages\spacy\__main__.py", line 35, in <module>
    plac.call(commands[command], sys.argv[1:])
  File "C:\Users\Yishai\AppData\Local\Programs\Python\Python37\lib\site-packages\plac_core.py", line 367, in call
    cmd, result = parser.consume(arglist)
  File "C:\Users\Yishai\AppData\Local\Programs\Python\Python37\lib\site-packages\plac_core.py", line 232, in consume
    return cmd, self.func(*(args + varargs + extraopts), **kwargs)
  File "C:\Users\Yishai\AppData\Local\Programs\Python\Python37\lib\site-packages\spacy\cli\train.py", line 498, in train
    best_model_path = _collate_best_model(meta, output_path, nlp.pipe_names)
  File "C:\Users\Yishai\AppData\Local\Programs\Python\Python37\lib\site-packages\spacy\cli\train.py", line 560, in _collate_best_model
    bests[component] = _find_best(output_path, component)
  File "C:\Users\Yishai\AppData\Local\Programs\Python\Python37\lib\site-packages\spacy\cli\train.py", line 579, in _find_best
    accs = srsly.read_json(epoch_model / "accuracy.json")
  File "C:\Users\Yishai\AppData\Local\Programs\Python\Python37\lib\site-packages\srsly\_json_api.py", line 50, in read_json
    file_path = force_path(location)
  File "C:\Users\Yishai\AppData\Local\Programs\Python\Python37\lib\site-packages\srsly\util.py", line 21, in force_path
    raise ValueError("Can't read file: {}".format(location))
ValueError: Can't read file: models\model0\accuracy.json
Which page or section is this issue related to?
https://spacy.io/usage/training#spacy-train-cli