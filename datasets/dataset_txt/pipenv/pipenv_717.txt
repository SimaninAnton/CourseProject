foxlegend commented on 23 Aug 2018
Hello,
Issue description
When specifying two wheel packages in a Pipfile, where one is a dependency of the other, pipenv does not generate the lock file, and raises a CRITICAL error saying that it could not find a version that satisfies the requirement.
My Pipfile:
[[source]]
url = "https://pypi.org/simple"
verify_ssl = true
name = "pypi"

[packages]
vapi-runtime = {path = "./lib/vapi-runtime/vapi_runtime-2.9.0-py2.py3-none-any.whl"}
vapi-common-client = {path = "./lib/vapi-common-client/vapi_common_client-2.9.0-py2.py3-none-any.whl"}

[dev-packages]

[requires]
python_version = "3.6"
In this example, vapi-common-client requires vapi-runtime==2.9.0 as subdependency.
Expected result
pipenv should handle dependencies between wheels packages, and let the lock file being created.
Actual result
pipenv install --verbose                                                                                                                                                                                                 [14:30:31]
Pipfile.lock not found, creating...
Locking [dev-packages] dependencies...
Locking [packages] dependencies...
using sources: [{'url': 'https://pypi.org/simple', 'verify_ssl': True, 'name': 'pypi'}]
Using pip: -i https://pypi.org/simple

                          ROUND 1                           
Current constraints:
  vapi-common-client==2.9.0 from file:///home/fox/Repositories/GitHub/pipenv-wheels-example/lib/vapi-common-client/vapi_common_client-2.9.0-py2.py3-none-any.whl (from -r /tmp/pipenv-wmz87d5q-requirements/pipenv-rh0mk4rl-constraints.txt (line 3))
  vapi-runtime==2.9.0 from file:///home/fox/Repositories/GitHub/pipenv-wheels-example/lib/vapi-runtime/vapi_runtime-2.9.0-py2.py3-none-any.whl (from -r /tmp/pipenv-wmz87d5q-requirements/pipenv-rh0mk4rl-constraints.txt (line 2))

Finding the best candidates:
  found candidate vapi-common-client==2.9.0 (constraint was ==2.9.0)
  found candidate vapi-runtime==2.9.0 (constraint was ==2.9.0)

Finding secondary dependencies:
  vapi-common-client==2.9.0 not in cache, need to check index
Using pip: -i https://pypi.org/simple

                          ROUND 1                           
Current constraints:
  vapi-common-client==2.9.0 from file:///home/fox/Repositories/GitHub/pipenv-wheels-example/lib/vapi-common-client/vapi_common_client-2.9.0-py2.py3-none-any.whl (from -r /tmp/pipenv-wmz87d5q-requirements/pipenv-vg4rvh9a-constraints.txt (line 3))
  vapi-runtime==2.9.0 from file:///home/fox/Repositories/GitHub/pipenv-wheels-example/lib/vapi-runtime/vapi_runtime-2.9.0-py2.py3-none-any.whl (from -r /tmp/pipenv-wmz87d5q-requirements/pipenv-vg4rvh9a-constraints.txt (line 2))

Finding the best candidates:
  found candidate vapi-common-client==2.9.0 (constraint was ==2.9.0)
  found candidate vapi-runtime==2.9.0 (constraint was ==2.9.0)

Finding secondary dependencies:
  vapi-runtime==2.9.0       requires asn1crypto>=0.21.0, attrs, automat>=0.3.0, certifi>=2017.4.17, cffi!=1.11.3,>=1.7, chardet<3.1.0,>=3.0.2, constantly>=15.1, cryptography>=2.2.1, hyperlink>=17.1.1, idna<2.8,>=2.5, incremental>=16.10.1, lxml>=3.4.1, pyasn1, pyasn1-modules, pycparser, pyhamcrest>=1.9.0, pyopenssl>=0.15.1, requests>=2.6.0, service-identity>=16.0.0, setuptools, simplejson>=3.6.5, six>=1.9, twisted>=16.0.0, urllib3<1.24,>=1.21.1, vapi-runtime==2.9.0, werkzeug>=0.10.4, zope.interface>=4.4.2
  vapi-common-client==2.9.0 not in cache, need to check index

CRITICAL:notpip._internal.index:Could not find a version that satisfies the requirement vapi-runtime==2.9.0 (from vapi-common-client==2.9.0->-r /tmp/pipenv-wmz87d5q-requirements/pipenv-rh0mk4rl-constraints.txt (line 3)) (from versions: 2.5.0)
Warning: Your dependencies could not be resolved. You likely have a mismatch in your sub-dependencies.
  You can use $ pipenv install --skip-lock to bypass this mechanism, then run $ pipenv graph to inspect the situation.
  Hint: try $ pipenv lock --pre if it is a pre-release dependency.
No matching distribution found for vapi-runtime==2.9.0 (from vapi-common-client==2.9.0->-r /tmp/pipenv-wmz87d5q-requirements/pipenv-rh0mk4rl-constraints.txt (line 3))
CRITICAL:notpip._internal.index:Could not find a version that satisfies the requirement vapi-runtime==2.9.0 (from vapi-common-client==2.9.0->-r /tmp/pipenv-wmz87d5q-requirements/pipenv-vg4rvh9a-constraints.txt (line 3)) (from versions: 2.5.0)
Warning: Your dependencies could not be resolved. You likely have a mismatch in your sub-dependencies.
  You can use $ pipenv install --skip-lock to bypass this mechanism, then run $ pipenv graph to inspect the situation.
  Hint: try $ pipenv lock --pre if it is a pre-release dependency.
No matching distribution found for vapi-runtime==2.9.0 (from vapi-common-client==2.9.0->-r /tmp/pipenv-wmz87d5q-requirements/pipenv-vg4rvh9a-constraints.txt (line 3))
Steps to replicate
Use pipenv install or pipenv lock on a Pipfile where a wheel package is dependent of another.
I created a sample repository where this issue occurs: foxlegend/pipenv-wheels-example. You may clone this project and execute a
pipenv install command to replicate the problem.
$ pipenv --support