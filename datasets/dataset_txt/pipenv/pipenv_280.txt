glinskyc commented on 17 Feb 2019
Issue description
Upon installing a local package from source, the Pipenv file accurately reflects the installed package, but Pipenv lock fails.
pipenv install "./relative/path/to/my-custom-package-0.1.0.tar.gz"
Pipenv file then contains the following, as expected:
[packages]
my-custom-package = {path = "./relative/path/to/my-custom-package-0.1.0.tar.gz"}
The setup.py file in my-custom-package includes the python_requires attribute with a list of str elements for each package required in my-custom-package. I mention this because I originally thought this is where the problem is, but not so sure now.
As a side note, I already tried pipenv lock --clear, but the same error occurs.
Expected result
Pipenv lock is expected to resolve as normal.
Actual result
TypeError occurs. Here's the trace:
Locking [dev-packages] dependenciesâ€¦
Traceback (most recent call last):
File "c:\users\chad\miniconda3\lib\runpy.py", line 193, in _run_module_as_main
"main", mod_spec)
File "c:\users\chad\miniconda3\lib\runpy.py", line 85, in run_code
exec(code, run_globals)
File "C:\Users\Chad\Miniconda3\Scripts\pipenv.exe_main.py", line 9, in
File "c:\users\chad\miniconda3\lib\site-packages\pipenv\vendor\click\core.py", line 764, in call
return self.main(*args, **kwargs)
File "c:\users\chad\miniconda3\lib\site-packages\pipenv\vendor\click\core.py", line 717, in main
rv = self.invoke(ctx)
File "c:\users\chad\miniconda3\lib\site-packages\pipenv\vendor\click\core.py", line 1137, in invoke
return _process_result(sub_ctx.command.invoke(sub_ctx))
File "c:\users\chad\miniconda3\lib\site-packages\pipenv\vendor\click\core.py", line 956, in invoke
return ctx.invoke(self.callback, **ctx.params)
File "c:\users\chad\miniconda3\lib\site-packages\pipenv\vendor\click\core.py", line 555, in invoke
return callback(*args, **kwargs)
File "c:\users\chad\miniconda3\lib\site-packages\pipenv\vendor\click\decorators.py", line 64, in new_func
return ctx.invoke(f, obj, *args, **kwargs)
File "c:\users\chad\miniconda3\lib\site-packages\pipenv\vendor\click\core.py", line 555, in invoke
return callback(*args, **kwargs)
File "c:\users\chad\miniconda3\lib\site-packages\pipenv\vendor\click\decorators.py", line 17, in new_func
return f(get_current_context(), *args, **kwargs)
File "c:\users\chad\miniconda3\lib\site-packages\pipenv\cli\command.py", line 332, in lock
pypi_mirror=state.pypi_mirror,
File "c:\users\chad\miniconda3\lib\site-packages\pipenv\core.py", line 1055, in do_lock
packages, project, r=False, include_index=True
File "c:\users\chad\miniconda3\lib\site-packages\pipenv\utils.py", line 832, in convert_deps_to_pip
req = new_dep.as_line(sources=indexes if include_index else None).strip()
File "c:\users\chad\miniconda3\lib\site-packages\pipenv\vendor\requirementslib\models\requirements.py", line 1276, in as_line
index_string = " ".join(source_list)
TypeError: sequence item 3: expected str instance, NoneType found