ncoish commented on 5 Feb 2019
Issue description
When trying to specify dependencies on a private pypi server hosted on a specific port on a host, pipenv install fails to create a lockfile, claiming it can't find a version of the dependencies which satisfies the requirements. Upon trying to run pipenv install --skip-lock, it's revealed that there is an SSL error when trying to verify the certificate, even though in the Pipfile the source was specified to verify_ssl=false (See the following codeblock for the source):
[[source]]
name = "mypypi"
url = "https://my.pypirepo.net:4443"
verify_ssl = false
When running with verbose output on, it appears that pipenv is passing --trusted-host to pip without the port number:
['/path/to/pip', 'install', '--verbose', '--upgrade', '"my-package==1.0.5"', '-i', 'https://my.pypirepo.net:4443', '--trusted-host', 'my.pypirepo.net']
which fails when I run pip directly (pip works if I provide the port).
Expected result
pipenv should include the port number in the --trusted-host argument if it is provided.
Actual result
pipenv does not include the port number when it invokes pip with --trusted-host
Steps to replicate
Configure a private pypi repo behind https without a valid SSL certificate, accessible on a non-standard HTTPS port (Any port other than 443).
Specify a source in a pipfile which points at this address, and specify verify_ssl=false
Specify a dependency to pull from the above source
Run pipenv install --skip-lock
$ pipenv --support
1