jlirochon commented on 23 Mar 2018
pipenv install --deploy refuses to run despite Pipenv.lock was created a second ago. It claims the Pipenv.lock is outdated. It may be related to the interpolation of environment variables.
$ python -m pipenv.help output
Expected result
pipenv install --deploy should install the packages from Pipfile.lock.
Actual result
pipenv install --deploy claims that Pipfile.lock is outdated, despite it was generated one second ago.
# pipenv install --deploy
Your Pipfile.lock (edd7a5) is out of date. Expected: (6a2984).
Aborting deploy.
# pipenv lock
Locking [dev-packages] dependencies…
Locking [packages] dependencies…
Updated Pipfile.lock (6ebe9f)!
# pipenv install --deploy
Your Pipfile.lock (6ebe9f) is out of date. Expected: (492c98).
Aborting deploy.
Steps to replicate
have PYPI_USERNAME and PYPI_PASSWORD defined
use my Pipfile
run pipenv lock
run pipenv install --deploy
I noticed that:
the expected hash changes if you change the value of PYPI_USERNAME and PYPI_PASSWORD
if you unset PYPI_USERNAME and PYPI_PASSWORD, the expected hash matches the one in Pipfile.lock, but of course you miss the credentials to install from private pypi server.