DmitryDeryabin commented on 5 Mar 2019
Issue description
pipenv lock fails when Pipfile contains {editable = true, path = "."} and setup.py contains VCS dependency. pipenv install --skip-lock completes without any issues. I've tried pipenv lock --clear and removed pip local cache with no luck, the same error occurs.
At the same time when I push package1 into the git repo and then add it into a new Pipfile in a fresh pipenv environment, pipenv install succeeds even without --skip-lock. So I suspect pipenv doesn't play well together with setup.py and VCS dependencies for some reason.
If I remember correctly, I've had some similar issues before and solved them by using PIP_PROCESS_DEPENDENCY_LINKS=1 env variable, but newer versions of pip do not support this anymore.
Project setup:
Pipfile:
[packages]
package1 = {editable = true, path = "."}
setup.py:
setup(name='package1',
      ...
      install_requires=[
          ...
          'package2 @ git+ssh://git@gitlab.com/.../package2.git@v0.0.2#egg=package2'
      ]
      )
Expected result
Pipfile.lock is generated.
Actual result
I'm getting the following error:
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/pipenv/resolver.py", line 126, in <module>
    main()
  File "/usr/local/lib/python3.6/site-packages/pipenv/resolver.py", line 119, in main
    parsed.requirements_dir, parsed.packages)
  File "/usr/local/lib/python3.6/site-packages/pipenv/resolver.py", line 85, in _main
    requirements_dir=requirements_dir,
  File "/usr/local/lib/python3.6/site-packages/pipenv/resolver.py", line 69, in resolve
    req_dir=requirements_dir
  File "/usr/local/lib/python3.6/site-packages/pipenv/utils.py", line 726, in resolve_deps
    req_dir=req_dir,
  File "/usr/local/lib/python3.6/site-packages/pipenv/utils.py", line 480, in actually_resolve_deps
    resolved_tree = resolver.resolve()
  File "/usr/local/lib/python3.6/site-packages/pipenv/utils.py", line 395, in resolve
    raise ResolutionFailure(message=str(e))
pipenv.exceptions.ResolutionFailure: ERROR: ERROR: Could not find a version that matches package2@ git+ssh://git@gitlab.com/.../package2.git@v0.0.2#egg=package2 from git+ssh://git@gitlab.com/.../package2.git@v0.0.2#egg=package2
No versions found
Was https://pypi.org/simple reachable?
Steps to replicate
Not sure whether it's common issue with VCS dependencies or just this case.
$ pipenv --support