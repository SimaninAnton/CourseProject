scott-vsi commented on 27 Sep 2018
Issue description
Running pipenv lock twice produces a different Pipfile.lock
Expected result
I would expect it to produce the same lock file both times
Actual result and Steps to replicate
$ cat Pipfile
[[source]]
url = "https://pypi.org/simple"
verify_ssl = true
name = "pypi"

[dev-packages]

[packages]
ipython = "*"

[requires]
python_version = "2.7"
$ PIPENV_CACHE_DIR=./venv pipenv lock --verbose
output
$ cat Pipfile.lock | grep -B4 pathlib
        "pathlib2": {
            "hashes": [
                "sha256:8eb170f8d0d61825e09a95b38be068299ddeda82f35e96c3301a8a5e7604cb83",
                "sha256:d1aa2a11ba7b8f7b21ab852b1fb5afb277e1bb99d5dfc663380b5015c0d80c5a"
            ],
            "markers": "python_version == '2.7' or python_version == '3.3'",
            "version": "==2.3.2"
        },
In this form, pathlib is not actually installed after running pipenv install (so ipython is broken). Now, after re-running the command, the lock file has changed:
$ PIPENV_CACHE_DIR=./venv pipenv lock --verbose
output
$ cat Pipfile.lock | grep -B4 pathlib
        "pathlib2": {
            "hashes": [
                "sha256:8eb170f8d0d61825e09a95b38be068299ddeda82f35e96c3301a8a5e7604cb83",
                "sha256:d1aa2a11ba7b8f7b21ab852b1fb5afb277e1bb99d5dfc663380b5015c0d80c5a"
            ],
            "markers": "python_version in '2.6 2.7 3.2 3.3'",
            "version": "==2.3.2"
        },
Now, after running pipenv install, ipython works.
$ pipenv --support