stlehmann commented on 4 Oct 2017
I just discovered pipenv throwing an UnicodeDecodeError when it comes to creating a new virtual environment based on a directory containing umlauts. I guess that is due to the default encoding in Windows is CP-1252 which is not compatible to utf-8.
Traceback (most recent call last):
  File "c:\python36\lib\runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "c:\python36\lib\runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "C:\Python36\Scripts\pipenv.exe\__main__.py", line 9, in <module>
  File "c:\python36\lib\site-packages\pipenv\vendor\click\core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "c:\python36\lib\site-packages\pipenv\vendor\click\core.py", line 697, in main

    rv = self.invoke(ctx)
  File "c:\python36\lib\site-packages\pipenv\vendor\click\core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "c:\python36\lib\site-packages\pipenv\vendor\click\core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "c:\python36\lib\site-packages\pipenv\vendor\click\core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "c:\python36\lib\site-packages\pipenv\cli.py", line 1736, in install
    ensure_project(three=three, python=python, system=system, warn=True, deploy=deploy)
  File "c:\python36\lib\site-packages\pipenv\cli.py", line 588, in ensure_project
    ensure_virtualenv(three=three, python=python, site_packages=site_packages)
  File "c:\python36\lib\site-packages\pipenv\cli.py", line 559, in ensure_virtualenv
    do_create_virtualenv(python=python, site_packages=site_packages)
  File "c:\python36\lib\site-packages\pipenv\cli.py", line 929, in do_create_virtualenv
    click.echo(crayons.blue(c.out), err=True)
  File "c:\python36\lib\site-packages\pipenv\vendor\delegator.py", line 92, in out
    self.__out = self._pexpect_out
  File "c:\python36\lib\site-packages\pipenv\vendor\delegator.py", line 80, in _pexpect_out
    result += self.subprocess.read()
  File "c:\python36\lib\site-packages\pipenv\vendor\pexpect\spawnbase.py", line 413, in read
    self.expect(self.delimiter)
  File "c:\python36\lib\site-packages\pipenv\vendor\pexpect\spawnbase.py", line 321, in expect
    timeout, searchwindowsize, async)
  File "c:\python36\lib\site-packages\pipenv\vendor\pexpect\spawnbase.py", line 345, in expect_list
    return exp.expect_loop(timeout)
  File "c:\python36\lib\site-packages\pipenv\vendor\pexpect\expect.py", line 99, in expect_loop
    incoming = spawn.read_nonblocking(spawn.maxread, timeout)
  File "c:\python36\lib\site-packages\pipenv\vendor\pexpect\popen_spawn.py", line 86, in read_nonblocking
    buf += self._decoder.decode(incoming, final=False)
  File "c:\python36\lib\codecs.py", line 321, in decode
    (result, consumed) = self._buffer_decode(data, self.errors, final)
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe4 in position 54: invalid continuation byte