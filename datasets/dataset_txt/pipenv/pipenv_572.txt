HuangShaoyan commented on 11 Oct 2018
Issue description
pipenv clean doesn't uninstall package not specified in Pipfile.lock.
Expected result
pipenv clean should uninstall all packages not specified in Pipfile.lock only.
Actual result
pipenv clean doesn't uninstall package that not specify in Pipfile.lock, but always show uninstalling package "pipenv" and "virtualenv".
$ pipenv clean -v
Ignoring 'pip'.
Ignoring 'setuptools'.
Ignoring 'wheel'.
Uninstalling 'virtualenv'…
Uninstalling 'virtualenv-clone'…
Uninstalling 'pipenv'…
Uninstalling 'certifi'…                                                                                                                                                     
Steps to replicate
install package sh
$ pipenv install sh
pip list it
$ pipenv run pip list
Package    Version
---------- -------
pip        18.1
setuptools 40.4.3
sh         1.12.14
wheel      0.32.1
I can't use pipenv graph to show dependencies. It is still broken. Please refer to #2952
Pipfile:
[packages]
sh = "*"
comment package sh in Pipfile
Pipfile:
[packages]
# sh = "*"
clean
$ pipenv clean -v
Ignoring 'pip'.
Ignoring 'setuptools'.
Ignoring 'wheel'.
Uninstalling 'virtualenv'…
Uninstalling 'virtualenv-clone'…
Uninstalling 'pipenv'…
Uninstalling 'certifi'…
package "sh" not uninstall
$ pipenv run pip list
Package    Version
---------- -------
pip        18.1
setuptools 40.4.3
sh         1.12.14
wheel      0.32.1
$ pipenv --support