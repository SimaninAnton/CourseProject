zenozen commented on 23 Mar 2018 â€¢
edited
Be sure to check the existing issues (both open and closed!).
Describe the issue briefly here.
pipenv lock should respect allow_prereleases in existing Pipfile
pipenv install packagename fails to pass --pre either from command line or from Pipfile into pipenv lock, causes the command to fail during locking
Either we pass --pre or have allow_prereleases in the Pipfile, as long as there's package name in the cli arguments, it does not work, because of this code fails to passing pre=pre, to my guess: https://github.com/pypa/pipenv/blob/master/pipenv/core.py#L2005
pipenv update --pre --outdated not respecting the --pre flag, removing --outdated works
Expected result
None of the things above works when there's a prerelease dependency in the Pipfile, for example, proto-google-datastore-v1beta3
Actual result
They should all work (IMO, at least for the last two)
Steps to replicate
Pipfile is as follows:
[[source]]
url = "https://pypi.python.org/simple"
verify_ssl = true
name = "pypi"

[packages]
"proto-google-datastore-v1beta3" = "*"

[dev-packages]
ipdb = "*"

[requires]
python_version = "3.6"

[pipenv]
allow_prereleases = true
Running any of the 3 commands above should fail with this Pipfile with the error
Warning: Your dependencies could not be resolved. You likely have a mismatch in your sub-dependencies.
  You can use $ pipenv install --skip-lock to bypass this mechanism, then run $ pipenv graph to inspect the situation.
Could not find a version that matches proto-google-datastore-v1beta3
Tried: 0.0.2rc0, 0.0.3rc0, 1.0.0b0, 1.0.0b1, 1.0.0b2