nstoik commented on 12 Mar 2018
Be sure to check the existing issues (both open and closed!).
Describe the issue briefly here.
When running pipenv in a new folder on Windows 10, the virtualenv and Pipfile are created, but the virtualenv is not used. Running $ pipenv --venv shows No virtualenv has been created for this project yet!
Any subsequent pipenv commands tries to create another virtualenv. When installing a package like pipenv install requests, pipenv tries to install the package globally.
Please run $ python -m pipenv.help, and paste the results here.
C:\Users\Nelson\temp>python -m pipenv.help

Pipenv version: `'11.5.2'`

Pipenv location: `'C:\\Program Files (x86)\\Python36-32\\lib\\site-packages\\pipenv'`

Python location: `'C:\\Program Files (x86)\\Python36-32\\python.exe'`

Other Python installations in `PATH`:

  - `2.7`: `C:\Python27\python.exe`
  - `3.6`: `C:\Program Files (x86)\Python36-32\python.exe`

  - `3.6.4`: `C:\Program Files (x86)\Python36-32\python.exe`
  - `2.7.12`: `C:\Python27\python.exe`
  - `3.6.4`: `C:\Windows\py.exe`

PEP 508 Information:

{'implementation_name': 'cpython',
 'implementation_version': '3.6.4',
 'os_name': 'nt',
 'platform_machine': 'AMD64',
 'platform_python_implementation': 'CPython',
 'platform_release': '10',
 'platform_system': 'Windows',
 'platform_version': '10.0.17115',
 'python_full_version': '3.6.4',
 'python_version': '3.6',
 'sys_platform': 'win32'}

System environment variables:

  - `ALLUSERSPROFILE`
  - `APPDATA`
  - `COMMONPROGRAMFILES`
  - `COMMONPROGRAMFILES(X86)`
  - `COMMONPROGRAMW6432`
  - `COMPUTERNAME`
  - `COMSPEC`
  - `DRIVERDATA`
  - `FPS_BROWSER_APP_PROFILE_STRING`
  - `FPS_BROWSER_USER_PROFILE_STRING`
  - `HOMEDRIVE`
  - `HOMEPATH`
  - `KICAD_PTEMPLATES`
  - `KISYS3DMOD`
  - `KISYSMOD`
  - `LOCALAPPDATA`
  - `LOGONSERVER`
  - `NUMBER_OF_PROCESSORS`
  - `ONEDRIVE`
  - `OS`
  - `PATH`
  - `PATHEXT`
  - `PROCESSOR_ARCHITECTURE`
  - `PROCESSOR_ARCHITEW6432`
  - `PROCESSOR_IDENTIFIER`
  - `PROCESSOR_LEVEL`
  - `PROCESSOR_REVISION`
  - `PROGRAMDATA`
  - `PROGRAMFILES`
  - `PROGRAMFILES(X86)`
  - `PROGRAMW6432`
  - `PROMPT`
  - `PSMODULEPATH`
  - `PUBLIC`
  - `SESSIONNAME`
  - `SYSTEMDRIVE`
  - `SYSTEMROOT`
  - `TEMP`
  - `TMP`
  - `USERDOMAIN`
  - `USERDOMAIN_ROAMINGPROFILE`
  - `USERNAME`
  - `USERPROFILE`
  - `VS140COMNTOOLS`
  - `WINDIR`
  - `WORKON_HOME`
  - `PIP_PYTHON_PATH`
  - `PYTHONUNBUFFERED`

Pipenv�specific environment variables:


Debug�specific environment variables:

  - `PATH`: `C:\Program Files (x86)\Python36-32\;C:\Program Files (x86)\Python36-32\Scripts\;C:\Python27\;C:\Python27\Scripts;C:\WINDOWS\system32;C:\WINDOWS;C:\WINDOWS\System32\Wbem;C:\WINDOWS\System32\WindowsPowerShell\v1.0\;C:\Program Files\Lenovo\Bluetooth Software\;C:\Program Files\Lenovo\Bluetooth Software\syswow64;C:\Program Files\Intel\WiFi\bin\;C:\Program Files\Common Files\Intel\WirelessCommon\;C:\Program Files\Microsoft SQL Server\120\Tools\Binn\;C:\Program Files (x86)\Windows Kits\10\Windows Performance Toolkit\;%localappdata%\Microsoft\WindowsApps;C:\Program Files\Microsoft SQL Server\130\Tools\Binn\;C:\Program Files\Microsoft SQL Server\Client SDK\ODBC\130\Tools\Binn\;C:\Program Files (x86)\Microsoft SQL Server\130\Tools\Binn\;C:\Program Files\Microsoft SQL Server\130\DTS\Binn\;C:\Program Files (x86)\Microsoft SQL Server\Client SDK\ODBC\130\Tools\Binn\;C:\Program Files (x86)\Microsoft SQL Server\130\DTS\Binn\;C:\Program Files (x86)\Microsoft SQL Server\130\Tools\Binn\ManagementStudio\;C:\Program Files\nodejs\;C:\Program Files\dotnet\;C:\Program Files\Intel\WiFi\bin\;C:\Program Files\Common Files\Intel\WirelessCommon\;C:\Users\Nelson\AppData\Local\Microsoft\WindowsApps;C:\Users\Nelson\AppData\Roaming\npm;C:\Program Files\Microsoft VS Code\bin;C:\Program Files\Heroku\bin;C:\Users\Nelson\AppData\Local\GitHub\PortableGit_f02737a78695063deace08e96d5042710d3e32db\cmd;C:\Users\Nelson\AppData\Local\GitHubDesktop\bin;%USERPROFILE%\AppData\Local\Microsoft\WindowsApps;`
If you're on MacOS, just run the following:
$ python -m pipenv.help | pbcopy
Expected result
Describe what you expected.
Run pipenv shell or pipenv install XXX in a new folder, and have the venv created and start using the venv right away with the package installed in the venv.
Actual result
When possible, provide the verbose output (--verbose), especially for locking and dependencies resolving issues.
C:\Users\Nelson>cd temp

C:\Users\Nelson\temp>pipenv shell --verbose
Creating a virtualenv for this project…
Using c:\program files (x86)\python36-32\python.exe (3.6.4) to create virtualenv…
Already using interpreter c:\program files (x86)\python36-32\python.exe
Using base prefix 'c:\\program files (x86)\\python36-32'
New python executable in E:\Documents\Envs\temp-fJUtMCm1\Scripts\python.exe
Installing setuptools, pip, wheel...done.

Virtualenv location:
Creating a Pipfile for this project…
Launching subshell in virtual environment. Type 'exit' to return.
Microsoft Windows [Version 10.0.17115.1]
(c) 2017 Microsoft Corporation. All rights reserved.

C:\Users\Nelson\temp>exit

C:\Users\Nelson\temp>pipenv --venv
No virtualenv has been created for this project yet!

C:\Users\Nelson\temp>
Running with SET PIPENV_VENV_IN_PROJECT=1 gives a different error message but the same result.
C:\Users\Nelson\temp>SET PIPENV_VENV_IN_PROJECT=1

C:\Users\Nelson\temp>pipenv shell
Creating a virtualenv for this project…
Using C:\Program Files (x86)\Python36-32\python.exe (3.6.4) to create virtualenv…
Running virtualenv with interpreter C:\Program Files (x86)\Python36-32\python.exe
Using base prefix 'C:\\Program Files (x86)\\Python36-32'
New python executable in C:\Users\Nelson\temp\.venv\Scripts\python.exe
Installing setuptools, pip, wheel...done.

Virtualenv location: C:\Users\Nelson\temp\.venv
ERROR: Environment '.venv' does not exist. Create it with 'pew new .venv'.

C:\Users\Nelson\temp>pipenv --venv
C:\Users\Nelson\temp\.venv

C:\Users\Nelson\temp>pipenv shell
ERROR: Environment '.venv' does not exist. Create it with 'pew new .venv'.

C:\Users\Nelson\temp>
Steps to replicate
Provide the steps to replicate (which usually at least includes the commands and the Pipfile).
See actual results above.
1