Contributor
rconradharris commented on 22 Mar 2018 â€¢
edited
Commit ecf7842 removes the host-environment-markers key from the Pipfile.lock _meta section.
This means that Pipfile.lock files generated by >11.0 won't be readable by earlier version of pipenv, because they will fail with a KeyError when trying to reference it.
A concrete form of this issue occurs when using the Heroku python-buildpack, because it is currently pinned to version 11.8.2 (correction: that's what their master branch says now, in production they must be running 10.x for this bug to manifest) which expects host-environment-markers to be there. When you try to git push heroku using the latest pipenv you get a deploy error. (see heroku/heroku-buildpack-python#669)
I'm not sure what the correct solution is here. One possibility would be to add back host-environment-markers for now to preserve backwards compatibility and emit a deprecation warning for a while and then remove it down the road.
Another possible option here is to WONTFIX this, and just say that Pipfile.lock compatibility won't be emphasized, yet. But this means that organizations will have to lock-step their pipenv installations so that everyone is using a similar version. I don't think this is tenable.
1