littlemo commented 17 days ago
Issue description
The package setuptools release 45.0.0, which is not support py2 , yesterday(Jan 12, 2020)
Cant create new virtualenv environment under py2
Expected result
Successfully created virtual environment
Actual result
$ pipenv install --two
Creating a virtualenv for this project…
Pipfile: /Volumes/Develop/xx/test/Pipfile
Using /usr/bin/python (2.7.16) to create virtualenv…
⠸ Creating virtual environment...New python executable in /Volumes/Develop/.virtualenvs/test_py2/bin/python
Installing setuptools, pip, wheel...

  Complete output from command /Volumes/Develop/.vi.../test_py2/bin/python - setuptools pip wheel:
  DEPRECATION: Python 2.7 will reach the end of its life on January 1st, 2020. Please upgrade your Python as Python 2.7 won't be maintained after that date. A future version of pip will drop support for Python 2.7.
Looking in indexes: http://devpi.intra.xx.cn/root/xx/+simple/
Looking in links: /Users/moore/.pyenv/versions/3.6.5/lib/python3.6/site-packages/virtualenv_support
Collecting setuptools
  Downloading http://devpi.intra.xx.cn/root/mirror/%2Bf/616/b116b122e4140/setuptools-45.0.0-py2.py3-none-any.whl (583kB)
ERROR: setuptools requires Python '>=3.5' but the running Python is 2.7.16
----------------------------------------
...Installing setuptools, pip, wheel...done.
Running virtualenv with interpreter /usr/bin/python

✘ Failed creating virtual environment
[pipenv.exceptions.VirtualenvCreationException]:   File "/Users/moore/.pyenv/versions/3.6.5/lib/python3.6/site-packages/pipenv/cli/command.py", line 254, in install
[pipenv.exceptions.VirtualenvCreationException]:       editable_packages=state.installstate.editables,
[pipenv.exceptions.VirtualenvCreationException]:   File "/Users/moore/.pyenv/versions/3.6.5/lib/python3.6/site-packages/pipenv/core.py", line 1741, in do_install
[pipenv.exceptions.VirtualenvCreationException]:       pypi_mirror=pypi_mirror,
[pipenv.exceptions.VirtualenvCreationException]:   File "/Users/moore/.pyenv/versions/3.6.5/lib/python3.6/site-packages/pipenv/core.py", line 574, in ensure_project
[pipenv.exceptions.VirtualenvCreationException]:       pypi_mirror=pypi_mirror,
[pipenv.exceptions.VirtualenvCreationException]:   File "/Users/moore/.pyenv/versions/3.6.5/lib/python3.6/site-packages/pipenv/core.py", line 506, in ensure_virtualenv
[pipenv.exceptions.VirtualenvCreationException]:       python=python, site_packages=site_packages, pypi_mirror=pypi_mirror
[pipenv.exceptions.VirtualenvCreationException]:   File "/Users/moore/.pyenv/versions/3.6.5/lib/python3.6/site-packages/pipenv/core.py", line 935, in do_create_virtualenv
[pipenv.exceptions.VirtualenvCreationException]:       extra=[crayons.blue("{0}".format(c.err)),]
[pipenv.exceptions.VirtualenvCreationException]: Traceback (most recent call last):
  File "/Users/moore/.pyenv/versions/3.6.5/lib/python3.6/site-packages/virtualenv.py", line 2580, in <module>
    main()
  File "/Users/moore/.pyenv/versions/3.6.5/lib/python3.6/site-packages/virtualenv.py", line 831, in main
    symlink=options.symlink,
  File "/Users/moore/.pyenv/versions/3.6.5/lib/python3.6/site-packages/virtualenv.py", line 1123, in create_environment
    install_wheel(to_install, py_executable, search_dirs, download=download)
  File "/Users/moore/.pyenv/versions/3.6.5/lib/python3.6/site-packages/virtualenv.py", line 973, in install_wheel
    _install_wheel_with_search_dir(download, project_names, py_executable, search_dirs)
  File "/Users/moore/.pyenv/versions/3.6.5/lib/python3.6/site-packages/virtualenv.py", line 1060, in _install_wheel_with_search_dir
    call_subprocess(cmd, show_stdout=False, extra_env=env, stdin=script)
  File "/Users/moore/.pyenv/versions/3.6.5/lib/python3.6/site-packages/virtualenv.py", line 924, in call_subprocess
    raise OSError("Command {} failed with error code {}".format(cmd_desc, proc.returncode))
OSError: Command /Volumes/Develop/.vi.../test_py2/bin/python - setuptools pip wheel failed with error code 1

Failed to create virtual environment.
Steps to replicate
$ pipenv --support