koyeung commented on 24 Feb 2018
If install and import a requirement file, --site-packages has no effect.
Pipfile
Describe your environment
OS Type: macOS 10.13.3 (MacPorts 2.4.2)
Python version: Python 3.6.4
Pipenv version: pipenv, version 10.0.0
Expected result
System version of python package would be used, instead of more updated version, e.g. if system copy of tox is of version 2.7.0
$ pipenv run pip freeze
pluggy==0.6.0
py==1.5.2
tox==2.7.0
virtualenv==15.1.0
Actual result
Newer version of tox is installed:
$ pipenv run pip freeze
pluggy==0.6.0
py==1.5.2
six==1.11.0
tox==2.9.1
virtualenv==15.1.0
Steps to replicate
Provide the steps to replicate (which usually at least includes the commands and the Pipfile).
tox 2.7.0 is already available in system site-packages. Latest version of tox is 2.9.1 in pypi.
We are going to create a new environment with tox in requirements.txt
System packages:
$ pip freeze
certifi==2018.1.18
chardet==3.0.4
click==6.7
flake8==3.5.0
idna==2.6
mccabe==0.6.1
pew==1.1.2
pipenv==10.0.0
pipsi==0.9
pluggy==0.6.0
py==1.5.2
pycodestyle==2.3.1
pyflakes==1.6.0
requests==2.18.4
tox==2.7.0
urllib3==1.22
virtualenv==15.1.0
virtualenv-clone==0.2.6
requirements.txt contains only tox; no Pipfile yet.
$ cat requirements.txt 
tox

$ ls -aFC
./   ../   requirements.txt
$ pipenv --site-packages install -r requirements.txt 
Creating a virtualenv for this projectâ€¦
â ‹Using base prefix '/opt/local/Library/Frameworks/Python.framework/Versions/3.6'
New python executable in /private/tmp/koyeung/20180224/testprj3/.venv/bin/python3.6
Also creating executable in /private/tmp/koyeung/20180224/testprj3/.venv/bin/python
Installing setuptools, pip, wheel...done.

Virtualenv location: /private/tmp/koyeung/20180224/testprj3/.venv
requirements.txt found, instead of Pipfile! Convertingâ€¦
Warning: Your Pipfile now contains pinned versions, if your requirements.txt did. 
We recommend updating your Pipfile to specify the "*" version, instead.
Requirements file provided! Importing into Pipfileâ€¦
Pipfile.lock not found, creatingâ€¦
Locking [dev-packages] dependenciesâ€¦
Locking [packages] dependenciesâ€¦
Updated Pipfile.lock (f7fa8a)!
Installing dependencies from Pipfile.lock (f7fa8a)â€¦
  ðŸ   â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰ 5/5 â€” 00:00:00
To activate this project's virtualenv, run the following:
 $ pipenv shell
More updated version of tox has been installed:
$ pipenv run pip freeze
pluggy==0.6.0
py==1.5.2
six==1.11.0
tox==2.9.1
virtualenv==15.1.0

$ cat Pipfile
[[source]]

url = "https://pypi.python.org/simple"
verify_ssl = true
name = "pypi"


[packages]

tox = "*"


[dev-packages]
If we run the installation without the requirement file, the system version of tox would be used:
$ pipenv --site-packages install tox
Creating a virtualenv for this projectâ€¦
â ‹Using base prefix '/opt/local/Library/Frameworks/Python.framework/Versions/3.6'
New python executable in /private/tmp/koyeung/20180224/testprj4/.venv/bin/python3.6
Also creating executable in /private/tmp/koyeung/20180224/testprj4/.venv/bin/python
Installing setuptools, pip, wheel...done.

Virtualenv location: /private/tmp/koyeung/20180224/testprj4/.venv
Creating a Pipfile for this projectâ€¦
Installing toxâ€¦
Requirement already satisfied: tox in /opt/local/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages
Requirement already satisfied: py>=1.4.17 in /opt/local/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages (from tox)
Requirement already satisfied: pluggy<1.0,>=0.3.0 in /opt/local/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages (from tox)
Requirement already satisfied: virtualenv>=1.11.2 in /opt/local/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages (from tox)

Adding tox to Pipfile's [packages]â€¦
Locking [dev-packages] dependenciesâ€¦
Locking [packages] dependenciesâ€¦
Updated Pipfile.lock (f7fa8a)!
$ pipenv run pip freeze
pluggy==0.6.0
py==1.5.2
tox==2.7.0
virtualenv==15.1.0