dresnick-sf commented on 5 Jul 2018
Issue description
This package is not installed though I'm running with python 2.7:
        "monotonic": {
            "hashes": [
                "sha256:23953d55076df038541e648a53676fb24980f7a1be290cdda21300b3bc21dfb0",
                "sha256:552a91f381532e33cbd07c6a2655a21908088962bb8fa7239ecbcc6ad1140cc7"
            ],
            "markers": "python_version == '2.6' or python_version == '2.7' or python_version == '3.0' or python_version == '3.1' or python_version == '3.2'",
            "version": "==1.5"
        }
The output from pipenv:
Ignoring monotonic: markers 'python_version == "3.2"' don't match your environment
Expected result
A package with markers matching my version of python to be installed.
Actual result
When running with -v I see this as it is installing:
Installing "monotonic==1.5; python_version == '3.2' --hash=sha256:23953d55076df038541e648a53676fb24980f7a1be290cdda21300b3bc21dfb0 --hash=sha256:552a91f381532e33cbd07c6a2655a21908088962bb8fa7239ecbcc6ad1140cc7"
Steps to replicate
Building this Dockerfile shows the problem.
FROM ubuntu:xenial-20180525

RUN set -x \
 && DEBIAN_FRONTEND=noninteractive \
 && apt-get update \
 && apt-get -y --no-install-recommends install \
  python-pip \
  python-setuptools \
 && pip install --upgrade pip==10.0.1 pipenv==2018.7.1 \
 && apt-get clean
WORKDIR /home
RUN set -x \
 && pipenv install monotonic \
 && cat Pipfile.lock \
 && pipenv --rm \
 && rm Pipfile* \
 && pipenv install click coloredlogs \
 && pipenv --rm \
 && pipenv install --deploy --system
RUN pipenv --support
The key part of the output:
+ pipenv install --deploy --system
Installing dependencies from Pipfile.lock (fe9a7a)...
Ignoring monotonic: markers 'python_version == "3.2"' don't match your environment
$ pipenv --support
1