volkanunsal commented on 3 Jul 2019 •
edited
Issue description
I'm using Miniconda (Python 3.7.3) with Pipenv. But I don't think it's related to Miniconda, it happens with system Python as well.
Here is what is happening. I installed pipenv using Homebrew.
brew install pipenv
Then I tried to install the package black, and this is what I saw:
✗ pipenv install black
Creating a virtualenv for this project…
Pipfile: /Users/newuser/forks/licp/vendor/citiesense/Pipfile
Using /usr/local/Cellar/pipenv/2018.11.26_2/libexec/bin/python3.7 (3.7.3) to create virtualenv…
⠦ Creating virtual environment...Already using interpreter /usr/local/Cellar/pipenv/2018.11.26_2/libexec/bin/python3.7
Using real prefix '/usr/local/Cellar/python/3.7.3/Frameworks/Python.framework/Versions/3.7'
New python executable in /Users/newuser/.local/share/virtualenvs/citiesense-U8VSteJY/bin/python3.7
Also creating executable in /Users/newuser/.local/share/virtualenvs/citiesense-U8VSteJY/bin/python
Please make sure you remove any previous custom paths from your /Users/newuser/.pydistutils.cfg file.
Installing setuptools, pip, wheel...

  Complete output from command /Users/newuser/.loca...VSteJY/bin/python3.7 - setuptools pip wheel:
  Looking in links: /usr/local/Cellar/pipenv/2018.11.26_2/libexec/lib/python3.7/site-packages/virtualenv_support
Collecting setuptools
  Using cached https://files.pythonhosted.org/packages/ec/51/f45cea425fd5cb0b0380f5b0f048ebc1da5b417e48d304838c02d6288a1e/setuptools-41.0.1-py2.py3-none-any.whl
Collecting pip
  Using cached https://files.pythonhosted.org/packages/5c/e0/be401c003291b56efc55aeba6a80ab790d3d4cece2778288d65323009420/pip-19.1.1-py2.py3-none-any.whl
Collecting wheel
  Using cached https://files.pythonhosted.org/packages/bb/10/44230dd6bf3563b8f227dbf344c908d412ad2ff48066476672f3a72e174e/wheel-0.33.4-py2.py3-none-any.whl
Installing collected packages: setuptools, pip, wheel
Could not install packages due to an EnvironmentError: [Errno 13] Permission denied: '/lib/python3.7/site-packages/easy_install.py'
Consider using the `--user` option or check the permissions.
Since I read in the documentation that pipenv CLI API is compatible with pip, I tried passing in --user flag
pipenv install --user black
But I got the same error. Then I tried changing the target directory of pip to Miniconda's site-packages folder from pip.conf and the error went away, but the packages were not installed into pipenv virtual environment, so this wasn't a solution.
cat ~/.config/pip/pip.conf
[global]
target = /miniconda3/envs/pipenv-test/lib/python3.7/site-packages
I tried using sudo -H with pipenv install and that worked as well, but it also changed the permissions of all files in the virtualenv, making it near impossible to do anything without sudo.
EDIT
Then I cleared the contents of /Users/newuser/.pydistutils.cfg since that seemed to be what the error message was complaining about. And that seemed to work. But I had not changed this before. The only thing that it had was something like prefix=''.
Please run $ pipenv --support, and paste the results here. Don't put backticks (`) around it! The output already contains Markdown formatting.
$ pipenv --support
1