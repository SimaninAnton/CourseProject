argaen commented on 3 Apr 2018 •
edited
Hi, I have the following Pipfile:
[[source]]
url = "https://pypi.python.org/simple"
verify_ssl = true
name = "pypi"

[packages]
"e1839a8" = {path = ".", editable = true}

[dev-packages]
"e1839a8" = {path = ".", extras = ["dev"], editable = true}
When I execute pipenv lock, In develop section dependencies coming with the "dev" extra are missing
Versions NOT working:
11.9.0
11.0.0
10.1.0
Versions working:
10.0.1
10.0.0
Expected result
Depdencies from extras should be included in the develop section
Actual result
18:36 $ pipenv lock --verbose | pbcopy
Locking [dev-packages] dependencies…
Using pip: -i https://pypi.python.org/simple

                          ROUND 1
Current constraints:
  file:///Users/manuelmiranda/Projects/mshell-python-aiohttp-core

Finding the best candidates:
  found candidate -e file:///Users/manuelmiranda/Projects/mshell-python-aiohttp-core (constraint was <any>)

Finding secondary dependencies:

New dependencies found in this round:
  adding ['aiohttp', '<3.0,>=2.3.0', '[]']
  adding ['aiotask-context', '>=0.4.1', '[]']
  adding ['yarl', '>=0.13.0', '[]']
Removed dependencies in this round:
Unsafe dependencies in this round:
------------------------------------------------------------
Result of round 1: not stable

                          ROUND 2
Current constraints:
  aiohttp<3.0,>=2.3.0
  aiotask-context>=0.4.1
  mshell-aiohttp-core==5.5.2 from file:///Users/manuelmiranda/Projects/mshell-python-aiohttp-core
  yarl>=0.13.0

Finding the best candidates:
  found candidate aiohttp==2.3.10 (constraint was >=2.3.0,<3.0)
  found candidate aiotask-context==0.5.0 (constraint was >=0.4.1)
  found candidate -e file:///Users/manuelmiranda/Projects/mshell-python-aiohttp-core (constraint was ==5.5.2)
  found candidate yarl==1.1.1 (constraint was >=0.13.0)

Finding secondary dependencies:
  aiohttp==2.3.10           requires async-timeout>=1.2.0, chardet, idna-ssl>=1.0.0, multidict>=4.0.0, yarl>=1.0.0
  yarl==1.1.1               requires idna>=2.0, multidict>=4.0
  aiotask-context==0.5.0    requires -

New dependencies found in this round:
  adding ['async-timeout', '>=1.2.0', '[]']
  adding ['chardet', '', '[]']
  adding ['idna', '>=2.0', '[]']
  adding ['idna-ssl', '>=1.0.0', '[]']
  adding ['multidict', '>=4.0,>=4.0.0', '[]']
  adding ['yarl', '>=0.13.0,>=1.0.0', '[]']
Removed dependencies in this round:
  removing ['yarl', '>=0.13.0', '[]']
Unsafe dependencies in this round:
------------------------------------------------------------
Result of round 2: not stable

                          ROUND 3
Current constraints:
  aiohttp<3.0,>=2.3.0
  aiotask-context>=0.4.1
  async-timeout>=1.2.0
  chardet
  idna>=2.0
  idna-ssl>=1.0.0
  mshell-aiohttp-core==5.5.2 from file:///Users/manuelmiranda/Projects/mshell-python-aiohttp-core
  multidict>=4.0,>=4.0.0
  yarl>=0.13.0,>=1.0.0

Finding the best candidates:
  found candidate aiohttp==2.3.10 (constraint was >=2.3.0,<3.0)
  found candidate aiotask-context==0.5.0 (constraint was >=0.4.1)
  found candidate async-timeout==2.0.1 (constraint was >=1.2.0)
  found candidate chardet==3.0.4 (constraint was <any>)
  found candidate idna==2.6 (constraint was >=2.0)
  found candidate idna-ssl==1.0.1 (constraint was >=1.0.0)
  found candidate -e file:///Users/manuelmiranda/Projects/mshell-python-aiohttp-core (constraint was ==5.5.2)
  found candidate multidict==4.1.0 (constraint was >=4.0,>=4.0.0)
  found candidate yarl==1.1.1 (constraint was >=0.13.0,>=1.0.0)

Finding secondary dependencies:
  multidict==4.1.0          requires -
  chardet==3.0.4            requires -
  yarl==1.1.1               requires idna>=2.0, multidict>=4.0
  aiohttp==2.3.10           requires async-timeout>=1.2.0, chardet, idna-ssl>=1.0.0, multidict>=4.0.0, yarl>=1.0.0
  idna-ssl==1.0.1           requires idna>=2.0
  idna==2.6                 requires -
  aiotask-context==0.5.0    requires -
  async-timeout==2.0.1      requires -
------------------------------------------------------------
Result of round 3: stable, done

Locking [packages] dependencies…
Using pip: -i https://pypi.python.org/simple

                          ROUND 1
Current constraints:
  file:///Users/manuelmiranda/Projects/mshell-python-aiohttp-core

Finding the best candidates:
  found candidate -e file:///Users/manuelmiranda/Projects/mshell-python-aiohttp-core (constraint was <any>)

Finding secondary dependencies:

New dependencies found in this round:
  adding ['aiohttp', '<3.0,>=2.3.0', '[]']
  adding ['aiotask-context', '>=0.4.1', '[]']
  adding ['yarl', '>=0.13.0', '[]']
Removed dependencies in this round:
Unsafe dependencies in this round:
------------------------------------------------------------
Result of round 1: not stable

                          ROUND 2
Current constraints:
  aiohttp<3.0,>=2.3.0
  aiotask-context>=0.4.1
  mshell-aiohttp-core==5.5.2 from file:///Users/manuelmiranda/Projects/mshell-python-aiohttp-core
  yarl>=0.13.0

Finding the best candidates:
  found candidate aiohttp==2.3.10 (constraint was >=2.3.0,<3.0)
  found candidate aiotask-context==0.5.0 (constraint was >=0.4.1)
  found candidate -e file:///Users/manuelmiranda/Projects/mshell-python-aiohttp-core (constraint was ==5.5.2)
  found candidate yarl==1.1.1 (constraint was >=0.13.0)

Finding secondary dependencies:
  yarl==1.1.1               requires idna>=2.0, multidict>=4.0
  aiohttp==2.3.10           requires async-timeout>=1.2.0, chardet, idna-ssl>=1.0.0, multidict>=4.0.0, yarl>=1.0.0
  aiotask-context==0.5.0    requires -

New dependencies found in this round:
  adding ['async-timeout', '>=1.2.0', '[]']
  adding ['chardet', '', '[]']
  adding ['idna', '>=2.0', '[]']
  adding ['idna-ssl', '>=1.0.0', '[]']
  adding ['multidict', '>=4.0,>=4.0.0', '[]']
  adding ['yarl', '>=0.13.0,>=1.0.0', '[]']
Removed dependencies in this round:
  removing ['yarl', '>=0.13.0', '[]']
Unsafe dependencies in this round:
------------------------------------------------------------
Result of round 2: not stable

                          ROUND 3
Current constraints:
  aiohttp<3.0,>=2.3.0
  aiotask-context>=0.4.1
  async-timeout>=1.2.0
  chardet
  idna>=2.0
  idna-ssl>=1.0.0
  mshell-aiohttp-core==5.5.2 from file:///Users/manuelmiranda/Projects/mshell-python-aiohttp-core
  multidict>=4.0,>=4.0.0
  yarl>=0.13.0,>=1.0.0

Finding the best candidates:
  found candidate aiohttp==2.3.10 (constraint was >=2.3.0,<3.0)
  found candidate aiotask-context==0.5.0 (constraint was >=0.4.1)
  found candidate async-timeout==2.0.1 (constraint was >=1.2.0)
  found candidate chardet==3.0.4 (constraint was <any>)
  found candidate idna==2.6 (constraint was >=2.0)
  found candidate idna-ssl==1.0.1 (constraint was >=1.0.0)
  found candidate -e file:///Users/manuelmiranda/Projects/mshell-python-aiohttp-core (constraint was ==5.5.2)
  found candidate multidict==4.1.0 (constraint was >=4.0,>=4.0.0)
  found candidate yarl==1.1.1 (constraint was >=0.13.0,>=1.0.0)

Finding secondary dependencies:
  yarl==1.1.1               requires idna>=2.0, multidict>=4.0
  aiohttp==2.3.10           requires async-timeout>=1.2.0, chardet, idna-ssl>=1.0.0, multidict>=4.0.0, yarl>=1.0.0
  idna-ssl==1.0.1           requires idna>=2.0
  idna==2.6                 requires -
  multidict==4.1.0          requires -
  async-timeout==2.0.1      requires -
  chardet==3.0.4            requires -
  aiotask-context==0.5.0    requires -
------------------------------------------------------------
Result of round 3: stable, done

Updated Pipfile.lock (9a02ff)!
Steps to replicate
Create Pipfile with same contents, execute pipenv lock.
setup.py file used:
import os

from setuptools import setup, find_packages

install_requires = [
    'aiohttp>=2.3.0,<3.0',
    'aiotask-context>=0.4.1',
    'yarl>=0.13.0',
]

dev_requires = [
    "coverage>=4.4.1",
    "flake8>=3.3.0",
    "pytest-mock>=1.6.0",
    "pytest>=3.0.7",
    "pytest-asyncio>=0.8.0",
    "asynctest>=0.10.0",
]

setup(
    name="whatever",
    install_requires=install_requires,
    extras_require={
        'dev': dev_requires
    },
)