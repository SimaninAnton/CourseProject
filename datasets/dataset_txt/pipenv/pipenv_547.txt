decaz commented on 15 Oct 2018
Issue description
Very strange behavior when using dependencies with extras. I'm trying to define raven[flask].
Expected result
Installed raven, flask and blinker as defined in https://github.com/getsentry/raven-python/blob/master/setup.py.
Actual result
Installed just raven and some of the flask's dependencies but flask and blinker.
Steps to replicate
$ pipenv install
Installing dependencies from Pipfile.lock (95d6c3)…
Ignoring blinker: markers 'extra == "flask"' don't match your environment
Ignoring flask: markers 'extra == "flask"' don't match your environment
  🐍   ▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉ 8/8 — 00:00:01
$ pipenv graph
Click==7.0
itsdangerous==0.24
Jinja2==2.10
  - MarkupSafe [required: >=0.23, installed: 1.0]
raven==6.9.0
Werkzeug==0.14.1
$ pipenv --support
Pipenv version: '2018.10.13'
Pipenv location: '/usr/local/lib/python3.6/dist-packages/pipenv'
Python location: '/usr/bin/python3.6'
Python installations found:
3.6.4: /home/decaz/.virtualenvs/test-pipenv-ka2JIAz4/bin/python3.6
3.6.4: /usr/bin/python3.6
3.6.4: /usr/bin/python3.6m
2.7.13: /usr/bin/python2.7
PEP 508 Information:
{'implementation_name': 'cpython',
 'implementation_version': '3.6.4',
 'os_name': 'posix',
 'platform_machine': 'x86_64',
 'platform_python_implementation': 'CPython',
 'platform_release': '4.9.0-8-amd64',
 'platform_system': 'Linux',
 'platform_version': '#1 SMP Debian 4.9.110-3+deb9u6 (2018-10-08)',
 'python_full_version': '3.6.4',
 'python_version': '3.6',
 'sys_platform': 'linux'}
System environment variables:
LS_COLORS
VIRTUALENVWRAPPER_WORKON_CD
XDG_MENU_PREFIX
VIRTUALENVWRAPPER_HOOK_DIR
LANG
GDM_LANG
DISPLAY
OLDPWD
WORKON_HOME
EDITOR
COLORTERM
USERNAME
XDG_VTNR
SSH_AUTH_SOCK
VIRTUAL_ENV
XDG_SESSION_ID
USER
DESKTOP_SESSION
PIP_PYTHON_PATH
QT_QPA_PLATFORMTHEME
PWD
HOME
PIP_SHIMS_BASE_MODULE
JOURNAL_STREAM
SSH_AGENT_PID
QT_ACCESSIBILITY
TMUX
XDG_SESSION_TYPE
XDG_DATA_DIRS
PIPENV_ACTIVE
XDG_SESSION_DESKTOP
GJS_DEBUG_OUTPUT
PROJECT_HOME
GTK_MODULES
VIRTUALENVWRAPPER_PYTHON
VISUAL
WINDOWPATH
VIRTUALENVWRAPPER_SCRIPT
SHELL
TERM
VTE_VERSION
XDG_CURRENT_DESKTOP
GPG_AGENT_INFO
QT_LINUX_ACCESSIBILITY_ALWAYS_ON
TMUX_PANE
PYTHONDONTWRITEBYTECODE
SHLVL
XDG_SEAT
PYTHONPATH
WINDOWID
GDMSESSION
GNOME_DESKTOP_SESSION_ID
LOGNAME
DBUS_SESSION_BUS_ADDRESS
XDG_RUNTIME_DIR
XAUTHORITY
VIRTUALENVWRAPPER_PROJECT_FILENAME
PATH
PS1
GJS_DEBUG_TOPICS
SESSION_MANAGER
_
Pipenv–specific environment variables:
PIPENV_ACTIVE: 1
Debug–specific environment variables:
PATH: /home/decaz/.virtualenvs/test-pipenv-ka2JIAz4/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games:/opt/mssql-tools/bin:/opt/mssql-tools/bin
SHELL: /bin/bash
EDITOR: vim
LANG: en_US.UTF-8
PWD: /home/decaz/workspace/test-pipenv
VIRTUAL_ENV: /home/decaz/.virtualenvs/test-pipenv-ka2JIAz4
Contents of Pipfile ('/home/decaz/workspace/test-pipenv/Pipfile'):
[packages]
raven = {extras = ["flask"], version = "*"}
Contents of Pipfile.lock ('/home/decaz/workspace/test-pipenv/Pipfile.lock'):
{
    "_meta": {
        "hash": {
            "sha256": "7b73d9bcda45fb7d28307312f7ba7675d7952e41db9f50ae188f3824f995d6c3"
        },
        "pipfile-spec": 6,
        "requires": {},
        "sources": [
            {
                "name": "pypi",
                "url": "https://pypi.org/simple",
                "verify_ssl": true
            }
        ]
    },
    "default": {
        "blinker": {
            "hashes": [
                "sha256:471aee25f3992bd325afa3772f1063dbdbbca947a041b8b89466dc00d606f8b6"
            ],
            "markers": "extra == 'flask'",
            "version": "==1.4"
        },
        "click": {
            "hashes": [
                "sha256:2335065e6395b9e67ca716de5f7526736bfa6ceead690adf616d925bdc622b13",
                "sha256:5b94b49521f6456670fdb30cd82a4eca9412788a93fa6dd6df72c94d5a8ff2d7"
            ],
            "version": "==7.0"
        },
        "flask": {
            "hashes": [
                "sha256:2271c0070dbcb5275fad4a82e29f23ab92682dc45f9dfbc22c02ba9b9322ce48",
                "sha256:a080b744b7e345ccfcbc77954861cb05b3c63786e93f2b3875e0913d44b43f05"
            ],
            "markers": "extra == 'flask'",
            "version": "==1.0.2"
        },
        "itsdangerous": {
            "hashes": [
                "sha256:cbb3fcf8d3e33df861709ecaf89d9e6629cff0a217bc2848f1b41cd30d360519"
            ],
            "version": "==0.24"
        },
        "jinja2": {
            "hashes": [
                "sha256:74c935a1b8bb9a3947c50a54766a969d4846290e1e788ea44c1392163723c3bd",
                "sha256:f84be1bb0040caca4cea721fcbbbbd61f9be9464ca236387158b0feea01914a4"
            ],
            "version": "==2.10"
        },
        "markupsafe": {
            "hashes": [
                "sha256:a6be69091dac236ea9c6bc7d012beab42010fa914c459791d627dad4910eb665"
            ],
            "version": "==1.0"
        },
        "raven": {
            "extras": [
                "flask"
            ],
            "hashes": [
                "sha256:3fd787d19ebb49919268f06f19310e8112d619ef364f7989246fc8753d469888",
                "sha256:95f44f3ea2c1b176d5450df4becdb96c15bf2632888f9ab193e9dd22300ce46a"
            ],
            "index": "pypi",
            "version": "==6.9.0"
        },
        "werkzeug": {
            "hashes": [
                "sha256:c3fd7a7d41976d9f44db327260e263132466836cef6f91512889ed60ad26557c",
                "sha256:d5da73735293558eb1651ee2fddc4d0dedcfa06538b8813a2e20011583c9e49b"
            ],
            "version": "==0.14.1"
        }
    },
    "develop": {}
}