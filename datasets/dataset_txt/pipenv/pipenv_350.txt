ErikBjare commented on 26 Dec 2018 •
edited
Issue description
When pipenv install -e file:///home/user/parent-project/child-project is ran it removes the child-project folder. This wiped out a lot of work for me and I wouldn't want that to happen to anyone else.
Expected result
I expected it to uninstall the child-project in the pipenv for parent-project.
Actual result
It removed the entire child-project folder, and failed with an error message: FileNotFoundError: [Errno 2] No such file or directory: '/home/user/parent-project/child-project
Steps to replicate
$ cd ~
$ mkdir parent-project && cd parent-project
$ mkdir child-project
$ pipenv install -e file:///home/user/parent-project/child-project
Installing -e file:///home/user/parent-project/child-project…
Traceback (most recent call last):
  File "/usr/bin/pipenv", line 11, in <module>
    load_entry_point('pipenv==2018.11.15.dev0', 'console_scripts', 'pipenv')()
  File "/usr/lib/python3.7/site-packages/pipenv/vendor/click/core.py", line 764, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python3.7/site-packages/pipenv/vendor/click/core.py", line 717, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python3.7/site-packages/pipenv/vendor/click/core.py", line 1137, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python3.7/site-packages/pipenv/vendor/click/core.py", line 956, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python3.7/site-packages/pipenv/vendor/click/core.py", line 555, in invoke
    return callback(*args, **kwargs)
  File "/usr/lib/python3.7/site-packages/pipenv/vendor/click/decorators.py", line 64, in new_func
    return ctx.invoke(f, obj, *args, **kwargs)
  File "/usr/lib/python3.7/site-packages/pipenv/vendor/click/core.py", line 555, in invoke
    return callback(*args, **kwargs)
  File "/usr/lib/python3.7/site-packages/pipenv/vendor/click/decorators.py", line 17, in new_func
    return f(get_current_context(), *args, **kwargs)
  File "/usr/lib/python3.7/site-packages/pipenv/cli/command.py", line 254, in install
    editable_packages=state.installstate.editables,
  File "/usr/lib/python3.7/site-packages/pipenv/core.py", line 1909, in do_install
    pkg_requirement = Requirement.from_line(pkg_line)
  File "/usr/lib/python3.7/site-packages/pipenv/vendor/requirementslib/models/requirements.py", line 1092, in from_line
    r = FileRequirement.from_line(line_with_prefix, extras=extras)
  File "/usr/lib/python3.7/site-packages/pipenv/vendor/requirementslib/models/requirements.py", line 548, in from_line
    return cls.create(**arg_dict)
  File "/usr/lib/python3.7/site-packages/pipenv/vendor/requirementslib/models/requirements.py", line 477, in create
    setup_info = SetupInfo.from_ireq(ireq)
  File "/usr/lib/python3.7/site-packages/pipenv/vendor/requirementslib/models/setup_info.py", line 422, in from_ireq
    progress_bar="off",
  File "/usr/lib/python3.7/site-packages/pipenv/patched/notpip/_internal/download.py", line 824, in unpack_url
    unpack_file_url(link, location, download_dir, hashes=hashes)
  File "/usr/lib/python3.7/site-packages/pipenv/patched/notpip/_internal/download.py", line 729, in unpack_file_url
    unpack_file(from_path, location, content_type, link)
  File "/usr/lib/python3.7/site-packages/pipenv/patched/notpip/_internal/utils/misc.py", line 585, in unpack_file
    tarfile.is_tarfile(filename) or
  File "/usr/lib/python3.7/tarfile.py", line 2442, in is_tarfile
    t = open(name)
  File "/usr/lib/python3.7/tarfile.py", line 1573, in open
    return func(name, "r", fileobj, **kwargs)
  File "/usr/lib/python3.7/tarfile.py", line 1638, in gzopen
    fileobj = gzip.GzipFile(name, mode + "b", compresslevel, fileobj)
  File "/usr/lib/python3.7/gzip.py", line 163, in __init__
    fileobj = self.myfileobj = builtins.open(filename, mode or 'rb')
FileNotFoundError: [Errno 2] No such file or directory: '/home/erb/Programming/quantifiedme/QSlang'
$ ls child-project
ls: cannot access 'child-project': No such file or directory
$ pipenv --support