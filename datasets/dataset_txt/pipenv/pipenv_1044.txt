maliky commented on 20 May 2018 â€¢
edited
When running as non root user on centos 7.5, pipenv shell returns an OS Error: Out of pty devices
There are 4096 pty available on the machine and only 22 are used.
A strace shows a permission error on /dev/ptmx but the file exist and has +rw rights for the group of the user making the call. And every thing works well when pipenv shell is run as root.
$ python -m pipenv.help.
https://gist.github.com/maliky/01249e028943a350512d70d697038017
Expected result
The shell in the virtual env for a non root user.
Actual result
the console's trace after pipenv shell
https://gist.github.com/maliky/f17c7e73d96cccbb90d9efac15c0957f
the excerpt of strace showing the permission error
https://gist.github.com/maliky/2a15911790e5642688f0345eb8e28506
dev/ptmx", O_RDWR)               = -1 EACCES (Permission denied)
open("/dev/ptyp0", O_RDWR)              = -1 ENOENT (No such file or directory)
open("/dev/ptmx", O_RDWR) = -1 EACCES (Permission denied)
The full strace pipenv shell.
https://gist.github.com/maliky/ae17fc015913907e37ce058ae27d569a
Steps to replicate
I'm running centos 7.5
create a normal user
then log in his account
#su -l user
install pipenv for the user
$ pip3 install pipenv
create a virutal env with pipenv
$ pipenv --three
try to open the shell in the virtual env
$ pipenv shell