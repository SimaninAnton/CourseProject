remcohaszing commented on 15 Aug 2018
Issue description
Pipenv fails to start zsh.
Expected result
A zsh subshell.
Actual result
pipenv shell crashes with the following stacktrace.
Launching subshell in virtual environmentâ€¦
Traceback (most recent call last):
  File "/home/remco/.local/bin/pipenv", line 11, in <module>
    sys.exit(cli())
  File "/home/remco/.local/lib/python3.6/site-packages/pipenv/vendor/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/home/remco/.local/lib/python3.6/site-packages/pipenv/vendor/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/home/remco/.local/lib/python3.6/site-packages/pipenv/vendor/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/home/remco/.local/lib/python3.6/site-packages/pipenv/vendor/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/home/remco/.local/lib/python3.6/site-packages/pipenv/vendor/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/remco/.local/lib/python3.6/site-packages/pipenv/cli.py", line 665, in shell
    three=three, python=python, fancy=fancy, shell_args=shell_args, pypi_mirror=pypi_mirror
  File "/home/remco/.local/lib/python3.6/site-packages/pipenv/core.py", line 2163, in do_shell
    shell.fork_compat(*fork_args)
  File "/home/remco/.local/lib/python3.6/site-packages/pipenv/shells.py", line 107, in fork_compat
    self.cmd, ['-i'], dimensions=(dims.lines, dims.columns),
  File "/home/remco/.local/lib/python3.6/site-packages/pipenv/vendor/pexpect/pty_spawn.py", line 204, in __init__
    self._spawn(command, args, preexec_fn, dimensions)
  File "/home/remco/.local/lib/python3.6/site-packages/pipenv/vendor/pexpect/pty_spawn.py", line 276, in _spawn
    'executable: %s.' % self.command)
pipenv.vendor.pexpect.exceptions.ExceptionPexpect: The command was not found or was not executable: -/bin/zsh.
I stepped into choose_shell with a debugger. Apparently type_ is 'zsh', and command is -/bin/zsh.
Steps to replicate
I use Tilix and zsh. It just crashes when I run pipenv shell.
When I run pipenv shell from another TTY, it just works as expected.
Provide the steps to replicate (which usually at least includes the commands and the Pipfile).
$ pipenv --support