Elia-Sh commented on 7 Aug 2019
Hi,
While trying to utilize pipenv for python package management,
on OSX 10.14.6, I suspect I've got tangled with resolving installed site packages,
First is the output of $ pipenv --support | pbcopy -
$ pipenv --support
The question is how can I fix pipenv so I will be able to successfully manage packages with pipenv instead of pythons working venv
The full story -
installed pipenv via brew -> as instructed in https://docs.pipenv.org/en/latest/install/#installing-pipenv
The pip file contect -
[[source]]
name = "pypi"
url = "https://pypi.org/simple"
verify_ssl = true

[dev-packages]

[packages]
flask = "*"
flask-cors = "*"
flask-pymongo = "*"
pymongo = "*"
bson = "*"

[requires]
python_version = "3.7"
First before running pipenv install; deleting any preious using pipenv --rm and cleaning,
and followed clearing cache dirs as explained in: https://docs.pipenv.org/en/latest/diagnose/#your-dependencies-could-not-be-resolved
running pipenv install - finishes with no errors
Warning: the environment variable LANG is not set!
We recommend setting this in ~/.profile (or equivalent) for proper expected behavior.
Creating a virtualenv for this project‚Ä¶
Pipfile: /Users/elia/BE_Blog_posts/server_api/Pipfile
Using /usr/local/bin/python3 (3.7.4) to create virtualenv‚Ä¶
‚†π Creating virtual environment...Using base prefix '/usr/local/Cellar/python/3.7.4/Frameworks/Python.framework/Versions/3.7'
New python executable in /Users/elia/.local/share/virtualenvs/server_api-gYoqao8P/bin/python3.7
Also creating executable in /Users/elia/.local/share/virtualenvs/server_api-gYoqao8P/bin/python
Please make sure you remove any previous custom paths from your /Users/elia/.pydistutils.cfg file.
Installing setuptools, pip, wheel...
done.
Running virtualenv with interpreter /usr/local/bin/python3

‚úî Successfully created virtual environment!
Virtualenv location: /Users/elia/.local/share/virtualenvs/server_api-gYoqao8P
Pipfile.lock not found, creating‚Ä¶
Locking [dev-packages] dependencies‚Ä¶
Locking [packages] dependencies‚Ä¶
‚úî Success!
Updated Pipfile.lock (6b5575)!
  üêç   ‚ñâ‚ñâ‚ñâ‚ñâ‚ñâ‚ñâ‚ñâ‚ñâ‚ñâ‚ñâ‚ñâ‚ñâ‚ñâ‚ñâ‚ñâ‚ñâ‚ñâ‚ñâ‚ñâ‚ñâ‚ñâ‚ñâ‚ñâ‚ñâ‚ñâ‚ñâ‚ñâ‚ñâ‚ñâ‚ñâ‚ñâ‚ñâ 12/12 ‚Äî 00:00:02
starting pipenv and attempting to run the app resolves in failure for ModuleNotFoundError: No module named 'flask'
python app.py
Traceback (most recent call last):
  File "app.py", line 1, in <module>
    from flask import Flask
ModuleNotFoundError: No module named 'flask'
The Bellow is from within pipenv shell -
which python
/Users/elia/.local/share/virtualenvs/server_api-gYoqao8P/bin/python

python -m site
sys.path = [
    '/Users/elia/BE_Blog_posts/server_api',
    '/Users/elia/.local/share/virtualenvs/server_api-gYoqao8P/lib/python37.zip',
    '/Users/elia/.local/share/virtualenvs/server_api-gYoqao8P/lib/python3.7',
    '/Users/elia/.local/share/virtualenvs/server_api-gYoqao8P/lib/python3.7/lib-dynload',
    '/usr/local/Cellar/python/3.7.4/Frameworks/Python.framework/Versions/3.7/lib/python3.7',
    '/Users/elia/.local/share/virtualenvs/server_api-gYoqao8P/lib/python3.7/site-packages',
]
USER_BASE: '/Users/elia/.local' (exists)
USER_SITE: '/Users/elia/.local/lib/python3.7/site-packages' (doesn't exist)
ENABLE_USER_SITE: False

pip list
Package          Version
---------------- ----------
bson             0.5.8
certifi          2018.10.15
Click            7.0
Flask            1.1.1
Flask-Cors       3.0.8
Flask-PyMongo    2.3.0
itsdangerous     1.1.0
Jinja2           2.10.1
MarkupSafe       1.1.1
pip              19.1.1
pipenv           2018.11.26
pymongo          3.8.0
python-dateutil  2.8.0
setuptools       41.0.1
six              1.12.0
virtualenv       16.3.0
virtualenv-clone 0.3.0
Werkzeug         0.15.5
wheel            0.33.4
After not being able to resolve this lack of ability to load packages, I've tried the Pythons default venv following: https://opensource.com/article/19/4/managing-python-packages
and after the activation of venv I'm able to successfully start the app and non modules are missing -
### output is when venv is activated (sourced activae script)
$ which python
/Users/elia/BE_Blog_posts/server_api/be_test1/bin/python

$ which pip
/Users/elia/BE_Blog_posts/server_api/be_test1/bin/pip

$ pip list
Package       Version
------------- -------
Click         7.0
Flask         1.1.1
Flask-Cors    3.0.8
Flask-PyMongo 2.3.0
itsdangerous  1.1.0
Jinja2        2.10.1
MarkupSafe    1.1.1
pip           19.2.1
pymongo       3.8.0
setuptools    40.8.0
six           1.12.0
Werkzeug      0.15.5

# python loads flask package and runs as expected - 
$ python app.py
 * Serving Flask app "app" (lazy loading)
 * Environment: production
   WARNING: This is a development server. Do not use it in a production deployment.
   Use a production WSGI server instead.
 * Debug mode: off
 * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
I would appreciate any help with troubleshooting and fixing lovely pipenv,
Thanks,
Elia.