Contributor
jleclanche commented on 19 Mar 2018 â€¢
edited
I'm sorry I don't have a reduced test case for this but this is so crazy slow it's hard to actually debug.
Steps to reproduce
Clone https://github.com/HearthSim/hearthsim-vagrant
Inside that directory, clone https://github.com/HearthSim/HSReplay.net
Run docker-compose build django (this builds an image based on the python-stretch docker image, which will also install the latest pipenv systemwide, cf. Dockerfile).
Finally, run docker-compose run django, which runs pipenv install --dev
On linux, this stays stuck at Locking [packages] for over 15 minutes, with no output even when run with --verbose. Then after ~15 mins, it gives me the full output of what it's been doing for all that time.
When run outside of docker, it still takes a couple of minutes on that step, but at most 1-2 mins. I have a pretty beefy CPU and SSD, so I don't know why it would take this long in the first place.
I also see a lot of Warning: Error generating hash for ... in the verbose output, I don't know if that's related.
Any idea? How can I debug this further?
9