kylemart commented on 27 Oct 2018 â€¢
edited
Here is a link to the original issue: microsoft/vscode-python#2968. It should contain all of the information required for this bug report.
In short, VS Code executes pipenv --venv behind the scenes when opening a Python project containing a Pipfile. For some reason, this is resulting in an error. I cannot reproduce this issue outside of VS Code...
Environment data
VS Code version: 1.28.2 (7f3ce96ff4729c91352ae6def877e59c561f4850)
Extension version (available under the Extensions sidebar): 2018.9.1
OS and version: macOS 10.14
Python version (& distribution if applicable, e.g. Anaconda): 3.7.0
Type of virtual environment used (N/A | venv | virtualenv | conda | ...): pipenv
Actual behavior
Upon opening a project folder with an existing virtual environment, I get the following error message:
Workspace contains pipfile but attempt to run 'pipenv --venv' failed with 'Traceback (most recent call last):
  File "/usr/local/bin/pipenv", line 7, in <module>
    from pipenv import cli
  File "/usr/local/lib/python3.7/site-packages/pipenv/__init__.py", line 23, in <module>
    from .cli import cli
  File "/usr/local/lib/python3.7/site-packages/pipenv/cli/__init__.py", line 3, in <module>
    from .command import cli
  File "/usr/local/lib/python3.7/site-packages/pipenv/cli/command.py", line 7, in <module>
    import crayons
  File "/usr/local/lib/python3.7/site-packages/pipenv/patched/crayons.py", line 49, in <module>
    is_powershell = "powershell" in shellingham.detect_shell()[0]
  File "/usr/local/lib/python3.7/site-packages/pipenv/vendor/shellingham/__init__.py", line 22, in detect_shell
    shell = get_shell(pid, max_depth=max_depth)
  File "/usr/local/lib/python3.7/site-packages/pipenv/vendor/shellingham/posix/__init__.py", line 54, in get_shell
    mapping = _get_process_mapping()
  File "/usr/local/lib/python3.7/site-packages/pipenv/vendor/shellingham/posix/__init__.py", line 15, in _get_process_mapping
    mapping = impl.get_process_mapping()
  File "/usr/local/lib/python3.7/site-packages/pipenv/vendor/shellingham/posix/ps.py", line 18, in get_process_mapping
    'ps', '-ww', '-o', 'pid=', '-o', 'ppid=', '-o', 'args=',
  File "/usr/local/Cellar/python/3.7.0/Frameworks/Python.framework/Versions/3.7/lib/python3.7/subprocess.py", line 376, in check_output
    **kwargs).stdout
  File "/usr/local/Cellar/python/3.7.0/Frameworks/Python.framework/Versions/3.7/lib/python3.7/subprocess.py", line 468, in run
    output=stdout, stderr=stderr)
subprocess.CalledProcessError: Command '['ps', '-ww', '-o', 'pid=', '-o', 'ppid=', '-o', 'args=']' returned non-zero exit status 1.'. Make sure pipenv is on the PATH.
Expected behavior
No error message.
Steps to reproduce:
Create directory.
Run pipenv install in the directory.
Open the directory in VS Code.
Please run $ pipenv --support, and paste the results here.
$ pipenv --support