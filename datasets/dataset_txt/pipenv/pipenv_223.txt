vlotorev commented on 25 Mar 2019 â€¢
edited
Issue description
Installing local package that has requirement with PEP 508 Git URL fetches and locks that requirement to version from PyPI not from the specified URL.
Expected result
Pipfile.lock would contain git SHA commit for python-ivi package.
Installing package via pip install package-with-git-sha-dep properly fetches specified Git commit.
Actual result
Pipfile.lock doesn't contain git SHA, python-ivi package installed from PyPi.
Steps to replicate
Clear pipenv environment if existed, pipenv --rm; rm Pipfile*.
Prepare local package package-with-git-sha-dep. Note it has python-ivi specified to Git repository with SHA:
cat > setup.py << eof
import setuptools
setuptools.setup(
    name='package-with-git-sha-dep',
    version='0.0.2',
    python_requires='~=2.7',
    install_requires=[
        'python-ivi@git+https://github.com/python-ivi/python-ivi.git@cfa45ceade0758debe4bc24ba4c8195222cad1e2',
    ]
)
eof
cd -
Install created package via pipenv install -e ./package-with-git-sha-dep and look at generated Pipfile.lock - it doesn't contain information about Git commit SHA, but installed v0.14.9 from PyPi.
pip --version -> pip 19.0.3 from /home/vlotorev/.local/lib/python2.7/site-packages/pip (python 2.7)
$ pipenv --support