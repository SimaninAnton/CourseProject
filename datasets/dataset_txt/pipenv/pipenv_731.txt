hjpotter92 commented on 19 Aug 2018
Issue description
On execution of almost all subcommands of pipenv, I am receiving a ResourceWarning, as follows:
/usr/local/lib/python3.6/site-packages/pipenv/core.py:355: ResourceWarning: unclosed file <_io.FileIO name=4 mode='wb' closefd=True>
  version = python_version(p)
/usr/local/lib/python3.6/site-packages/pipenv/core.py:355: ResourceWarning: unclosed file <_io.FileIO name=5 mode='rb' closefd=True>
  version = python_version(p)
/usr/local/lib/python3.6/site-packages/pipenv/core.py:910: ResourceWarning: unclosed file <_io.FileIO name=4 mode='wb' closefd=True>
  crayons.green('({0})'.format(python_version(python))),
/usr/local/lib/python3.6/site-packages/pipenv/core.py:910: ResourceWarning: unclosed file <_io.FileIO name=5 mode='rb' closefd=True>
  crayons.green('({0})'.format(python_version(python))),
.
.
.
Expected result
No warnings issued!
Actual result
as an example, I did a pipenv install -v pip in a temp directory:
Creating a virtualenv for this project...
Pipfile: /tmp/test/Pipfile
/usr/local/lib/python3.6/site-packages/pipenv/core.py:910: ResourceWarning: unclosed file <_io.FileIO name=4 mode='wb' closefd=True>
  crayons.green('({0})'.format(python_version(python))),
/usr/local/lib/python3.6/site-packages/pipenv/core.py:910: ResourceWarning: unclosed file <_io.FileIO name=5 mode='rb' closefd=True>
  crayons.green('({0})'.format(python_version(python))),
Using /usr/local/bin/python3.6 (3.6.6) to create virtualenv...
Already using interpreter /usr/local/bin/python3.6
Using base prefix '/usr/local'
New python executable in /root/.local/share/virtualenvs/test-hxkKlP5o/bin/python3.6
Also creating executable in /root/.local/share/virtualenvs/test-hxkKlP5o/bin/python
Installing setuptools, pip, wheel.../usr/local/lib/python3.6/site-packages/virtualenv.py:904: ResourceWarning: unclosed file <_io.BufferedReader name=5>
  call_subprocess(cmd, show_stdout=False, extra_env=env, stdin=SCRIPT)
done.
Setting project for test-hxkKlP5o to /tmp/test

Virtualenv location: /root/.local/share/virtualenvs/test-hxkKlP5o
/usr/local/lib/python3.6/subprocess.py:766: ResourceWarning: subprocess 9521 is still running
  ResourceWarning, source=self)
/usr/local/lib/python3.6/site-packages/pipenv/core.py:556: ResourceWarning: unclosed file <_io.FileIO name=4 mode='wb' closefd=True>
  do_create_virtualenv(python=python, site_packages=site_packages, pypi_mirror=pypi_mirror)
/usr/local/lib/python3.6/site-packages/pipenv/core.py:556: ResourceWarning: unclosed file <_io.FileIO name=5 mode='rb' closefd=True>
  do_create_virtualenv(python=python, site_packages=site_packages, pypi_mirror=pypi_mirror)
Creating a Pipfile for this project...
/usr/local/lib/python3.6/site-packages/pipenv/project.py:608: ResourceWarning: unclosed file <_io.FileIO name=4 mode='wb' closefd=True>
  version = python_version(required_python) or PIPENV_DEFAULT_PYTHON_VERSION
/usr/local/lib/python3.6/site-packages/pipenv/project.py:608: ResourceWarning: unclosed file <_io.FileIO name=5 mode='rb' closefd=True>
  version = python_version(required_python) or PIPENV_DEFAULT_PYTHON_VERSION
Installing 'pip'
$ "/root/.local/share/virtualenvs/test-hxkKlP5o/bin/pip" install   --verbose    "pip" -i https://pypi.org/simple --exists-action w
Pipfile.lock not found, creating...
Locking [dev-packages] dependencies...
Locking [packages] dependencies...
using sources: [{'url': 'https://pypi.org/simple', 'verify_ssl': True, 'name': 'pypi'}]
Using pip: -i https://pypi.org/simple

                          ROUND 1
Current constraints:

Finding the best candidates:

Finding secondary dependencies:

New dependencies found in this round:
Removed dependencies in this round:
Unsafe dependencies in this round:
  remembering unsafe ['pip', 'None', '[]']
------------------------------------------------------------
Result of round 1: not stable

                          ROUND 2
Current constraints:

Finding the best candidates:

Finding secondary dependencies:

New dependencies found in this round:
Removed dependencies in this round:
Unsafe dependencies in this round:
  remembering unsafe ['pip', 'None', '[]']
------------------------------------------------------------
Result of round 1: not stable

                          ROUND 2
Current constraints:

Finding the best candidates:

Finding secondary dependencies:
------------------------------------------------------------
Result of round 2: stable, done

Updated Pipfile.lock (ecfa48)!
Steps to replicate
Not sure!
# pipenv --support > support
/usr/local/lib/python3.6/site-packages/pipenv/core.py:355: ResourceWarning: unclosed file <_io.FileIO name=4 mode='wb' closefd=True>
  version = python_version(p)
/usr/local/lib/python3.6/site-packages/pipenv/core.py:355: ResourceWarning: unclosed file <_io.FileIO name=5 mode='rb' closefd=True>
  version = python_version(p)
/usr/local/lib/python3.6/site-packages/pipenv/core.py:355: ResourceWarning: unclosed file <_io.FileIO name=4 mode='wb' closefd=True>
  version = python_version(p)
/usr/local/lib/python3.6/site-packages/pipenv/core.py:355: ResourceWarning: unclosed file <_io.FileIO name=5 mode='rb' closefd=True>
  version = python_version(p)
/usr/local/lib/python3.6/site-packages/pipenv/core.py:355: ResourceWarning: unclosed file <_io.FileIO name=4 mode='wb' closefd=True>
  version = python_version(p)
/usr/local/lib/python3.6/site-packages/pipenv/core.py:355: ResourceWarning: unclosed file <_io.FileIO name=5 mode='rb' closefd=True>
  version = python_version(p)
/usr/local/lib/python3.6/site-packages/pipenv/core.py:355: ResourceWarning: unclosed file <_io.FileIO name=4 mode='wb' closefd=True>
  version = python_version(p)
/usr/local/lib/python3.6/site-packages/pipenv/core.py:355: ResourceWarning: unclosed file <_io.FileIO name=5 mode='rb' closefd=True>
  version = python_version(p)
/usr/local/lib/python3.6/site-packages/pipenv/core.py:355: ResourceWarning: unclosed file <_io.FileIO name=4 mode='wb' closefd=True>
  version = python_version(p)
/usr/local/lib/python3.6/site-packages/pipenv/core.py:355: ResourceWarning: unclosed file <_io.FileIO name=5 mode='rb' closefd=True>
  version = python_version(p)
/usr/local/lib/python3.6/site-packages/pipenv/core.py:355: ResourceWarning: unclosed file <_io.FileIO name=4 mode='wb' closefd=True>
  version = python_version(p)
/usr/local/lib/python3.6/site-packages/pipenv/core.py:355: ResourceWarning: unclosed file <_io.FileIO name=5 mode='rb' closefd=True>
  version = python_version(p)
/usr/local/lib/python3.6/site-packages/pipenv/core.py:355: ResourceWarning: unclosed file <_io.FileIO name=4 mode='wb' closefd=True>
  version = python_version(p)
/usr/local/lib/python3.6/site-packages/pipenv/core.py:355: ResourceWarning: unclosed file <_io.FileIO name=5 mode='rb' closefd=True>
  version = python_version(p)
/usr/local/lib/python3.6/site-packages/pipenv/core.py:355: ResourceWarning: unclosed file <_io.FileIO name=4 mode='wb' closefd=True>
  version = python_version(p)
/usr/local/lib/python3.6/site-packages/pipenv/core.py:355: ResourceWarning: unclosed file <_io.FileIO name=5 mode='rb' closefd=True>
  version = python_version(p)
/usr/local/lib/python3.6/site-packages/pipenv/core.py:355: ResourceWarning: unclosed file <_io.FileIO name=4 mode='wb' closefd=True>
  version = python_version(p)
/usr/local/lib/python3.6/site-packages/pipenv/core.py:355: ResourceWarning: unclosed file <_io.FileIO name=5 mode='rb' closefd=True>
  version = python_version(p)
/usr/local/lib/python3.6/site-packages/pipenv/help.py:42: ResourceWarning: unclosed file <_io.FileIO name=4 mode='wb' closefd=True>
  print('  - `{0}`: `{1}`'.format(python_version(f), f))
/usr/local/lib/python3.6/site-packages/pipenv/help.py:42: ResourceWarning: unclosed file <_io.FileIO name=5 mode='rb' closefd=True>
  print('  - `{0}`: `{1}`'.format(python_version(f), f))
/usr/local/lib/python3.6/site-packages/pipenv/help.py:42: ResourceWarning: unclosed file <_io.FileIO name=4 mode='wb' closefd=True>
  print('  - `{0}`: `{1}`'.format(python_version(f), f))
/usr/local/lib/python3.6/site-packages/pipenv/help.py:42: ResourceWarning: unclosed file <_io.FileIO name=5 mode='rb' closefd=True>
  print('  - `{0}`: `{1}`'.format(python_version(f), f))
/usr/local/lib/python3.6/site-packages/pipenv/help.py:42: ResourceWarning: unclosed file <_io.FileIO name=4 mode='wb' closefd=True>
  print('  - `{0}`: `{1}`'.format(python_version(f), f))
/usr/local/lib/python3.6/site-packages/pipenv/help.py:42: ResourceWarning: unclosed file <_io.FileIO name=5 mode='rb' closefd=True>
  print('  - `{0}`: `{1}`'.format(python_version(f), f))
and actual --support output is:
$ pipenv --support