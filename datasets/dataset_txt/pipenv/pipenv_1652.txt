Contributor
hynek commented on 15 Jan 2018
While installing packages that have conditions or markers on them (like “CFFI not on PyPy” for cryptography, or “funcsigs on Python before 3.3” on mock), those conditions are ignored.
I suspect this has something to do with another bug I keep running into but which I was not able to trigger reproducibly: sometimes after a pipenv update my Pipfile.lock (and on pipenv lock --requirements the requirements.txt) gets markers added and after another pipenv update they get removed.
Describe your environment
OS Type: macOS High Sierra
Python version: $ python -V: for Pipenv Python 3.6.3
Pipenv version: $ pipenv --version: 9.0.1 and latest master as of 2018-01-15
Expected result
Conditions are respected.
Actual result
Conditions are ignored.
Steps to replicate
The easiest way to test this: go to an empty directory and type pipenv install --two mock:
As you can see, funcsigs gets installed (“Successfully installed funcsigs-1.0.2 mock-2.0.0 pbr-3.1.1 six-1.11.0”).
However it’s not present in Pipfile.lock:
That means:
it’s not pinned on deployments
after the next pipenv update, it's gonna be gone in development.
Curiously, pipenv graph knows it should depend on funcsigs just fine and seems flabbergasted (?) by its absence:
pipenv graph
mock==2.0.0
  - funcsigs [required: >=1, installed: ?]
  - pbr [required: >=0.11, installed: 3.1.1]
  - six [required: >=1.9, installed: 1.11.0]