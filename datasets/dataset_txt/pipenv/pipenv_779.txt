jmcs commented on 31 Jul 2018
Issue description
When I run pipenv check I get the following message:
Checking PEP 508 requirements...
Passed!
Checking installed package safety...
36351: cryptography >=1.9.0 resolved (2.3 installed)!
python-cryptography versions >=1.9.0 and <2.3 did not enforce a minimum tag length for finalize_with_tag API. If a user did not validate the input length prior to passing it to finalize_with_tag an attacker could craft an invalid payload with a shortened tag (e.g. 1 byte) such that they would have a 1 in 256 chance of passing the MAC check. GCM tag forgeries can cause key leakage.
According to the description the bug was fixed 2.3, which I have installed but it appears pipenv is flagging everything >=1.9.0.
Executing pipenv run safety check shows no vulnerabilities.
Expected result
Pipenv check doesn't report a false positive.
Actual result
Pipenv checks reports a false positive.
Steps to replicate
Create a pipfile that depends on cryptography==2.3
$ pipenv --support