diegohdez90 commented on 12 Jan 2019
Issue description
Install a project environment with pipenv
I use an env of anaconda to create a project environment with pipenv and display me this error
(env-django2-python367) C:\Users\Diego\Documents\developer\django-react-rest>pipenv install
Creating a virtualenv for this project…
Pipfile: C:\Users\Diego\Documents\developer\django-react-rest\Pipfile
Using c:\users\diego\appdata\local\conda\conda\envs\env-django2-python367\python.exe (3.6.7) to create virtualenv…
[ ===] Creating virtual environment...Already using interpreter c:\users\diego\appdata\local\conda\conda\envs\env-django2-python367\python.exe
Using base prefix 'c:\\users\\diego\\appdata\\local\\conda\\conda\\envs\\env-django2-python367'
Overwriting C:\Users\Diego\.virtualenvs\django-react-rest-TsvzdSKG\lib\orig-prefix.txt with new content
New python executable in C:\Users\Diego\.virtualenvs\django-react-rest-TsvzdSKG\Scripts\python.exe
ERROR: The executable C:\Users\Diego\.virtualenvs\django-react-rest-TsvzdSKG\Scripts\python.exe is not functioning
ERROR: It thinks sys.prefix is 'c:\\users\\diego\\documents\\developer\\django-react-rest' (should be 'c:\\users\\diego\\.virtualenvs\\django-react-rest-tsvzdskg')
ERROR: virtualenv is not compatible with this system or executable
Note: some Windows users have reported this error when they installed Python for "Only this user" or have multiple versions of Python installed. Copying the appropriate PythonXX.dll to the virtualenv Scripts/ directory may fix this problem.

Failed creating virtual environment
[pipenv.exceptions.VirtualenvCreationException]:   File "C:\Users\Diego\AppData\Roaming\Python\Python36\site-packages\pipenv\cli\command.py", line 254, in install
[pipenv.exceptions.VirtualenvCreationException]:       editable_packages=state.installstate.editables,
[pipenv.exceptions.VirtualenvCreationException]:   File "C:\Users\Diego\AppData\Roaming\Python\Python36\site-packages\pipenv\core.py", line 1741, in do_install
[pipenv.exceptions.VirtualenvCreationException]:       pypi_mirror=pypi_mirror,
[pipenv.exceptions.VirtualenvCreationException]:   File "C:\Users\Diego\AppData\Roaming\Python\Python36\site-packages\pipenv\core.py", line 574, in ensure_project
[pipenv.exceptions.VirtualenvCreationException]:       pypi_mirror=pypi_mirror,
[pipenv.exceptions.VirtualenvCreationException]:   File "C:\Users\Diego\AppData\Roaming\Python\Python36\site-packages\pipenv\core.py", line 506, in ensure_virtualenv
[pipenv.exceptions.VirtualenvCreationException]:       python=python, site_packages=site_packages, pypi_mirror=pypi_mirror
[pipenv.exceptions.VirtualenvCreationException]:   File "C:\Users\Diego\AppData\Roaming\Python\Python36\site-packages\pipenv\core.py", line 935, in do_create_virtualenv
[pipenv.exceptions.VirtualenvCreationException]:       extra=[crayons.blue("{0}".format(c.err)),]
[pipenv.exceptions.VirtualenvCreationException]: Fatal Python error: Py_Initialize: unable to load the file system codec
LookupError: no codec search functions registered: can't find encoding

Current thread 0x0000042c (most recent call first):

Failed to create virtual environment.
Expected result
A message that environment is created successfully.
Actual result
Open Anaconda Prompt
(base) C:\Users\Diego>activate env-django2-python367
(env-django2-python367) C:\Users\Diego>pipenv --version
pipenv, version 2018.11.26
(env-django2-python367) C:\Users\Diego>pip list
Package          Version
---------------- ----------
certifi          2018.11.29
Django           2.0
pip              18.1
pipenv           2018.11.26
pytz             2018.9
setuptools       40.6.3
virtualenv       16.2.0
virtualenv-clone 0.4.0
wheel            0.32.3
wincertstore     0.2

(env-django2-python367) C:\Users\Diego\Documents\developer\django-react-rest>pipenv install
Creating a virtualenv for this project…
Pipfile: C:\Users\Diego\Documents\developer\django-react-rest\Pipfile
Using c:\users\diego\appdata\local\conda\conda\envs\env-django2-python367\python.exe (3.6.7) to create virtualenv…
[ ===] Creating virtual environment...Already using interpreter c:\users\diego\appdata\local\conda\conda\envs\env-django2-python367\python.exe
Using base prefix 'c:\\users\\diego\\appdata\\local\\conda\\conda\\envs\\env-django2-python367'
Overwriting C:\Users\Diego\.virtualenvs\django-react-rest-TsvzdSKG\lib\orig-prefix.txt with new content
New python executable in C:\Users\Diego\.virtualenvs\django-react-rest-TsvzdSKG\Scripts\python.exe
ERROR: The executable C:\Users\Diego\.virtualenvs\django-react-rest-TsvzdSKG\Scripts\python.exe is not functioning
ERROR: It thinks sys.prefix is 'c:\\users\\diego\\documents\\developer\\django-react-rest' (should be 'c:\\users\\diego\\.virtualenvs\\django-react-rest-tsvzdskg')
ERROR: virtualenv is not compatible with this system or executable
Note: some Windows users have reported this error when they installed Python for "Only this user" or have multiple versions of Python installed. Copying the appropriate PythonXX.dll to the virtualenv Scripts/ directory may fix this problem.

Failed creating virtual environment
[pipenv.exceptions.VirtualenvCreationException]:   File "C:\Users\Diego\AppData\Roaming\Python\Python36\site-packages\pipenv\cli\command.py", line 254, in install
[pipenv.exceptions.VirtualenvCreationException]:       editable_packages=state.installstate.editables,
[pipenv.exceptions.VirtualenvCreationException]:   File "C:\Users\Diego\AppData\Roaming\Python\Python36\site-packages\pipenv\core.py", line 1741, in do_install
[pipenv.exceptions.VirtualenvCreationException]:       pypi_mirror=pypi_mirror,
[pipenv.exceptions.VirtualenvCreationException]:   File "C:\Users\Diego\AppData\Roaming\Python\Python36\site-packages\pipenv\core.py", line 574, in ensure_project
[pipenv.exceptions.VirtualenvCreationException]:       pypi_mirror=pypi_mirror,
[pipenv.exceptions.VirtualenvCreationException]:   File "C:\Users\Diego\AppData\Roaming\Python\Python36\site-packages\pipenv\core.py", line 506, in ensure_virtualenv
[pipenv.exceptions.VirtualenvCreationException]:       python=python, site_packages=site_packages, pypi_mirror=pypi_mirror
[pipenv.exceptions.VirtualenvCreationException]:   File "C:\Users\Diego\AppData\Roaming\Python\Python36\site-packages\pipenv\core.py", line 935, in do_create_virtualenv
[pipenv.exceptions.VirtualenvCreationException]:       extra=[crayons.blue("{0}".format(c.err)),]
[pipenv.exceptions.VirtualenvCreationException]: Fatal Python error: Py_Initialize: unable to load the file system codec
LookupError: no codec search functions registered: can't find encoding

Current thread 0x0000042c (most recent call first):

Failed to create virtual environment.