ociule commented on 13 Sep 2018 â€¢
edited
Issue description
I am trying to run pipenv clean after removing a package from Pipfile and running pipfile lock
Expected result
That the removed packaged is uninstalled by pipenv clean.
Actual result
Pipenv actually tries to remove 4 packages from the global env: pipenv, virtualenv, virtualenv-clone and certifi. It doesn't actually remove them. Maybe it's actually removing them from another virtualenv ?
Steps to replicate
Create a project, add a package with pipenv install.
Remove it by editing the Pipfile.
Run pipfile lock to update Pipfile.lock
Run pipfile clean to remove the package you edited out of Pipfile.
Pipenv clean --dry-run just lists the names of the 4 packages it tries to remove: pipenv, virtualenv, virtualenv-clone, certifi
I then run pip list and the package I removed from Pipfile is still there in the venv. The 4 packages it tried to remove are not even installed in the venv.
I have tested this on both the latest pip release and pipenv master, on Windows. I've tested on both cmd.exe and git bash. Yeah I know bash is not officially supported, that's why I reproed on cmd.exe
This happens in the venv shell or not, and by running 'pipenv run pipenv clean' too.
Update:
Amusingly, if I do install one of the four packages in the venv, it does uninstall it, which points to the code that gets that list as being faulty. The code that tries to uninstall the packages from that list is at fault for failing silently, though.
I can try to repro on Mac OS later tonight
$ pipenv --support