bobh0303 commented on 12 Sep 2018
Issue description
pipenv install results in NameError: global name 'InvalidMarker' is not defined traceback.
I've seen several other closed issues related to Invalid Marker, but I was unable to discover any cause from them.
Expected result
Should have created new virtualenv and installed glyphsLib 2.4.0 and its dependencies
Actual result
C:\SRC\GitHub\pysilfont>pipenv.exe --rm
Removing virtualenv (C:\Users\bobh\.virtualenvs\pysilfont-Lv_ggtc6)...

C:\SRC\GitHub\pysilfont>pipenv.exe install --verbose
Creating a virtualenv for this project...
Pipfile: C:\SRC\GitHub\pysilfont\Pipfile
Using C:\Python27\python.exe (2.7.13) to create virtualenv...
Running virtualenv with interpreter C:\Python27\python.exe
New python executable in C:\Users\bobh\.virtualenvs\pysilfont-Lv_ggtc6\Scripts\python.exe
Installing setuptools, pip, wheel...done.
Setting project for pysilfont-Lv_ggtc6 to C:\SRC\GitHub\pysilfont

Virtualenv location: C:\Users\bobh\.virtualenvs\pysilfont-Lv_ggtc6
Pipfile.lock not found, creating...
Locking [dev-packages] dependencies...
Traceback (most recent call last):
  File "c:\python27\lib\runpy.py", line 174, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "c:\python27\lib\runpy.py", line 72, in _run_code
    exec code in run_globals
  File "C:\Python27\Scripts\pipenv.exe\__main__.py", line 9, in <module>
  File "c:\python27\lib\site-packages\pipenv\vendor\click\core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "c:\python27\lib\site-packages\pipenv\vendor\click\core.py", line 697, in main
    rv = self.invoke(ctx)
  File "c:\python27\lib\site-packages\pipenv\vendor\click\core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "c:\python27\lib\site-packages\pipenv\vendor\click\core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "c:\python27\lib\site-packages\pipenv\vendor\click\core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "c:\python27\lib\site-packages\pipenv\cli.py", line 435, in install
    selective_upgrade=selective_upgrade,
  File "c:\python27\lib\site-packages\pipenv\core.py", line 1943, in do_install
    pypi_mirror=pypi_mirror,
  File "c:\python27\lib\site-packages\pipenv\core.py", line 1312, in do_init
    pypi_mirror=pypi_mirror,
  File "c:\python27\lib\site-packages\pipenv\core.py", line 1057, in do_lock
    settings['packages'], project, r=False, include_index=True
  File "c:\python27\lib\site-packages\pipenv\utils.py", line 513, in convert_deps_to_pip
    new_dep = Requirement.from_pipfile(dep_name, dep)
  File "c:\python27\lib\site-packages\pipenv\vendor\requirementslib\models\requirements.py", line 766, in from_pipfile
    r = NamedRequirement.from_pipfile(name, pipfile)
  File "c:\python27\lib\site-packages\pipenv\vendor\requirementslib\models\requirements.py", line 88, in from_pipfile
    return cls(**creation_args)
  File "<attrs generated init a6e0ca26c49ba3dc9d3385e0a2ff78e4bcd1f859>", line 9, in __init__
  File "c:\python27\lib\site-packages\pipenv\vendor\attr\validators.py", line 106, in __call__
    self.validator(inst, attr, value)
  File "c:\python27\lib\site-packages\pipenv\vendor\requirementslib\models\utils.py", line 140, in validate_specifiers
    except (InvalidMarker, InvalidSpecifier):
NameError: global name 'InvalidMarker' is not defined
c:\python27\lib\site-packages\pipenv\_compat.py:113: ResourceWarning: Implicitly cleaning up <TemporaryDirectory 'c:\\users\\bobh\\appdata\\local\\temp\\pipenv-ai84cx-requirements'>
  warnings.warn(warn_message, ResourceWarning)

C:\SRC\GitHub\pysilfont>
Steps to replicate
pipenv.exe install --verbose
Pipfile is show within the pipenv --support output included below.
$ pipenv --support