chtseac commented on 26 Nov 2018 â€¢
edited
Issue description
One of my dependencies is in the format "lib" = {ref = "branch-name", git = "https://url/to/repo.git"}.
I run pipenv lock --requirements > requirements.txt for the first time inside a docker container.
Expected result
I get a valid requirements.txt
Actual result
See below
Steps to replicate
docker run -it --rm python:3.6 bash
Inside container
pip install pipenv==2018.11.26

echo '                        
[[source]]
url = "https://pypi.org/simple"
verify_ssl = true
name = "pypi"

[dev-packages]

[packages]
"numpy" = {ref = "maintenance/1.15.x", git = "https://github.com/numpy/numpy.git"}
' > Pipfile

pipenv lock --requirements > requirements.txt
Resultant requirements.txt (yes really):
Switched to a new branch 'maintenance/1.15.x'
Branch maintenance/1.15.x set up to track remote branch maintenance/1.15.x from origin.
-i https://pypi.org/simple
git+https://github.com/numpy/numpy.git@3430d78c01a3b9a19adad75f1acb5ae18286da73#egg=numpy
And of course:
root@3f46e6fed2ba:/# pip install -r requirements.txt 
Invalid requirement: 'Switched to a new branch 'maintenance/1.15.x''
It looks like a path. File 'Switched to a new branch 'maintenance/1.15.x'' does not exist.
Workaround
I run pipenv lock --requirements > /dev/null 2>&1 once before running the actual command.
Please run $ pipenv --support, and paste the results here. Don't put backticks (`) around it! The output already contains Markdown formatting.
$ pipenv --support