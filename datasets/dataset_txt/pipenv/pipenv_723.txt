mikob commented on 20 Aug 2018
Issue description
I'm on the master branch of pipenv. This doesn't work on the stable 2018.7.1 release of pipenv because extras don't work in that official release.
After doing a pipenv install of a package from a git-repo with extras, the "extra's" dependencies show as first-level dependencies rather than under the tree of the installed package. Also one of the packages (lxml) doesn't show up in the lockfile. One difference with lxml is I specify a version for it in the setup.py (copied below).
Expected result
Expecting to see all the packages in "extras" listed as second-level dependencies under hra-common (the git repo package). Expecting lxml to be listed in the lockfile.
Steps to replicate
setup.py of git repo dependency hra-common:
#!/usr/bin/env python

from distutils.core import setup

setup(name='HRA Common',
      version='1.0',
      description='HRA Common Facilities',
      author='Miko',
      packages=[
        'hra',
      ],
      dependency_links=[
          'git+https://github.com/mikob/django-geoposition@master#egg=django-geoposition-2.0.0',
          'git+https://github.com/mikob/django-hstore@django-2#egg=django-hstore-2.0.0',
      ],
      install_requires=[
          'six',
          'hyper==0.6.0',
          'pyOpenSSL',
          'dj-database-url',
          # statsd
      ],
      extras_require={
        'd_models':  [
          'Django==2.0.6',
   'django-geoposition',
   'django-hstore',
        ],
        'ac': [
          'aiohttp',
          'aiodns',
          'brotlipy',
          'cchardet', # makes aiohttp faster
          'lxml==4.2.3',
          'yarl',
        ],
      }
     )
$ pipenv install -e 'git+ssh://bitbucket.org/mikob/hotel-alerts-common.git@f4a7#egg=hra-common[ac]
Look at the lockfile, or at pipenv graph and see the aforementioned issues.
$ pipenv --support
1