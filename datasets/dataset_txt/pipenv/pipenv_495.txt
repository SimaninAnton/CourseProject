swenzel commented on 30 Oct 2018
My issue is similar to #1757
Issue description
In an application we have a dependency on one of our libraries (https://github.com/real-digital/pyconnect), which in turn has a dependency on https://github.com/confluentinc/confluent-kafka-python with the extra avro.
Now the problem. Our app has an unconditional dev dependency on 'requests', 'confluent-kafka-python' has a conditional dependency on 'requests' when extra == "avro".
However when I run pipenv install --dev 'requests' is not installed and I get the message:
Ignoring requests: markers 'extra == "avro"' don't match your environment
Complete new installation of the environment doesn't help (it's actually built in a clean python36 container in drone and it worked until a few days ago).
Also the trick with {version='*', marker = "extra != 'fake'"} doesn't do it.
I've run pipenv install --dev, rm Pipfile.lock, pipenv --rm, pipenv lock, and pipenv sync --dev more than a few times in different combinations to make sure everything is up to date.
The only thing that works is putting 'requests' into the base dependencies or explicitly installing it via pipenv install --dev requests (I still get the warning but apparently it is installed anyway).
Expected result
'requests' is installed when I run pipenv install --dev
Actual result
'requests' is not installed, therefore Pipfile.lock doesn't provide a fixed environment for dev.
pipenv.log
Steps to replicate
Minimal non-working Pipenv:
[[source]]
url = "https://pypi.org/simple"
verify_ssl = true
name = "pypi"

[packages]
pyconnect = "*"

[dev-packages]
requests = "*"

[requires]
python_version = "3.6"
$ pipenv --support