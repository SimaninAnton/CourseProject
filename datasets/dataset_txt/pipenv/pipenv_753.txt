ben-g- commented on 9 Aug 2018 â€¢
edited
Say I manually edit my Pipfile -- add some dependencies, remove some dependencies. I would expect that there would be a single command for updating both the Pipfile.lock and the virtual environment to reflect the current state of the Pipfile. As far as I can tell, there isn't.
Here's what there is instead (along with some critiques):
lock: updates the Pipfile.lock to reflect the current state of the Pipfile
sync: installs all packages specified in the Pipfile.lock, but does not uninstall packages not specified in Pipfile.lock (which makes the name misleading, since it doesn't entirely synchronize the environment with the Pipfile.lock)
update: runs lock, then sync, i.e. it does not uninstall packages not specified in Pipfile, even though it removes them from the Pipfile.lock
clean: runs lock, then uninstalls packages not specified in Pipfile.lock. (The help text only says that it does the latter, so the fact that it runs lock first comes as a surprise. In other words, based on the help text, one thinks it's analogous to sync, but it turns out to be analogous to update, and there is no analog to sync.) It doesn't install packages, even though it adds them to the Pipfile.lock.
In summary: The sync command doesn't entirely synchronize anything, which means it's misnamed. And it's weird to have a command that modifies both the Pipfile.lock and the virtual environment yet leaves them unsynchronized -- which is the case for both update and clean.
Given the existing commands, I think that you can completely synchronize everything with the Pipfile by running the following sequence of two commands: clean, then sync.
So this is mainly a request to add a single command that does what that sequence of two commands does.
But also, secondarily, a suggestion to clean up the existing commands and their documentation.
3