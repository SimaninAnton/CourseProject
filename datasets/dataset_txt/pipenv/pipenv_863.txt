lorien commented on 5 Jul 2018 •
edited
Issue description
If I use invalid dependency description tgram = {path = "/web/lib_tgram", editable = True} (should be true, not True), then I got IndexError exception that does not help much.
Expected result
Something like Hey! Your Pipfile is broken at line #XXX
Actual result
$ pipenv install -ve /web/lib_tgram
Installing -e /web/lib_tgram…

... few lines skipped ...

Successfully installed tgram
Cleaning up...

Adding -e /web/lib_tgram to Pipfile's [packages]…
Traceback (most recent call last):
  File "/usr/local/bin/pipenv", line 11, in <module>
    sys.exit(cli())
  File "/home/lorien/.local/lib/python2.7/site-packages/pipenv/vendor/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/home/lorien/.local/lib/python2.7/site-packages/pipenv/vendor/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/home/lorien/.local/lib/python2.7/site-packages/pipenv/vendor/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/home/lorien/.local/lib/python2.7/site-packages/pipenv/vendor/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/home/lorien/.local/lib/python2.7/site-packages/pipenv/vendor/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/lorien/.local/lib/python2.7/site-packages/pipenv/cli.py", line 366, in install
    selective_upgrade=selective_upgrade,
  File "/home/lorien/.local/lib/python2.7/site-packages/pipenv/core.py", line 1996, in do_install
    requirements_dir=requirements_directory,
  File "/home/lorien/.local/lib/python2.7/site-packages/pipenv/core.py", line 1321, in do_init
    p = pipfile.load(project.pipfile_location)
  File "/home/lorien/.local/lib/python2.7/site-packages/pipenv/patched/pipfile/api.py", line 223, in load
    return Pipfile.load(filename=pipfile_path, inject_env=inject_env)
  File "/home/lorien/.local/lib/python2.7/site-packages/pipenv/patched/pipfile/api.py", line 154, in load
    pipfile.data = p.parse(inject_env=inject_env)
  File "/home/lorien/.local/lib/python2.7/site-packages/pipenv/patched/pipfile/api.py", line 102, in parse
    parsed = toml.loads(content)
  File "/home/lorien/.local/lib/python2.7/site-packages/pipenv/vendor/toml.py", line 373, in loads
    multibackslash)
  File "/home/lorien/.local/lib/python2.7/site-packages/pipenv/vendor/toml.py", line 478, in _load_line
    value, vtype = _load_value(pair[1], _dict, strictly_valid)
  File "/home/lorien/.local/lib/python2.7/site-packages/pipenv/vendor/toml.py", line 640, in _load_value
    _load_inline_object(v, inline_object, _dict)
  File "/home/lorien/.local/lib/python2.7/site-packages/pipenv/vendor/toml.py", line 398, in _load_inline_object
    candidate_groups[0] = candidate_group + "," + candidate_groups[0]
IndexError: list index out of range
/home/lorien/.local/lib/python2.7/site-packages/pipenv/utils.py:1230: ResourceWarning: Implicitly cleaning up <TemporaryDirectory '/tmp/pipenv-MZT2mQ-requirements'>
  warnings.warn(warn_message, ResourceWarning)
Steps to replicate
Use some local dependency with invalid option editable = True, for example: tgram = {path = "/web/lib_tgram", editable = True}
Please run $ pipenv --support, and paste the results here. Don't put backticks (`) around it! The output already contains Markdown formatting.
$ pipenv --support
Error: no such option: --support