AEHamrick commented on 9 May 2019 •
edited
Pipfile.txt
Issue description
pipenv install keyrings.cryptfile raises pipenv.exceptions.ResolutionFailure: ERROR: ERROR: Could not find a version that matches keyrings-cryptfile --this is peculiar because you'll note that the error replaces the . in the package name with -. Following this, the package shows up in pipenv graph but removing it is seemingly impossible.
Expected result
The package either installs successfully or raises a more specific error if its naming convention is illegal or otherwise a problem; pipenv refers to the package without replacing characters.
Actual result
Different pipenv commands refer to the package as keyrings.cryptfile or keyrings-cryptfile and the package cannot be removed.
Steps to replicate
Step 1: blow away extant environment, make a new one, install from pipfile:
(user):(project)$ pipenv --rm
Removing virtualenv (/home/(user)/.local/share/virtualenvs/(project)-HNPoG7zF)…
(user):(project)$ pipenv shell
Creating a virtualenv for this project…
Pipfile: (project)/Pipfile
Using /usr/local/bin/python3.6 (3.6.8) to create virtualenv…
? Creating virtual environment...Already using interpreter /usr/local/bin/python3.6
Using base prefix '/usr/local'
New python executable in /home/(user)/.local/share/virtualenvs/(project)-HNPoG7zF/bin/python3.6
Also creating executable in /home/(user)/.local/share/virtualenvs/(project)-HNPoG7zF/bin/python
Installing setuptools, pip, wheel...
done.
? Successfully created virtual environment!
Virtualenv location: /home/(user)/.local/share/virtualenvs/(project)-HNPoG7zF
Launching subshell in virtual environment…
(user):(project)$ . /home/(user)/.local/share/virtualenvs/(project)-HNPoG7zF/bin/activate
((project)) (user):(project)$ pipenv install
Installing dependencies from Pipfile.lock (aba4b9)…
?? ???????????????????????????????? 27/27 — 00:00:02
((project)) (user):(project)$ pipenv graph
colorama==0.4.1
docopt==0.6.2
keyring==19.0.1
entrypoints [required: Any, installed: 0.3]
secretstorage [required: Any, installed: 3.1.1]
cryptography [required: Any, installed: 2.6.1]
asn1crypto [required: >=0.21.0, installed: 0.24.0]
cffi [required: >=1.8,!=1.11.3, installed: 1.12.3]
pycparser [required: Any, installed: 2.19]
six [required: >=1.4.1, installed: 1.12.0]
jeepney [required: Any, installed: 0.4]
lxml==4.3.3
pydbus==0.6.0
pyodbc==4.0.26
pytest==4.4.2
atomicwrites [required: >=1.0, installed: 1.3.0]
attrs [required: >=17.4.0, installed: 19.1.0]
more-itertools [required: >=4.0.0, installed: 7.0.0]
pluggy [required: >=0.11, installed: 0.11.0]
py [required: >=1.5.0, installed: 1.8.0]
setuptools [required: Any, installed: 41.0.1]
six [required: >=1.10.0, installed: 1.12.0]
requests==2.21.0
certifi [required: >=2017.4.17, installed: 2019.3.9]
chardet [required: >=3.0.2,<3.1.0, installed: 3.0.4]
idna [required: >=2.5,<2.9, installed: 2.8]
urllib3 [required: >=1.21.1,<1.25, installed: 1.24.3]
SQLAlchemy==1.3.3
uptime==3.0.1
Step 2: attempt to install keyrings.cryptfile; note that the error gives "keyrings-cryptfile", not "keyrings.cryptfile"
((project)) (user):(project)$ pipenv install keyrings.cryptfile
Installing keyrings.cryptfile…
? Installation Succeeded
Pipfile.lock (7abca9) out of date, updating to (aba4b9)…
Locking [dev-packages] dependencies…
Locking [packages] dependencies…
? Locking Failed!
[pipenv.exceptions.ResolutionFailure]: File "/usr/local/lib/python3.6/site-packages/pipenv/resolver.py", line 69, in resolve
[pipenv.exceptions.ResolutionFailure]: req_dir=requirements_dir
[pipenv.exceptions.ResolutionFailure]: File "/usr/local/lib/python3.6/site-packages/pipenv/utils.py", line 726, in resolve_deps
[pipenv.exceptions.ResolutionFailure]: req_dir=req_dir,
[pipenv.exceptions.ResolutionFailure]: File "/usr/local/lib/python3.6/site-packages/pipenv/utils.py", line 480, in actually_resolve_deps
[pipenv.exceptions.ResolutionFailure]: resolved_tree = resolver.resolve()
[pipenv.exceptions.ResolutionFailure]: File "/usr/local/lib/python3.6/site-packages/pipenv/utils.py", line 395, in resolve
[pipenv.exceptions.ResolutionFailure]: raise ResolutionFailure(message=str(e))
[pipenv.exceptions.ResolutionFailure]: pipenv.exceptions.ResolutionFailure: ERROR: ERROR: Could not find a version that matches keyrings-cryptfile
[pipenv.exceptions.ResolutionFailure]: No versions found
[pipenv.exceptions.ResolutionFailure]: Warning: Your dependencies could not be resolved. You likely have a mismatch in your sub-dependencies.
First try clearing your dependency cache with $ pipenv lock --clear, then try the original command again.
Alternatively, you can use $ pipenv install --skip-lock to bypass this mechanism, then run $ pipenv graph to inspect the situation.
Hint: try $ pipenv lock --pre if it is a pre-release dependency.
ERROR: ERROR: Could not find a version that matches keyrings-cryptfile
No versions found
Was https://pypi.org/simple reachable?
[pipenv.exceptions.ResolutionFailure]: req_dir=requirements_dir
[pipenv.exceptions.ResolutionFailure]: File "/usr/local/lib/python3.6/site-packages/pipenv/utils.py", line 726, in resolve_deps
[pipenv.exceptions.ResolutionFailure]: req_dir=req_dir,
[pipenv.exceptions.ResolutionFailure]: File "/usr/local/lib/python3.6/site-packages/pipenv/utils.py", line 480, in actually_resolve_deps
[pipenv.exceptions.ResolutionFailure]: resolved_tree = resolver.resolve()
[pipenv.exceptions.ResolutionFailure]: File "/usr/local/lib/python3.6/site-packages/pipenv/utils.py", line 395, in resolve
[pipenv.exceptions.ResolutionFailure]: raise ResolutionFailure(message=str(e))
[pipenv.exceptions.ResolutionFailure]: pipenv.exceptions.ResolutionFailure: ERROR: ERROR: Could not find a version that matches keyrings-cryptfile
[pipenv.exceptions.ResolutionFailure]: No versions found
[pipenv.exceptions.ResolutionFailure]: Warning: Your dependencies could not be resolved. You likely have a mismatch in your sub-dependencies.
First try clearing your dependency cache with $ pipenv lock --clear, then try the original command again.
Alternatively, you can use $ pipenv install --skip-lock to bypass this mechanism, then run $ pipenv graph to inspect the situation.
Hint: try $ pipenv lock --pre if it is a pre-release dependency.
ERROR: ERROR: Could not find a version that matches keyrings-cryptfile
No versions found
Was https://pypi.org/simple reachable?
Step 3: look at the graph--here it shows "keyrings.cryptfile"
((project)) (user):(project)$ pipenv graph
colorama==0.4.1
docopt==0.6.2
keyrings.cryptfile==1.3.4
argon2-cffi [required: Any, installed: 19.1.0]
cffi [required: >=1.0.0, installed: 1.12.3]
pycparser [required: Any, installed: 2.19]
six [required: Any, installed: 1.12.0]
keyring [required: >=19.0.0, installed: 19.0.1]
entrypoints [required: Any, installed: 0.3]
secretstorage [required: Any, installed: 3.1.1]
cryptography [required: Any, installed: 2.6.1]
asn1crypto [required: >=0.21.0, installed: 0.24.0]
cffi [required: >=1.8,!=1.11.3, installed: 1.12.3]
pycparser [required: Any, installed: 2.19]
six [required: >=1.4.1, installed: 1.12.0]
jeepney [required: Any, installed: 0.4]
pycryptodome [required: Any, installed: 3.8.1]
lxml==4.3.3
pydbus==0.6.0
pyodbc==4.0.26
pytest==4.4.2
atomicwrites [required: >=1.0, installed: 1.3.0]
attrs [required: >=17.4.0, installed: 19.1.0]
more-itertools [required: >=4.0.0, installed: 7.0.0]
pluggy [required: >=0.11, installed: 0.11.0]
py [required: >=1.5.0, installed: 1.8.0]
setuptools [required: Any, installed: 41.0.1]
six [required: >=1.10.0, installed: 1.12.0]
requests==2.21.0
certifi [required: >=2017.4.17, installed: 2019.3.9]
chardet [required: >=3.0.2,<3.1.0, installed: 3.0.4]
idna [required: >=2.5,<2.9, installed: 2.8]
urllib3 [required: >=1.21.1,<1.25, installed: 1.24.3]
SQLAlchemy==1.3.3
uptime==3.0.1
Step 4: Try to remove, get same if not similar exception as installing
((project)) (user):(project)$ pipenv uninstall keyrings.cryptfile
Uninstalling keyrings.cryptfile…
No package keyrings.cryptfile to remove from Pipfile.
Locking [dev-packages] dependencies…
Locking [packages] dependencies…
? Locking Failed!
[pipenv.exceptions.ResolutionFailure]: File "/usr/local/lib/python3.6/site-packages/pipenv/resolver.py", line 69, in resolve
[pipenv.exceptions.ResolutionFailure]: req_dir=requirements_dir
[pipenv.exceptions.ResolutionFailure]: File "/usr/local/lib/python3.6/site-packages/pipenv/utils.py", line 726, in resolve_deps
[pipenv.exceptions.ResolutionFailure]: req_dir=req_dir,
[pipenv.exceptions.ResolutionFailure]: File "/usr/local/lib/python3.6/site-packages/pipenv/utils.py", line 480, in actually_resolve_deps
[pipenv.exceptions.ResolutionFailure]: resolved_tree = resolver.resolve()
[pipenv.exceptions.ResolutionFailure]: File "/usr/local/lib/python3.6/site-packages/pipenv/utils.py", line 395, in resolve
[pipenv.exceptions.ResolutionFailure]: raise ResolutionFailure(message=str(e))
[pipenv.exceptions.ResolutionFailure]: pipenv.exceptions.ResolutionFailure: ERROR: ERROR: Could not find a version that matches keyrings-cryptfile
[pipenv.exceptions.ResolutionFailure]: No versions found
[pipenv.exceptions.ResolutionFailure]: Warning: Your dependencies could not be resolved. You likely have a mismatch in your sub-dependencies.
First try clearing your dependency cache with $ pipenv lock --clear, then try the original command again.
Alternatively, you can use $ pipenv install --skip-lock to bypass this mechanism, then run $ pipenv graph to inspect the situation.
Hint: try $ pipenv lock --pre if it is a pre-release dependency.
ERROR: ERROR: Could not find a version that matches keyrings-cryptfile
No versions found
Was https://pypi.org/simple reachable?
[pipenv.exceptions.ResolutionFailure]: req_dir=requirements_dir
[pipenv.exceptions.ResolutionFailure]: File "/usr/local/lib/python3.6/site-packages/pipenv/utils.py", line 726, in resolve_deps
[pipenv.exceptions.ResolutionFailure]: req_dir=req_dir,
[pipenv.exceptions.ResolutionFailure]: File "/usr/local/lib/python3.6/site-packages/pipenv/utils.py", line 480, in actually_resolve_deps
[pipenv.exceptions.ResolutionFailure]: resolved_tree = resolver.resolve()
[pipenv.exceptions.ResolutionFailure]: File "/usr/local/lib/python3.6/site-packages/pipenv/utils.py", line 395, in resolve
[pipenv.exceptions.ResolutionFailure]: raise ResolutionFailure(message=str(e))
[pipenv.exceptions.ResolutionFailure]: pipenv.exceptions.ResolutionFailure: ERROR: ERROR: Could not find a version that matches keyrings-cryptfile
[pipenv.exceptions.ResolutionFailure]: No versions found
[pipenv.exceptions.ResolutionFailure]: Warning: Your dependencies could not be resolved. You likely have a mismatch in your sub-dependencies.
First try clearing your dependency cache with $ pipenv lock --clear, then try the original command again.
Alternatively, you can use $ pipenv install --skip-lock to bypass this mechanism, then run $ pipenv graph to inspect the situation.
Hint: try $ pipenv lock --pre if it is a pre-release dependency.
ERROR: ERROR: Could not find a version that matches keyrings-cryptfile
No versions found
Was https://pypi.org/simple reachable?
Step 5: Try to uninstall it with a hyphen in the package name instead of . and it acts as if it was successful
((project)) (user):(project)$ pipenv uninstall keyrings-cryptfile
Uninstalling keyrings-cryptfile…
Removing keyrings-cryptfile from Pipfile…
Locking [dev-packages] dependencies…
Locking [packages] dependencies…
? Success!
Updated Pipfile.lock (aba4b9)!
Step 6: Likewise, pipenv clean
(ds-ops-tools) (user):(project)$ pipenv clean
Uninstalling pycryptodome…
Uninstalling keyrings-cryptfile…
Uninstalling argon2-cffi…
Step 7: pipenv graph, however still shows it there
((project)) (user):(project)$ pipenv graph
colorama==0.4.1
docopt==0.6.2
keyrings.cryptfile==1.3.4
argon2-cffi [required: Any, installed: ?]
keyring [required: >=19.0.0, installed: 19.0.1]
entrypoints [required: Any, installed: 0.3]
secretstorage [required: Any, installed: 3.1.1]
cryptography [required: Any, installed: 2.6.1]
asn1crypto [required: >=0.21.0, installed: 0.24.0]
cffi [required: >=1.8,!=1.11.3, installed: 1.12.3]
pycparser [required: Any, installed: 2.19]
six [required: >=1.4.1, installed: 1.12.0]
jeepney [required: Any, installed: 0.4]
pycryptodome [required: Any, installed: ?]
lxml==4.3.3
pydbus==0.6.0
pyodbc==4.0.26
pytest==4.4.2
atomicwrites [required: >=1.0, installed: 1.3.0]
attrs [required: >=17.4.0, installed: 19.1.0]
more-itertools [required: >=4.0.0, installed: 7.0.0]
pluggy [required: >=0.11, installed: 0.11.0]
py [required: >=1.5.0, installed: 1.8.0]
setuptools [required: Any, installed: 41.0.1]
six [required: >=1.10.0, installed: 1.12.0]
requests==2.21.0
certifi [required: >=2017.4.17, installed: 2019.3.9]
chardet [required: >=3.0.2,<3.1.0, installed: 3.0.4]
idna [required: >=2.5,<2.9, installed: 2.8]
urllib3 [required: >=1.21.1,<1.25, installed: 1.24.3]
SQLAlchemy==1.3.3
uptime==3.0.1
$ pipenv --support