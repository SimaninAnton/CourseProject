chepner commented on 30 Sep 2017 •
edited
I am trying to install a package from a private repository, but I appear to be getting an EOFError when trying to authenticate.
pip alone works:
pip install --extra-index-url 'https://<user>:<password>@<host>/artifactory/api/pypi/pypi-all/simple' <my_package>
First I set things up
% mkdir pipenv-test
% cd pipenv-test
% pipenv lock  # Just to generate an initial Pipfile
I add the following to the Pipfile
[[source]]
verify_ssl = true
name = "work repo"
url = "https://<user>:<password>@<host>/artifactory/api/pypi/pypi-all/simple"
then run
% pipenv lock  # should this be necessary?
% pipenv install <my_package>
On attempting to install a program, it looks like something is ignoring the user id in the source URL, and trying to read from empty/closed standard input when prompted for the user id.
% pipenv install <my_package>
Installing <my_package>…
Collecting <my_package>
User for <host>:
Error:  An error occurred while installing <my_package>!
Exception:
Traceback (most recent call last):
  File "/Users/clint/.local/share/virtualenvs/pipenv-test-pou_DiX5/lib/python3.6/site-packages/pip/basecommand.py", line 215, in main
    status = self.run(options, args)
  File "/Users/clint/.local/share/virtualenvs/pipenv-test-pou_DiX5/lib/python3.6/site-packages/pip/commands/install.py", line 335, in run
    wb.build(autobuilding=True)
  File "/Users/clint/.local/share/virtualenvs/pipenv-test-pou_DiX5/lib/python3.6/site-packages/pip/wheel.py", line 749, in build
    self.requirement_set.prepare_files(self.finder)
  File "/Users/clint/.local/share/virtualenvs/pipenv-test-pou_DiX5/lib/python3.6/site-packages/pip/req/req_set.py", line 380, in prepare_files
    ignore_dependencies=self.ignore_dependencies))
  File "/Users/clint/.local/share/virtualenvs/pipenv-test-pou_DiX5/lib/python3.6/site-packages/pip/req/req_set.py", line 554, in _prepare_file
    require_hashes
  File "/Users/clint/.local/share/virtualenvs/pipenv-test-pou_DiX5/lib/python3.6/site-packages/pip/req/req_install.py", line 278, in populate_link
    self.link = finder.find_requirement(self, upgrade)
  File "/Users/clint/.local/share/virtualenvs/pipenv-test-pou_DiX5/lib/python3.6/site-packages/pip/index.py", line 465, in find_requirement
    all_candidates = self.find_all_candidates(req.name)
  File "/Users/clint/.local/share/virtualenvs/pipenv-test-pou_DiX5/lib/python3.6/site-packages/pip/index.py", line 423, in find_all_candidates
    for page in self._get_pages(url_locations, project_name):
  File "/Users/clint/.local/share/virtualenvs/pipenv-test-pou_DiX5/lib/python3.6/site-packages/pip/index.py", line 568, in _get_pages
    page = self._get_page(location)
  File "/Users/clint/.local/share/virtualenvs/pipenv-test-pou_DiX5/lib/python3.6/site-packages/pip/index.py", line 683, in _get_page
    return HTMLPage.get_page(link, session=self.session)
  File "/Users/clint/.local/share/virtualenvs/pipenv-test-pou_DiX5/lib/python3.6/site-packages/pip/index.py", line 792, in get_page
    "Cache-Control": "max-age=600",
  File "/Users/clint/.local/share/virtualenvs/pipenv-test-pou_DiX5/lib/python3.6/site-packages/pip/_vendor/requests/sessions.py", line 488, in get
    return self.request('GET', url, **kwargs)
  File "/Users/clint/.local/share/virtualenvs/pipenv-test-pou_DiX5/lib/python3.6/site-packages/pip/download.py", line 386, in request
    return super(PipSession, self).request(method, url, *args, **kwargs)
  File "/Users/clint/.local/share/virtualenvs/pipenv-test-pou_DiX5/lib/python3.6/site-packages/pip/_vendor/requests/sessions.py", line 475, in request
    resp = self.send(prep, **send_kwargs)
  File "/Users/clint/.local/share/virtualenvs/pipenv-test-pou_DiX5/lib/python3.6/site-packages/pip/_vendor/requests/sessions.py", line 602, in send
    r = dispatch_hook('response', hooks, r, **kwargs)
  File "/Users/clint/.local/share/virtualenvs/pipenv-test-pou_DiX5/lib/python3.6/site-packages/pip/_vendor/requests/hooks.py", line 31, in dispatch_hook
    _hook_data = hook(hook_data, **kwargs)
  File "/Users/clint/.local/share/virtualenvs/pipenv-test-pou_DiX5/lib/python3.6/site-packages/pip/download.py", line 181, in handle_401
    username = six.moves.input("User for %s: " % parsed.netloc)
EOFError: EOF when reading a line
Omitting the credentials from the url (https:///artifactory/api/pypi/pypi-all/simple) results in a simpler error:
% pipenv install <my_package>
Installing <my_package>…
Collecting <my_package>

Error:  An error occurred while installing <my_package>!
  Could not find a version that satisfies the requirement <my_package> (from versions: )
No matching distribution found for <my_package>
It appears no attempt is made to connect to the private repo, and <my_package> is of course not on PyPi.