kylegibson commented on 12 Feb 2018
Variables in a .env file that have single-quoted spaces are not loaded into the environment. If double quotes are used, then the variables are loaded into the environment.
Describe your environment
ubuntu 17.10
Python version: $ python -V - 3.6.4
Pipenv version: $ pipenv --version - 9.0.3
Expected result
All variables in .env would be loaded
Actual result
Variables in .env that are single-quoted and contain spaces are not loaded
Steps to replicate
Given the following .env file:
FOO='Hello World'
BAR='Test'
BAZ="Hello World"
Running pipenv shell
FOO will not be set in the environment.
This happens because the FOO line doesn't match the regex used ('^\s*(\w*)\s*=\s*("[^"]*"|[^\s]*)\s*$') in the parsing algorithm.
Additional information
I tracked this issue down by stepping through the dotenv loading code used by pipenv. When I found this line of code, I learned that only double quotes would allow spaces:
https://github.com/pypa/pipenv/blob/master/pipenv/patched/dotenv/main.py#L100
This parsing algorithm diverges a bit from the official dotenv logic:
https://github.com/theskumar/python-dotenv/blob/master/dotenv/main.py#L98