pahome commented on Feb 21, 2019 â€¢
edited
My scikit-learn version is 0.20.2 , I tried this will happen in 0.20.1
My datasets are below:
X: 2097088 x 5
y: 2097088 x 1
Size of X by sys.getsizeof(X): 100660256
I only init model as:
model = RandomForestRegressor(n_estimators=100, n_jobs=1).fit(X, y)
My ram is 4GB and also swap-space.
But it consume my all ram and swap-space then raise MemoryError exception below:
Traceback (most recent call last):
  File "regression.py", line 908, in <module>
    model = train_model(d.train_X, d.train_y)
  File "regression.py", line 574, in train_model
    model = ensemble.RandomForestRegressor(n_estimators=100, n_jobs=1).fit(train_X, train_y)
  File "/usr/local/lib/python2.7/dist-packages/sklearn/ensemble/forest.py", line 333, in fit
    for i, t in enumerate(trees))
  File "/usr/local/lib/python2.7/dist-packages/sklearn/externals/joblib/parallel.py", line 920, in __call__
    while self.dispatch_one_batch(iterator):
  File "/usr/local/lib/python2.7/dist-packages/sklearn/externals/joblib/parallel.py", line 759, in dispatch_one_batch
    self._dispatch(tasks)
  File "/usr/local/lib/python2.7/dist-packages/sklearn/externals/joblib/parallel.py", line 716, in _dispatch
    job = self._backend.apply_async(batch, callback=cb)
  File "/usr/local/lib/python2.7/dist-packages/sklearn/externals/joblib/_parallel_backends.py", line 182, in apply_async
    result = ImmediateResult(func)
  File "/usr/local/lib/python2.7/dist-packages/sklearn/externals/joblib/_parallel_backends.py", line 549, in __init__
    self.results = batch()
  File "/usr/local/lib/python2.7/dist-packages/sklearn/externals/joblib/parallel.py", line 225, in __call__
    for func, args, kwargs in self.items]
  File "/usr/local/lib/python2.7/dist-packages/sklearn/ensemble/forest.py", line 119, in _parallel_build_trees
    tree.fit(X, y, sample_weight=curr_sample_weight, check_input=False)
  File "/usr/local/lib/python2.7/dist-packages/sklearn/tree/tree.py", line 1142, in fit
    X_idx_sorted=X_idx_sorted)
  File "/usr/local/lib/python2.7/dist-packages/sklearn/tree/tree.py", line 366, in fit
    builder.build(self.tree_, X, y, sample_weight, X_idx_sorted)
  File "sklearn/tree/_tree.pyx", line 145, in sklearn.tree._tree.DepthFirstTreeBuilder.build
  File "sklearn/tree/_tree.pyx", line 244, in sklearn.tree._tree.DepthFirstTreeBuilder.build
  File "sklearn/tree/_tree.pyx", line 735, in sklearn.tree._tree.Tree._add_node
  File "sklearn/tree/_tree.pyx", line 706, in sklearn.tree._tree.Tree._resize_c
  File "sklearn/tree/_utils.pyx", line 39, in sklearn.tree._utils.safe_realloc
MemoryError: could not allocate 117440512 bytes
^C