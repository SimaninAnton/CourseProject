Member
jnothman commented on Jun 20, 2017
We recently changed plot_stock_market to use Google's API, not Yahoo's. It looks like it can occasionally result in an exception when Google's API gives us an empty response:
/home/ubuntu/miniconda/envs/testenv/bin/sphinx-build:35: UserWarning: genfromtxt: Empty input file: "<http.client.HTTPResponse object at 0x2b95e1c85780>"
/home/ubuntu/scikit-learn/doc/sphinxext/sphinx_gallery/gen_rst.py:491: UserWarning: ________________________________________________________________________________
/home/ubuntu/scikit-learn/examples/applications/plot_stock_market.py failed to execute correctly:Traceback (most recent call last):
  File "/home/ubuntu/scikit-learn/doc/sphinxext/sphinx_gallery/gen_rst.py", line 472, in execute_code_block
    exec(code_block, example_globals)
  File "<string>", line 104, in <module>
  File "<string>", line 104, in <listcomp>
  File "<string>", line 35, in quotes_historical_google
  File "/home/ubuntu/miniconda/envs/testenv/lib/python3.6/site-packages/numpy/lib/npyio.py", line 1775, in genfromtxt
    converters[i].update(conv, locked=True,
IndexError: list index out of range
________________________________________________________________________________
We should retry when there is an empty response. Or at least it should probably not fail the entire build.