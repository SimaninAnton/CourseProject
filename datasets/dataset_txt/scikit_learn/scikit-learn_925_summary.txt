Is the average operation in meanshift function a bug?