J6767 commented on Apr 9, 2016
My classes are unbalanced. I cannot seem to add class_weights to either of these classifiers. Note that my problem is multiclass, multilabel. Here is my code:
X_train, X_test, y_train, y_test = train_test_split(X_train, y_train, test_size=0.2)

rf = RandomForestClassifier(n_estimators=1000, max_depth=None, min_samples_split=1, criterion="entropy", random_state=11, n_jobs=5, class_weight={1:1, 2:5, 3:1, 4:1, 5:1})

rf.fit(X_train, y_train)
y_pred = rf.predict(X_test)
The training labels are arrays of 1-5, indicating the labels. e.g: [1, 2, 5] or [2, 5]. If I keep my training labels in the original format I get the error:
ValueError: You appear to be using a legacy multi-label data representation. Sequence of sequences are no longer supported; use a binary array or sparse matrix instead.
If I convert the labels to a binary format using MultiLabelBinarizer() I get the error:
ValueError: Class label 2 not present
I am having the same problem with SVM. Is this an error, or am I doing something wrong? Many thanks!