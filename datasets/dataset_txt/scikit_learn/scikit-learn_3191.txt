ayushidalmia commented on Feb 12, 2016
I want to build models and want to predict for only one test sample. When I do the following using a logisticRegressor, it does not throw any error:
model_linear = linear_model.LinearRegression()
model_linear.fit(X_train, Y_train)
model_linear.predict(X_test)
where,
X_train.shape=(numberOfSamples,numberOfFeatures)
Y_train.shape=(numberOfSamples)
X_test.shape=(numberOfFeatures,).
Thus. there is just one sample to test. The above works fine. However, when I do the following using Bagging Regressor
model = BaggingRegressor(base_estimator=linear_model.LinearRegression(), n_estimators=rounds, max_samples=percentageOfSamples, max_features=percentageOfFeatures, bootstrap=True, bootstrap_features=True, oob_score=False, n_jobs=1, random_state=None, verbose=1)
model.fit(X_train, Y_train)
 model.predict(X_test)
It throws an error saying IndexError: too many indices for array. The following is the error log:
Traceback (most recent call last):
  File "../../../codeAndScripts/code/syntheticDataset/robustRegressionUsingScikitPackages.py", line 99, in <module>
    main()
  File "../../../codeAndScripts/code/syntheticDataset/robustRegressionUsingScikitPackages.py", line 55, in main
    predictedValuesColumnWise[j][i] = model.predict(X_test)
  File "/usr/local/lib/python2.7/dist-packages/sklearn/ensemble/bagging.py", line 818, in predict
    for i in range(n_jobs))
  File "/usr/local/lib/python2.7/dist-packages/sklearn/externals/joblib/parallel.py", line 653, in __call__
    self.dispatch(function, args, kwargs)
  File "/usr/local/lib/python2.7/dist-packages/sklearn/externals/joblib/parallel.py", line 400, in dispatch
    job = ImmediateApply(func, args, kwargs)
  File "/usr/local/lib/python2.7/dist-packages/sklearn/externals/joblib/parallel.py", line 138, in __init__
    self.results = func(*args, **kwargs)
  File "/usr/local/lib/python2.7/dist-packages/sklearn/ensemble/bagging.py", line 185, in _parallel_predict_regression
    estimators_features))
  File "/usr/local/lib/python2.7/dist-packages/sklearn/ensemble/bagging.py", line 184, in <genexpr>
    for estimator, features in zip(estimators,
IndexError: too many indices for array
However, when I do a casting of 1D array to 2D it works fine as follows:
model = BaggingRegressor(base_estimator=linear_model.LinearRegression(), n_estimators=rounds, max_samples=percentageOfSamples, max_features=percentageOfFeatures, bootstrap=True, bootstrap_features=True, oob_score=False, n_jobs=1, random_state=None, verbose=1)
model.fit(X_train, Y_train)
model.predict(X_test[None,:])
Is this merely a drawback of BaggingRegressor to not handle the single dimensions arrays automatically or am I missing something here?