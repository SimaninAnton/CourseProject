BarneyGordon commented on Oct 19, 2016 â€¢
edited by lesteve
Description
Fitting a (20242848, 5) numpy array using any more than 4 clusters results in IndexError
Steps/Code to Reproduce
from sklearn.cluster import KMeans
src = gdal.Open(fname)
img = src.ReadAsArray()
X = img.transpose(1,2,0).reshape(-1, img.shape[0])
print X.shape
(20242848, 5)
k_means = KMeans(n_clusters=4, n_jobs=-1, random_state=10)
k_means.fit(X)
labels = k_means.labels_

print labels.shape
(20242848,)
k_means = KMeans(n_clusters=5, n_jobs=-1, random_state=10)
k_means.fit(X)
labels = k_means.labels_

print labels.shape
---------------------------------------------------------------------------
JoblibIndexError                          Traceback (most recent call last)
<ipython-input-22-379757258e42> in <module>()
      1 k_means = KMeans(n_clusters=5, n_jobs=-1, random_state=10)
----> 2 k_means.fit(X)
      3 labels = k_means.labels_
      4 
      5 print labels.shape

[SHORTENED]

IndexError: index 20242848 is out of bounds for axis 0 with size 20242848
___________________________________________________________________________
Expected Results
(20242848, )
Actual Results
Versions
Windows-7-6.1.7601-SP1
('Python', '2.7.11 |Anaconda 4.0.0 (64-bit)| (default, Feb 16 2016, 09:58:36) [MSC v.1500 64 bit (AMD64)]')
('NumPy', '1.11.2')
('SciPy', '0.18.1')
('Scikit-Learn', '0.18')