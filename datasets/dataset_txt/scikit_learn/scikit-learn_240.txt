siddhajj commented on Sep 19, 2019
Description
ValueError thrown when passing categories as numpy array to OneHotEncoder.
Steps/Code to Reproduce
from sklearn import preprocessing

x = np.array(['cat', 'dog', 'cow'])
ohe = preprocessing.OneHotEncoder(categories=np.unique(x))
ohe.fit(x.reshape(-1, 1))
Expected Results
It should return a one hot encoder fit with the given categories
Actual Results
ValueError Traceback (most recent call last)
in
----> 1 ohe.fit(x.reshape(-1,1))
~/anaconda3/lib/python3.6/site-packages/sklearn/preprocessing/_encoders.py in fit(self, X, y)
491 return self
492 else:
--> 493 self.fit(X, handle_unknown=self.handle_unknown)
494 self.drop_idx = self._compute_drop_idx()
495 return self
~/anaconda3/lib/python3.6/site-packages/sklearn/preprocessing/_encoders.py in _fit(self, X, handle_unknown)
80 X_list, n_samples, n_features = self._check_X(X)
81
---> 82 if self._categories != 'auto':
83 if len(self._categories) != n_features:
84 raise ValueError("Shape mismatch: if categories is an array,"
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()
Versions
System:
python: 3.6.9 |Anaconda, Inc.| (default, Jul 30 2019, 19:07:31) [GCC 7.3.0]
executable: /home/sjain/anaconda3/bin/python
machine: Linux-4.15.0-1044-gcp-x86_64-with-debian-stretch-sid
Python deps:
pip: 19.2.2
setuptools: 41.0.1
sklearn: 0.21.3
numpy: 1.16.2
scipy: 1.2.1
Cython: 0.29.13
pandas: 0.24.0