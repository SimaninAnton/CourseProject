Member
larsmans commented on Jul 24, 2012
SciPy issue here. We have, in sklearn/utils/fixes.py, a function
def qr_economic(A, **kwargs):
    """Compat function for the QR-decomposition in economic mode

    Scipy 0.9 changed the keyword econ=True to mode='economic'
    """
    import scipy.linalg
    # trick: triangular solve has introduced in 0.9
    if hasattr(scipy.linalg, 'solve_triangular'):
        return scipy.linalg.qr(A, mode='economic', **kwargs)
    else:
        return scipy.linalg.qr(A, econ=True, **kwargs)
which, on my Debian box with SciPy 0.7.2, consistently issues the warning
/usr/lib/python2.6/dist-packages/scipy/linalg/decomp.py:1177: DeprecationWarning: qr econ argument will be removed after scipy 0.7. The economy transform will then be available through the mode='economic' argument.
This is annoying when testing, since it clutters the terminal. I've found out that the mode arguments is also available in 0.7.2, but using that results in several errors:
======================================================================
ERROR: sklearn.datasets.tests.test_samples_generator.test_make_low_rank_matrix
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/usr/lib/pymodules/python2.6/nose/case.py", line 183, in runTest
    self.test(*self.arg)
  File "/scratch/apps/src/scikit-learn/sklearn/datasets/tests/test_samples_generator.py", line 131, in test_make_low_rank_matrix
    tail_strength=0.01, random_state=0)
  File "/scratch/apps/src/scikit-learn/sklearn/datasets/samples_generator.py", line 923, in make_low_rank_matrix
    return np.dot(np.dot(u, s), v.T)
ValueError: matrices are not aligned
Does anyone know what's going wrong? Is this a bug in older SciPy? (I'll see if I can work around it by just suppressing the warning.)