Contributor
robinschucker commented on Sep 13, 2016 â€¢
edited by TomDLT
Description
Doc for KernelRidge is incorrect for:
dual_coef_ : array, shape = [n_features] or [n_targets, n_features]
Weight vector(s) in kernel space
It should be:
dual_coef_ : array, shape = [n_samples] or [n_samples, n_targets]
As dual_coef_ represents the weight vector(s) in the kernel space which could be infinite dimensional and is stored as a linear combination of the training samples in the kernel space.
Code to Reproduce
from sklearn.kernel_ridge import KernelRidge
import numpy as np
x = np.arange(18).reshape(3,6) # n_samples = 3, n_features = 6
y = np.array([[1.5,2.5],[4.3,-0.1],[2.3,1.2]]) # n_samples = 3, n_targets = 2
clf = KernelRidge(kernel='rbf')
clf.fit(x,y)
clf.dual_coef_.shape # (3, 2)