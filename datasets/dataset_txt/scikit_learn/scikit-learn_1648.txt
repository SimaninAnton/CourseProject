Contributor
NarineK commented on Jan 1, 2018 •
edited
Description
As described in #10175 the output of decision_function for NuSVC and SVC isn't inconsistent with predict when decision_function_shape='ovo'. It works fine with 'orv'
Steps/Code to Reproduce
classifier = NuSVC(decision_function_shape=‘ovo’)
X, y = make_blobs(n_samples=30, random_state=0, cluster_std=0.1)
X, y = shuffle(X, y, random_state=7)
X = StandardScaler().fit_transform(X)
X -= X.min() - .1
X = pairwise_estimator_convert_X(X, clf)
y_names = np.array(["one", "two", "three"])[y]
y_ = y_names
set_random_state(classifier)
classifier.fit(X, y_)
y_pred = classifier.predict(X)

decision = classifier.decision_function(X)
decision_y = np.argmax(decision, axis=1).astype(int)
dec_func = classifier.classes_[decision_y]
Output
dec_func:

>>> array(['two', 'three', 'two', 'two', 'two', 'one', 'two', 'one', 'one',
       'three', 'two', 'one', 'one', 'three', 'two', 'one', 'one', 'one',
       'two', 'one', 'one', 'three', 'two', 'three', 'three', 'two',
       'three', 'one', 'one', 'one'],
      dtype='|S5')

y_pred:
>>> 
array(['three', 'one', 'three', 'three', 'three', 'one', 'three', 'one',
       'two', 'one', 'three', 'two', 'two', 'one', 'three', 'two', 'two',
       'two', 'three', 'two', 'two', 'one', 'three', 'one', 'one', 'three',
       'one', 'two', 'two', 'one'],
      dtype='|S5')
Expected Results
I was expecting that dec_func and y_pred will return the same results.
Versions
Darwin-17.2.0-x86_64-i386-64bit
('Python', '2.7.11 (default, Jan 22 2016, 08:29:18) \n[GCC 4.2.1 Compatible Apple LLVM 7.0.2 (clang-700.1.81)]')
('NumPy', '1.13.1')
('SciPy', '0.18.0')
('Scikit-Learn', '0.19.dev0')