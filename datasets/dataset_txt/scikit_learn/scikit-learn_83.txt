lihu8918 commented on Dec 13, 2019 â€¢
edited
I'm trying to train a binary classifier, and when I use learning_curve with scoring='neg_log_loss', I got this error:
ValueError: got predict_proba of shape (27, 1), but need classifier with two classes for log_loss scoring
clf_path = r'D:\project\riet\hab_predict\trained_models\RFC.pkl'
clf = joblib.load(clf_path)
trn_sizes = np.linspace(0.01, 1.0, 10)
_, train_scores, validation_scores = learning_curve(clf, X_train_scaled, y_train, cv=5, scoring='neg_log_loss', n_jobs=None, train_sizes=trn_sizes)
Expected Results
Actual Results
ValueError: got predict_proba of shape (27, 1), but need classifier with two classes for log_loss scoring
Versions
scikit-learn = 0.21.3