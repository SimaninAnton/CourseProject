eyadsibai commented on Dec 30, 2018 â€¢
edited
Description
cross_val_score is not using StratiffiedKFold by default
Steps/Code to Reproduce
print(cross_val_score(clf, data, y=list(y), scoring='roc_auc', cv=5, n_jobs=-1, verbose=1))
When I run this instead it works fine.
skf = StratifiedKFold(n_splits=5)
print(cross_val_score(clf, data, y=list(y), scoring='roc_auc', cv=skf, n_jobs=-1, verbose=1))
The data is around 300,000 samples with 100,000 samples of class 0 and 200k with class 1
Expected Results
list of auc values per fold
Actual Results
ValueError: Only one class present in y_true. ROC AUC score is not defined in that case.
Versions
System:
    python: 3.6.7 |Anaconda, Inc.| (default, Oct 23 2018, 19:16:44)  [GCC 7.3.0]
executable: /home/.../bin/python
   machine: Linux-4.18.0-13-generic-x86_64-with-debian-buster-sid

BLAS:
    macros: HAVE_CBLAS=None
  lib_dirs: /home/eyad/miniconda3/envs/xyz/lib
cblas_libs: openblas, openblas

Python deps:
       pip: 18.1
setuptools: 40.6.3
   sklearn: 0.20.2
     numpy: 1.15.4
     scipy: 1.1.0
    Cython: None
    pandas: 0.23.4