Contributor
briancheung commented on Jul 13, 2012
Error Message:
RuntimeError: Factor is exactly singular
There appears to be an issue with the eigsh stability when using shift-invert mode. I've attached code which reproduces the error below. I'm not quite certain if this is specific to ARPACK. The eigendecomposition works fine when not using shift-invert mode.
import numpy as np
from sklearn.neighbors import kneighbors_graph
from sklearn import cluster

def generate_blobs():
    np.random.seed(27)
    x1 = np.random.randn(10,2) + np.array([1.4, 1.8])
    x2 = np.random.randn(10,2) + np.array([4.7, 4.0])
    x3 = np.random.randn(10,2) + np.array([9.7, 13.0])
    blobs = np.vstack((x1,x2,x3))

    return blobs

blobs = generate_blobs()
n_clusters = 3
neighbors = 10


C_X = kneighbors_graph(blobs, n_neighbors=neighbors)
C_X = 0.5 * (C_X + C_X.T)

algorithm = cluster.SpectralClustering(k=n_clusters, mode='arpack')
algorithm.fit(C_X)