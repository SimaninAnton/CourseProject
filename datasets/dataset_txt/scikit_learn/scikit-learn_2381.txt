Contributor
paulochf commented on Feb 22, 2017 â€¢
edited
Description
I'm trying to use an imbalanced dataset to run LassoCV (that's why the StratifiedShuffleSplit), but it raises an error. Using another cross validation strategy object yields the same error (i.e. StratifiedKFold).
I looked for the line in the code and I changed by myself this line from
folds = list(cv.split(X))
to
folds = list(cv.split(X, y))
and it seemed to work. Also, I found another occurrence of this call here.
I don't know scikit's code as well as some contributor, but AFAIU it seems wrong.
Thanks!
Steps/Code to Reproduce
I'll put some dataset here just to run the code until the error.
from sklearn.pipeline import make_pipeline
from sklearn.preprocessing import StandardScaler
from sklearn.model_selection import StratifiedShuffleSplit
from sklearn import datasets
from sklearn.linear_model import LassoCV

diabetes = datasets.load_diabetes()
X = diabetes.data
y = diabetes.target

pipe = make_pipeline(
    StandardScaler(),
    LassoCV(
        cv=StratifiedShuffleSplit(
            n_splits=5,
            test_size=0.1,
        )
    )
)
pipe.fit(X, y)
Expected Results
No error thrown.
Actual Results
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-20-5c3c3e1d8a9e> in <module>()
----> 1 pipe.fit(X, y)

/home/paulo/Programs/repos/pyenv/versions/3.6.0/envs/work-3.6/lib/python3.6/site-packages/sklearn/pipeline.py in fit(self, X, y, **fit_params)
    268         Xt, fit_params = self._fit(X, y, **fit_params)
    269         if self._final_estimator is not None:
--> 270             self._final_estimator.fit(Xt, y, **fit_params)
    271         return self
    272 

/home/paulo/Programs/repos/pyenv/versions/3.6.0/envs/work-3.6/lib/python3.6/site-packages/sklearn/linear_model/coordinate_descent.py in fit(self, X, y)
   1165 
   1166         # Compute path for all folds and compute MSE to get the best alpha
-> 1167         folds = list(cv.split(X))
   1168         best_mse = np.inf
   1169 

TypeError: split() missing 1 required positional argument: 'y'
Versions
Linux-4.4.0-63-generic-x86_64-with-debian-stretch-sid
Python 3.6.0 (default, Feb  2 2017, 20:35:50) 
[GCC 5.4.0 20160609]
NumPy 1.12.0
SciPy 0.18.1
Scikit-Learn 0.18.1