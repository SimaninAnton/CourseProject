jonsondag commented on Jul 19, 2011
Small issue with the PCA feature that allows the user to specify n_components via the amount of variance that needs to be explained (0 < n_components < 1). When the user passes in an m by n matrix with n > m (i.e. more columns than rows) the resulting n_components is determined incorrectly.
E.g. the following code sets n_components to something like 17 for a 5 by 20 matrix:
import numpy as np
import scikits.learn.decomposition.pca
mat = np.reshape(np.random.random(100), (5, 20))
my_pca = scikits.learn.decomposition.pca.PCA(n_components=.5).fit(mat)
print my_pca  #output is PCA(copy=True, n_components=17, whiten=False)
I think this can be fixed by changing lines 248-250 of the current development version from:
n_remove = np.sum(self.explained_variance_ratio_.cumsum() >= self.n_components) - 1
self.n_components = n_features - n_remove
to something like:
self.n_components = np.sum(self.explained_variance_ratio_.cumsum() < self.n_components) + 1
I am using version 0.8 and the development version appears to have the same issue.