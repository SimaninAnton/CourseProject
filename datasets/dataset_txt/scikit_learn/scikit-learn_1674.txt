JustM57 commented on Dec 15, 2017
Got a interesting bug. It's mostly connected with KFold.
How this bug happened:
I had a coo matrix(hstacked(std_scaler+dict_vect))
Trying to fit sgd and rf worked OK.
But when I've tried to do in this way:
for d, (train, test) in kf(X, y):
clf.fit(X[train], y[train])
Value Error: Can't fit matrix with Nans or Infinities
The idea I wanted to get prediction for each split in order to train meta classifier
Okay... I've tried csr matix format and dense too - same error.
I've tried searching for NaNs and Inf...
There weren't any in X either X[train]
This is akward. Shape check said I had the right shapes.
Fixed this problem by calculating cross_val_predict, but that wasn't supposed to be in this way