MatthewK100000 commented on Jan 23, 2019
Hello,
I'm trying to fit my MNIST data to the LinearSVC class with dual='False' since n_samples >n_features. I get the following error:
ValueError: Unsupported set of arguments: The combination of penalty='l1' and loss='squared_hinge' are not supported when dual=False, Parameters: penalty='l1', loss='squared_hinge', dual='False'
I've tried all 4 combinations for the loss and penalty parameters and none of them work. I have no clue what the problem is. If anyone could illuminate me on that, I'd be grateful. The following is the code I ran:
Steps/Code to Reproduce
from sklearn.model_selection import train_test_split
from sklearn.svm import LinearSVC

from sklearn.datasets import fetch_openml
mnist = fetch_openml('mnist_784', version=1)

Xtrain,Xvaltest,ytrain,yvaltest = train_test_split(mnist['data'],mnist['target'],test_size=20000)
Xval,Xtest,yval,ytest = train_test_split(Xvaltest,yvaltest,test_size=10000)

lsvc = LinearSVC(C=1.0,penalty='l1',loss='squared_hinge',dual='False',random_state=42)
lsvc.fit(Xtrain,ytrain)
Here's info about my libraries:
System:
    python: 3.6.4 (v3.6.4:d48ecebad5, Dec 18 2017, 21:07:28)  [GCC 4.2.1 (Apple Inc. build 5666) (dot 3)]
executable: /Library/Frameworks/Python.framework/Versions/3.6/bin/python3
   machine: Darwin-17.7.0-x86_64-i386-64bit

BLAS:
    macros: NO_ATLAS_INFO=3, HAVE_CBLAS=None
  lib_dirs: 
cblas_libs: cblas

Python deps:
       pip: 18.1
setuptools: 39.2.0
   sklearn: 0.20.2
     numpy: 1.15.3
     scipy: 1.2.0
    Cython: 0.28.4
    pandas: 0.23.3