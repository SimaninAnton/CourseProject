WendyShang commented on Jun 25, 2013
Hi I was running the SGDRegressor and got into this error:
-- Epoch 1
Norm: nan, NNZs: 43, Bias: nan, T: 215875, Avg. loss: nan
Total training time: 0.04 seconds.
Traceback (most recent call last):
  File "SGDwith36Text.py", line 14, in <module>
    clf.fit(X, Y)
  File "/Library/Python/2.7/site-packages/scikit_learn-0.13.1-py2.7-macosx-10.8-intel.egg/sklearn/linear_model/stochastic_gradient.py", line 842, in fit
    sample_weight=sample_weight)
  File "/Library/Python/2.7/site-packages/scikit_learn-0.13.1-py2.7-macosx-10.8-intel.egg/sklearn/linear_model/stochastic_gradient.py", line 811, in _fit
    coef_init, intercept_init)
  File "/Library/Python/2.7/site-packages/scikit_learn-0.13.1-py2.7-macosx-10.8-intel.egg/sklearn/linear_model/stochastic_gradient.py", line 764, in _partial_fit
    sample_weight, n_iter)
  File "/Library/Python/2.7/site-packages/scikit_learn-0.13.1-py2.7-macosx-10.8-intel.egg/sklearn/linear_model/stochastic_gradient.py", line 900, in _fit_regressor
    intercept_decay)
  File "sgd_fast.pyx", line 508, in sklearn.linear_model.sgd_fast.plain_sgd (/private/tmp/easy_install-SFyi_g/scikit-learn-0.13.1/sklearn/linear_model/sgd_fast.c:8446)
ValueError: floating-point under-/overflow occured.
I did what previous threads said: normalize the data. I don't know how to decrease learning rate, since when I type in learning_rate=0.01, it throws another error: learning rate 0.01 is not supported.
Here is my code:
import numpy as np
from sklearn.linear_model import SGDRegressor
from sklearn import preprocessing

f = open("GroupA.txt") #open the file
header = f.readline() #read the header

data = np.loadtxt(f,delimiter=",")

X=data[:,1:] #select columns 1 through end
Y=data[:,0]#select column 0, usefulness
X_scaled = preprocessing.scale(X) #normalize X
clf = SGDRegressor(alpha=0.5, n_iter=20,verbose=3, learning_rate=0.1)
clf.fit(X, Y)
Thank you very much!