gupta17anukriti commented on May 25, 2018 â€¢
edited
I am trying to built an incremental model, where each and every time I run the command for partial fit, the output of my confusion matrix gets updated.. I am wondering why this is happening.. Ideally there should not be that major change just with the fitting the model with same data.
from sklearn.model_selection import ParameterGrid
from sklearn.linear_model import SGDClassifier
from sklearn.metrics import roc_auc_score

from parfit import bestFit
import parfit as pf

model =SGDClassifier()
grid ={ 
'alpha' : [1e-4,1e-3,1e-2,1e-1,1e0,1e1,1e2,1e3,1e4], #learning rate 
'n_iter': [1000], #epoch
'loss'  : ['log'], #logistic regression 
'penalty':['l2'], 
'n_jobs': [-1]
}
paramGrid = ParameterGrid(grid)


bestModel, bestScore, allModels, allScores = pf.bestFit(model, paramGrid, train_X1, train_Y1, test_X1, test_Y1, 
                                                        metric = roc_auc_score, greater_is_better = True, scoreLabel = "AUC")

print(bestModel, bestScore)


bestModel.partial_fit(train_X2,train_Y2)
###accuracy of train and test of mini batch 2
print("Accuracy with Mini Batch2 (train,test)-" , accuracy_score(train_Y2,bestModel.predict(train_X2)), accuracy_score(test_Y2,bestModel.predict(test_X2)))
confusion_matrix(comb_Y2,bestModel.predict(comb_X2))