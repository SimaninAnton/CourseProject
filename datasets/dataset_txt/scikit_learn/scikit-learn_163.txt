Contributor
NicolasHug commented on Nov 10, 2019
I was trying the new plotting API for the PDPs and was surprised that a seemingly natural pattern wasn't supported:
it is impossible to re-use the same ax object and pass it along to different displays.
ax.plot... will not plot anything. This looks like a bug to me so I'm marking it as a blocker :/
@thomasjpfan
from sklearn.experimental import enable_hist_gradient_boosting  # noqa
from sklearn.ensemble import HistGradientBoostingRegressor
from sklearn.inspection import plot_partial_dependence
from sklearn.datasets import make_regression
import numpy as np
import matplotlib.pyplot as plt

fig, ax = plt.subplots()

X, y = make_regression()

gbdt = HistGradientBoostingRegressor()
gbdt.fit(X, y)
disp_1 = plot_partial_dependence(gbdt, X, features=[0], ax=ax)

gbdt = HistGradientBoostingRegressor()
gbdt.fit(X, y)

# why can't I just pass ax here? It raises an error
disp_2 = plot_partial_dependence(gbdt, X, features=[0], ax=disp_1.axes_)


# Same here, I cannot use ax: it will not change the plot at all!
disp_1.axes_[0, 0].plot(X[:, 0], y, 'o', alpha=.6)

plt.show()