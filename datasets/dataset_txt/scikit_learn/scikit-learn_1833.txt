cdagnino commented on Oct 14, 2017 â€¢
edited
Description
TypeError: object of type 'generator' has no len() thrown when trying to use TimeSeriesSplit as an iterator in GridSearchCV
Steps/Code to Reproduce
import xgboost as xgb
from sklearn.model_selection import TimeSeriesSplit
from sklearn.grid_search import GridSearchCV
import numpy as np
X = np.array([[4, 5, 6, 1, 0, 2], [3.1, 3.5, 1.0, 2.1, 8.3, 1.1]]).T
y = np.array([1, 6, 7, 1, 2, 3])
tscv = TimeSeriesSplit(n_splits=2)
model = xgb.XGBRegressor()
param_search = {'max_depth' : [3, 5]}

my_cv = TimeSeriesSplit(n_splits=2).split(X)
gsearch = GridSearchCV(estimator=model, cv=my_cv,
                        param_grid=param_search)
gsearch.fit(X, y)
Expected Results
I expected no error to be thrown.
The docs for GridSearchCV state I can use the cv argument with:
int, cross-validation generator or an iterable, optional
On the other hand, the code does work if I write the array explicitly:
my_cv = [(train,test) for train, test in TimeSeriesSplit(n_splits=2).split(X)]
You can check this stackoverflow question for more details
Actual Results
TypeError: object of type 'generator' has no len()
Versions
Darwin-16.7.0-x86_64-i386-64bit
Python 3.5.3 | packaged by conda-forge | (default, Feb 10 2017, 07:09:50)
[GCC 4.2.1 Compatible Apple LLVM 7.3.0 (clang-703.0.31)]
NumPy 1.12.1
SciPy 0.19.1
Scikit-Learn 0.19.0
XGboost 0.6
Thanks for all your work!