svohara commented on Apr 10, 2014
I'm using sklearn 0.14.1 with python 2.7.5+ on ubuntu 13.10.
I have a large matrix of SIFT descriptors I'm trying to cluster with minibatch kmeans. (7.5 million, 128 dimensional data). After about 20 minutes of processing, the minibatch k-means reports the following MemoryError.
Parameters I'm using include:
batch size: 5000
number of clusters: 1024
initialization: kmeans++
  File "/usr/local/lib/python2.7/dist-packages/sklearn/cluster/k_means_.py", line 1218, in fit
    X, x_squared_norms, self.cluster_centers_)
  File "/usr/local/lib/python2.7/dist-packages/sklearn/cluster/k_means_.py", line 471, in _labels_inertia
    centers)
  File "/usr/local/lib/python2.7/dist-packages/sklearn/cluster/k_means_.py", line 417, in _labels_inertia_precompute_dense
    squared=True)
  File "/usr/local/lib/python2.7/dist-packages/sklearn/metrics/pairwise.py", line 176, in euclidean_distances
    distances = safe_sparse_dot(X, Y.T, dense_output=True)
  File "/usr/local/lib/python2.7/dist-packages/sklearn/utils/extmath.py", line 83, in safe_sparse_dot
    return np.dot(a, b)
MemoryError