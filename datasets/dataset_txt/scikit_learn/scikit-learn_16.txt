Tizpaz commented 14 days ago â€¢
edited
Hello,
I am reporting a potential performance issue in the implementation of Newton-CG algorithm:
scikit-learn/sklearn/utils/optimize.py
Line 123 in b194674
 def _newton_cg(grad_hess, func, grad, x0, args=(), tol=1e-4, 
In particular, at line 185, the (user) given 'tol' parameter is compared against the calculated max 'absgrad' with strictly less than comparison operator. This can lead problems such as if the 'tol'=0 and the calculated 'absgrad'=0, the algorithm still takes loop further and calls to calculate loss and Hessian unnecessarily. Even the specification in the function saying that this should be less than or equal:
scikit-learn/sklearn/utils/optimize.py
Line 148 in b194674
     tol : float 
I suggest replacing the less than comparison with less than or equal one at line 185.
Please let me know if you have any question,
Saeid