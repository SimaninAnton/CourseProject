lorepirri commented on Feb 12, 2019
Description
The download of the language dataset for the 20 newsgroups example fails for with ssl error certificate verify failed.
This happens for other downloads too (#10201), because apparently since Python version 3.6+ the
trust certificates in system and user keychains managed by the Keychain Access application and the security command line utility are no longer used as defaults
as stated in ( $ less /Applications/Python\ 3.6/ReadMe.rtf )
...There is important information there about changes in the 3.6.0 installer-supplied Python, particularly with regard to SSL certificate validation...
Apparently this is also happening for Windows users, not only Mac OS.
Steps/Code to Reproduce
Run the command to fetch the data as specified by the tutorial Working With Text Data:
% cd $TUTORIAL_HOME/data/languages
% python fetch_data.py
Example:
% cd scikit-learn/doc/tutorial/text_analytics/data/languages
% python fetch_data.py
Expected Results
No error is thrown. The specified html pages from Wikipedia are downloaded.
Actual Results
The very first download fails with the following error:
    raise URLError(err)
urllib.error.URLError: <urlopen error [SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: unable to get local issuer certificate (_ssl.c:1051)>
Detailed traceback
Versions
Python 3.7.1 (default, Dec 10 2018, 22:54:23) [MSC v.1915 64 bit (AMD64)]
Scikit-Learn 0.21.dev0
Detailed system info
Proposed solution
One solution is to modify the source code and add this, as also suggested in this issue #10201's comment:
import os, ssl
if (not os.environ.get('PYTHONHTTPSVERIFY', '') and
    getattr(ssl, '_create_unverified_context', None)): 
    ssl._create_default_https_context = ssl._create_unverified_context
The other one is to install
$ sudo /Applications/Python\ 3.6/Install\ Certificates.command
as suggested in this other issue #10201's comment: