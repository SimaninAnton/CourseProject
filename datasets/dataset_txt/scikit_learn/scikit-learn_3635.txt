akxlr commented on Aug 28, 2015
When using LogisticRegression for multi-class classification with multi_class='multinomial' (i.e. cross-entropy error rather than OvR), I am finding that predict_proba gives incorrect probability estimates.
The weights are learned correctly but I think predict_proba assumes an OvR scheme and calculates the 2-class probability for each boundary using a sigmoid function and then normalises. I would have expected it instead to return exp(w_c'x)/[sum_k exp(w_k'x)] for each class c, which is the expression for p(C_c|x) used to derive the cross-entropy loss function. The results are quite different, at least in my application.