Member
adrinjalali commented on Nov 11, 2019
Now that we don't cythonize before creating the sdist, using the sdist fails to properly install the package if the freshly created environment doesn't include scipy.
pip install scikit-learnxxx.tar.gz on an environment which has numpy and cython, will fail while trying to cythonize sklearn/utils/_cython_blas.pyx.
Example error:
 sklearn/utils/_cython_blas.pyx:203:40: Converting to Python object not allowed without gil
  
  Error compiling Cython file:
  ------------------------------------------------------------
  ...
          if floating is float:
              sgemm(&ta_, &tb_, &m, &n, &k, &alpha, A,
                    &lda, B, &ldb, &beta, C, &ldc)
          else:
              dgemm(&ta_, &tb_, &m, &n, &k, &alpha, A,
                    &lda, B, &ldb, &beta, C, &ldc)
                                            ^
  ------------------------------------------------------------
  
  sklearn/utils/_cython_blas.pyx:203:43: Converting to Python object not allowed without gil