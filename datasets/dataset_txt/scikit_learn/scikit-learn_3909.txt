vkuznet commented on Apr 7, 2015
Hi, I downloaded latest pandas (version 0.16.0) and found that I can't longer fit my models. I tried different classifiers and all of them fails with the same error:
  # this is my code where I apply the scaler to train dataset
  x_train = getattr(preprocessing, scaler)().fit_transform(x_train)

  # this is last part of traceback of sklearn failure
  File "/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/sklearn/base.py", line 433, in fit_transform
    return self.fit(X, **fit_params).transform(X)
  File "/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/sklearn/preprocessing/data.py", line 348, in fit
    ensure_2d=False)
  File "/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/sklearn/utils/validation.py", line 336, in check_array
    if hasattr(array, "dtype") and array.dtype.kind == "O":
  File "/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/pandas/core/generic.py", line 1978, in __getattr__
    (type(self).__name__, name))
AttributeError: 'Series' object has no attribute 'kind'
The same code worked fine in previous version of pandas (version 0.15.1) and sklearn (version 0.15.2). I was able to fix the problem by changing sklearn/utils/validation.py file line 336 from
if hasattr(array, "dtype") and array.dtype.kind == "O":
to
if hasattr(array, "dtype"):
For reference this is direct URL to the failed line:
https://github.com/scikit-learn/scikit-learn/blob/master/sklearn/utils/validation.py#L336
Since I don't know the logic of sklearn in details I'll leave it up to developers to investigate and apply proper change. But removing array.dtype.kind check fixed the problem for me.
Thanks,
Valentin.