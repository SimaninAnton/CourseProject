Member
glouppe commented on Oct 4, 2014
While preparing the slides for the defense of my thesis, I encountered what seems to be quite a serious bug in GridSearchCV. I basically wanted to do model selection inside a cross-validation loop in order to have an unbiased estimate of the generalization error of my selected model, so I did something like:
print -cross_val_score(GridSearchCV(estimator=RandomForestRegressor(n_estimators=50, n_jobs=-1), 
                                    param_grid={"max_features": range(1, X.shape[1]+1)},
                                    scoring="mean_squared_error"),
                       X, y, scoring="mean_squared_error", cv=3)
>>> [ 0.20720674 -0.28844932 -0.30089467]
The first estimate on the first fold is correct, the following are obviously wrong, they should be positive.