parthaghosh commented on Sep 25, 2014
Sklearn's classifier's predict_proba method does not return the probabilities for all the classes. I am running Python 3.3.5 and scikit-learn v 0.15.2. Consider the following code:
import numpy as np 
from sklearn import svm 
from sklearn.multiclass import OneVsRestClassifier
feat = [[1,2,3], [4,5,6]]
labels = ['One', 'Two']
np_feat = np.array(feat)
svm_clf  = svm.SVC(probability=True)
ovr = OneVsRestClassifier(svm_clf)
ovr.fit(np_feat,labels)
ovr.predict([[1,3,2]])
ovr.predict_proba([[1,3,2]])
Now, run the following command sequence under Python Interpreter console.
>>> ovr.classes_
You get as output:
array(['One', 'Two'], dtype='< U3') 
Next execute:
>>>ovr.predict ([1,3,2]) 
You get as output:
array(['One'], dtype=''< U3') 
Next execute:
>>> ovr.predict_proba([[1,3,2]])
You ONLY get as output:
array([[ 1.]])
Clearly the probability value for the class "Two" is missing from the output. This causes the problem for downstream code to know which classes are present in the output. We typically assume probability values [even if some are "0"] for all the classes are present.
What is the way out?