sparse_encode does not check input order