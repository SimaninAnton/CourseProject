Contributor
kmike commented on Sep 10, 2013
The following code sometimes works and sometimes hangs when executed as script:
import numpy as np
from sklearn import cross_validation
from sklearn import datasets
from sklearn.linear_model import LogisticRegression

if __name__ == '__main__':
    X, y = datasets.make_classification(n_samples=1000, n_features=5000)
    clf = LogisticRegression()   # LinearSVC behaves the same
    print(cross_validation.cross_val_score(clf, X, y, cv=5, n_jobs=4))
Sometimes it hangs without any messages, sometimes this message is printed:
python2.7(35006) malloc: *** error for object 0x7fba52d024f8: incorrect checksum for freed object - object was probably modified after being freed.
*** set a breakpoint in malloc_error_break to debug
When n_jobs is not set the code works without issues, but with n_jobs > 1 there are spurious hangs. Maybe I'm lucky, but the example above works fine with GaussianNB.
I'm not sure where to post this ticket, but since 'top'-level function that hangs/segfaults is in scikit-learn, I'm opening ticket here.
Enviroment: Mac OS X 10.8.4, Python 2.7.5 (installed using homebrew), virtualenv; latest versions of scikit-learn, numpy and scipy are installed using pip (scikit-learn==0.14.1, scipy==0.12.0, numpy==1.7.1)