Contributor
k0pernicus commented on Jun 16, 2017 â€¢
edited
Description
No deterministic results to predict clusters using KMeans, even using random_state
Steps/Code to Reproduce
This is an example:
for i in range(10):
    model = KMeans(n_clusters=nb_corpus_groups, random_state=random_state, n_jobs=n_jobs)
    groups = model.fit_predict(X)
    print(model.cluster_centers_)
    print("*" * 15)
Expected Results
I thought that the 10 results must be the same, but it does not.
Actual Results
[[ -1.08420217e-18  -1.08420217e-18   4.77048956e-18 ...,   4.77048956e-18
    4.77048956e-18   9.47867299e-03]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00 ...,   0.00000000e+00
    0.00000000e+00   0.00000000e+00]
 [ -9.21571847e-19  -9.21571847e-19   4.55364912e-18 ...,   4.55364912e-18
   -1.30104261e-18  -1.84314369e-18]
 ..., 
 [ -2.16840434e-19  -2.16840434e-19   0.00000000e+00 ...,   0.00000000e+00
   -3.03576608e-18  -4.33680869e-19]
 [ -3.25260652e-19  -3.25260652e-19   7.12589074e-03 ...,  -5.20417043e-18
    2.64545330e-17  -6.50521303e-19]
 [  5.42101086e-20   5.42101086e-20   0.00000000e+00 ...,   0.00000000e+00
   -4.33680869e-19   1.08420217e-19]]
***************
[[  3.38983051e-03  -1.46367293e-18   1.30104261e-18 ...,   1.30104261e-18
    1.73472348e-17  -2.92734587e-18]
 [ -1.57209315e-18  -1.57209315e-18  -2.38524478e-18 ...,  -2.38524478e-18
    2.25514052e-17  -3.14418630e-18]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00 ...,   0.00000000e+00
   -3.90312782e-18   0.00000000e+00]
 ..., 
 [  4.33680869e-19   4.33680869e-19   2.16840434e-18 ...,   2.16840434e-18
   -5.20417043e-18   8.67361738e-19]
 [ -1.62630326e-19  -1.62630326e-19   0.00000000e+00 ...,   0.00000000e+00
   -2.16840434e-18  -3.25260652e-19]
 [ -5.42101086e-20  -5.42101086e-20   3.03576608e-18 ...,   3.03576608e-18
   -5.63785130e-18  -1.08420217e-19]]
***************
[[  5.52943108e-18   1.20481928e-03  -1.30104261e-17 ...,   3.61445783e-03
    1.08433735e-02   1.10588622e-17]
 [ -7.04731412e-19  -7.04731412e-19   4.33680869e-18 ...,   4.33680869e-18
   -6.07153217e-18   1.21951220e-02]
 [ -8.13151629e-19  -8.13151629e-19   4.33680869e-18 ...,   4.33680869e-18
   -4.77048956e-18  -1.62630326e-18]
 ..., 
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00 ...,   0.00000000e+00
    0.00000000e+00   0.00000000e+00]
 [  3.25260652e-19   3.25260652e-19   1.51788304e-18 ...,   1.51788304e-18
   -4.77048956e-18   6.50521303e-19]
 [ -1.24683250e-18  -1.24683250e-18   4.98732999e-18 ...,   4.98732999e-18
    9.97465999e-18  -2.49366500e-18]]
***************
[[ -1.62630326e-19  -1.62630326e-19   0.00000000e+00 ...,   0.00000000e+00
   -2.16840434e-18  -3.25260652e-19]
 [ -7.04731412e-19  -7.04731412e-19  -4.77048956e-18 ...,  -4.77048956e-18
    2.55871713e-17  -1.40946282e-18]
 [ -7.04731412e-19  -7.04731412e-19   4.11996826e-18 ...,   4.11996826e-18
   -6.07153217e-18  -1.40946282e-18]
 ..., 
 [ -5.42101086e-20  -5.42101086e-20   0.00000000e+00 ...,   0.00000000e+00
   -3.90312782e-18  -1.08420217e-19]
 [ -2.71050543e-19  -2.71050543e-19   0.00000000e+00 ...,   0.00000000e+00
   -3.46944695e-18  -5.42101086e-19]
 [ -5.96311195e-19  -5.96311195e-19   4.11996826e-18 ...,   4.11996826e-18
   -6.07153217e-18  -1.19262239e-18]]
...
Versions
Linux-4.9.0-2-amd64-x86_64-with-debian-9.0
Python 3.5.3 (default, Jan 19 2017, 14:11:04)
[GCC 6.3.0 20170118]
NumPy 1.12.1
SciPy 0.19.0
Scikit-Learn 0.18.1
Thanks !