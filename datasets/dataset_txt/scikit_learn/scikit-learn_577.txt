NagabhushanS commented on Apr 20, 2019 â€¢
edited by TomDLT
I implemented my custom cross_val_score using KFold as cv. But I am getting different scores on my cross val score implementation and that on sklearn's cross_val_score. Following is the code:
model = SGDClassifier(random_state=7, loss='log')

kf = KFold(5)

scores1 = cross_val_score(model, XTrain, yTrain, cv=kf, scoring='accuracy', n_jobs=-1)
print(scores1)


kf = KFold(5)

scores2=[]

for ti, vi in kf.split(XTrain, yTrain):
  
  XT = XTrain[ti]
  XV = XTrain[vi]
  yT = yTrain[ti]
  yV = yTrain[vi]
  
  model = SGDClassifier(random_state=7, loss='log')
  model.fit(XT, yT)
  
  yP = model.predict(XV)
        
  scores2.append(accuracy_score(yV, yP)) 

print(scores2)
Here scores1 and scores2 are way different. How is this possible? Is cross_val_score implemented differently than how I implemented?