Member
amueller commented on Aug 27, 2012
I know about the warning with the nearly singular matrices but there seems something fishy still.
This code visualizes the spectral embedding:
      import matplotlib.pyplot as plt
      X, y = make_blobs(n_samples=40, random_state=1, centers=[[1, 1], [-1, -1]],                        
              cluster_std=0.4)                                                                           

      sp = SpectralClustering(n_clusters=2, gamma=1)                                                     
      labels = sp.fit(X).labels_
      print(sp.affinity_matrix_)                                                                         
      embedding = spectral_embedding(sp.affinity_matrix_, n_components=2)                                
      print(embedding)                                                                                   
      plt.scatter(X[:, 0], X[:, 1], c=labels)
      plt.figure()
      print(embedding.shape)                                                                             
      plt.scatter(embedding[0, :], embedding[1, :])                                                      
      plt.show() 
This is the data (with colors giving the clustering):
this is the embedding:
That just doesn't seem right.