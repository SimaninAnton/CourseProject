Contributor
jbDelafosse commented on May 17, 2017 â€¢
edited
Not a very important issue.
Description
Giving instance of sklearn.neighbors.DistanceMetric as distance in KNeighborsRegressor raises an Exception
Steps/Code to Reproduce
from sklearn.neighbors import KNeighborsRegressor
from sklearn.neighbors import DistanceMetric

#Model that does not raise an Exception
model_without_exception = KNeighborsRegressor(n_neighbors=5,
                                              weights='distance',
                                              algorithm='auto',
                                              metric="euclidean",
                                              n_jobs=1)

#Model that raises an Exception
distance =DistanceMetric.get_metric("euclidean")
model_with_exception = KNeighborsRegressor(n_neighbors=5,
                                           weights='distance',
                                           algorithm='auto',
                                           metric=distance,
                                           n_jobs=1)
Expected Results
No error is thrown
Actual Results
ValueError                                Traceback (most recent call last)
<ipython-input-1-71c66dfd107e> in <module>()
      6                                   algorithm='auto',
      7                                   metric=distance,
----> 8                                   n_jobs=1)

C:\Anaconda3\lib\site-packages\sklearn\neighbors\regression.py in __init__(self, n_neighbors, weights, algorithm, leaf_size, p, metric, metric_params, n_jobs, **kwargs)
    123                           algorithm=algorithm,
    124                           leaf_size=leaf_size, metric=metric, p=p,
--> 125                           metric_params=metric_params, n_jobs=n_jobs, **kwargs)
    126         self.weights = _check_weights(weights)
    127 

C:\Anaconda3\lib\site-packages\sklearn\neighbors\base.py in _init_params(self, n_neighbors, radius, algorithm, leaf_size, metric, p, metric_params, n_jobs)
    140         elif metric not in VALID_METRICS[alg_check]:
    141             raise ValueError("Metric '%s' not valid for algorithm '%s'"
--> 142                              % (metric, algorithm))
    143 
    144         if self.metric_params is not None and 'p' in self.metric_params:

ValueError: Metric '<sklearn.neighbors.dist_metrics.EuclideanDistance object at 0x0000000004CFD6D8>' not valid for algorithm 'auto'
Versions
Windows-7-6.1.7601-SP1
Python 3.5.3 |Anaconda 2.5.0 (64-bit)| (default, Feb 22 2017, 21:28:42) [MSC v.1900 64 bit (AMD64)]
NumPy 1.11.3
SciPy 0.18.1
Scikit-Learn 0.18.1