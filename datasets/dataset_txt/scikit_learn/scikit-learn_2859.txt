bspeice commented on Aug 5, 2016
Description
First off, thank you so much for the Isolation Forest algorithm being incorporated. This has been absolutely amazing already, I've been doing a lot with it.
I found an interesting edge case with the IsolationForest where if the data being passed in is all the same for each feature (i.e. each column consists of a single value for all rows) then the model degenerates and does two interesting things:
All training points, if run through prediction, are classified as anomalies
All points predicted on in the future no matter what their value is will be classified as anomalies.
That is, if the model is fitted on either a single row, or an array where each column contains nothing but the same value, then everything is always considered an anomaly during prediction.
Now, there's no way to really fix this, but I wanted to make sure both that this was a known issue, and ask: should a warning be created to detect this behavior?
Steps/Code to Reproduce
from sklearn.ensemble import IsolationForest
import numpy as np

#2-d array of all 1s
X = np.ones((100, 10))
iforest = IsolationForest()
iforest.fit(X)

assert all(iforest.predict(X) == -1)
assert all(iforest.predict(np.random.randn(100, 10)) == -1)
assert all(iforest.predict(X + 1) == -1)
assert all(iforest.predict(X - 1) == -1)

#2-d array where columns contain the same value across rows
X = np.repeat(np.random.randn(1, 10), 100, 0)
iforest = IsolationForest()
iforest.fit(X)

assert all(iforest.predict(X) == -1)
assert all(iforest.predict(np.random.randn(100, 10)) == -1)
assert all(iforest.predict(np.ones((100, 10))) == -1)

# Single row
X = np.random.randn(1, 10)
iforest = IsolationForest()
iforest.fit(X)

assert all(iforest.predict(X) == -1)
assert all(iforest.predict(np.random.randn(100, 10)) == -1)
assert all(iforest.predict(np.ones((100, 10))) == -1)
Versions (though the version shouldn't actually matter)
Windows-7-6.1.7601-SP1
('Python', '2.7.12 |Anaconda 4.1.1 (64-bit)| (default, Jun 29 2016, 11:07:13) [MSC v.1500 64 bit (AMD64)]')
('NumPy', '1.11.1')
('SciPy', '0.17.1')
('Scikit-Learn', '0.18.dev0')
Thanks, hope you all have a great day.