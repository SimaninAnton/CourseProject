lsamper commented on Jan 11, 2017
Description
I have a malloc error with TruncatedSVD.
My issue seems closed to #7626
Steps/Code to Reproduce
Code to reproduce my error:
from sklearn.datasets import fetch_20newsgroups
from sklearn.feature_extraction.text import CountVectorizer
from sklearn import decomposition
from sklearn.pipeline import make_pipeline
from sklearn.datasets import fetch_20newsgroups

twenty_train = fetch_20newsgroups(subset='train')
twenty_test = fetch_20newsgroups(subset='test')

dt_svd_clf = make_pipeline(CountVectorizer(), 
                           decomposition.TruncatedSVD(n_components=25), 
                          )
dt_svd_clf.fit(twenty_train.data, twenty_train.target)
python crashes with a segfault:
python(1883,0x7fff79fe5000) malloc: *** mach_vm_map(size=18446744072715628544) failed (error code=3)
*** error: can't allocate region
*** set a breakpoint in malloc_error_break to debug
Segmentation fault: 11
I reproduce the bug all the time.
I have 8GB RAM on my computer and I have some enough RAM left when running the code.
With algorithm='arpack' it works. I can even set n_components to 250 for instance.
dt_svd_clf = make_pipeline(CountVectorizer(), 
                           decomposition.TruncatedSVD(algorithm='arpack',n_components=25), 
                          )
Versions
My configuration:
Darwin-15.6.0-x86_64-i386-64bit
Python 3.5.2 (default, Oct 11 2016, 15:01:29)
[GCC 4.2.1 Compatible Apple LLVM 7.3.0 (clang-703.0.31)]
NumPy 1.11.2
SciPy 0.18.1
Scikit-Learn 0.18.1
Thanks
üëç 3