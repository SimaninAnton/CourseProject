Contributor
nelson-liu commented on Jul 19, 2017 â€¢
edited
Description
LabelEncoder doesn't seem to work properly with FrozenSets. The docs say that LabelEncoder works with things that are comparable and hashable, which FrozenSets are (correct me if I'm wrong here). Maybe it has something to do with the elements of the frozenset not being hashable? (This could entirely be an issue with my understanding of python, and not with the scikit-learn code)
Steps/Code to Reproduce
In [25]: short_str_labels = [frozenset(['-s$']), frozenset(['+z$', '-ces$']), frozenset(['-s$']), frozenset(['-as$', '+o$']), frozenset(['-es$']), frozenset(['+a$', '-ia
    ...: $']), frozenset(['-es$']), frozenset(['-s$'])]

In [26]: short_str_labels
Out[26]:
[frozenset({'-s$'}),
 frozenset({'+z$', '-ces$'}),
 frozenset({'-s$'}),
 frozenset({'+o$', '-as$'}),
 frozenset({'-es$'}),
 frozenset({'+a$', '-ia$'}),
 frozenset({'-es$'}),
 frozenset({'-s$'})]

In [27]: set(short_str_labels)
Out[27]:
{frozenset({'+o$', '-as$'}),
 frozenset({'-s$'}),
 frozenset({'+z$', '-ces$'}),
 frozenset({'-es$'}),
 frozenset({'+a$', '-ia$'})}

In [28]: le = LabelEncoder()

In [29]: le.fit(short_str_labels)
Out[29]: LabelEncoder()

In [30]: le.classes_
Out[30]:
array([frozenset({'-s$'}), frozenset({'+z$', '-ces$'}), frozenset({'-s$'}),
       frozenset({'+o$', '-as$'}), frozenset({'-es$'}),
       frozenset({'+a$', '-ia$'}), frozenset({'-es$'}), frozenset({'-s$'})], dtype=object)
Expected Results
In [30]: le.classes_
Out[30]:
array([frozenset({'-s$'}), frozenset({'+z$', '-ces$'}),
       frozenset({'+o$', '-as$'}), frozenset({'-es$'}),
       frozenset({'+a$', '-ia$'})], dtype=object)
(note that the order of the labels doesn't matter -- the expected results is that the same frozenset does not appear twice in the classes array)
Actual Results
In [30]: le.classes_
Out[30]:
array([frozenset({'-s$'}), frozenset({'+z$', '-ces$'}), frozenset({'-s$'}),
       frozenset({'+o$', '-as$'}), frozenset({'-es$'}),
       frozenset({'+a$', '-ia$'}), frozenset({'-es$'}), frozenset({'-s$'})], dtype=object)
Versions
Linux-4.8.0-58-generic-x86_64-with-debian-stretch-sid
Python 3.6.1 |Continuum Analytics, Inc.| (default, May 11 2017, 13:09:58)
[GCC 4.4.7 20120313 (Red Hat 4.4.7-1)]
NumPy 1.13.0
SciPy 0.19.0
Scikit-Learn 0.18.2