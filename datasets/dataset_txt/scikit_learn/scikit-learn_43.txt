Contributor
glemaitre commented 29 days ago
In the following lines:
scikit-learn/sklearn/linear_model/_ridge.py
Lines 578 to 585 in a847cde
 if solver == 'sag' and sparse.issparse(X) and self.fit_intercept: 
     self.coef_, self.n_iter_, self.intercept_ = _ridge_regression( 
         X, y, alpha=self.alpha, sample_weight=sample_weight, 
         max_iter=self.max_iter, tol=self.tol, solver=self.solver, 
         random_state=self.random_state, return_n_iter=True, 
         return_intercept=True, check_input=False) 
     # add the offset which was subtracted by _preprocess_data 
     self.intercept_ += y_offset 
we call _ridge_regression passing solver=self.solver while we made a validation step we should use solver=solver instead.