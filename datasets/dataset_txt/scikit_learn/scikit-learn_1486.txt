iBM88 commented on Mar 19, 2018 â€¢
edited
Description
Hi
I am trying to implement online training by enabling warm_start from RandomForestClassifier:
my_classifier = RandomForestClassifier(warm_start=True, n_estimators=0)
In each iteration I feed new data to the classifier and train it by my_classifier.fit(data) after increasing the number of estimators n_estimators.
The problem occurs when the data is made up of only a single class. In this case in forest.py in accumulate_prediction we will have an error in line: out[0] += prediction. The error specifically is the mismatch of sizes of out[0] and prediction:
ValueError: non-broadcastable output operand with shape (10,1) doesn't match the broadcast shape (10,2)
forest.py:381
scikit-learn/sklearn/ensemble/forest.py
Line 381 in 58f8469
 def accumulate_prediction(predict, X, out, lock): 