Contributor
NicolasHug commented 24 days ago â€¢
edited
CategoricalNB expects X to be integers as mentioned in the docs. However it will fail with a rather cryptic message, i.e.
TypeError: `pad_width` must be of integral type.
MRE:
import numpy as np
from sklearn.naive_bayes import CategoricalNB
X = rng.randn(6, 100)
y = np.array([1, 2, 3, 4, 5, 6])
CategoricalNB().fit(X, y)
Might be worth failing with a more graceful message, or even force cast. I'm not sure whether that was discussed in the original PR, @jnothman and @qinhanmin2014 ?