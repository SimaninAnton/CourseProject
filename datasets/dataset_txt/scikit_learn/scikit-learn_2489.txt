johnny5550822 commented on Jan 6, 2017 â€¢
edited
Since 0.17, I kno GridSearchCV support probability scoring calculation. Here is what I do
svr = svm.SVC(kernel="rbf", class_weight={1: class_weight}, probability=True)
inner_cv = StratifiedKFold(n_splits=num_folds, shuffle=True, random_state=i)
clf = GridSearchCV(estimator=svr, param_grid=p_grid, cv=inner_cv,scoring='roc_auc')
clf.fit(features,labels)
print(clf.best_score_)
For whatever reason, the best_score is pretty low, i.e., 0.45470483
And when I do clf.cv_results_, one of the test_score array actually has higher mean score (see below; I am doing 5-fold CV). Did I do something wrong or it is a bug?
[ 0.48435374 0.4952381 0.48979592 0.48571429]
Please help! I spend many hours to go through forum and documentation and still cannot figure it out...