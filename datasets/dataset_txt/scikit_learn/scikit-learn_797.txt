xiaobena commented on Jan 14, 2019
Hi,
I ran into an error when using sklearn.metrics.pairwise_distances. I would appreciate any thoughts about whether I'm up against a bug, or this is unsupported usage.
Reproducing code example:
from sklearn.metrics.pairwise import pairwise_distances
import numpy as np
a  = np.array([[1,2,3], [4,5,6], [7,8,9]])
d = pairwise_distances(a, a, metric='minkowski', w=None)
Error message:
Traceback (most recent call last):
  File "<input>", line 4, in <module>
  File "C:\ProgramData\Anaconda3\envs\scipy\lib\site-packages\sklearn\metrics\pairwise.py", line 1403, in pairwise_distances
    **kwds))
  File "C:\ProgramData\Anaconda3\envs\scipy\lib\site-packages\scipy\spatial\distance.py", line 1734, in pdist
    dm = pdist(X, _TEST_METRICS[mstr], **kwargs)
  File "C:\ProgramData\Anaconda3\envs\scipy\lib\site-packages\scipy\spatial\distance.py", line 1690, in pdist
    dm[k] = metric(X[i], X[j], **kwargs)
  File "C:\ProgramData\Anaconda3\envs\scipy\lib\site-packages\scipy\spatial\distance.py", line 481, in minkowski
    dist = norm(u_v, ord=p)
  File "C:\ProgramData\Anaconda3\envs\scipy\lib\site-packages\scipy\linalg\misc.py", line 129, in norm
    a = np.asarray_chkfinite(a)
  File "C:\ProgramData\Anaconda3\envs\scipy\lib\site-packages\numpy\lib\function_base.py", line 461, in asarray_chkfinite
    "array must not contain infs or NaNs")
ValueError: array must not contain infs or NaNs
version information:
Python 3.6.8
NumPy 1.15.0
SciPy 1.0.0
Scikit-Learn 0.20.1