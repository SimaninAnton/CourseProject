Contributor
ziky90 commented on Feb 20, 2015
Hi,
I am calling the metrics.precision_recall_curve(y_true, probas_pred)
with
y_true = [0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
probas_pred = [0.5, 0.5, 0.5, 0.5, 0.5, 0.49284466537947241, 0.5, 0.5, 0.49150201157082946, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.50586456836621119, 0.5, 0.50514369749934984, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.50582602266220467, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
And I am obtaining result:
precision = [ 0.02 0.01010101 0. 0. 0. 0. 1. ]
recall = [ 1. 0.5 0. 0. 0. 0. 0. ]
thresholds = [ 0.49150201 0.49284467 0.5 0.5051437 0.50582602 0.50586457]
Which is strange.
So by further debugging I can see that the output from metrics._binary_clf_curve() here was:
fps = [ 1. 2. 3. 98. 98. 98.]
tps = [ 0. 0. 0. 0. 1. 2.]
thresholds = [0.50586457 0.50582602 0.5051437 0.5 0.49284467 0.49150201 ]
This seems to me as incorrect. If I understand it correctly this correctly the correct output of the metrics._binary_clf_curve() for this set of thresholds should be:
tps = [ 2. 2. 2. 2. 2. 2.]
fps = [1. 2. 3. 98. 98. 98.]
and thus
precision = [0.02 0.02 0.02 0.4 0.5 0.66666 1.]
recall = [1. 1. 1. 1. 1. 1. 0.]
So if I understand this correctly then there is a bug somewhere around the line 323 in metrics._binary_clf_curve()