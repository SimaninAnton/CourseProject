grechkay commented on Sep 1, 2014
I was working with pandas and sklearn modules, and I tried using the following:
skcv.cross_val_score(clf_1_v3, feature_vec, result_vec.ix[:, 0] , cv=5, scoring='mean_squared_error')
With feature_vec and result_vec both being pandas DataFrames; I got the following error
Traceback (most recent call last):
  File "/usr/lib/python2.7/dist-packages/IPython/core/interactiveshell.py", line 2820, in run_code
    exec code_obj in self.user_global_ns, self.user_ns
  File "<ipython-input-48-4e1db779e5e6>", line 1, in <module>
    skcv.cross_val_score(clf_1_v3,aa ,bb , cv=5, scoring='mean_squared_error')
  File "/home/grechkay/.local/lib/python2.7/site-packages/sklearn/cross_validation.py", line 1151, in cross_val_score
    for train, test in cv)
  File "/home/grechkay/.local/lib/python2.7/site-packages/sklearn/externals/joblib/parallel.py", line 644, in __call__
    self.dispatch(function, args, kwargs)
  File "/home/grechkay/.local/lib/python2.7/site-packages/sklearn/externals/joblib/parallel.py", line 391, in dispatch
    job = ImmediateApply(func, args, kwargs)
  File "/home/grechkay/.local/lib/python2.7/site-packages/sklearn/externals/joblib/parallel.py", line 129, in __init__
    self.results = func(*args, **kwargs)
  File "/home/grechkay/.local/lib/python2.7/site-packages/sklearn/cross_validation.py", line 1240, in _fit_and_score
    test_score = _score(estimator, X_test, y_test, scorer)
  File "/home/grechkay/.local/lib/python2.7/site-packages/sklearn/cross_validation.py", line 1296, in _score
    score = scorer(estimator, X_test, y_test)
  File "/home/grechkay/.local/lib/python2.7/site-packages/sklearn/metrics/scorer.py", line 80, in __call__
    return self._sign * self._score_func(y_true, y_pred, **self._kwargs)
  File "/home/grechkay/.local/lib/python2.7/site-packages/sklearn/metrics/metrics.py", line 2221, in mean_squared_error
    weights=sample_weight)
  File "/usr/lib/python2.7/dist-packages/numpy/lib/function_base.py", line 496, in average
    scl = avg.dtype.type(a.size/avg.size)
AttributeError: 'float' object has no attribute 'dtype'
After quite a few hours of debugging, I tried to convert the DataFrame to ndarray, but I got the same error, and then I looked at the type of individual datapoints and compared them to types that are known to function properly.
Turns out that the type of my data was 'float', while the type of data known to function properly was 'numpy.float64'. So then I changed my command to:
skcv.cross_val_score(clf_1_v3, feature_vec.astype('float64'), result_vec.ix[:, 0].astype('float64'), cv=5, scoring='mean_squared_error')
And that fixed the problem.
It seems that the cross_val_score should detect and fix this automatically.