hazlittv5 commented on Mar 22, 2019 â€¢
edited
Description
I'm dnot know how to use GridSearchCV for LightGBM multiclass,just had a try and it go wrong,please help~~~
Steps/Code to Reproduce
lgb_train = lgb.Dataset(x_train, y_train)
lgb_eval = lgb.Dataset(x_test, y_test, reference=lgb_train)
params = {
'boosting_type': 'gbdt',
'objective': 'multiclass',
'num_class': 17,
'metric': 'multi_error',
'num_leaves': 300,
'min_data_in_leaf': 100,
'learning_rate': 0.01,
'feature_fraction': 0.8,
'bagging_fraction': 0.8,
'bagging_freq': 5,
'lambda_l1': 0.4,
'lambda_l2': 0.5,
'min_gain_to_split': 0.2,
'verbose': 5,
'is_unbalance': True
}
gbm = lgb.train(params,
lgb_train,
num_boost_round=10000,
valid_sets=lgb_eval,
early_stopping_rounds=500)
from sklearn.model_selection import GridSearchCV
estimator = gbm
param_grid=params_test1
gbm1 = GridSearchCV(estimator, param_grid)
gbm1.fit(x_train, y_train)
print('Best parameters found by grid search are:', gbm1.best_params_)
Actual Results
TypeError: estimator should be an estimator implementing 'fit' method, <lightgbm.basic.Booster object at 0x0000025E442621D0> was passed