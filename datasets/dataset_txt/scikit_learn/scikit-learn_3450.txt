pkch commented on Nov 5, 2015
In DummyClassifier, it seems there's a bug that causes predict_proba to fail with MemoryError when strategy is "most_frequent".
    for k in range(self.n_outputs_):
        if self.strategy == "most_frequent":
            ind = np.ones(n_samples, dtype=int) * class_prior_[k].argmax() # here
            out = np.zeros((n_samples, n_classes_[k]), dtype=np.float64)
            out[:, ind] = 1.0
I think the commented line should be
            ind = class_prior_[k].argmax()
unless I misunderstand how numpy array works. At least after this change, everything worked fine. Before the change, it was trying to create a huge number of columns.
Python 3.5, numpy 1.10.1.