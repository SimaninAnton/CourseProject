Contributor
olologin commented on Sep 5, 2015
Something weird, i know that predict and predict_proba results is independent in NuSVC implementation, but i don't know if this is normal behaviour. Because sometimes predict_proba returns maximum probability not for same class that was returned by predict:
import numpy as np
from sklearn.utils import shuffle
from sklearn.preprocessing import StandardScaler
from sklearn.datasets import make_blobs
from sklearn.svm import NuSVC

X_m, y_m = make_blobs(n_samples=300, random_state=0)
X_m, y_m = shuffle(X_m, y_m, random_state=7)
X_m = StandardScaler().fit_transform(X_m)

f = NuSVC(probability=True)
f.fit(X_m, y_m)
y_pred = f.predict(X_m)
y_prob = f.predict_proba(X_m)
print(np.where(np.argmax(y_prob, axis=1) != y_pred))
(array([ 50, 147, 208, 283]),)