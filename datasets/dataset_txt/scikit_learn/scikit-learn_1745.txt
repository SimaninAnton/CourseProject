Contributor
wdevazelhes commented on Nov 16, 2017 â€¢
edited
Description
sklearn.model_selection.StratifiedKFold docstring states that
All the folds have size trunc(n_samples / n_splits), the last one has the complementary.
This is not true in general. Indeed, in this particular case for instance, all folds have different sizes:
Steps/Code to Reproduce
from sklearn.model_selection import StratifiedKFold
d = np.zeros((15, 2)) 
t = np.hstack([np.ones(7), np.zeros(8)])
s = StratifiedKFold()  
gen = s.split(d, t)
[e[0].shape[0] for e in gen]
Expected Results: (according to the doc)
[10, 10, 10]
Actual Results
[9, 10, 11]
Versions
Linux-4.4.0-97-generic-x86_64-with-debian-stretch-sid
Python 3.6.2 |Continuum Analytics, Inc.| (default, Jul 20 2017, 13:51:32)
[GCC 4.4.7 20120313 (Red Hat 4.4.7-1)]
NumPy 1.13.1
SciPy 0.19.1
Scikit-Learn 0.20.dev0
UPDATE
The example below is much clearer since it looks at the validation set size instead of the training set size, and validation set i is in fact fold i according to StratifiedKFold code (and its mother classes code):
import numpy as np
from sklearn.model_selection import StratifiedKFold
d = np.zeros((15, 2)) 
t = np.hstack([np.zeros(7), np.ones(8)])
s = StratifiedKFold(n_splits=3)  
gen = s.split(d, t)
[e[1].shape[0] for e in gen]
Expected Result (according to the docstring)
[5, 5, 5]
Actual Result
[6, 5, 4]