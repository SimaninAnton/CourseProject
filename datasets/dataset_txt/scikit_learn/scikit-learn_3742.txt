davidgbe commented on Jul 3, 2015
Hi all!
I've been using sklearn's SVM for a bit, and I've encountered a small edge case in the compute_class_weight function in sklearn/utils/class_weight.py. The issue occurs at line 60. Here's some context:
        for c in class_weight:
            i = np.searchsorted(classes, c)
            if classes[i] != c:
                raise ValueError("Class label %d not present." % c)
            else:
                weight[i] = class_weight[c]
Basically, we are affirming that each key (class) in the class_weight dict actually exists in the classes. The issue occurs when a class in class_weight is greater than all the values in the classes array. Instead of raising the specified value error, you simply get an unhelpful IndexError. Here is the proposed solution:
            if i >= len(classes) or classes[i] != c:
                raise ValueError("Class label %d not present." % c)
Thanks for all you do guys! This library is a huge help to everyone!