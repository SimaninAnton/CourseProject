Member
TomDLT commented on Dec 11, 2017 â€¢
edited
LinearRegression is sometimes not deterministic, as shown by the following test:
from sklearn.linear_model import LinearRegression
from sklearn.utils.testing import assert_array_equal
from sklearn.tests.test_multioutput import generate_multilabel_dataset_with_correlations

def test_investigate_linear_regression_indeterminacy():
    # Is LinearRegression deterministic?
    X, Y = generate_multilabel_dataset_with_correlations()
    y = Y[:, 1]
    ref = LinearRegression().fit(X, y).coef_
    for i in range(1000):
        coef = LinearRegression().fit(X, y).coef_
        assert_array_equal(ref, coef, 'iter %d' % i)

test_investigate_linear_regression_indeterminacy()
which failed at iteration 18 in this Travis job. I can't reproduce locally.
It only occurs on one Travis platform (Linux + python 3.6.2), only sometimes (iteration 18 in this test case).
Failure spotted initially in #9257 (comment)