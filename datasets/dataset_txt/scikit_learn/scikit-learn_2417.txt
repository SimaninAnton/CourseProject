migglu commented on Feb 9, 2017 â€¢
edited
Description
Can't create a Pipeline with intermediate element(s) which only implement sklearn.base.TransformerMixin (fit_transform). Constructor calls a method to validate the steps for the pipeline and it throws an exception stating the element of the pipeline has to implement fit and transform.
I am aware I'm not using the newest stable version of scikit-learn, but this issue seems to be in present in the master branch as well.
Steps/Code to Reproduce
from sklearn.pipeline import Pipeline
from sklearn.base import TransformerMixin
from sklearn.linear_model import LinearRegression


class DummyTransformer(TransformerMixin):
    
    def fit_transform(self, X, y=None):
        return X


pipeline = Pipeline(steps=[
    ("dummy_tranformer", DummyTransformer()),
    ("estimator", LinearRegression())
])
Expected Results
Pipeline to be created without an error.
Actual Results
TypeErrorTraceback (most recent call last)
<ipython-input-1-c6e25693967d> in <module>()
     12 pipeline = Pipeline(steps=[
     13     ("dummy_tranformer", DummyTransformer()),
---> 14     ("estimator", LinearRegression())
     15 ])

/usr/local/lib/python3.5/dist-packages/sklearn/pipeline.py in __init__(self, steps)
    151         # shallow copy of steps
    152         self.steps = tosequence(steps)
--> 153         self._validate_steps()
    154 
    155     def get_params(self, deep=True):

/usr/local/lib/python3.5/dist-packages/sklearn/pipeline.py in _validate_steps(self)
    198                 raise TypeError("All intermediate steps should be "
    199                                 "transformers and implement fit and transform."
--> 200                                 " '%s' (type %s) doesn't" % (t, type(t)))
    201 
    202         # We allow last estimator to be None as an identity transformation

TypeError: All intermediate steps should be transformers and implement fit and transform. '<__main__.DummyTransformer object at 0x7f42a0294828>' (type <class '__main__.DummyTransformer'>) doesn't
Versions
Linux-4.8.0-2-amd64-x86_64-with-Ubuntu-16.04-xenial
Python 3.5.2 (default, Sep 10 2016, 08:21:44) 
[GCC 5.4.0 20160609]
NumPy 1.11.2
SciPy 0.18.1
Scikit-Learn 0.18