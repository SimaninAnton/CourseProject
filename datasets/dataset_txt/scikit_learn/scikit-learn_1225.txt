vahidbas commented on Jul 18, 2018
Description
Once transformer fit is done here and again here during fit_transform. I don't think this is intended as fitting can be costly and there is no reason to repeat it for the same data.
Steps/Code to Reproduce
from sklearn.base import TransformerMixin, BaseEstimator
from sklearn.compose import TransformedTargetRegressor
from sklearn.tree import DecisionTreeRegressor
from sklearn import datasets

class DummyTransformer(BaseEstimator, TransformerMixin):
    def __init__(self):
        pass
    
    def fit(self, X):
        print('in fit')
        return self
    
    def transform(self, X):
        print('in transform')
        return X
    
    def inverse_transform(self, X):
        print('in inverse_transform')
        return X
    
    
estimator = TransformedTargetRegressor(
    regressor=DecisionTreeRegressor(),
    transformer=DummyTransformer(),
    check_inverse = False
)

X, y = datasets.load_linnerud(return_X_y=True)

estimator.fit(X, y)
returns:
in fit
in fit
in transform
Expected Results
in fit
in transform