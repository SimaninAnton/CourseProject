Member
ogrisel commented on Jul 13, 2017 â€¢
edited
This issue should be "easy" if you are already familiar with:
travis configuration
bash scripting
docker
We need to add the following line in our .travis.yml:
sudo: required

services:
  - docker
more details in Using Docker in Builds.
Here is a minimalistic script that could put in build_tools/travis/docker_test.sh:
# This test script is mean to be executed with 'docker run' using one of the manylinux images
set -e
export PATH=/opt/python/cp36-cp36m/bin:$PATH
pip install numpy scipy cython nose pytest
cd /io
pip install -e .
pytest -l sklearn
This script can used to launch the test with (for 32 bit linux):
docker run --rm -v`pwd`:/io quay.io/pypa/manylinux1_i686 \
    bash /io/build_tools/travis/docker_test.sh
This command should be launched from the scikit-learn folder such that the -v flag mount the scikit-learn source folder of the host into the /io folder inside the container.
The above test script should be improved to specify the version number of python, numpy scipy and cython with environment variables defined in .travis.yml (that should be passed via the -e flag of the docker command).