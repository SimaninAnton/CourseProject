stollpa commented on Apr 12, 2019
Hi, I am not sure if this is the correct place to put this question. But maybe you can help me. I was using k nearest neighbor with mahalanobis distance. I wanted to check if the distance I get is the same as with the package: DistanceMetric.get_metric('mahalanobis') but there is actually a difference. Can you maybe tell me where this difference comes from?
Here is my code:
from sklearn.neighbors import DistanceMetric
from sklearn.neighbors import KNeighborsClassifier as kNN

X = pd.DataFrame([
        [64.0,    580.0,   29.0],
        [66.0,    570.0,   33.0],
        [68.0,    590.0,   37.0],
        [69.0,    660.0,   46.0],
        [73.0,    600.0,   55.0]])
y = [0,0,1,1,0]

knn = kNN(algorithm='brute', n_neighbors = 5, metric = 'mahalanobis', metric_params={'V': X.cov()})
knn.fit(X, y)
dist, neighbors = knn.kneighbors(X)
distance = DistanceMetric.get_metric('mahalanobis', V = np.cov(X.T))
dist_maha = distance.pairwise(X).round(5)
print([dist_maha[0,0], dist_maha[0,1],dist_maha[0,3],dist_maha[0,4],dist_maha[0,2]],"\n", dist.round(5)[0])
The output is:
[0.0, 1.09954, 2.4634, 2.72317, 2.77999] 
[0.      1.16624 2.61283 2.88836 2.94863]
These two Arrays should print exactly the same in the same order, but they don't.