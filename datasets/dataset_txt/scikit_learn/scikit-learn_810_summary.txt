DBSCAN with custom distance function: big problem of performance