lwoloszy commented on Mar 13, 2012
The following code should produce an area under the curve of 1.0. auc function from the metrics module does not:
import numpy as np
from sklearn.metrics import roc_curve, auc
x=np.random.rand(20)
x1=x[argsort(x)][0:10]
x2=x[argsort(x)][10:]
labels = np.repeat([0,1],[10,10])
fpr,tpr,thresholds = roc_curve(labels,np.concatenate([x1,x2]))
print auc(fpr,tpr)
I'm pretty sure the bug's related to how argsort function within auc is handling (or mishandling) rank ties. In particular, auc function sorts fpr vector but if there are many equal entries for fpr argsort appears to randomly assign a rank to them but this is a problem because then the tpr vector can (and will) get misaligned.