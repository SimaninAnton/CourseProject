Contributor
mih commented on Feb 28, 2014
Not sure if you consider this a bug, but it may be worth a note in the docs.
euclidean_distances() is not guaranteed to return a symmetric matrix, due to tiny numerical errors. The following code bit always fails on the last line
from sklearn.metrics.pairwise import euclidean_distances
from scipy.spatial.distance import squareform, pdist
import numpy as np

data = np.array([[ 0.15227033,  0.00968607,  0.66563669],
                 [ 0.20121417,  0.93050023,  0.83427689],
                 [ 0.31380433,  0.45351911,  0.70250607],
                 [ 0.12726916,  0.01265142,  0.24546851],
                 [ 0.53571383,  0.6603375 ,  0.9784678 ]])
#data = np.random.random((5,3))

sp_dists = squareform(pdist(data, metric='euclidean'))
skl_dists = euclidean_distances(data)

print 'dss:', np.sum((sp_dists - skl_dists)**2)
vf = squareform(skl_dists)
I know that there are ways around this, but it felt "not right" when the error was
ValueError: Distance matrix 'X' must be symmetric.