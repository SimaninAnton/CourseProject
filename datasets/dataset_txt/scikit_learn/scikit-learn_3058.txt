PCavalie commented on Apr 12, 2016
Hello,
I want to save a randomForest model to predict a class on new data. I use joblib to save and load data but I get this error when I use joblib.load. ValueError: "Did not recognize loaded array layout"
More information :
platform: Windows-7-6.1.7601-SP1
system: 'Python', '2.7.10 |Anaconda 2.3.0 (32-bit)| (default, May 28 2015, 17:02:00) [MSC v.1500 32 bit (Intel)]'
numpy version 1.9.2
sklearn version 0.16.1
scipy version 0.15.1
code reproducing the error:
from sklearn.externals import joblib
import numpy as np
from sklearn.ensemble import RandomForestClassifier
X = np.random.randn(1500,8)
l = np.random.randint(6, size = 1500)
clf_forest = RandomForestClassifier(n_estimators = 10)
clf_forest.fit(X,l)
joblib.dump(clf_forest,'clf_forest.pkl')
X_test = joblib.load('clf_forest.pkl')
Full error:
  File "<ipython-input-4-fbcdf8eeb9d7>", line 1, in <module>
    X_test = joblib.load('clf_forest.pkl')
  File "C:\Users\P\AppData\Local\Continuum\Anaconda\lib\site-packages\sklearn\externals\joblib\numpy_pickle.py", line 425, in load
    obj = unpickler.load()

  File "C:\Users\P\AppData\Local\Continuum\Anaconda\lib\pickle.py", line 858, in load
    dispatch[key](self)

  File "C:\Users\P\AppData\Local\Continuum\Anaconda\lib\site-packages\sklearn\externals\joblib\numpy_pickle.py", line 285, in load_build
    Unpickler.load_build(self)

  File "C:\Users\P\AppData\Local\Continuum\Anaconda\lib\pickle.py", line 1217, in load_build
    setstate(state)

  File "sklearn/tree/_tree.pyx", line 3113, in sklearn.tree._tree.Tree.__setstate__ (sklearn\tree\_tree.c:23599)

ValueError: Did not recognise loaded array layout
Thanks for the help