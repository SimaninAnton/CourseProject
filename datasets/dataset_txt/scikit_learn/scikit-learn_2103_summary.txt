Fitting a NearestNeighbors model fails with sparse input and a callable as metric