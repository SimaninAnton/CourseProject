calling type_of_target crashes before returning unknown