Contributor
sabba commented on Jul 29, 2011
I'm working on a lasso/elasticnet minimizer using proximal methods.
Comparing my implementation with the ones in scikits.learn I have noticed a (probably) little bug in the stopping condition.
You check if:
d_w_max / w_max < d_w_tol 
but w_max is updated only when:
if w[ii] > w_max:
        w_max = w[ii]
This means that if the solution contains negative coefficients (or only negative coefficients) the tolerance is scaled
only respect to the positive ones leading to an early calculation of the duality gap which may slow down the algorithm.
A solution may be:
if fabs(w[ii]) > w_max:
        w_max = fabs(w[ii])