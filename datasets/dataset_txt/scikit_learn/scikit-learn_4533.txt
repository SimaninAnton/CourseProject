laminko commented on Jan 25, 2014
Hi,
I tried to cluster docs using MBKmeans. I made 100K docs into chunks (each chunk contained 5000 docs). I run MBK partial_fit. Then, I select the docs like each_chunk[labels == e]. I got no docs. How should I do? I have large amount of files to cluster?
Here is the code:
def selectDocsByCluster(self, chunks):
        centroids = self.kmeans.cluster_centers_
        labels = self.kmeans.labels_

        if self.verbose:
            print 'labels:', len(labels.tolist())

        checker_docs_count = 0

        collected_data = dict()

        for e, centroid in enumerate(centroids):
            members = labels == e

            for each_chunk in chunks:
                docs_by_cluster = each_chunk[members]

                if e in collected_data.keys():
                    collected_data[e].extend(docs_by_cluster.tolist())
                else:
                    collected_data.update({e:docs_by_cluster.tolist()})

            if self.verbose:
                print 'Members:', len(members.tolist()), type(members)

            total_selected = len(collected_data.get(e) or [])
            print 'clusterID:', e, "Total Docs:", total_selected

            checker_docs_count += total_selected

        print 'check docs count:', checker_docs_count
And, detail code is here.
Thanks in advance.
I also made a question at stackoverflow.