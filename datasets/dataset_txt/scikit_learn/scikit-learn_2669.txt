chrisorm commented on Oct 12, 2016
Description
I get an error relating to the K means c code when I try and build the scikit learn source on windows.
Windows 10, python 2.7, 64 bit.
I have followed religiously the instructions at http://scikit-learn.org/stable/developers/advanced_installation.html#id2.
Error Message
sklearn\neighbors\typedefs.pyx has not changed
sklearn\svm\liblinear.pyx has not changed
sklearn\svm\libsvm.pyx has not changed
sklearn\svm\libsvm_sparse.pyx has not changed
sklearn\tree_criterion.pyx has not changed
sklearn\tree_splitter.pyx has not changed
sklearn\tree_tree.pyx has not changed
sklearn\tree_utils.pyx has not changed
sklearn\utils\arrayfuncs.pyx has not changed
sklearn\utils\fast_dict.pyx has not changed
sklearn\utils\graph_shortest_path.pyx has not changed
sklearn\utils\lgamma.pyx has not changed
sklearn\utils\murmurhash.pyx has not changed
sklearn\utils\seq_dataset.pyx has not changed
sklearn\utils\sparsefuncs_fast.pyx has not changed
sklearn\utils\weight_vector.pyx has not changed
sklearn\utils_logistic_sigmoid.pyx has not changed
sklearn\utils_random.pyx has not changed
sklearn\utils\sparsetools_graph_tools.pyx has not changed
sklearn\utils\sparsetools_traversal.pyx has not changed
sklearn__check_build_check_build.pyx has not changed
_dbscan_inner.pyx
_hierarchical.pyx
_check_build.pyx
blas_opt_info:
blas_mkl_info:
C:\Users\Chris\Anaconda\lib\site-packages\numpy\distutils\system_info.py:635: UserWarning: Specified path C:\aroot\stage\Library\lib is invalid.
warnings.warn('Specified path %s is invalid.' % d)
C:\Users\Chris\Anaconda\lib\site-packages\numpy\distutils\system_info.py:635: UserWarning: Specified path C:\aroot\stage\Library\include is invalid.
warnings.warn('Specified path %s is invalid.' % d)
libraries mkl_core_dll,mkl_intel_lp64_dll,mkl_intel_thread_dll not found in []
NOT AVAILABLE
openblas_info:
libraries openblas not found in ['C:\Users\Chris\Anaconda\lib', 'C:', 'C:\Users\Chris\Anaconda\libs']
NOT AVAILABLE
atlas_3_10_blas_threads_info:
Setting PTATLAS=ATLAS
libraries tatlas not found in ['C:\Users\Chris\Anaconda\lib', 'C:', 'C:\Users\Chris\Anaconda\libs']
NOT AVAILABLE
atlas_3_10_blas_info:
libraries satlas not found in ['C:\Users\Chris\Anaconda\lib', 'C:', 'C:\Users\Chris\Anaconda\libs']
NOT AVAILABLE
atlas_blas_threads_info:
Setting PTATLAS=ATLAS
libraries ptf77blas,ptcblas,atlas not found in ['C:\Users\Chris\Anaconda\lib', 'C:', 'C:\Users\Chris\Anaconda\libs']
NOT AVAILABLE
atlas_blas_info:
libraries f77blas,cblas,atlas not found in ['C:\Users\Chris\Anaconda\lib', 'C:', 'C:\Users\Chris\Anaconda\libs']
NOT AVAILABLE
C:\Users\Chris\Anaconda\lib\site-packages\numpy\distutils\system_info.py:1651: UserWarning:
Atlas (http://math-atlas.sourceforge.net/) libraries not found.
Directories to search for the libraries can be specified in the
numpy/distutils/site.cfg file (section [atlas]) or by setting
the ATLAS environment variable.
warnings.warn(AtlasNotFoundError.doc)
blas_info:
libraries blas not found in ['C:\Users\Chris\Anaconda\lib', 'C:', 'C:\Users\Chris\Anaconda\libs']
NOT AVAILABLE
C:\Users\Chris\Anaconda\lib\site-packages\numpy\distutils\system_info.py:1660: UserWarning:
Blas (http://www.netlib.org/blas/) libraries not found.
Directories to search for the libraries can be specified in the
numpy/distutils/site.cfg file (section [blas]) or by setting
the BLAS environment variable.
warnings.warn(BlasNotFoundError.doc)
blas_src_info:
NOT AVAILABLE
C:\Users\Chris\Anaconda\lib\site-packages\numpy\distutils\system_info.py:1663: UserWarning:
Blas (http://www.netlib.org/blas/) sources not found.
Directories to search for the sources can be specified in the
numpy/distutils/site.cfg file (section [blas_src]) or by setting
the BLAS_SRC environment variable.
warnings.warn(BlasSrcNotFoundError.doc)
NOT AVAILABLE
sklearn\setup.py:71: UserWarning:
Blas (http://www.netlib.org/blas/) libraries not found.
Directories to search for the libraries can be specified in the
numpy/distutils/site.cfg file (section [blas]) or by setting
the BLAS environment variable.
warnings.warn(BlasNotFoundError.doc)
running develop
running build_scripts
running egg_info
running build_src
build_src
building library "libsvm-skl" sources
building library "cblas" sources
building extension "sklearn.__check_build._check_build" sources
building extension "sklearn.cluster._dbscan_inner" sources
building extension "sklearn.cluster._hierarchical" sources
building extension "sklearn.cluster._k_means_elkan" sources
building extension "sklearn.cluster._k_means" sources
building extension "sklearn.datasets._svmlight_format" sources
building extension "sklearn.decomposition._online_lda" sources
building extension "sklearn.decomposition.cdnmf_fast" sources
building extension "sklearn.ensemble._gradient_boosting" sources
building extension "sklearn.feature_extraction._hashing" sources
building extension "sklearn.manifold._utils" sources
building extension "sklearn.manifold._barnes_hut_tsne" sources
building extension "sklearn.metrics.pairwise_fast" sources
building extension "sklearn.metrics/cluster.expected_mutual_info_fast" sources
building extension "sklearn.neighbors.ball_tree" sources
building extension "sklearn.neighbors.kd_tree" sources
building extension "sklearn.neighbors.dist_metrics" sources
building extension "sklearn.neighbors.typedefs" sources
building extension "sklearn.tree._tree" sources
building extension "sklearn.tree._splitter" sources
building extension "sklearn.tree._criterion" sources
building extension "sklearn.tree._utils" sources
building extension "sklearn.svm.libsvm" sources
building extension "sklearn.svm.liblinear" sources
building extension "sklearn.svm.libsvm_sparse" sources
building extension "sklearn._isotonic" sources
building extension "sklearn.linear_model.cd_fast" sources
building extension "sklearn.linear_model.sgd_fast" sources
building extension "sklearn.linear_model.sag_fast" sources
building extension "sklearn.utils.sparsetools._traversal" sources
building extension "sklearn.utils.sparsetools._graph_tools" sources
building extension "sklearn.utils.sparsefuncs_fast" sources
building extension "sklearn.utils.arrayfuncs" sources
building extension "sklearn.utils.murmurhash" sources
building extension "sklearn.utils.lgamma" sources
building extension "sklearn.utils.graph_shortest_path" sources
building extension "sklearn.utils.fast_dict" sources
building extension "sklearn.utils.seq_dataset" sources
building extension "sklearn.utils.weight_vector" sources
building extension "sklearn.utils._random" sources
building extension "sklearn.utils._logistic_sigmoid" sources
building data_files sources
build_src: building npy-pkg config files
writing requirements to scikit_learn.egg-info\requires.txt
writing scikit_learn.egg-info\PKG-INFO
writing top-level names to scikit_learn.egg-info\top_level.txt
writing dependency_links to scikit_learn.egg-info\dependency_links.txt
reading manifest file 'scikit_learn.egg-info\SOURCES.txt'
reading manifest template 'MANIFEST.in'
writing manifest file 'scikit_learn.egg-info\SOURCES.txt'
running build_ext
customize MSVCCompiler
Missing compiler_cxx fix for MSVCCompiler
customize MSVCCompiler using build_clib
customize MSVCCompiler
customize MSVCCompiler using build_ext
customize MSVCCompiler
Missing compiler_cxx fix for MSVCCompiler
customize MSVCCompiler using build_ext
building 'sklearn.cluster._k_means_elkan' extension
compiling C sources
cl.exe /c /nologo /Ox /MD /W3 /GS- /DNDEBUG -IC:\Users\Chris\Anaconda\lib\site-packages\numpy\core\include -IC:\Users\Chris\Anaconda\lib\site-packages\numpy\core\include -IC:\Users\Chris\Anaconda\include -IC:\Users\Chris\Anaconda\PC -IC:\Users\Chris\Anaconda\include -IC:\Users\Chris\Anaconda\PC /Tcsklearn\cluster_k_means_elkan.c /Fobuild\temp.win-amd64-2.7\Release\sklearn\cluster_k_means_elkan.obj
Found executable C:\Program Files (x86)\Microsoft Visual Studio 9.0\VC\Bin\amd64\cl.exe
_k_means_elkan.c
c:\users\chris\anaconda\lib\site-packages\numpy\core\include\numpy\npy_1_7_deprecated_api.h(12) : Warning Msg: Using deprecated NumPy API, disable it by #defining NPY_NO_DEPRECATED_API NPY_1_7_API_VERSION
sklearn\cluster_k_means_elkan.c(2259) : warning C4244: '=' : conversion from 'double' to 'float', possible loss of data
sklearn\cluster_k_means_elkan.c(3944) : warning C4244: 'function' : conversion from 'Py_ssize_t' to 'int', possible loss of data
sklearn\cluster_k_means_elkan.c(3944) : warning C4244: 'function' : conversion from 'Py_ssize_t' to 'int', possible loss of data
sklearn\cluster_k_means_elkan.c(4373) : warning C4244: 'function' : conversion from 'Py_ssize_t' to 'int', possible loss of data
sklearn\cluster_k_means_elkan.c(4436) : warning C4244: 'function' : conversion from 'Py_ssize_t' to 'int', possible loss of data
sklearn\cluster_k_means_elkan.c(5050) : warning C4244: 'function' : conversion from 'Py_ssize_t' to 'int', possible loss of data
sklearn\cluster_k_means_elkan.c(5050) : warning C4244: 'function' : conversion from 'Py_ssize_t' to 'int', possible loss of data
sklearn\cluster_k_means_elkan.c(5674) : warning C4244: 'function' : conversion from 'Py_ssize_t' to 'int', possible loss of data
sklearn\cluster_k_means_elkan.c(5674) : warning C4244: 'function' : conversion from 'Py_ssize_t' to 'int', possible loss of data
sklearn\cluster_k_means_elkan.c(6103) : warning C4244: 'function' : conversion from 'Py_ssize_t' to 'int', possible loss of data
sklearn\cluster_k_means_elkan.c(6166) : warning C4244: 'function' : conversion from 'Py_ssize_t' to 'int', possible loss of data
sklearn\cluster_k_means_elkan.c(6780) : warning C4244: 'function' : conversion from 'Py_ssize_t' to 'int', possible loss of data
sklearn\cluster_k_means_elkan.c(6780) : warning C4244: 'function' : conversion from 'Py_ssize_t' to 'int', possible loss of data
sklearn\cluster_k_means_elkan.c(18452) : error C2275: 'PyGILState_STATE' : illegal use of this type as an expression
C:\Users\Chris\Anaconda\include\pystate.h(137) : see declaration of 'PyGILState_STATE'
sklearn\cluster_k_means_elkan.c(18452) : error C2146: syntax error : missing ';' before identifier '__pyx_gilstate_save'
sklearn\cluster_k_means_elkan.c(18452) : error C2065: '__pyx_gilstate_save' : undeclared identifier
sklearn\cluster_k_means_elkan.c(18523) : error C2065: '__pyx_gilstate_save' : undeclared identifier
sklearn\cluster_k_means_elkan.c(18549) : error C2275: 'PyGILState_STATE' : illegal use of this type as an expression
C:\Users\Chris\Anaconda\include\pystate.h(137) : see declaration of 'PyGILState_STATE'
sklearn\cluster_k_means_elkan.c(18549) : error C2146: syntax error : missing ';' before identifier '__pyx_gilstate_save'
sklearn\cluster_k_means_elkan.c(18549) : error C2065: '__pyx_gilstate_save' : undeclared identifier
sklearn\cluster_k_means_elkan.c(18622) : error C2065: '__pyx_gilstate_save' : undeclared identifier
sklearn\cluster_k_means_elkan.c(18649) : error C2275: 'PyGILState_STATE' : illegal use of this type as an expression
C:\Users\Chris\Anaconda\include\pystate.h(137) : see declaration of 'PyGILState_STATE'
sklearn\cluster_k_means_elkan.c(18649) : error C2146: syntax error : missing ';' before identifier '__pyx_gilstate_save'
sklearn\cluster_k_means_elkan.c(18649) : error C2065: '__pyx_gilstate_save' : undeclared identifier
sklearn\cluster_k_means_elkan.c(18739) : error C2065: '__pyx_gilstate_save' : undeclared identifier
sklearn\cluster_k_means_elkan.c(19406) : error C2275: 'PyGILState_STATE' : illegal use of this type as an expression
C:\Users\Chris\Anaconda\include\pystate.h(137) : see declaration of 'PyGILState_STATE'
sklearn\cluster_k_means_elkan.c(19406) : error C2146: syntax error : missing ';' before identifier '__pyx_gilstate_save'
sklearn\cluster_k_means_elkan.c(19406) : error C2065: '__pyx_gilstate_save' : undeclared identifier
sklearn\cluster_k_means_elkan.c(19432) : error C2065: '__pyx_gilstate_save' : undeclared identifier
sklearn\cluster_k_means_elkan.c(21154) : warning C4305: '=' : truncation from 'double' to 'float'
sklearn\cluster_k_means_elkan.c(21184) : warning C4305: '=' : truncation from 'double' to 'float'
error: Command "cl.exe /c /nologo /Ox /MD /W3 /GS- /DNDEBUG -IC:\Users\Chris\Anaconda\lib\site-packages\numpy\core\include -IC:\Users\Chris\Anaconda\lib\site-packages\numpy\core\include -IC:\Users\Chris\Anaconda\include -IC:\Users\Chris\Anaconda\PC -IC:\Users\Chris\Anaconda\include -IC:\Users\Chris\Anaconda\PC /Tcsklearn\cluster_k_means_elkan.c /Fobuild\temp.win-amd64-2.7\Release\sklearn\cluster_k_means_elkan.obj" failed with exit status 2
Am I missing something obvious?
Thanks