antillean commented on Sep 25, 2014
Given
import numpy as np
from sklearn.linear_model import LogisticRegression

X = np.random.randn(50,20)
Y = np.random.randn(50,2)

log_reg = LogisticRegression()
log_reg.fit(X,Y)
Expected
A successful model fit.
Actual
Scikit-learn complains about the shape of the response. It seems that it's expecting it to be one-dimensional.
ValueError                                Traceback (most recent call last)
<ipython-input-18-c7c4912c4a75> in <module>()
      3 
      4 log_reg = LogisticRegression()
----> 5 log_reg.fit(X,Y)

.../lib/python2.7/site-packages/sklearn/svm/base.pyc in fit(self, X, y)
    672         """
    673         self._enc = LabelEncoder()
--> 674         y_ind = self._enc.fit_transform(y)
    675         if len(self.classes_) < 2:
    676             raise ValueError("The number of classes has to be greater than"

.../lib/python2.7/site-packages/sklearn/preprocessing/label.pyc in fit_transform(self, y)
    123         y : array-like of shape [n_samples]
    124         """
--> 125         y = column_or_1d(y, warn=True)
    126         _check_numpy_unicode_bug(y)
    127         self.classes_, y = np.unique(y, return_inverse=True)

.../lib/python2.7/site-packages/sklearn/utils/validation.pyc in column_or_1d(y, warn)
    317         return np.ravel(y)
    318 
--> 319     raise ValueError("bad input shape {0}".format(shape))
    320 
    321 

ValueError: bad input shape (50, 2)