ksun91 commented on Aug 6, 2018 â€¢
edited
Description
A TyperError is thrown when utilizing the n_jobs parameter when using cross_val_score
Steps/Code to Reproduce
from keras.wrappers.scikit_learn import KerasClassifier
from sklearn.model_selection import cross_val_score
from keras.models import Sequential
from keras.layers import Dense
def build_classifier():
    classifier = Sequential()
    classifier.add(Dense(units = 6, kernel_initializer = 'uniform', activation = 'relu', input_dim = 11))
    classifier.add(Dense(units = 6, kernel_initializer = 'uniform', activation = 'relu'))
    classifier.add(Dense(units = 1, kernel_initializer = 'uniform', activation = 'sigmoid'))
    classifier.compile(optimizer = 'adam', loss = 'binary_crossentropy', metrics = ['accuracy'])
    return classifier
classifier = KerasClassifier(build_fn = build_classifier, batch_size = 10, epochs = 100)
accuracies = cross_val_score(estimator = classifier, X = X_train, y = y_train, cv = 10, n_jobs = -1)
Expected Results
Expect my ANN to run multiple epochs at a time in parallel
Actual Results
File "", line 99, in
accuracies = cross_val_score(estimator = classifier, X = X_train, y = y_train, cv = 10, n_jobs = -1)
File "/Users/kevinsun/anaconda3/lib/python3.6/site-packages/sklearn/model_selection/_validation.py", line 342, in cross_val_score
pre_dispatch=pre_dispatch)
File "/Users/kevinsun/anaconda3/lib/python3.6/site-packages/sklearn/model_selection/_validation.py", line 206, in cross_validate
for train, test in cv.split(X, y, groups))
File "/Users/kevinsun/anaconda3/lib/python3.6/site-packages/sklearn/externals/joblib/parallel.py", line 749, in call
n_jobs = self._initialize_backend()
File "/Users/kevinsun/anaconda3/lib/python3.6/site-packages/sklearn/externals/joblib/parallel.py", line 547, in _initialize_backend
**self._backend_args)
File "/Users/kevinsun/anaconda3/lib/python3.6/site-packages/sklearn/externals/joblib/_parallel_backends.py", line 298, in configure
n_jobs = self.effective_n_jobs(n_jobs)
File "/Users/kevinsun/anaconda3/lib/python3.6/site-packages/sklearn/externals/joblib/_parallel_backends.py", line 294, in effective_n_jobs
return super(MultiprocessingBackend, self).effective_n_jobs(n_jobs)
TypeError: super(type, obj): obj must be an instance or subtype of type
Versions
Darwin-17.7.0-x86_64-i386-64bit
Python 3.6.6 |Anaconda custom (64-bit)| (default, Jun 28 2018, 11:07:29)
[GCC 4.2.1 Compatible Clang 4.0.1 (tags/RELEASE_401/final)]
NumPy 1.15.0
SciPy 1.1.0
Scikit-Learn 0.19.2
MacOS High Sierra Version 10.13.6