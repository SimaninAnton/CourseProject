Member
ogrisel commented on Feb 17, 2011
Here is a report I received by anonymous private mail:
https://github.com/scikit-learn/scikit-learn/blob/master/scikits/learn/cluster/k_means_.py
Line 176:
175        elif hasattr(init, '__array__'):
176            centers = np.asanyarray(init).copy()
177        elif callable(init):
You take predefined centers as an optional initialization method. You
copy them directly into the kmeans, but you don't account for the fact
that the X data has already been centered on line 167:
167    X -= Xmean
Also, when you return the centers, you make sure to add xmean back:
208    return best_centers + Xmean, best_labels, best_inertia
This seems like a bug, but I could be wrong in some very subtle way.
The obvious fix for this would be to replace line 176 with this:
centers = np.asanyarray(init).copy() - Xmean