Dropping extra check_array calls in sparse_encode