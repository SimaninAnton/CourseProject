Member
fabianp commented on Oct 19, 2015
Contrary to what is said on the documentation, it does not seem like GaussianProcess allows to specify initialization parameters theta0, thetaL, thetaU to have shape (n_features,). Here is a minimal reproducing example:
import numpy as np
from sklearn import gaussian_process

X = np.random.randn(10, 2)
y = np.random.randn(10)
n_samples, n_features = X.shape

# this works
clf = gaussian_process.GaussianProcess(
    theta0=1.,
    thetaL=1.,
    thetaU=1.)
clf.fit(X, y)

# this raises an exception
clf = gaussian_process.GaussianProcess(
theta0 = np.ones(n_features),
thetaL = np.ones(n_features),
thetaU = np.ones(n_features)
)
clf.fit(X, y)
This ends with the following exception:
Traceback (most recent call last):
  File "t.py", line 18, in <module>
    clf.fit(X, y)
  File "/Users/fabian/dev/scikit-learn/sklearn/gaussian_process/gaussian_process.py", line 340, in fit
    self._arg_max_reduced_likelihood_function()
  File "/Users/fabian/dev/scikit-learn/sklearn/gaussian_process/gaussian_process.py", line 732, in _arg_max_reduced_likelihood_function
    iprint=0)
  File "/Users/fabian/dev/scipy/scipy/optimize/cobyla.py", line 172, in fmin_cobyla
    **opts)
  File "/Users/fabian/dev/scipy/scipy/optimize/cobyla.py", line 239, in _minimize_cobyla
    f = c['fun'](x0, *c['args'])
  File "/Users/fabian/dev/scikit-learn/sklearn/gaussian_process/gaussian_process.py", line 709, in <lambda>
    log10t[i] - np.log10(self.thetaL[0, i]))
IndexError: index 1 is out of bounds for axis 0 with size 1