Contributor
srivatsan-ramesh commented on Oct 10, 2016
Description
I tried to use PCA with default configuration on MNIST dataset, It gave memory allocation error. The code given below worked well in the previous version of scikit-learn(0.17). The PCA class chooses the randomised svd solver for this dataset, whereas in the previous version it was just svd_solver='full'. If I give explicitly svd_solver='full', it works fine, but when I leave it to find the best solver it chooses randomized svd solver and the code gives memory allocation error when it tries to calculate linalg.lu() using Scipy.
Steps/Code to Reproduce
from sklearn.model_selection import train_test_split
from sklearn.datasets import fetch_mldata
from sklearn.decomposition import PCA

mnist = fetch_mldata('MNIST original', data_home='./data')
X_train, X_test, y_train, y_test = train_test_split(mnist.data, mnist.target, test_size=0.3, random_state=0)

pca = PCA(n_components=100)
pca.fit_transform(X_train)
Error
Python(17010,0x7fffa552c3c0) malloc: *** mach_vm_map(size=18446744066138652672) failed (error code=3)
*** error: can't allocate region
*** set a breakpoint in malloc_error_break to debug
Versions
Darwin-16.0.0-x86_64-i386-64bit
[GCC 4.2.1 (Apple Inc. build 5666) (dot 3)]
NumPy 1.11.2
SciPy 0.18.1
Scikit-Learn 0.18