Contributor
kingjr commented on Jun 1, 2014
Hi,
I am trying to use make_scorer with a probabilistic output from an SVC, but the clf outputs 2 probabilities (1 for each class) and thus leads to an error.
Any advice?
from sklearn.svm import SVC
from sklearn.metrics import make_scorer, roc_auc_score
from numpy.random import random

X = random((50,1000))
y = [0]*25+[1]*25

# works
clf = SVC(C=1, kernel='linear')
clf.fit(X, y)
scorer = make_scorer(roc_auc_score)
scorer(clf, X, y)

# does't work
clf = SVC(C=1, kernel='linear', probability=True)
clf.fit(X, y)
scorer = make_scorer(roc_auc_score, needs_proba=True)
scorer(clf, X, y)
Thanks !