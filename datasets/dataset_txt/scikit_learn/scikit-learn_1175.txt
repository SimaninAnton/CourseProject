imatiach-msft commented on Aug 9, 2018
Description
KMeans currently densifies the centroids even if the original input matrix was sparse. It seems it should instead keep the format of the original input dataset.
Now, whether you should be running kmeans on high dimensional sparse data is another question - usually you should try to avoid it; due to curse of dimensionality the clusters may not be meaningful and it's usually better to use dimensionality reduction like PCA beforehand. Regardless, if you do run on even moderately sparse data and the centroids are sparse it doesn't make sense to convert the centroids to dense format.
Steps/Code to Reproduce
run kmeans on sparse matrix and retrieve the centroids - it is dense
Expected Results
The centroids should be the same format as the input matrix - or they should be densified only if the data is truly dense
Actual Results
The centroids returned are a numpy array
Versions
Windows-10-10.0.17134-SP0
Python 3.6.6 |Anaconda, Inc.| (default, Jun 28 2018, 11:27:44) [MSC v.1900 64 bit (AMD64)]
NumPy 1.15.0