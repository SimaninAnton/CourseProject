elDan101 commented on Oct 19, 2019 •
edited
Description
1
The NearestNeighbors with settings algorithm="ball_tree", metric="sqeuclidean" raises an error
ValueError: Metric 'sqeuclidean' not valid. Use sorted(sklearn.neighbors.VALID_METRICS['ball_tree']) to get valid options. Metric can also be a callable function.
The documentation, however, states:
Valid values for metric are:
from scikit-learn: [‘cityblock’, ‘cosine’, ‘euclidean’, ‘l1’, ‘l2’, ‘manhattan’]
from scipy.spatial.distance: [‘braycurtis’, ‘canberra’, ‘chebyshev’, ‘correlation’, ‘dice’,
‘hamming’, ‘jaccard’, ‘kulsinski’, ‘mahalanobis’, ‘minkowski’, ‘rogerstanimoto’, ‘russellrao’,
‘seuclidean’, ‘sokalmichener’, ‘sokalsneath’, ‘sqeuclidean’, ‘yule’]
2
After looking at sklearn.neighbors.VALID_METRICS['ball_tree'] I realised there is no sqeuclidean, so I changed the metric to seuclidean, but also this errors.
sklearn/neighbors/binary_tree.pxi in sklearn.neighbors.ball_tree.BinaryTree.__init__()

sklearn/neighbors/dist_metrics.pyx in sklearn.neighbors.dist_metrics.DistanceMetric.get_metric()

sklearn/neighbors/dist_metrics.pyx in sklearn.neighbors.dist_metrics.SEuclideanDistance.__init__()

TypeError: __init__() takes exactly 1 positional argument (0 given)
This error is also raised when setting the metric directly to BallTree (included in code)
Steps/Code to Reproduce
import sklearn.neighbors as nn
import numpy as np

X = np.random.rand(100, 100)  # example data

# First part (errors with ValueError: Metric 'sqeuclidean' not valid.)
nn_obj = nn.NearestNeighbors(radius=100, algorithm="ball_tree", metric="sqeuclidean")
nn_obj = nn_obj.fit(X)
distance_matrix = nn_obj.radius_neighbors_graph(mode="distance")

# Second part (errors with incorrect __init__ when setting to seuclidean)

### Both this and ...
nn_obj = nn.NearestNeighbors(radius=100, algorithm="ball_tree", metric="seuclidean")
nn_obj.fit(X)
distance_matrix = nn_obj.radius_neighbors_graph(mode="distance") 

### ... this
nn.BallTree(X, metric="seuclidean")
Expected Results
According to the documentation, both seuclidean (BallTree and NearestNeighbors) and sqeuclidean (NearestNeighbors) are valid metrics.
Versions
System:
    python: 3.6.8 (default, Oct  7 2019, 12:59:55)  [GCC 8.3.0]
executable: /usr/bin/python3
   machine: Linux-5.0.0-31-generic-x86_64-with-LinuxMint-19.2-tina

Python deps:
       pip: 9.0.1
setuptools: 41.2.0
   sklearn: 0.21.3
     numpy: 1.17.3
     scipy: 1.3.1
    Cython: 0.29.10
    pandas: 0.25.1