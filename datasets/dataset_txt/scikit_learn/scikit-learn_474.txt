bfelbo commented on Jun 8, 2019
Description
RFE is unable to find the 3 informative features using a simple linear SVM classifier despite the SVM classifier getting ~99% accuracy. Am I missing something or is there a bug with the feature selection or with make_classification()?
According to the docs, the 3 informative features from make_classification() should be in the first three columns.
Steps/Code to Reproduce
import numpy as np
from sklearn.datasets import make_classification
from sklearn.feature_selection import RFE
from sklearn.svm import SVC
from sklearn.model_selection import cross_val_score

X, y = make_classification(n_samples=5000, n_features=10,
                           n_informative=3, n_redundant=0, n_repeated=0,
                           n_classes=2, class_sep=3, flip_y=0.0)
clf = SVC(kernel="linear")
print("Accuracy: ", np.mean(cross_val_score(clf, X, y, scoring="accuracy")))
selector = RFE(clf, 3)
selector = selector.fit(X, y)
print(selector.support_)
print(selector.ranking_)
Expected Results
Accuracy:  0.9881988766729713
[True True True False False False  False False False False]
[1 1 1 ...]
Actual Results
Accuracy:  0.9881988766729713
[False  True False False False False  True False  True False]
[3 1 6 7 4 5 1 2 1 8]
Versions
System:
    python: 3.7.3 (default, Mar 27 2019, 09:23:15)  [Clang 10.0.1 (clang-1001.0.46.3)]
executable: /usr/local/opt/python/bin/python3.7
   machine: Darwin-18.2.0-x86_64-i386-64bit

BLAS:
    macros: NO_ATLAS_INFO=3, HAVE_CBLAS=None
  lib_dirs: 
cblas_libs: cblas

Python deps:
       pip: 19.0.3
setuptools: 40.8.0
   sklearn: 0.21.2
     numpy: 1.15.3
     scipy: 1.3.0
    Cython: None
    pandas: None