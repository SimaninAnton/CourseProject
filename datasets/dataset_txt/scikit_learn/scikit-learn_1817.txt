crawles commented on Oct 19, 2017
Description
Unicode feature names makes the decision tree plot incorrect.
If you replace
features = [u'{}'.format(c) for c in indep_var]
with
features = ['{}'.format(c) for c in indep_var]
the issue is resolved. It's due to the u
Steps/Code to Reproduce
# in jupyter notebook
%matplotlib inline
import sklearn
import matplotlib
import pydot
import seaborn as sns

from IPython.display import Image
from sklearn.externals.six import StringIO
from sklearn.tree import export_graphviz
from sklearn.tree import DecisionTreeClassifier

df = sns.load_dataset('titanic')

dep_var = 'survived'
id_var = ['pclass', 'sex']
indep_var = ['age', 'sibsp', 'parch', 'fare']

# tree
tree = DecisionTreeClassifier(max_depth=2)
tree.fit(df[indep_var].fillna(-9999), df[dep_var]) 

features = [u'{}'.format(c) for c in indep_var]
# viz
dot_data = StringIO()  
export_graphviz(tree, out_file=dot_data,  
                    feature_names=features,
#                     class_names=tree.classes_,  
#                     filled=True, rounded=True,  
                    special_characters=True)
graph = pydot.graph_from_dot_data(dot_data.getvalue())[0]  
Image(graph.create_png())  
Expected Results
Actual Results
Versions
Darwin-16.6.0-x86_64-i386-64bit
('Python', '2.7.12 |Anaconda custom (x86_64)| (default, Jul 2 2016, 17:43:17) \n[GCC 4.2.1 (Based on Apple Inc. build 5658) (LLVM build 2336.11.00)]')
('NumPy', '1.13.1')
('SciPy', '0.19.1')
('Scikit-Learn', '0.19.0')
('Matplotlib', '2.0.2')