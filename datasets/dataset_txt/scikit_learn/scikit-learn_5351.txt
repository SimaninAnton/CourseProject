chrivo commented on May 29, 2012
I tried to train a HMM with the codebelow. The call to fit threw an exception and complained that the transition probabilities probabilities didn't summed to one. After some debuging I saw that the call to _hmmc._forward resulted in NANs in the forward-lattice, which where (i think) caused by the zeros in the initial transmat. I temporarily solved the problem by setting the zeros to 1e-6 and renormalized transmat before calling fit. I guess a check for NANs would help here.
import numpy as np
from sklearn.hmm import GaussianHMM
startprob = np.array([1,0,0,0,0])
transmat = np.array([[0.9,0.1,0,0,0],
[0,0.9,0.1,0,0],
[0,0,0.9,0.1,0],
[0,0,0,0.9,0.1],
[0,0,0,0,1.0]])
hmm = GaussianHMM(n_components=5,
covariance_type='full',
startprob=startprob,
transmat=transmat)
hmm.means_ = np.zeros((5,10))
hmm.covars_ = np.tile(np.identity(10), (5, 1, 1))
obs = [hmm.sample(10)[0] for _ in range(10)]
hmm.fit(obs=obs, n_iter=100, init_params='st')