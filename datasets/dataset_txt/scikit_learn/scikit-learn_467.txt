amjass12 commented on Jun 12, 2019
Hi all,
I was wondering if you could help with an issue I am having plotting a confusion matrix. I am not sure if this is a bug as I cant see why this should be happening.
I have trained a neural network in keras. I am able to plot a confusion matrix as follows:
cm = confusion_matrix(y_train[:,0:6].argmax(axis=1), modelPred[:,0:6].argmax(axis=1))
This produces a 6x6 array and works fine (the data are subset as this is a binary problem, but again there is no issue here)
However, when I input a brand new dataset for testing, I create the one hot matrix as above but for the new data set and carry out the model.predict on the new data.
This works fine however when I now go to construct the CM, one column is missed out and I am unsure about why this is happening. Any help would be appreciated as this is really frustrating!
Code on new data:
cm = confusion_matrix(y_trainNew[:,0:6].argmax(axis=1), modelPredNew[:,0:6].argmax(axis=1))
For some reason now one column is missed out and I get a 5x5 matrix (screenshot attached). Subsetting to 6:18 etc... messes up the data and doesn't subset 12 columns but 11, again, missing one out. this is really confusing!
One thing I will add, is that the new data has the same labels as the original training data... but as you can see the correct age is predicted (its just that that is the only age in the new data). Therefore all other age one-hot data are 0's. I dont believe this should cause a problem?
Thank you for your time.