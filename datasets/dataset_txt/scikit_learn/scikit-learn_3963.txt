Contributor
artsobolev commented on Mar 17, 2015
A recent issue indicated a flaw in many of sklearn's tests: there are many places where arrays are compared using assert_array_equal which does not take float's lack of precision into account.
Sometimes, though, we might expect a tested functionality to return exactly the same value â€” when checking, say, predict. It seems legitimate to use strict comparison in those cases.
Even though apparently this is not a problem at the moment (at least no one filed a bunch of bug reports like the one I mentioned), we might want to do something with it. Some of the possible fixes are:
Redefine assert_array_equal to use approximate comparison in case of floating data type. Might break guarantees like "predict returns the same values that were passed in y".
Replace assert_array_equal with assert_array_almost_equal when appropriate. This is a huge body of work, there are at least 229 tests that compare float arrays using assert_array_equal.
Ignore it until somebody files an issue. Tests pass right now, so we're good :-)