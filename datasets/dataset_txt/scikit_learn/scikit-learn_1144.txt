MohammedPUD commented on Aug 22, 2018
Hello,
When a large dataset is clustered using KMeans, the homogeneity score metric is returning nan value. However, the problem is not related to the size of the data, as I have tested data with larger sizes with no problems of what so ever. The warning "RuntimeWarning: invalid value ncountered in log log_outer = -np.log(outer) + log(pi.sum()) + log(pj.sum())" is also displayed before the nan value is returned. The clustering is achieved using the following code:
kmeans = KMeans(init='k-means++', n_clusters=15, n_init=10)
ff=kmeans.fit_predict(x)
metrics.homogeneity_score(y,ff)
I have double checked the actual and predicted values, where all the values are limited to integers between zero and 14. Moreover, I started a loop to calculate the homogeneity score for incrementing slices from the actual and predicted values in order to figure out the position where the error starts to occur. The values at that position are absolutely normal and similar to many values prior to it.
Is it a bug or am I doing something wrong?
Thank you