Imorton-zd commented on Aug 31, 2016 â€¢
edited by TomDLT
    trainDocs,trainLabels = readfile(r'train', 700)
    testDocs,testLabels = readfile(r'test', 200)

    count_vect = CountVectorizer()
    X_train_counts = count_vect.fit_transform(trainDocs)

    tfidf_transformer = TfidfTransformer()
    X_train_tfidf = tfidf_transformer.fit_transform(X_train_counts)
    X_train_array = X_train_tfidf.toarray()

    X_test_counts = count_vect.transform(testDocs)
    X_test_tfidf = tfidf_transformer.transform(X_test_counts)
    X_test_array = X_test_tfidf.toarray()

    clf = SGDClassifier(loss = 'hinge',penalty = 'elasticnet',alpha = 1e-3,n_iter = 10, random_state = 40)

    clf.fit(X_train_tfidf,np.array(trainLabels))
    predicted = clf.predict(X_test_tfidf)
    acc_tfidf = np.mean(predicted == np.array(testLabels))

    clf.fit(X_train_array,np.array(trainLabels))
    predicted = clf.predict(X_test_array)
    acc_array = np.mean(predicted == np.array(testLabels))
Output:
acc_tfidf = 0.57
acc_array = 0.47
Why this happens? What is the actual input of these classifiers such as SGDClassifier? Many Thanks