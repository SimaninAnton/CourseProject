Snowball0823 commented on Jul 14, 2018 â€¢
edited
Description
There have errors when I use pip to install sklearn,so then I use source code to install,but there still have errors when I use cython to compile sklearn
My environment:
macOS 10.11.6
python 3.7.0
Python 0.28.4
scikit-learn 0.19.1
The first compile errors
[ 1/40] Cythonizing _sklearn/__check_build/_check_build.pyx
[ 2/40] Cythonizing sklearn/_isotonic.pyx
[ 3/40] Cythonizing sklearn/cluster/_dbscan_inner.pyx
[ 4/40] Cythonizing sklearn/cluster/_hierarchical.pyx
[ 5/40] Cythonizing sklearn/cluster/_k_means.pyx
[ 6/40] Cythonizing sklearn/cluster/_k_means_elkan.pyx
[ 7/40] Cythonizing sklearn/datasets/_svmlight_format.pyx
[ 8/40] Cythonizing sklearn/decomposition/_online_lda.pyx
[ 9/40] Cythonizing sklearn/decomposition/cdnmf_fast.pyx
[10/40] Cythonizing sklearn/ensemble/_gradient_boosting.pyx
[11/40] Cythonizing sklearn/feature_extraction/_hashing.pyx
[12/40] Cythonizing sklearn/linear_model/cd_fast.pyx
[13/40] Cythonizing sklearn/linear_model/sag_fast.pyx
[14/40] Cythonizing sklearn/linear_model/sgd_fast.pyx
[15/40] Cythonizing sklearn/manifold/_barnes_hut_tsne.pyx
[16/40] Cythonizing sklearn/manifold/_utils.pyx
[17/40] Cythonizing sklearn/metrics/cluster/expected_mutual_info_fast.pyx
Error compiling Cython file:
------------------------------------------------------------
...
# cython: cdivision=True
^
------------------------------------------------------------
sklearn/metrics/cluster/expected_mutual_info_fast.pyx:1:0: 'sklearn.metrics/cluster.expected_mutual_info_fast' is not a valid module name
Traceback (most recent call last):
File "setup.py", line 269, in
setup_package()
File "setup.py", line 265, in setup_package
setup(**metadata)
File "/Volumes/Win-and-Mac/Python-Virtual/Haker/lib/python3.7/site-packages/numpy/distutils/core.py", line 135, in setup
config = configuration()
File "setup.py", line 135, in configuration
config.add_subpackage('sklearn')
File "/Volumes/Win-and-Mac/Python-Virtual/Haker/lib/python3.7/site-packages/numpy/distutils/misc_util.py", line 1024, in add_subpackage
caller_level = 2)
File "/Volumes/Win-and-Mac/Python-Virtual/Haker/lib/python3.7/site-packages/numpy/distutils/misc_util.py", line 993, in get_subpackage
caller_level = caller_level + 1)
File "/Volumes/Win-and-Mac/Python-Virtual/Haker/lib/python3.7/site-packages/numpy/distutils/misc_util.py", line 930, in _get_configuration_from_setup_py
config = setup_module.configuration(*args)
File "sklearn/setup.py", line 82, in configuration
maybe_cythonize_extensions(top_path, config)
File "/Volumes/Win-and-Mac/Python-Virtual/scikit-learn-0.19.1/sklearn/_build_utils/init.py", line 84, in maybe_cythonize_extensions
config.ext_modules = cythonize(config.ext_modules)
File "/Volumes/Win-and-Mac/Python-Virtual/Haker/lib/python3.7/site-packages/Cython/Build/Dependencies.py", line 1026, in cythonize
cythonize_one(*args)
File "/Volumes/Win-and-Mac/Python-Virtual/Haker/lib/python3.7/site-packages/Cython/Build/Dependencies.py", line 1146, in cythonize_one
raise CompileError(None, pyx_file)
Cython.Compiler.Errors.CompileError: sklearn/metrics/cluster/expected_mutual_info_fast.pyx
Expected Results
Compiling sklearn/metrics/pairwise_fast.pyx because it changed.
Compiling sklearn/neighbors/ball_tree.pyx because it changed.
Compiling sklearn/neighbors/kd_tree.pyx because it changed.
Compiling sklearn/neighbors/dist_metrics.pyx because it changed.
Compiling sklearn/neighbors/typedefs.pyx because it changed.
Compiling sklearn/neighbors/quad_tree.pyx because it changed.
Compiling sklearn/tree/_tree.pyx because it changed.
Compiling sklearn/tree/_splitter.pyx because it changed.
Compiling sklearn/tree/_criterion.pyx because it changed.
Compiling sklearn/tree/_utils.pyx because it changed.
Compiling sklearn/svm/libsvm.pyx because it changed.
Compiling sklearn/svm/liblinear.pyx because it changed.
Compiling sklearn/svm/libsvm_sparse.pyx because it changed.
Compiling sklearn/utils/sparsefuncs_fast.pyx because it changed.
Compiling sklearn/utils/arrayfuncs.pyx because it changed.
Compiling sklearn/utils/murmurhash.pyx because it changed.
Compiling sklearn/utils/lgamma.pyx because it changed.
Compiling sklearn/utils/graph_shortest_path.pyx because it changed.
Compiling sklearn/utils/fast_dict.pyx because it changed.
Compiling sklearn/utils/seq_dataset.pyx because it changed.
Compiling sklearn/utils/weight_vector.pyx because it changed.
Compiling sklearn/utils/_random.pyx because it changed.
Compiling sklearn/utils/_logistic_sigmoid.pyx because it changed.
[ 1/23] Cythonizing sklearn/metrics/pairwise_fast.pyx
[ 2/23] Cythonizing sklearn/neighbors/ball_tree.pyx
[ 3/23] Cythonizing sklearn/neighbors/dist_metrics.pyx
[ 4/23] Cythonizing sklearn/neighbors/kd_tree.pyx
[ 5/23] Cythonizing sklearn/neighbors/quad_tree.pyx
[ 6/23] Cythonizing sklearn/neighbors/typedefs.pyx
[ 7/23] Cythonizing sklearn/svm/liblinear.pyx
[ 8/23] Cythonizing sklearn/svm/libsvm.pyx
[ 9/23] Cythonizing sklearn/svm/libsvm_sparse.pyx
[10/23] Cythonizing sklearn/tree/_criterion.pyx
[11/23] Cythonizing sklearn/tree/_splitter.pyx
[12/23] Cythonizing sklearn/tree/_tree.pyx
[13/23] Cythonizing sklearn/tree/_utils.pyx
[14/23] Cythonizing sklearn/utils/_logistic_sigmoid.pyx
[15/23] Cythonizing sklearn/utils/_random.pyx
[16/23] Cythonizing sklearn/utils/arrayfuncs.pyx
[17/23] Cythonizing sklearn/utils/fast_dict.pyx
[18/23] Cythonizing sklearn/utils/graph_shortest_path.pyx
[19/23] Cythonizing sklearn/utils/lgamma.pyx
[20/23] Cythonizing sklearn/utils/murmurhash.pyx
[21/23] Cythonizing sklearn/utils/seq_dataset.pyx
[22/23] Cythonizing sklearn/utils/sparsefuncs_fast.pyx
[23/23] Cythonizing sklearn/utils/weight_vector.pyx
running install
running build
.........
running install_egg_info
Removing /Volumes/Win-and-Mac/Python-Virtual/Haker/lib/python3.7/site-packages/scikit_learn-0.19.1-py3.7.egg-info
Writing /Volumes/Win-and-Mac/Python-Virtual/Haker/lib/python3.7/site-packages/scikit_learn-0.19.1-py3.7.egg-info
running install_clib
Soloution
(Use source code to install)
When have the error
1. cd /path/to/scikit-learn-0.19.1
2. cython sklearn/metrics/cluster/expected_mutual_info_fast.pyx
3. python setup.py install
Then we can compile it without errors.
(Use pip to install)
pip install git+https://github.com/scikit-learn/scikit-learn
If you have errors like "Found existing installation: scikit-learn 0.19.1
Cannot uninstall 'scikit-learn'. It is a distutils installed project and thus we cannot accurately determine which files belong to it which would lead to only a partial uninstall",you should use the option "pip install --ignore-installed"