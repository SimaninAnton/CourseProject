adrien-pain-01 commented on Apr 9, 2015

Upgrading scikit-learn from 0.15.2 to 0.16.0 (using Anaconda3 under ubuntu 14.04 64-bits) leads in a performance drop on a project i'm working on, using RandomForests.
sklearn-0.15.2 : running in 44.17 sec. 20.235 sec spent in sklearn/ensemble/forest.py:477(predict_proba)
sklearn-0.16.0 : running in 80.27 sec. 49.902 sec spent in sklearn/ensemble/forest.py:477(predict_proba)
Both runs used same input-data and same sklearn pipeline :
-> MinMaxScaler(copy=True, feature_range=(-1, 1))
-> RandomForestClassifier(bootstrap=True, class_weight=None, criterion='gini', max_depth=None,
max_features='auto', max_leaf_nodes=None, min_samples_leaf=1,
min_samples_split=2, min_weight_fraction_leaf=0.0, n_estimators=500,
n_jobs=1, oob_score=False, random_state=42, verbose=False,
warm_start=False)
}
Please note that I specified n_jobs=1 for both runs.
The times shown above are given by a predict() loop over all test-datas (820 call to pipeline.predict_proba(), each using the same RandomForest with 500 estimators).
It seems that the performance drop comes from multiprocessing (externals/joblib ?) but i'm not sure.
I've cProfiled the runs, but it seems I can only attach image files (PNG, JPG, ...)
How can I join the binary dumps from cProfile ? Is it relevant for you to investigate ?
Thanks.