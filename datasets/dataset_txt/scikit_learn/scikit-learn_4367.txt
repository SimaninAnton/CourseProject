chrisspen commented on Jun 7, 2014
I'm unable to save and load serialized classifier instances using the joblib dependency.
import os
import tempfile
from sklearn.ensemble import RandomForestClassifier
from sklearn.externals import joblib

from data import load_training_data

c = RandomForestClassifier()
c.fit(load_training_data())

# Save
_, fn = tempfile.mkstemp()
joblib.dump(c, fn, compress=9)
fin = open(fn, 'rb')
c_serialized = b64encode(fin.read())
fin.close()
os.remove(fn)

# Load
_, fn = tempfile.mkstemp()
fout = open(fn, 'wb')
fout.write(b64decode(c_serialized))
fout.close()
obj = joblib.load(fn)
os.remove(fn)
But running this throws an exception when I try and unserialize the data returned by joblib.
    obj = joblib.load(fn)
  File "/usr/local/project/.env/local/lib/python2.7/site-packages/sklearn/externals/joblib/numpy_pickle.py", line 424, in load
    obj = unpickler.load()
  File "/usr/lib/python2.7/pickle.py", line 858, in load
    dispatch[key](self)
  File "/usr/local/project/.env/local/lib/python2.7/site-packages/sklearn/externals/joblib/numpy_pickle.py", line 293, in load_build
    array = nd_array_wrapper.read(self)
  File "/usr/local/project/.env/local/lib/python2.7/site-packages/sklearn/externals/joblib/numpy_pickle.py", line 159, in read
    data = read_zfile(open(filename, 'rb'))
IOError: [Errno 2] No such file or directory: '/tmp/tmpGOpTA__01.npy.z'
It's unclear if the fault lies with joblib, sklearn's classifier implementation, or my own use of either. Why does the deserialization attempt to read a non-existent tmp file?
I'm using package versions:
joblib==0.8.0a3
scikit-learn==0.14.1