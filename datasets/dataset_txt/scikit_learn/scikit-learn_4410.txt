Contributor
mvdoc commented on May 18, 2014
Hi,
when running some simulations I found out that if the connectivity matrix is too sparse, ward_tree fails with an IndexError. It works fine with a different connectivity matrix.
---------------------------------------------------------------------------
IndexError                                Traceback (most recent call last)
<ipython-input-44-fdfab3cceda7> in <module>()
----> 1 out = ward_tree(X, connectivity)

/usr/lib/python2.7/dist-packages/sklearn/cluster/hierarchical.pyc in ward_tree(X, connectivity, n_components, copy, n_clusters)
    167         # identify the merge
    168         while True:
--> 169             inert, i, j = heappop(inertia)
    170             if used_node[i] and used_node[j]:
    171                 break

IndexError: index out of range
See this notebook for the simulation code: http://nbviewer.ipython.org/github/mvdoc/notebooks/blob/master/ward_tree_failing.ipynb