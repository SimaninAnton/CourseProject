duartedenio commented on Apr 18, 2017 â€¢
edited
Description
When y_true and y_pred are matrix (multi-target), mean_squared_error fails becasue it calculates the mean over the mean.
First, output_errors is assigned with all target squared difference and then the mean is calculated.
If the parameters multioutput is equal to 'uniform_average' (default), the funcion calculates the average over output_errors, and it is not corretc. It should just sum them up.
I'm afraid that this problem is spread all over to the other multi-target regression metrics.
Steps/Code to Reproduce
Example:
import numpy as np
from sklearn.metrics import mean_squared_error as msqe
y=np.array([[1,2,6],[2,1,4],[3,2,1]])
y_pred=np.array([[1.3,1.5,5],[2.3,1.1,4],[3,2.5,1.3]])
print(msqe(y,y_pred)) ## outputs 0.1978
print(msqe(y,y_pred,multioutput='raw_values')) ## outputs [ 0.06      ,  0.17      ,  0.36333333]
print(msqe(y,y_pred,multioutput='raw_values').sum()) ## outputs 0.5933

import spotpy as sp ## another statistic library
print(sp.objectivefunctions.mse(y,y_pred)) ## outputs 0.5933