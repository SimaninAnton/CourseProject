Member
jnothman commented on Jul 27, 2016 â€¢
edited
As raised by @staubda in #6877, sklearn.utils.random.sample_without_replacement with its variants implemented in Cython, can be very slow. Indeed _sample_without_replacement_with_tracking_selection may be slower than a pure Python implementation.
Currently the slowness appears to derive from using a Python wrapper to numpy.random.RandomState.randint and using Python sets.
One solution may indeed be reverting to a native Python implementation. A more native C implementation is another option. Using numpy's permutation method directly, or otherwise avoiding _sample_without_replacement_with_tracking_selection. Benchmarks needed in any case.