discrete branch: quantile and kmeans strategies