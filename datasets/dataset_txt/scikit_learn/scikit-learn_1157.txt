whalebot-helmsman commented on Aug 17, 2018
Description
sklearn.metrics.adjusted_mutual_info_score returns nan on some inputs
Steps/Code to Reproduce
import sklearn.metrics as M
print(M.adjusted_mutual_info_score([1,0,1],[1,0,1]))
print(M.adjusted_mutual_info_score([1,0],[1,0]))
Expected Results
1.0 printed two times on screen
Actual Results
1.0
/home/nikita/ves/dsc-tipevo-full-3.6/lib/python3.6/site-packages/sklearn/metrics/cluster/supervised.py:703: RuntimeWarning: invalid value encountered in double_scalars
  ami = (mi - emi) / (max(h_true, h_pred) - emi)
nan
Versions
Linux-4.4.0-96-generic-x86_64-with-debian-jessie-sid
Python 3.6.3 (default, Jun 4 2018, 10:24:41)
[GCC 4.8.4]
NumPy 1.13.3
SciPy 1.0.0
Scikit-Learn 0.19.0