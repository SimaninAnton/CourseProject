ivdorelian commented on Oct 24, 2016 â€¢
edited
Description
I am trying to write a wrapper for a classifier object that will do some preprocessing on X and y before calling the classifier's fit and predict methods. When applying a random search using this wrapper, the parameters are not set right.
Steps/Code to Reproduce
Example:
http://pastebin.com/p76V8v0C
My actual code is longer and does more in CLFWrapper, but this does reproduce the issue.
Expected Results
No error, complete the random search.
Actual Results
See: http://pastebin.com/bjDgYfyS
How is eta0 ever possibly equal to zero?!
Note: if I run the program multiple times without doing any change, usually after I restart the IPython Notebook (or not even that if I use Eclipse, just click the run button multiple times), sometimes it finishes. Here is a print after it finished:
[Parallel(n_jobs=16)]: Done 18 tasks | elapsed: 0.3s
[Parallel(n_jobs=16)]: Done 1000 out of 1000 | elapsed: 3.7s finished
Out[1]:
RandomizedSearchCV(cv=10, error_score='raise',
estimator=Pipeline(steps=[('clf', CLFWrapper(estimator=SGDClassifier(alpha=0.0001, average=False, class_weight=None, epsilon=0.1,
eta0=0.0, fit_intercept=True, l1_ratio=0.15,
learning_rate='optimal', loss='hinge', n_iter=5, n_jobs=1,
penalty='l2', power_t=0.5, random_state=None, shuffle=True,
verbose=0, warm_start=False)))]),
fit_params={}, iid=True, n_iter=100, n_jobs=16,
param_distributions={'clf__estimator__loss': ['hinge', 'log', 'modified_huber', 'squared_hinge', 'perceptron'], 'clf__estimator__penalty': ['none', 'l2', 'l1', 'elasticnet'], 'clf__estimator__eta0': [0.01, 0.05, 0.1, 0.2, 0.3, 0.4, 0.5, 1], 'clf__estimator__fit_intercept': [True, False], 'clf__estim...imator__power_t': [0, 0.5], 'clf__estimator__epsilon': [0, 1, 2], 'clf__estimator__n_iter': [5, 10]},
pre_dispatch='2*n_jobs', random_state=None, refit=False,
return_train_score=True, scoring='accuracy', verbose=1)
How is eta0 still equal to 0.0?
It appears as if only some of the parameters get set. If not would get set, it shouldn't give that error with everything on default. If only some get set, why only some?
How can I get my wrapper to work?
Versions
Linux-4.4.0-45-generic-x86_64-with-Ubuntu-16.04-xenial
Python 3.5.2 (default, Sep 10 2016, 08:21:44)
[GCC 5.4.0 20160609]
NumPy 1.11.2
SciPy 0.18.1
Scikit-Learn 0.18