using sparse matrix in fit_params