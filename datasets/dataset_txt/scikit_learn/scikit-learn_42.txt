vnmabus commented 29 days ago
The parameter tol is referred in the documentation as tolerance with respect to inertia:
scikit-learn/sklearn/cluster/_kmeans.py
Line 685 in b194674
         Relative tolerance with regards to inertia to declare convergence. 
However the tolerance was never measured against the difference in inertia, but as against the Frobenius norm of the difference in the cluster centers.
scikit-learn/sklearn/cluster/_kmeans.py
Lines 442 to 443 in b194674
 center_shift_total = squared_norm(centers_old - centers) 
 if center_shift_total <= tol: 
Either the documentation is wrong here or the check for convergence is wrong.