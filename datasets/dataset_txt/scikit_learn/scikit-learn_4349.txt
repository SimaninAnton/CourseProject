Member
MechCoder commented on Jun 25, 2014
Hi,
Either I am understanding the behaviour of StratifiedKFold wrong. I'm facing this while testing the Log Reg CV PR.
For example:
>>> import numpy as np
>>> from sklearn.cross_validation import StratifiedKFold
>>> y = np.random.permutation(np.tile([0, 1, 2], 4))
>>> folds = StratifiedKFold(y, 3)
>>> y
array([1, 2, 2, 0, 0, 1, 1, 1, 0, 2, 2, 0])

>>> for train, test in folds:
...     print y[train], y[test]
[1 1 0 2 2 0] [1 2 2 0 0 1]
[1 2 2 0 0 1 1 2 0] [1 0 2]
[1 2 2 0 0 1 1 0 2] [1 2 0]
which is as expected as 0, 1, 2 have a percentage of 50% in each of the folds. However when I do this.
>>> y[y == 0] = 1
>>> folds = StratifiedKFold(y, 3)
>>> for train, test in folds:
...     print y[train], y[test]     
[1 1 1 1 2 2 1] [1 2 2 1 1]
[1 2 2 1 1 1 2 1] [1 1 1 2]
[1 2 2 1 1 1 1 1 2] [1 2 1]
where the percentage of 1 and 2 is clearly not the same across all folds, when there is clearly a better alternative.
Can someone help out?