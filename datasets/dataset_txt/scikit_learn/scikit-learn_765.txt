mariolovric commented on Jan 28, 2019
Following https://stackoverflow.com/questions/54398353/sklearn-rfecv-inconsistent-results-for-feature-selection
Description
RFECV inconsistent in returning selected features
Steps/Code to Reproduce
from sklearn.datasets import make_regression
from sklearn.feature_selection import RFECV
from sklearn.model_selection import train_test_split
from sklearn.ensemble import RandomForestRegressor
CREATE ONCE
X,y=make_regression(n_samples=700, n_features=50, n_informative=10, n_targets=1, bias=0.9, random_state=None)
TEST SEVERAL TIMES
X_train, X_test, y_train, y_test = train_test_split(X,
y, test_size=0.2, random_state=42)
selector = RFECV(RandomForestRegressor(), min_features_to_select=6,
step=5, cv=5, n_jobs=-1)
selector.fit(X_train ,y_train)
print(sum(selector.support_))
Expected Results
The number 6 should be returned, as I requested 6 features.
Actual Results
If several times executed - sometimes returns 6, sometimes 10.
Versions
System:
python: 3.6.7 |Anaconda, Inc.| (default, Oct 28 2018, 19:44:12) [MSC v.1915 64 bit (AMD64)]
executable: C:\Users\user\AppData\Local\Continuum\anaconda3\envs\chemenv\python.exe
machine: Windows-10-10.0.17134-SP0
BLAS:
macros: SCIPY_MKL_H=None, HAVE_CBLAS=None
lib_dirs: C:/Users/user/AppData/Local/Continuum/anaconda3/envs/chemenv\Library\lib
cblas_libs: mkl_rt
Python deps:
pip: 18.1
setuptools: 40.6.2
sklearn: 0.20.1
numpy: 1.15.4
scipy: 1.1.0
Cython: None
pandas: 0.23.4