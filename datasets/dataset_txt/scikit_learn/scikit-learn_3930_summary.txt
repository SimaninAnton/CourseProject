array must not contain infs or NaNs