Contributor
shoyer commented on Oct 8, 2014
I recently made the extremely frustrating discovery that this method yields references to a single array, which is modified in-place as each element is yielded. For example,
predictions = np.array(list(est.staged_predict(x[:, np.newaxis])))
returns a 2D arrays with all elements fixed along the first axis (even if the staged predictions are different).
I understand why mutation may be desirable for performance reasons, but from the perspective of someone trying to use staged prediction to understand my model, I found this very surprising. I thought there was something wrong with how I was using gradient boosting.
At a minimum, this should be clearly documented, but if for some good reason this behavior cannot be changed, my preferred resolution would be to add a backwards compatible keyword argument such as copy=False or inplace=True so that this unintuitive behavior is clearly called out in the method signature. Thoughts?