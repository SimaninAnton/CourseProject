dianacrem commented on Jan 22, 2018
Description
Running RidgeClassifier on some sparse data coming from the CountVectorizer on small documents, but many fails when run with class_weight='balanced', but converges without any class_weight.
Steps/Code to Reproduce
vect = CountVectorizer(...)
vect.fit(X_tr)
X_tr = vect.transform(X_tr)
X_valid = vect.transform(X_valid)
clf=RidgeClassifier(solver='sag', max_iter=1500, class_weight='balanced')
clf.fit(X_tr)
pred= clf.predict(X_valid)
It fails at clf.fit(X_tr) saying that over/under flow in training and that I should use a scaler for my data. I did that too, with a Standard Scaler (with_mean=False) because it is sparse data, but it still fails with the same error.
This show on the screen all over again.
Exception ignored in: 'sklearn.linear_model.sag_fast.raise_infinite_error'
ValueError: Floating-point under-/overflow occurred at epoch #911. Lowering the step_size or scaling the input data with StandardScaler or MinMaxScaler might help.
ValueError: Floating-point under-/overflow occurred at epoch #911. Lowering the step_size or scaling the input data with StandardScaler or MinMaxScaler might help.
Exception ignored in: 'sklearn.linear_model.sag_fast.raise_infinite_error'
ValueError: Floating-point under-/overflow occurred at epoch #911. Lowering the step_size or scaling the input data with StandardScaler or MinMaxScaler might help.
ValueError: Floating-point under-/overflow occurred at epoch #911. Lowering the step_size or scaling the input data with StandardScaler or MinMaxScaler might help.
Versions
import platform; print(platform.platform())
Linux-3.10.0-514.26.1.el7.x86_64-x86_64-with-redhat-7.3-Nitrogen
import sys; print("Python", sys.version)
Python 3.6.3 |Anaconda, Inc.| (default, Nov 20 2017, 20:41:42)
[GCC 7.2.0]
import numpy; print("NumPy", numpy.version)
NumPy 1.13.3
import scipy; print("SciPy", scipy.version)
SciPy 1.0.0
import sklearn; print("Scikit-Learn", sklearn.version)
Scikit-Learn 0.19.1