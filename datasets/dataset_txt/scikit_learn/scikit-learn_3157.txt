Member
GaelVaroquaux commented on Feb 23, 2016
This is the error message that I am getting when building the dev version of scikit-learn on a system where Cython is not present. It's quite unclear to the user what the problem is (issue raised by a "real user", aka not me).
[lg237277@gabriel scikit-learn-master]$ python setup.py install --user
Partial import of sklearn during the build process.
Generating cython files
Cythonizing sources
sklearn
Processing sklearn/_isotonic.pyx
'import site' failed; use -v for traceback
Traceback (most recent call last):
  File "/usr/bin/cython", line 5, in <module>
    from pkg_resources import load_entry_point
ImportError: No module named pkg_resources
Traceback (most recent call last):
  File "/home/lg237277/.local/lib/python2.7/site-packages/scikit-learn-master/bu
ild_tools/cythonize.py", line 198, in <module>
    main(root_dir_arg)
  File "/home/lg237277/.local/lib/python2.7/site-packages/scikit-learn-master/bu
ild_tools/cythonize.py", line 190, in main
    check_and_cythonize(root_dir)
  File "/home/lg237277/.local/lib/python2.7/site-packages/scikit-learn-master/bu
ild_tools/cythonize.py", line 182, in check_and_cythonize
    cythonize_if_unchanged(cur_dir, cython_file, gen_file, hashes)
  File "/home/lg237277/.local/lib/python2.7/site-packages/scikit-learn-master/bu
ild_tools/cythonize.py", line 156, in cythonize_if_unchanged
    cythonize(full_cython_path, full_gen_file_path)
  File "/home/lg237277/.local/lib/python2.7/site-packages/scikit-learn-master/bu
ild_tools/cythonize.py", line 75, in cythonize
    raise Exception('Cythonizing %s failed' % cython_file)
Exception: Cythonizing sklearn/_isotonic.pyx failed
Traceback (most recent call last):
  File "setup.py", line 297, in <module>
    setup_package()
  File "setup.py", line 280, in setup_package
    generate_cython()
  File "setup.py", line 185, in generate_cython
    raise RuntimeError("Running cythonize failed!")
RuntimeError: Running cythonize failed!
The specific case of Cython absent (aka an 'import Cython' not working) should be captured and a nice error message raised (while still printing the original ImportError of Cython to facilitate debugging).