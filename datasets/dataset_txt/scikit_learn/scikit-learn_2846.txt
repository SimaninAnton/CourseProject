muzaluisa commented on Aug 15, 2016 ‚Ä¢
edited by TomDLT
Hello,
When I make Non-negative matrix factorization with sparse matrix input, I got the following error:
File "/share/apps/anaconda/4.0.0-python2.7/lib/python2.7/site-packages/sklearn/decomposition/nmf.py", line 1047, in fit_transform
self.reconstruction_err_ = _safe_compute_error(X, W, H)
File "/share/apps/anaconda/4.0.0-python2.7/lib/python2.7/site-packages/sklearn/decomposition/nmf.py", line 77, in _safe_compute_error
error = sqrt(norm_X + norm_WH - 2. * cross_prod)
ValueError: math domain error
With my own data, I can not reproduce the same error. However the usage can be approximated with the following code:
from __future__  import division
from sklearn.decomposition import NMF as nmf
import numpy as np
import os,re
from scipy import sparse as sp

X = np.random.rand(100,1000)
X  = sp.csr_matrix(X)
rp = nmf(n_components = 10, tol = 0.01)
Xtr = rp.fit_transform(X)
My specifications are:
Platform Linux-3.13.0-91-generic-x86_64-with-debian-jessie-sid
Python version 2.7.11 |Anaconda 4.0.0 (64-bit)| (default, Dec 6 2015, 18:08:32)
[GCC 4.4.7 20120313 (Red Hat 4.4.7-1)]
Numpy version 1.10.4
Scipy version 0.17.0
SKlearn version 0.17.1
Do you think that it could be caused by the norm calculation?
Cheers,
Luiza
üëç 2