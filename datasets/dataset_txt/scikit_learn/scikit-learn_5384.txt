Member
amueller commented on Apr 25, 2012
When using "predict" on k-means or minibatch k-means with a non-float X, the results are wrong.
Just wasted an hour trying to cluster colors :-/
Looks like an memory allocation issue as it works with integer types of the same size as float (I think).
What fails is:
import numpy as np

from sklearn.cluster import KMeans

X = np.random.normal(size=(40, 2))
X = (X * 10).astype(np.uint8)

km = KMeans(n_init=1).fit(X)
assert((km.labels_ == km.predict(X)).all())