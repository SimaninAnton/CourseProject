Freakwill commented on Sep 11, 2019 â€¢
edited
Do we need post-processing, the preprocessing method for Y (not for X).
Description
Is there some method, preprocessing for y (the output variable)? We have had preprocessing methods for X, applied in piplines. Sometimes we may need it for Y, for example in the regression problem Y = a exp(b X), we need trasform Y = log Y, before doing linear regression.
Code
I define a function (decorator) for the purpose, but is there some native method in scikit or more natively defined by scikit?
class LogTransformer(FunctionTransformer):
    func = np.log
    inverse_func = np.exp

def postproc(model, fty=LogTransformer()):
    new = copy.deepcopy(model)
    new.fty = fty

    def fit(self, X, Y):
        Y = self.fty.transform(Y)
        return model.fit(X, Y)

    new.fit = types.MethodType(fit, new)

    def predict(self, X):
        Y = model.predict(X)
        return self.fty.inverse_transform(Y)

    new.predict = types.MethodType(predict, new)
    return new