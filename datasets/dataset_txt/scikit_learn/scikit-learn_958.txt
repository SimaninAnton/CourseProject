mllobera commented on Nov 1, 2018
Description
Jupyter notebook constantly resets kernel when calculating weighted kernel density.
Steps/Code to Reproduce
When using kde.score_samples() after fitting the following kernel density
from sklearn.neighbors import KernelDensity
kde = KernelDensity(bandwidth = 200.0, algorithm='ball_tree', rtol= 0.00001)
kde.fit(xy_train, sample_weight= weights)
Z = np.exp(kde.score_samples(xy_sample))
where xy_train is a (2305, 2) array that with values similar to these:
array([[ 532001.29, 4385540.06],
       [ 531893.31, 4385561.15],
       [ 531910.92, 4385576.09],
       [ 531859.94, 4385575.44],
       [ 531872.15, 4385569.72]
       ...])
weights corresponds to a (2305,) array with values like these:
array([6.31807554e-04, 9.40258066e-05, 1.18105586e-04, 4.34582692e-04,
       2.01811487e-04]... )
and xy_sample is a (1076420, 2) array with values similar to xy_train.
the kernel of the jupyter notebook seems to be constantly resetting. Computation never completes.
I ran the exact same code without the ' sample_weight' parameter and works fine.
Expected Results
Actual Results
None are obtained
Versions
Result after running
sklearn.show_versions()  
Could not locate executable g77
Could not locate executable f77
Could not locate executable ifort
Could not locate executable ifl
Could not locate executable f90
Could not locate executable DF
Could not locate executable efl
Could not locate executable gfortran
Could not locate executable f95
Could not locate executable g95
Could not locate executable efort
Could not locate executable efc
Could not locate executable flang
don't know how to compile Fortran code on platform 'nt'
System
python: 3.6.6 |Anaconda, Inc.| (default, Jun 28 2018, 11:27:44) [MSC v.1900 64 bit (AMD64)]
executable: C:\Python\Miniconda3\envs\leiap\python.exe
machine: Windows-10-10.0.17134-SP0
BLAS
macros: 
lib_dirs:
cblas_libs: cblas
Python deps
   pip: 10.0.1
setuptools: 40.4.3
sklearn: 0.20.0
numpy: 1.15.2
scipy: 1.1.0
Cython: None
pandas: 0.23.4