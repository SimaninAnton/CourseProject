Contributor
venkyyuvy commented on Aug 31, 2019 â€¢
edited
Description
RidgeClassifierCV is not working when scoring param is fed and cv!=None.
It is similar to the issue mentioned here, where cv==None meaning loo approach for cv.
In the notes, it is mentioned as,
For multi-class classification, n_class classifiers are trained in a one-versus-all approach. Concretely, this is implemented by taking advantage of the multi-variate response support in Ridge.
since we are supporting different scoring option, I feel this to be a bug.
The issue is here it calls the Ridge() even for classification problem.
The class _BaseRidgeCV(LinearModel, MultiOutputMixin) is supposed to support both regression and classification.
Steps/Code to Reproduce
from sklearn.datasets import load_iris
from sklearn.linear_model import RidgeClassifierCV

X, y = load_iris(return_X_y=True)
ridgeClfCV = RidgeClassifierCV(cv=5, scoring='accuracy')
ridgeClfCV.fit(X, y)
Expected Results
No error is thrown
Actual Results
ValueError: Classification metrics can't handle a mix of multilabel-indicator and continuous-multioutput targets
Versions
System:
python: 3.7.3
executable: XXXContinuum\anaconda3\python.exe
machine: Windows-10
Python deps:
pip: 19.0.3
setuptools: 41.1.0
sklearn: 0.21.3
numpy: 1.17.0
scipy: 1.3.1
Cython: 0.29.6
pandas: 0.25.0