sudarshan1413 commented on Aug 27, 2017
Description
I asked question on SO, I want to store tree threshold in numpy float32 format for it to be compatible with JPMML elevator.
We raised issue on PMML : issue 6, the author says that sklearn should use float32 instead of double.
Can anyone suggest any workaround or fix to solve this issue.
Steps/Code to Reproduce
from sklearn import datasets
import pandas as pd
#import sklearn2pmml
from sklearn.ensemble import IsolationForest
import numpy as np
import pickle
#from sklearn2pmml import PMMLPipeline

data = datasets.load_boston()
df = pd.DataFrame(data.data,columns=data.feature_names)
clf = IsolationForest(n_estimators=1)
clf.fit(df)

i_tree = 0
for tree in clf.estimators_:
    pickle.dump(tree,open('bostontree_' + str(i_tree) + '.pickle', 'wb'))
    i_tree = i_tree + 1

nd= tree.tree_.threshold
print(tree.tree_.threshold[:4])
print(nd.dtype)

import numpy
a = tree.tree_.threshold[:4][-1] 
print(type(a))
print(numpy.float32(a))
# It shows precision loss while converting to the float32 format.
Expected Results
It should store tree threshold in float32 format.
Actual Results
It shows the float64 tree threshold.
Versions
0.18