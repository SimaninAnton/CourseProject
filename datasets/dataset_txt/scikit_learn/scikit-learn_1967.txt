zengxy commented on Aug 16, 2017
I'm dealing with some alghrithms with DecisionTreeRegressor and I foung that DecisionTreeRegressor with sample_weitght will fail to get right result in some case.
See following code:
# data
data = np.arange(1, 21).reshape(-1, 1)
label  = np.array([-1.5]*5 + [3.]*2 + [-1.5] + [3]*2 + [-1.5]*5 + [3]*2 + [-1.5] + [3]*2 )

# model
dt = DecisionTreeRegressor(max_depth=1)
# weight_1
w1 = np.full(20, 0.222222)
# weight_2
w2 = np.full(20, 0.2222222222)

# fit and predict
df.fit(data, label).predict(data)
## result: array([-0.3, -0.3, -0.3, -0.3, -0.3, -0.3, -0.3, -0.3, -0.3, -0.3, -0.3,
       -0.3, -0.3, -0.3, -0.3,  2.1,  2.1,  2.1,  2.1,  2.1])

dt.fit(data, label, sample_weight=w1).predict(data)
## result: array([-1.5, -1.5, -1.5, -1.5, -1.5,  0.9,  0.9,  0.9,  0.9,  0.9,  0.9,
        0.9,  0.9,  0.9,  0.9,  0.9,  0.9,  0.9,  0.9,  0.9])

dt.fit(data, label, sample_weight=w2).predict(data)
## result: >>> dt.fit(data, label, sample_weight=w2).predict(data)
array([-0.3, -0.3, -0.3, -0.3, -0.3, -0.3, -0.3, -0.3, -0.3, -0.3, -0.3,
       -0.3, -0.3, -0.3, -0.3,  2.1,  2.1,  2.1,  2.1,  2.1])
As you can see, when i change sample_weight, it got different results. While they should be same because sample_weight is none or same weight.
So could you tell me if I got something wrong or there are bugs?