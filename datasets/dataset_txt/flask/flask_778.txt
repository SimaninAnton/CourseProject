rafaelcapucho commented on 30 Jul 2016
The following view only generate output during the execution on Firefox.
On Chrome the request flush the entire response once, when the while ends, at the end.
What are making the it don't work on Chrome?
@processes.route('/read_buffer/<int:pid>')
def read_buffer(pid):

    def generate():
        sent = 0
        while not settings.buffers[pid]['finished']:
            for i, row in enumerate(settings.buffers[pid]['lines'][sent:]):
                sent += 1
                yield row

            gevent.sleep(0.5)

    return flask.Response(
        response=generate(),
        status=200,
        mimetype="text/plain"
    )
App config:
app = flask.Flask(__name__)
app.config['DEBUG'] = False
app.register_blueprint(processes.processes, url_prefix='/processes')
CORS(app)
socketio = SocketIO(app, async_mode='gevent')
socketio.run(
    app=app,
    host=_config.get('server', 'host', fallback='0.0.0.0'),
    port=_config.getint('server', 'port', fallback=5000),
    use_reloader=False
)
Thank you