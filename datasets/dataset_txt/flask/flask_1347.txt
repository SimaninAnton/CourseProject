nieder commented on 15 Sep 2013
The InstanceTestCase tests fail on OS X when being packaged by an unprivileged user:
/sw/bin/python2.7 run-tests.py || exit 2
........................................................................................................................F..FF.....................................................................................................
======================================================================
FAIL: test_main_module_paths (flask.testsuite.config.InstanceTestCase)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/sw/build.build/flask-py27-0.10.1-1/Flask-0.10.1/flask/testsuite/config.py", line 155, in test_main_module_paths
    self.assert_equal(app.instance_path, os.path.join(here, 'instance'))
  File "/sw/build.build/flask-py27-0.10.1-1/Flask-0.10.1/flask/testsuite/__init__.py", line 139, in assert_equal
    return self.assertEqual(x, y)
AssertionError: '/sw/var/run-tests-instance' != '/sw/build.build/flask-py27-0.10.1-1/Flask-0.10.1/instance'

======================================================================
FAIL: test_uninstalled_module_paths (flask.testsuite.config.InstanceTestCase)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/sw/build.build/flask-py27-0.10.1-1/Flask-0.10.1/flask/testsuite/config.py", line 162, in test_uninstalled_module_paths
    self.assert_equal(app.instance_path, os.path.join(here, 'test_apps', 'instance'))
  File "/sw/build.build/flask-py27-0.10.1-1/Flask-0.10.1/flask/testsuite/__init__.py", line 139, in assert_equal
    return self.assertEqual(x, y)
AssertionError: '/sw/var/config_module_app-instance' != '/sw/build.build/flask-py27-0.10.1-1/Flask-0.10.1/flask/testsuite/test_apps/instance'

======================================================================
FAIL: test_uninstalled_package_paths (flask.testsuite.config.InstanceTestCase)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/sw/build.build/flask-py27-0.10.1-1/Flask-0.10.1/flask/testsuite/config.py", line 167, in test_uninstalled_package_paths
    self.assert_equal(app.instance_path, os.path.join(here, 'test_apps', 'instance'))
  File "/sw/build.build/flask-py27-0.10.1-1/Flask-0.10.1/flask/testsuite/__init__.py", line 139, in assert_equal
    return self.assertEqual(x, y)
AssertionError: '/sw/var/config_package_app-instance' != '/sw/build.build/flask-py27-0.10.1-1/Flask-0.10.1/flask/testsuite/test_apps/instance'

----------------------------------------------------------------------
Ran 226 tests in 1.038s

FAILED (failures=3)
I'm packaging flask for use in the Fink project (an OS X package manager). We use an unprivileged user to build and assemble a package before installation. The above three tests fail during our build process. If I build and test flask as a normal user, the tests pass, so it seems that there is some incorrect assumption being made somewhere about what the environment should be. '/sw' is our prefix. '/sw/build.build' is the sandboxed build root.