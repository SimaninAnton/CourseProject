gabbard commented on 30 Aug 2018
Expected Behavior
When a chained exception is thrown, the full exception chain should be logged.
from flask import Flask

app = Flask(__name__)


def do_something():
  raise ValueError("Foo")


@app.route('/exception_test', methods=['GET', 'POST'])
def process():
  try:
    do_something()
  except Exception as e:
    raise ValueError("Wrapper") from e

if __name__ == '__main__':
  app.debug = True
  app.config['PROPAGATE_EXCEPTIONS'] = True
  app.run(debug=True)
Then wget http://127.0.0.1:5000/exception_test
Actual Behavior
Instead only the exception at the "end of the chain" is logged:
127.0.0.1 - - [29/Aug/2018 17:18:56] "GET /exception_test HTTP/1.1" 500 -
Traceback (most recent call last):
  File "/Users/gabbard/anaconda3/envs/gaia-alternatives/lib/python3.6/site-packages/flask/app.py", line 2309, in __call__
    return self.wsgi_app(environ, start_response)
  File "/Users/gabbard/anaconda3/envs/gaia-alternatives/lib/python3.6/site-packages/flask/app.py", line 2295, in wsgi_app
    response = self.handle_exception(e)
  File "/Users/gabbard/anaconda3/envs/gaia-alternatives/lib/python3.6/site-packages/flask/app.py", line 1741, in handle_exception
    reraise(exc_type, exc_value, tb)
  File "/Users/gabbard/anaconda3/envs/gaia-alternatives/lib/python3.6/site-packages/flask/_compat.py", line 35, in reraise
    raise value
  File "/Users/gabbard/anaconda3/envs/gaia-alternatives/lib/python3.6/site-packages/flask/app.py", line 2292, in wsgi_app
    response = self.full_dispatch_request()
  File "/Users/gabbard/anaconda3/envs/gaia-alternatives/lib/python3.6/site-packages/flask/app.py", line 1815, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/Users/gabbard/anaconda3/envs/gaia-alternatives/lib/python3.6/site-packages/flask/app.py", line 1718, in handle_user_exception
    reraise(exc_type, exc_value, tb)
  File "/Users/gabbard/anaconda3/envs/gaia-alternatives/lib/python3.6/site-packages/flask/_compat.py", line 35, in reraise
    raise value
  File "/Users/gabbard/anaconda3/envs/gaia-alternatives/lib/python3.6/site-packages/flask/app.py", line 1813, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/gabbard/anaconda3/envs/gaia-alternatives/lib/python3.6/site-packages/flask/app.py", line 1799, in dispatch_request
    return self.view_functions[rule.endpoint](**req.view_args)
  File "/Users/gabbard/projects/gaia/gaia-alternatives/repos/vista-nlp-jvm/vista_nlp_serialization/chained_exception_mcve.py", line 22, in process
    raise ValueError("Wrapper") from e
ValueError: Wrapper
The same problem appears in the HTML stack traces.
This problem was also mentioned by @mscheper in this comment
Environment
Python version: 3.6
Flask version: 1.0.2
Werkzeug version: 0.14.1