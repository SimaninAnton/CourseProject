01walid commented on 23 Oct 2014
Hi,
First, read this: "why use www" if you didn't already...
The problem
having many blueprints, with only some blueprints having subdomain value set to a given subdomain, the rest of the blueprints should serve the root domain name (with the consideration of www)
examples:
static blueprint set to serve static.example.com
dashboard blueprint set to serve dashboard.example.com
other blueprints, like users, frontend, messages, ..etc do not have subdomain set, and should serve www.example.com (assuming example.com auto redirect to www.example.com)
Setting SERVER_NAME to example.com wouldn't automatically handle the www part, and requires setting www as the subdomain of the rest of the blueprints, which I find it redundant and error prone.
Setting SERVER_NAME to www.example.com will cause other subdomain blueprints to generate static.www.example.com and dashboard.www.example.com which is not what you would expect.
I tried using app.url_map.default_subdomain = 'www' but it had no effect at all (did I miss anything else?)
As a workaround, I was forced to use this:
def configure_blueprints(app, blueprints):
    for blueprint in blueprints:
        if not blueprint.subdomain:
            blueprint.subdomain = 'www'
        app.register_blueprint(blueprint)
Suggested solution
www is a special subdomain and should be treated a bit differently and in a more explicit manner.
add DEFAULT_SUBDOMAIN or WWW or something similar to Flask's set of config variables/flags beside SERVER_NAME (which should be noted in documentation that SERVER_NAME should in most of the cases hold the naked domain name.)
when DEFAULT_SUBDOMAIN = 'www' # for instance or WWW = True, blueprints subdomain defaults to the given value.
extras
We would also add FORCE_WWW = Boolean, and when set to True would redirect the naked domain to its www one. Or make the subdomain param accept an array of value in case one would serve the same content via the naked and the non naked version of their domain name (e.g. example.com and www.example.com would serve the same set of their related blueprints.)
These are just some suggestions, I might be wrong or missing something, and if it's the case, please inform me.
Related issues to take into consideration: #998, #905, #821 .