oliviercperrier commented on 13 Nov 2019 •
edited
I am calling an endpoint i made to update a customer. When passing my json body i get a 400 Bad request. Seems like a json body that contains accent characters is not parsed correctly by the request object.
So this is the json body im sending to my endpoint:
{
  "last_name": "Gélinas"
}
Expected Behavior
The get_json fonction should not return a 400 Bad Request
request.get_json(force=True)
The request.data should not remove the last } from the body when it contains accent character
request.data
# Should contain : "b'{\\n \"last_name\": \"G\\xc3\\xa9linas\"\\n}'"
Actual Behavior
When reaching the endpoint, i am using the request object provided by flask to retrieve the body like so:
request.get_json(force=True)
But with this code, i am getting a 400 Bad Request error. So i try using raw data instead like so:
request.data
I found out the request.data contains:
"b'{\\n \"last_name\": \"G\\xc3\\xa9linas\"\\n'"
As you can see, there is a missing } at the end which brakes any call to json.loads function
Environment
Python version: 3.7.4
Flask version: 1.1.1
Werkzeug version: 0.16.0