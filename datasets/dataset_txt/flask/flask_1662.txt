Contributor
remyroy commented on 31 Mar 2011
When trying to use Module.after_app_request, it causes the following exception:
Traceback (most recent call last):
  File "/Users/remyroy/VirtualEnvs/issueproject/lib/python2.6/site-packages/flask/app.py", line 889, in __call__
    return self.wsgi_app(environ, start_response)
  File "/Users/remyroy/VirtualEnvs/issueproject/lib/python2.6/site-packages/flask/app.py", line 883, in wsgi_app
    response = self.make_response(self.handle_exception(e))
  File "/Users/remyroy/VirtualEnvs/issueproject/lib/python2.6/site-packages/flask/app.py", line 881, in wsgi_app
    response = self.process_response(response)
  File "/Users/remyroy/VirtualEnvs/issueproject/lib/python2.6/site-packages/flask/app.py", line 796, in process_response
    response = handler(response)
TypeError: after_request() takes no arguments (1 given)
Steps to reproduce:
Create a new folder issueproject.
Create a file called issueproject.py in that folder with the following content:
   # -_\- coding: utf-8 -_-
   from flask import Flask
   from issueproject.views import views

app = Flask(**name**)

app.config.from_object('issueproject.config.Config')
app.register_module(views)

if **name** == "**main**":
    app.run()
Create a sub folder issueproject.
Add a file called views.py in that sub folder with the following content:
# -*- coding: utf-8 -*-
from flask import Module
views = Module(__name__)

@views.after_app_request
def after_request():
    pass

@views.route('/')
def index():
    return 'hello world'
Add a file called config.py in that sub folder with the following content:
   # -_\- coding: utf-8 -_-

class Config(object):
    DEBUG = True
    TESTING = False
Run the main issueproject.py with the following command line:
python issueproject.py
Navigate to http://localhost:5000/ .
See the exception.
Here is the pip freeze from my environment:
Flask==0.6.1
Jinja2==2.5.5
PyRSS2Gen==1.0.0
Twisted==8.2.0
Werkzeug==0.6.2
altgraph==0.6.8.dev
bdist-mpkg==0.4.3.dev
bonjour-py==0.3
decorator==3.2.1
jsonrpc==0.01
macholib==1.2.1.dev
mercurial==1.8
modulegraph==0.7.2.dev
numpy==1.2.1
py==1.4.2
py2app==0.4.2
pyOpenSSL==0.7
pyobjc-core==2.2b3
pyobjc-framework-AddressBook==2.2b3
pyobjc-framework-AppleScriptKit==2.2b3
pyobjc-framework-Automator==2.2b3
pyobjc-framework-CFNetwork==2.2b3
pyobjc-framework-CalendarStore==2.2b3
pyobjc-framework-Cocoa==2.2b3
pyobjc-framework-Collaboration==2.2b3
pyobjc-framework-CoreData==2.2b3
pyobjc-framework-CoreText==2.2b3
pyobjc-framework-DictionaryServices==2.2b3
pyobjc-framework-ExceptionHandling==2.2b3
pyobjc-framework-FSEvents==2.2b3
pyobjc-framework-InputMethodKit==2.2b3
pyobjc-framework-InstallerPlugins==2.2b3
pyobjc-framework-InstantMessage==2.2b3
pyobjc-framework-InterfaceBuilderKit==2.2b3
pyobjc-framework-LatentSemanticMapping==2.2b3
pyobjc-framework-LaunchServices==2.2b3
pyobjc-framework-Message==2.2b3
pyobjc-framework-PreferencePanes==2.2b3
pyobjc-framework-PubSub==2.2b3
pyobjc-framework-QTKit==2.2b3
pyobjc-framework-Quartz==2.2b3
pyobjc-framework-ScreenSaver==2.2b3
pyobjc-framework-ScriptingBridge==2.2b3
pyobjc-framework-SearchKit==2.2b3
pyobjc-framework-SyncServices==2.2b3
pyobjc-framework-SystemConfiguration==2.2b3
pyobjc-framework-WebKit==2.2b3
pyobjc-framework-XgridFoundation==2.2b3
pyopencl==0.92
pytest==2.0.2
python-dateutil==1.2
pytools==11
virtualenv==1.5.1
wsgiref==0.1.2
wxPython==2.8.8.1
wxPython-common==2.8.8.1
wxaddons==2.8.8.1
xattr==0.5
zope.interface==3.5.1