rosekunkel commented on 27 May 2019 â€¢
edited
Expected Behavior
url_for should consistently produce urls which are absolute with regard to the server root, i.e., they should start with a /.
app = Flask(__name__, static_url_path='')
url_for('static', filename='some_static_file')
Actual Behavior
When running under gnunicorn with APPLICATION_ROOT='/myapp/', the url_for call produces the URL myapp/some_static_file, while when running under werkzeug with APPLICATION_ROOT='/', the url_for call produces the URL /some_static_file.
This is a problem, because, combined with this werkzeug issue, there's no straightforward way to use url_for in templates for both development and production: {{ url_for('static', filename='some_static_file') }} produces myapp/some_static_file in production, which fails, while /{{ url_for('static', filename='some_static_file') }} produces //some_static_file in development, which fails.
Environment
Python version: 3.6.5
Flask version: 1.0.2
Werkzeug version: 0.14.1