brenwickham commented on 8 Dec 2018 â€¢
edited
Expected Behavior
I put this IF statement in my base.html template:
    {% if "dashboard" in url_for(request.endpoint)  %}
    <script src={{ url_for('static', filename='js/dashboard.js') }}></script>
    {% endif %}
I added an endpoint with a value. For example:
@app.route("/accountmgmt/<int:userid>",methods=["GET","POST"])
@login_required
def accountmgmt(userid):
   ... etc
Actual Behavior
The above code causes a build error, but only when an endpoint has a value (as above).
When I remove the above IF statement from the template, the code does not error. But when it is included, I get this error (I am using the URL: http://127.0.0.1:5000/accountmgmt/123):
Could not build url for endpoint 'accountmgmt'. Did you forget to specify values ['userid']?
File "/Users/brendon/dev/nelliedata/flask/lib/python3.6/site-packages/flask/app.py", line 2309, in __call__
return self.wsgi_app(environ, start_response)
File "/Users/brendon/dev/nelliedata/flask/lib/python3.6/site-packages/flask/app.py", line 2295, in wsgi_app
response = self.handle_exception(e)
File "/Users/brendon/dev/nelliedata/flask/lib/python3.6/site-packages/flask/app.py", line 1741, in handle_exception
reraise(exc_type, exc_value, tb)
File "/Users/brendon/dev/nelliedata/flask/lib/python3.6/site-packages/flask/_compat.py", line 35, in reraise
raise value
File "/Users/brendon/dev/nelliedata/flask/lib/python3.6/site-packages/flask/app.py", line 2292, in wsgi_app
response = self.full_dispatch_request()
File "/Users/brendon/dev/nelliedata/flask/lib/python3.6/site-packages/flask/app.py", line 1815, in full_dispatch_request
rv = self.handle_user_exception(e)
File "/Users/brendon/dev/nelliedata/flask/lib/python3.6/site-packages/flask/app.py", line 1718, in handle_user_exception
reraise(exc_type, exc_value, tb)
File "/Users/brendon/dev/nelliedata/flask/lib/python3.6/site-packages/flask/_compat.py", line 35, in reraise
raise value
File "/Users/brendon/dev/nelliedata/flask/lib/python3.6/site-packages/flask/app.py", line 1813, in full_dispatch_request
rv = self.dispatch_request()
File "/Users/brendon/dev/nelliedata/flask/lib/python3.6/site-packages/flask/app.py", line 1799, in dispatch_request
return self.view_functions[rule.endpoint](**req.view_args)
File "/Users/brendon/dev/nelliedata/flask/lib/python3.6/site-packages/flask_login/utils.py", line 261, in decorated_view
return func(*args, **kwargs)
File "/Users/brendon/dev/nelliedata/nellieapp/routes.py", line 43, in accountmgmt
return render_template("accountmgmt.html",users=userlist, current_user=current_user,title="Nellie Data: Account Management")
File "/Users/brendon/dev/nelliedata/flask/lib/python3.6/site-packages/flask/templating.py", line 135, in render_template
context, ctx.app)
File "/Users/brendon/dev/nelliedata/flask/lib/python3.6/site-packages/flask/templating.py", line 117, in _render
rv = template.render(context)
File "/Users/brendon/dev/nelliedata/flask/lib/python3.6/site-packages/jinja2/asyncsupport.py", line 76, in render
return original_render(self, *args, **kwargs)
File "/Users/brendon/dev/nelliedata/flask/lib/python3.6/site-packages/jinja2/environment.py", line 1008, in render
return self.environment.handle_exception(exc_info, True)
File "/Users/brendon/dev/nelliedata/flask/lib/python3.6/site-packages/jinja2/environment.py", line 780, in handle_exception
reraise(exc_type, exc_value, tb)
File "/Users/brendon/dev/nelliedata/flask/lib/python3.6/site-packages/jinja2/_compat.py", line 37, in reraise
raise value.with_traceback(tb)
File "/Users/brendon/dev/nelliedata/nellieapp/templates/accountmgmt.html", line 1, in top-level template code
{% extends "base.html" %}
File "/Users/brendon/dev/nelliedata/nellieapp/templates/base.html", line 115, in top-level template code
{% if "test" in url_for(request.endpoint)  %}
File "/Users/brendon/dev/nelliedata/flask/lib/python3.6/site-packages/flask/helpers.py", line 356, in url_for
return appctx.app.handle_url_build_error(error, endpoint, values)
File "/Users/brendon/dev/nelliedata/flask/lib/python3.6/site-packages/flask/app.py", line 2061, in handle_url_build_error
reraise(exc_type, exc_value, tb)
File "/Users/brendon/dev/nelliedata/flask/lib/python3.6/site-packages/flask/_compat.py", line 35, in reraise
raise value
File "/Users/brendon/dev/nelliedata/flask/lib/python3.6/site-packages/flask/helpers.py", line 345, in url_for
force_external=external)
File "/Users/brendon/dev/nelliedata/flask/lib/python3.6/site-packages/werkzeug/routing.py", line 1776, in build
raise BuildError(endpoint, values, method, self)
werkzeug.routing.BuildError: Could not build url for endpoint 'accountmgmt'. Did you forget to specify values ['userid']?
Environment
Python version: 3.6.5
Flask version: 1.0.2
Werkzeug version: 0.14.1