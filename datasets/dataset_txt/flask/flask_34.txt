JarryShaw commented on 7 Nov 2019 â€¢
edited
We had implemented a two-in-one backend with Flask. For the website itself (which we call it tekid), we're having no trouble. But for the management portal (which we call it tekid-admin), even though using the same view registries, the WSGI server (both dev and prod) returns 404 NOT FOUND for all requests.
Expected Behavior
NB: tekid and tekid-admin should give the same output
The routes command would give like this:
$ tekid routes
# or
$ tekid-admin routes
Endpoint        Methods            Rule
--------------  -----------------  -----------------------------------
load_contact    GET, POST          /contact/
load_expertise  GET                /expertise/
load_index      GET                /
load_news       GET, POST          /news/
...
static          GET                /static/<path:filename>
We try curl http://127.0.0.1:5000/ after run on the website (tekid):
$ tekid run
 * Environment: development
 * Debug mode: on
 * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
 * Restarting with stat
 * Debugger is active!
 * Debugger PIN: 332-955-135
/fakepath/.venv/lib/python3.7/site-packages/flask/sessions.py:220: UserWarning: The session cookie domain is an IP address. This may not work as intended in some browsers. Add an entry to your hosts file, for example "localhost.localdomain", and use that instead.
  "The session cookie domain is an IP address. This may not work"
127.0.0.1 - - [07/Nov/2019 17:20:03] "GET / HTTP/1.1" 200 -
$ curl http://127.0.0.1:5000
<!--
  _______   _    _____ _____    _     _      _
 |__   __| | |  |_   _|  __ \  | |   | |    | |
    | | ___| | __ | | | |  | | | |   | |_ __| |
    | |/ _ \ |/ / | | | |  | | | |   | __/ _` |
    | |  __/   < _| |_| |__| | | |___| || (_| |_
    |_|\___|_|\_\_____|_____/  |______\__\__,_(_)
-->
... (the actual HTML page)
Actual Behavior
With the same configs as above, we try curl http://127.0.0.1:5000/ after run on the management portal (tekid-admin):
$ tekid-admin run
 * Environment: development
 * Debug mode: on
 * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
 * Restarting with stat
 * Debugger is active!
 * Debugger PIN: ***-***-***
/fakepath/.venv/lib/python3.7/site-packages/flask/sessions.py:220: UserWarning: The session cookie domain is an IP address. This may not work as intended in some browsers. Add an entry to your hosts file, for example "localhost.localdomain", and use that instead.
  "The session cookie domain is an IP address. This may not work"
127.0.0.1 - - [07/Nov/2019 17:06:25] "GET / HTTP/1.1" 404 -
$ curl http://127.0.0.1:5000
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
Environment
Python version: 3.7.4
Flask version: 1.1.1
Werkzeug version: 0.16.0