eliaperantoni commented on 24 Dec 2018
Expected Behavior
The request shouldn't take 65 seconds to complete.
from flask import Flask
app = Flask(__name__)
@app.route("/")
def index():
    return "anything", 204
Actual Behavior
The request takes 65 seconds to complete. According to the logs, uWSGI processes the request in some milliseconds, but somehow nginx hangs for more than a minute when a response with 204 code is provided.
This happens with any WSGI implementation. I've tried it with 2 different versions of uWSGI and Gunicorn. The result is the same.
Environment
Python version: 3.6.7
Flask version: 1.0.2
Werkzeug version: 0.14.1