eugenkiss commented on 1 Aug 2010
The first time the FlaskrTestCase source code is shown the setUp method looks like this:
def setUp(self):
    self.db_fd, flaskr.DATABASE = tempfile.mkstemp()
    self.app = flaskr.app.test_client()
    flaskr.init_db()
Note self.db_fd, flaskr.DATABASE = tempfile.mkstemp()
The second time it looks like this:
def setUp(self):
    self.db_fd, flaskr.app.config['DATABASE'] = tempfile.mkstemp()
    self.app = flaskr.app.test_client()
    flaskr.init_db()
Note self.db_fd, flaskr.app.config['DATABASE'] = tempfile.mkstemp()
Now I think the first version is not that good because it relies on the settings to be declared inside flaskr.py. I tried to put the settings in another file and load them with app.config.from_object(settings) only to find out that my real database is used because obviously blog.DATABASE is not read at all in flaskr.py.
Note that there is the same problem with the tearDown method.