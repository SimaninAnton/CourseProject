cmanallen commented on 27 Aug 2015
g seems to be persisting longer than it should. My understanding is that g only exists during a request's context. It shouldn't be persisted across multiple separate requests.
My auth handling
When you visit the resource a token is used to determine who you are. Once we get the user_id from that token we persist it like the below code.
if '_auth' not in g:
    g._auth = Auth(user_id=user)
return g._auth
Test Setup
def test(self):
    get = self.client.get('users', headers=make_headers())
    raise Exception(g._auth.user_id) # returns the user id outside the request context
Any ideas as to why g would be available? Let me know if you need more information. I wasn't sure how much to include.