brmzkw commented on 5 Dec 2016
test.py:
app = Flask(__name__)

@app.route('/')
def hello_world():
    return 'Hello, World!'
run:
$> FLASK_APP=test.py flask run
 * Serving Flask app "test"
 * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
query:
$> curl localhost:5000 -H "Host: '`python -c 'print \"\xbf\"'`" -i
HTTP/1.0 500 INTERNAL SERVER ERROR
Content-Type: text/html
Content-Length: 291
Server: Werkzeug/0.11.11 Python/2.7.12
Date: Mon, 05 Dec 2016 11:57:46 GMT

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<title>500 Internal Server Error</title>
<h1>Internal Server Error</h1>
<p>The server encountered an internal error and was unable to complete your request.  Either the server is overloaded or there is an error in the application.</p>
server log:
127.0.0.1 - - [05/Dec/2016 12:57:46] "GET / HTTP/1.1" 500 -
Error on request:
Traceback (most recent call last):
  File "/private/tmp/venv/lib/python2.7/site-packages/werkzeug/serving.py", line 193, in run_wsgi
    execute(self.server.app)
  File "/private/tmp/venv/lib/python2.7/site-packages/werkzeug/serving.py", line 181, in execute
    application_iter = app(environ, start_response)
  File "/private/tmp/venv/lib/python2.7/site-packages/flask/app.py", line 2000, in __call__
    return self.wsgi_app(environ, start_response)
  File "/private/tmp/venv/lib/python2.7/site-packages/flask/app.py", line 1983, in wsgi_app
    ctx = self.request_context(environ)
  File "/private/tmp/venv/lib/python2.7/site-packages/flask/app.py", line 1944, in request_context
    return RequestContext(self, environ)
  File "/private/tmp/venv/lib/python2.7/site-packages/flask/ctx.py", line 242, in __init__
    self.url_adapter = app.create_url_adapter(self.request)
  File "/private/tmp/venv/lib/python2.7/site-packages/flask/app.py", line 1771, in create_url_adapter
    server_name=self.config['SERVER_NAME'])
  File "/private/tmp/venv/lib/python2.7/site-packages/werkzeug/routing.py", line 1327, in bind_to_environ
    query_args=query_args)
  File "/private/tmp/venv/lib/python2.7/site-packages/werkzeug/routing.py", line 1239, in bind
    raise BadHost()
BadHost: 400: Bad Request
I'm not sure if this issue should be created here or on the werkzeug repository.
Anyway, I think a HTTP/400 should be returned to the client instead of a HTTP/500.