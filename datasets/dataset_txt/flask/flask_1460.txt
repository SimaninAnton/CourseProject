ernwa commented on 13 Nov 2012
on my system I am trying to run a flask app with minimum permissions. In this case, it is run as:
sudo -u nobody python flask_webapp.py
all the files in its directory are readable by everyone, but some parent directories are not. The app fails whenever I try to serve up a file, either indirectly by trying to access http://myapp.com/static/test.html, or directly by the following code:
@app.route('/test')
def web_app():
    return send_file("./static/test.html")
The problem is, flask converts all relative paths to absolute paths in the send_file function. This breaks if it doesn't have directory read access all the way to the system root.
The problem seems to arise from the following lines, 543 to 545 of helpers.py
if filename is not None:
    if not os.path.isabs(filename):
        filename = os.path.join(current_app.root_path, filename)