chilicat commented on 5 Jul 2013
Hello,
I'm new to python and I'm just playing around Flask.
Please consider following application (I have simplified my application to just show the issue):
@app.route('/thread', methods=['GET'])
def thre():

    def run():
        # Execute some external command. 
        # Note: I tried popen, call, etc...
        os.system("sleep 10")
        print "Done"

    # Execute the external command in a own process in order to return quickly
    # Note: I tried Thread, start_thread, etc...
    backProc = Process(target=run, args=())
    backProc.start()        

    # Create a generator/iterator. (Simplified)
    def gen():
        yield "My Result"
        return

    # Return the generator. 
    return Response(gen(),  status = 200, mimetype='text/plain')
If I will now call the REST service with curl
curl localhost:5000/thread
then I noticed that curl waits 10 seconds before it returns. It seem like that the "os.system" call blocks Flask of sending the data to the client.
If I use the same example without generator/iterator everything works as expected. The client receives the "My Result" before the "os.system" call finished.