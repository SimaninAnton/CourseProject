Member
greyli commented on 23 Dec 2018 â€¢
edited
flask.tests.test_basic.test_trapping_of_bad_request_key_errors failed in Travis-CI with enviroment devel.
Source
flask.tests.test_basic.test_trapping_of_bad_request_key_errors
def test_trapping_of_bad_request_key_errors(app, client):
    @app.route('/key')
    def fail():
        flask.request.form['missing_key']

    @app.route('/abort')
    def allow_abort():
        flask.abort(400)

    rv = client.get('/key')
    assert rv.status_code == 400
    assert b'missing_key' not in rv.data  # unpassed
Traceback
https://travis-ci.org/pallets/flask/builds/471002531
devel create: /home/travis/build/pallets/flask/.tox/devel
devel installdeps: pytest>=3, coverage, greenlet, blinker, python-dotenv, 
https://github.com/pallets/werkzeug/archive/master.tar.gz, 
https://github.com/pallets/markupsafe/archive/master.tar.gz, 
https://github.com/pallets/jinja/archive/master.tar.gz, 
https://github.com/pallets/itsdangerous/archive/master.tar.gz, 
https://github.com/pallets/click/archive/master.tar.gz
devel inst: /home/travis/build/pallets/flask/.tox/.tmp/package/1/Flask-1.0.3.dev0.zip
...
___________________ test_trapping_of_bad_request_key_errors ____________________
app = <Flask 'flask_test'>, client = <FlaskClient <Flask 'flask_test'>>
    def test_trapping_of_bad_request_key_errors(app, client):
        @app.route('/key')
        def fail():
            flask.request.form['missing_key']
    
        @app.route('/abort')
        def allow_abort():
            flask.abort(400)
    
        rv = client.get('/key')
        assert rv.status_code == 400
>       assert b'missing_key' not in rv.data
E       assert 'missing_key' not in "<!DOCTYPE HTML PUBL...'</code></pre></p>\n"
E         'missing_key' is contained here:
E           yError: \'missing_key\'</code></pre></p>
E         ?           +++++++++++