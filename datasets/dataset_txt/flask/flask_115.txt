jwhit265 commented on 18 Jun 2019
Not sure if this is the appropriate place to submit this but seems to either been an issue between flask and escpos so I thought I would start here.
Expected Behavior
Browsing to route prints receipt immediately despite how many times visited.
from flask import Flask, flash
from escpos import *
import PIL

app = Flask(__name__, template_folder='.')

@app.route('/')
def homepage():
  printerip = "192.168.3.197"
  Epson = printer.Network(printerip)
  Epson.text('CHARGING')
  Epson.cut()
  return 'printed'

if __name__ == '__main__':
  app.run(host='0.0.0.0', debug=True, port=80)
Actual Behavior
Receipt prints once but if visiting route again the receipt prints after a delay of 1+ minutes or until the flask application is killed the "backlog" prints immediately. Sometimes the route can be visited twice in a row and the receipt is printed immediately. I can consistently get this working if I have 2.2.0 of python-escpos installed. However when I install the latest version I start experiencing these delays. I require the latest version to take advantaged of image printing and text formatting.
Environment
Python version: 3.6.8
Flask version: 1.0.2
Werkzeug version: 3.6.8