csanders-git commented on 20 Sep 2019 â€¢
edited
Expected Behavior
When a user enters a route to a location with a trailing slash but leaves the trailing slash off, they either receive a 404 or they are redirected to that location with a trailing slash using the same scheme they provided (https vs http)
@sp_app.route('/acs/', methods=["GET", 'POST'])
def acs():
    # example code here
Actual Behavior
Flask will happily accept a route appended with a slash. When a user navigates to that route without the trailing slash they will be redirected with a 308 PERMANENT REDIRECT. This redirection does not maintain the schema of the original request, always dropping the request to HTTP.
This can be abused by an attacker to force transmission by a user over HTTP by sending a crafted link such as https://mysite.com/acs instead of https://mysite.com/acs/. It is also likely an administrator might make this mistake when configuring locations or distributing links.
Environment
Python version: 2.7.16
Flask version: 1.1.1