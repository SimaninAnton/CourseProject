obskyr commented on 21 Nov 2016
The function I designated as @app.teardown_appcontext is running before the view code runs - at least according to my own investigations. Printing something in teardown_appcontext and something in a view body results in the former appearing before the latter, at the very least. Using teardown_request, however, works as expected.
From the documentation, I would've expected teardown_appcontext to fire at roughly the same time ("These functions are typically also called when the request context is popped"), except it'd also work with with app.app_context. It seems that's not the case, however!
I'm on Python 2.7.12 with Flask 0.11.1 and Werkzeug 0.11.11.