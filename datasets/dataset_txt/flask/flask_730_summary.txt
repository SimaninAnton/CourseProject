why loop redirect with redirect('{0}/{1}'.format(site, page_name), code=301)?