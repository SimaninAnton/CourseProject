peakhell commented on 29 Aug 2017 â€¢
edited
Unexpected Behavior
I have a simple function to get json data from a website using "POST" method, for convenience, I save it as get_music.py file. Here is the code.
import requests
def get_music():
 baseUrl = "http://music.163.com/api/search/get/"
 parameters = {
     's': "acg",
     'limit': 100,
     'type': 1
 }
 response = requests.post(baseUrl, data=parameters)
 answer = response.json()
 return answer
and when we call the function, a json data will returned, that's no problems. But when i call it in the views function, things become strange. here is views.py.
from .get_music import get_music
from flask import render_template
from . import main

@main.route('/', methods=['GET', 'POST'])
def index():
    music = get_music()
    return render_template("index.html", music=music)
When I run the flask program, the json data is " {'msg': "Request method 'GET' not supported", 'code': 400}", it's not correct.
After debug i found the request method is "GET" when i use flask, but if run the get_music.py without flask , the request method is "POST". it's any problem in views funtion change the request method?