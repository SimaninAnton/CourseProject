before_request versus HTTP exceptions