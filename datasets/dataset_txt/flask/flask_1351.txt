Contributor
homeworkprod commented on 4 Sep 2013
I have a very simple app. It runs fine when the module (itself calling app.run()) is run.
However, when I try to run the app via CGI on Apache 2 using this .cgi script:
#!/usr/bin/env python

from wsgiref.handlers import CGIHandler
from someapp import app

CGIHandler().run(app)
it results in an exception:
Traceback (most recent call last):
  File "/usr/lib/python2.7/wsgiref/handlers.py", line 85, in run
    self.result = application(self.environ, self.start_response)
  File "/home/user/projects/SomeProject/venv/lib/python2.7/site-packages/flask/app.py", line 1836, in __call__
    return self.wsgi_app(environ, start_response)
  File "/home/user/projects/SomeProject/venv/lib/python2.7/site-packages/flask/app.py", line 1812, in wsgi_app
    ctx = self.request_context(environ)
  File "/home/user/projects/SomeProject/venv/lib/python2.7/site-packages/flask/app.py", line 1773, in request_context
    return RequestContext(self, environ)
  File "/home/user/projects/SomeProject/venv/lib/python2.7/site-packages/flask/ctx.py", line 247, in __init__
    self.match_request()
  File "/home/user/projects/SomeProject/venv/lib/python2.7/site-packages/flask/ctx.py", line 286, in match_request
    self.url_adapter.match(return_rule=True)
  File "/home/user/projects/SomeProject/venv/lib/python2.7/site-packages/werkzeug/routing.py", line 1386, in match
    self.subdomain, path_info.lstrip('/'))
AttributeError: 'NoneType' object has no attribute 'lstrip'
The setup is Flask 0.10.1 with Werkzeug 0.9.4.
On first sight, the WSGI environment variables seem to be incomplete, or something like that.