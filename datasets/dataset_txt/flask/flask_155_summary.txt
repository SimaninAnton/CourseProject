raise exception instead of using abort()