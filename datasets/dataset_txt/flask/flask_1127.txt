reteptilian commented on 20 Dec 2014
In werkzeug's WSGIRequestHandler, CONTENT-LENGTH defaults to an empty string ('') if the client did not provide a Content-Length header.
This is causing me problems in my flask web service, which is trying to proxy requests. The user creates a request without Content-Length, flask gives it to me and then I pass it along to another server, which then returns HTTP 400 due to the bad Content-Length that werkzeug has inserted. According to RFC 2616, Content-Length must be a number.
Initially I thought this should be considered a werkzeug bug but maybe the empty string was intended to be werkzeug's signifier for a non-existent Content-Length, rather than an actual Content-Length value that could be used directly. If that's the case, then I would modify flask so that Content-Length isn't included in the incoming request's headers if it is the empty string.
Bottom line, I believe that a client request that is missing a Content-Length header should not result in an incoming flask request with the Content-Length equal to the empty string.