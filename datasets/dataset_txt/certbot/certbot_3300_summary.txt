Implement locking to ensure two clients do not run at once