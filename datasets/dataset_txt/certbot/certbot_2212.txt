ffittschen commented on 12 Apr 2016
I wanted to renew my certificates, but ./letsencrypt-auto renew failed, because the .conf files in the /etc/letsencrypt/renewal directory are not up to date anymore (created using apache + letsencrypt apache plugin, but I switched to nginx)
So I moved the file into a tmp directory and ran ./letsencrypt-auto certonly --rsa-key-size 4096 --webroot -w /var/www/html/mydomain.com/public_html/ -d mydomain.com -d www.mydomain.com -w /var/www/html/subdomain.mydomain.com/public_html/ -d subdomain.mydomain.com --text -v
Since the docs stated that the --duplicate flag defaults to false, I thought it would renew my existing certificate (the domains and their order are the same as in the original certificate request). But instead it created a new mydomain.com-0001 certificate See the WARNING in the log below
This did not happen when I used the --dry-run flag!
Is this the correct behaviour? And is there any way to get asked if the CLI really should create a -0001 certificate?
Checking for new version...
Requesting root privileges to run letsencrypt...
   /root/.local/share/letsencrypt/bin/letsencrypt certonly --rsa-key-size 4096 --webroot -w /var/www/html/mydomain.com/public_html/ -d mydomain.com -d www.mydomain.com -w /var/www/html/subdomain.mydomain.com/public_html/ -d subdomain.mydomain.com --text -v
2016-04-11 20:49:30,574:INFO:letsencrypt.main:Saving debug log to /var/log/letsencrypt/letsencrypt.log
2016-04-11 20:49:30,771:INFO:requests.packages.urllib3.connectionpool:Starting new HTTPS connection (1): acme-v01.api.letsencrypt.org
2016-04-11 20:49:31,073:WARNING:letsencrypt.main:Renewal conf file /etc/letsencrypt/renewal/mydomain.com.conf is broken. Skipping.
2016-04-11 20:49:31,089:INFO:requests.packages.urllib3.connectionpool:Starting new HTTPS connection (1): acme-v01.api.letsencrypt.org
2016-04-11 20:49:31,435:INFO:requests.packages.urllib3.connectionpool:Starting new HTTPS connection (1): acme-v01.api.letsencrypt.org
2016-04-11 20:49:31,799:INFO:requests.packages.urllib3.connectionpool:Starting new HTTPS connection (1): acme-v01.api.letsencrypt.org
2016-04-11 20:49:32,147:INFO:requests.packages.urllib3.connectionpool:Starting new HTTPS connection (1): acme-v01.api.letsencrypt.org