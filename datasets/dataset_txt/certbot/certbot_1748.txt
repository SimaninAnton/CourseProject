Member
bmw commented on 11 Oct 2016
We have a problem with our optional dependencies psutil and dnspython that was identified in #3599.
Problem
The user does not install the optional dependency when installing our packages.
We try to import the optional dependency at runtime. We catch the ImportError if the package is not available, however, if this package was installed through other means, it may not be the version we require causing other errors at import time or later in execution.
Solution
Use pkg_resources.get_distribution(<module_name>).version to get the version number. If the function raises pkg_resources.DistributionNotFound, we assume this package isn't available. Once we have the version number, we use something like the class distutils.version.StrictVersion to compare the version number to the one we require. If the version number is okay, we import the module, otherwise, we don't.
@erikrose, what do you think?