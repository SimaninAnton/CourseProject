lyenliang commented on 27 Sep 2017 â€¢
edited
My operating system is (include version):
macOS Sierra
Version 10.12.6
I installed Certbot with (certbot-auto, OS package manager, pip, etc):
certbot-auto
I ran this command and it produced this output:
command with --dry-run doesn't work:
./certbot-auto certonly --dry-run --keep --webroot -w /usr/share/nginx/html -d myDomain.com
output with error messages:
Saving debug log to /var/log/letsencrypt/letsencrypt.log
Plugins selected: Authenticator webroot, Installer None
Cert not due for renewal, but simulating renewal for dry run
Renewing an existing certificate
Performing the following challenges:
http-01 challenge for myDomain.com
Using the webroot path /usr/share/nginx/html for all unmatched domains.
Waiting for verification...
Cleaning up challenges
Failed authorization procedure. myDomain.com (http-01): urn:acme:error:connection :: The server could not connect to the client to verify the domain :: DNS problem: SERVFAIL looking up A for myDomain.com

IMPORTANT NOTES:
- The following errors were reported by the server:

Domain: myDomain.com
Type:   connection
Detail: DNS problem: SERVFAIL looking up A for
myDomain.com

To fix these errors, please make sure that your domain name was
entered correctly and the DNS A/AAAA record(s) for that domain
contain(s) the right IP address. Additionally, please check that
your computer has a publicly routable IP address and that no
firewalls are preventing the server from communicating with the
client. If you're using the webroot plugin, you should also verify
that you are serving files from the webroot path you provided.
command without --dry-run works correctly:
./certbot-auto certonly --keep --webroot -w /usr/share/nginx/html -d myDomain.com
successful output:
Saving debug log to /var/log/letsencrypt/letsencrypt.log
Plugins selected: Authenticator webroot, Installer None
Obtaining a new certificate
Performing the following challenges:
http-01 challenge for myDomain.com
Using the webroot path /usr/share/nginx/html for all unmatched domains.
Waiting for verification...
Cleaning up challenges

IMPORTANT NOTES:
- Congratulations! Your certificate and chain have been saved at:
/etc/letsencrypt/live/myDomain.com/fullchain.pem
Your key file has been saved at:
/etc/letsencrypt/live/myDomain.com/privkey.pem
Your cert will expire on 2017-12-26. To obtain a new or tweaked
version of this certificate in the future, simply run certbot-auto
again. To non-interactively renew *all* of your certificates, run
"certbot-auto renew"
- If you like Certbot, please consider supporting our work by:

Donating to ISRG / Let's Encrypt:   https://letsencrypt.org/donate
Donating to EFF:                    https://eff.org/donate-le
I expect the command with --dry-run works correctly, but it doesn't. Is this a bug of certbot?
Another thing I need to mention is that myDomain.com is a CNAME, not an A record.