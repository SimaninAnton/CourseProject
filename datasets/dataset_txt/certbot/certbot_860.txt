StianOvrevage commented on 14 Dec 2017 â€¢
edited
Currently the Docker image of certbot (certbot/certbot) is using ENTRYPOINT [ "certbot" ].
The advantage is that you can then run a certbot command like this:
docker run -it --rm --name certbot certbot/certbot certonly --args
However, it also means that you cannot run a shell inside the container like this:
docker run -it --rm --name certbot certbot/certbot sh
Which makes using certbot very difficult as you have to invoke the docker container again and again, especially when having to update DNS entries for every try. It is also difficult to get the certificates out from the container, as the only way is to mount volumes to the host. 1) This is very flaky on Windows. 2) There is also some redirection in the Dockerfile (VOLUME /etc/letsencrypt /var/lib/letsencrypt) which means that the output from the container logs are wrong.
So, please consider something like this:
- ENTRYPOINT [ "certbot" ]
+ CMD [ "/bin/sh", "-c" ]
That way you can run it non-interactively (like now):
docker run -it --rm --name certbot certbot/certbot "certbot certonly --args" (Even works on Windows!).
And "interactively" via a shell:
docker run -it --rm --name certbot certbot/certbot sh
Not sure about the VOLUME statement. I think the paths could be cleaned up to avoid confusion.