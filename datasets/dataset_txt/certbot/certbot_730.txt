Member
bmw commented on 16 Feb 2018 â€¢
edited
#5578 (comment).
We have code in certbot.crypto_util that does this with the help of some ACME code. The code in new_order for extracting SANs is nicer than the code in acme.crypto_util._pyopenssl_cert_or_req_san. What I'd do is make (a) function(s) in acme.crypto_util that takes a string CSR and uses the SANs extracting code from new_order with the common name extracting code from certbot.crypto_util and returns the list of domains. If we're currently removing duplicates, we should do this here as well.