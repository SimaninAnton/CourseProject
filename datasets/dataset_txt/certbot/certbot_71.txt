lonix1 commented on 2 Oct 2019
Background
It is well known that certbot doesn't play nice in a dockerized environment, because certs must exist before nginx can serve, etc. The typical workaround is to initially run the --standalone server, get the certs saved in a docker volume, and thereafter run in --webroot mode in tandem with nginx.
Problem
But the --standalone server only works on port 80, the same port as the web server. This is a real hassle, and is messy.
Solution
Please allow us to configure the standalone server's port.
If we could do that, then we could run certbot alongside nginx, always in --standalone mode. It would do it's thing and save the certs to a docker named volume. Then a post hook could be used to reload nginx (which also has that volume mounted).
That would be MUCH simpler to setup, and MUCH simpler to run.
I've read that this was not done because 80 can only be used by a sudoer, and allowing a port which is >1024 could cause security risks.
Solutions:
Allow us to do so anyway, but force use of sudo
Use a port <1024 which is not generally used
Allow us to choose the port as long as it's <1024 <--- best option!
Please do this, certbot is unnecessarily complicated because of this.