jplatte commented on 4 Oct 2017
This is probably due to bad documentation on nginx side, but currently CertBot only generates a listen 443 ssl; directive, both for the validation domain used for tls-sni-01 and the actual domain(s) the certificate is for. This means that tls-sni-01 validation currently doesn't work on ipv6-enabled servers running nginx unless the validation server chooses ipv4 over ipv6 (which I'd assume it probably never does when the server has DNS records for both).
This issue should be reproducible by installing nginx on a server with both an ipv4 and an ipv6, plus corresponding A/AAAA DNS entries, and adding a simple server block like the following:
server {
    listen 80;
    listen [::]:80;

    server_name mydomain.horse;
    root /srv/http/mydomain.horse;
}
... and then running certbot --nginx -d mydomain.horse.