enugentdt commented on 7 Dec 2019 â€¢
edited
My operating system is (include version):
Mac OS X 10.14
I installed Certbot with (certbot-auto, OS package manager, pip, etc):
pip
I ran this command and it produced this output:
certbot renew
An unexpected error occurred:
argparse.ArgumentError: argument --webroot-path/-w: conflicting option string: -w
Please see the logfile '/var/folders/tp/gcrtlv2s0cs_m5fvc5c67k8r0000gn/T/tmp7s2e2beg/log' for more details.
Certbot's behavior differed from what I expected because:
Well, theoretically, this shouldn't crash on a fresh install.
Here is a Certbot log showing the issue (if available):
019-12-06 22:53:06,334:DEBUG:certbot._internal.main:certbot version: 1.0.0
2019-12-06 22:53:06,335:DEBUG:certbot._internal.main:Arguments: []
2019-12-06 22:53:06,335:DEBUG:certbot._internal.main:Discovered plugins: PluginsRegistry(PluginEntryPoint#-:dns-cloudflare,PluginEntryPoint#-ertbot-dns-cloudflare:dns-cloudflare,PluginEntryPoint#-ertbot:manual,PluginEntryPoint#-ertbot:null,PluginEntryPoint#-ertbot:standalone,PluginEntryPoint#-ertbot:webroot,PluginEntryPoint#dns-cloudflare,PluginEntryPoint#manual,PluginEntryPoint#null,PluginEntryPoint#standalone,PluginEntryPoint#webroot)
2019-12-06 22:53:06,359:DEBUG:certbot._internal.log:Exiting abnormally:
Traceback (most recent call last):
  File "/Users/space/Library/Python/3.7/bin/certbot", line 8, in <module>
    sys.exit(main())
  File "/Users/space/Library/Python/3.7/lib/python/site-packages/certbot/main.py", line 14, in main
    return internal_main.main(cli_args)
  File "/Users/space/Library/Python/3.7/lib/python/site-packages/certbot/_internal/main.py", line 1327, in main
    args = cli.prepare_and_parse_args(plugins, cli_args)
  File "/Users/space/Library/Python/3.7/lib/python/site-packages/certbot/_internal/cli.py", line 1243, in prepare_and_parse_args
    _plugins_parsing(helpful, plugins)
  File "/Users/space/Library/Python/3.7/lib/python/site-packages/certbot/_internal/cli.py", line 1456, in _plugins_parsing
    helpful.add_plugin_args(plugins)
  File "/Users/space/Library/Python/3.7/lib/python/site-packages/certbot/_internal/cli.py", line 832, in add_plugin_args
    plugin_ep.plugin_cls.inject_parser_options(parser_or_group, name)
  File "/Users/space/Library/Python/3.7/lib/python/site-packages/certbot/plugins/common.py", line 82, in inject_parser_options
    return cls.add_parser_arguments(add)
  File "/Users/space/Library/Python/3.7/lib/python/site-packages/certbot/_internal/plugins/webroot.py", line 51, in add_parser_arguments
    help="public_html / webroot path. This can be specified multiple "
  File "/Users/space/Library/Python/3.7/lib/python/site-packages/certbot/plugins/common.py", line 81, in add
    *args, **kwargs)
  File "/Users/space/Library/Python/3.7/lib/python/site-packages/certbot/_internal/cli.py", line 313, in add_argument
    self._parser.add(self._topic, *args, **kwargs)
  File "/Users/space/Library/Python/3.7/lib/python/site-packages/certbot/_internal/cli.py", line 762, in add
    self.parser.add_argument(*args, **kwargs)
  File "/Users/space/Library/Python/3.7/lib/python/site-packages/configargparse.py", line 889, in add_argument
    action = self.original_add_argument_method(*args, **kwargs)
  File "/usr/local/Cellar/python/3.7.5/Frameworks/Python.framework/Versions/3.7/lib/python3.7/argparse.py", line 1373, in add_argument
    return self._add_action(action)
  File "/usr/local/Cellar/python/3.7.5/Frameworks/Python.framework/Versions/3.7/lib/python3.7/argparse.py", line 1736, in _add_action
    self._optionals._add_action(action)
  File "/usr/local/Cellar/python/3.7.5/Frameworks/Python.framework/Versions/3.7/lib/python3.7/argparse.py", line 1577, in _add_action
    action = super(_ArgumentGroup, self)._add_action(action)
  File "/usr/local/Cellar/python/3.7.5/Frameworks/Python.framework/Versions/3.7/lib/python3.7/argparse.py", line 1387, in _add_action
    self._check_conflict(action)
  File "/usr/local/Cellar/python/3.7.5/Frameworks/Python.framework/Versions/3.7/lib/python3.7/argparse.py", line 1526, in _check_conflict
    conflict_handler(action, confl_optionals)
  File "/usr/local/Cellar/python/3.7.5/Frameworks/Python.framework/Versions/3.7/lib/python3.7/argparse.py", line 1535, in _handle_conflict_error
    raise ArgumentError(action, message % conflict_string)
argparse.ArgumentError: argument --webroot-path/-w: conflicting option string: -w
2019-12-06 22:53:06,359:ERROR:certbot._internal.log:An unexpected error occurred:
Here is the relevant nginx server block or Apache virtualhost for the domain I am configuring:
Not applicable
I'm honestly tearing my hair out - I've uninstalled and reinstalled it probably twenty times, through pip, pip3, and brew, at least twice on each. This issue occurs only when I install certbot-dns-cloudflare, though, not when I have just plain certbot installed.
Thanks!