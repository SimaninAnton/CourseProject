Contributor
cowlicks commented on 25 Dec 2015
Hey I'm trying to get letsencrypt running locally for the first time and I had small problem.
I'm on debian testing. While going through the steps for running a local copy of the client. I ran into trouble creating the virtualenv. When I got to:
./bootstrap/dev/venv.sh
The problem happens during a pip install cffi.
(conda-letsencrypt)âžœ  letsencrypt git:(master) pip install cffi
Collecting cffi
  Using cached cffi-1.4.2.tar.gz
Collecting pycparser (from cffi)
  Using cached pycparser-2.14.tar.gz
Building wheels for collected packages: cffi, pycparser
  Running setup.py bdist_wheel for cffi
  Complete output from command /home/blake/.miniconda3/envs/condaletsencrypt/bin/python3 -c "import setuptools;__file__='/tmp/pip-build-p_t6flwx/cffi/setup.py';exec(compile(open(__file__).read().replace('\r\n', '\n'), __file__, 'exec'))" bdist_wheel -d /tmp/tmpt1ufqegupip-wheel-:
  running bdist_wheel
  running build
  running build_py
  creating build
  creating build/lib.linux-x86_64-3.5
  creating build/lib.linux-x86_64-3.5/cffi
  copying cffi/lock.py -> build/lib.linux-x86_64-3.5/cffi
  copying cffi/api.py -> build/lib.linux-x86_64-3.5/cffi
  copying cffi/cparser.py -> build/lib.linux-x86_64-3.5/cffi
  copying cffi/ffiplatform.py -> build/lib.linux-x86_64-3.5/cffi
  copying cffi/backend_ctypes.py -> build/lib.linux-x86_64-3.5/cffi
  copying cffi/setuptools_ext.py -> build/lib.linux-x86_64-3.5/cffi
  copying cffi/model.py -> build/lib.linux-x86_64-3.5/cffi
  copying cffi/verifier.py -> build/lib.linux-x86_64-3.5/cffi
  copying cffi/__init__.py -> build/lib.linux-x86_64-3.5/cffi
  copying cffi/cffi_opcode.py -> build/lib.linux-x86_64-3.5/cffi
  copying cffi/commontypes.py -> build/lib.linux-x86_64-3.5/cffi
  copying cffi/recompiler.py -> build/lib.linux-x86_64-3.5/cffi
  copying cffi/vengine_gen.py -> build/lib.linux-x86_64-3.5/cffi
  copying cffi/gc_weakref.py -> build/lib.linux-x86_64-3.5/cffi
  copying cffi/vengine_cpy.py -> build/lib.linux-x86_64-3.5/cffi
  copying cffi/_cffi_include.h -> build/lib.linux-x86_64-3.5/cffi
  copying cffi/parse_c_type.h -> build/lib.linux-x86_64-3.5/cffi
  running build_ext
  building '_cffi_backend' extension
  creating build/temp.linux-x86_64-3.5
  creating build/temp.linux-x86_64-3.5/c
  gcc -pthread -Wsign-compare -Wunreachable-code -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC -DUSE__THREAD -I/home/blake/.miniconda3/envs/condaletsencrypt/include/python3.5m -c c/_cffi_backend.c -o build/temp.linux-x86_64-3.5/c/_cffi_backend.o
  gcc -pthread -shared -L/home/blake/.miniconda3/envs/condaletsencrypt/lib -Wl,-rpath=/home/blake/.miniconda3/envs/condaletsencrypt/lib,--no-as-needed build/temp.linux-x86_64-3.5/c/_cffi_backend.o -L/home/blake/.miniconda3/envs/condaletsencrypt/lib -lffi -lpython3.5m -o build/lib.linux-x86_64-3.5/_cffi_backend.cpython-35m-x86_64-linux-gnu.so
  /usr/bin/ld: /usr/lib/gcc/x86_64-linux-gnu/5/../../../x86_64-linux-gnu/crti.o: unrecognized relocation (0x2a) in section `.init'
  /usr/bin/ld: final link failed: Bad value
  collect2: error: ld returned 1 exit status
  error: command 'gcc' failed with exit status 1

  ----------------------------------------
  Failed building wheel for cffi
  Running setup.py bdist_wheel for pycparser
  Stored in directory: /home/blake/.cache/pip/wheels/c7/28/31/bac6d0b118c0bdcbf57f9219afdf2e624379c07efa6c769dbc
Successfully built pycparser
Failed to build cffi
Installing collected packages: pycparser, cffi
  Running setup.py install for cffi
    Complete output from command /home/blake/.miniconda3/envs/condaletsencrypt/bin/python3 -c "import setuptools, tokenize;__file__='/tmp/pip-build-p_t6flwx/cffi/setup.py';exec(compile(getattr(tokenize, 'open', open)(__file__).read().replace('\r\n', '\n'), __file__, 'exec'))" install --record /tmp/pip-s7gozfbg-record/install-record.txt --single-version-externally-managed --compile:
    running install
    running build
    running build_py
    running build_ext
    building '_cffi_backend' extension
    gcc -pthread -Wsign-compare -Wunreachable-code -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC -DUSE__THREAD -I/home/blake/.miniconda3/envs/condaletsencrypt/include/python3.5m -c c/_cffi_backend.c -o build/temp.linux-x86_64-3.5/c/_cffi_backend.o
    gcc -pthread -shared -L/home/blake/.miniconda3/envs/condaletsencrypt/lib -Wl,-rpath=/home/blake/.miniconda3/envs/condaletsencrypt/lib,--no-as-needed build/temp.linux-x86_64-3.5/c/_cffi_backend.o -L/home/blake/.miniconda3/envs/condaletsencrypt/lib -lffi -lpython3.5m -o build/lib.linux-x86_64-3.5/_cffi_backend.cpython-35m-x86_64-linux-gnu.so
    /usr/bin/ld: /usr/lib/gcc/x86_64-linux-gnu/5/../../../x86_64-linux-gnu/crti.o: unrecognized relocation (0x2a) in section `.init'
    /usr/bin/ld: final link failed: Bad value
    collect2: error: ld returned 1 exit status
    error: command 'gcc' failed with exit status 1

    ----------------------------------------
Command "/home/blake/.miniconda3/envs/condaletsencrypt/bin/python3 -c "import setuptools, tokenize;__file__='/tmp/pip-build-p_t6flwx/cffi/setup.py';exec(compile(getattr(tokenize, 'open', open)(__file__).read().replace('\r\n', '\n'), __file__, 'exec'))" install --record /tmp/pip-s7gozfbg-record/install-record.txt --single-version-externally-managed --compile" failed with error code 1 in /tmp/pip-build-p_t6flwx/cffi
This is possibly related to this debian bug.
I fixed this by upgrading gcc with
sudo apt-get upgrade gcc
My current working gcc version
gcc (Debian 5.3.1-3) 5.3.1 20151207
And I don't know what the broken version was.
I'm not sure what we should do so other users don't encounter this.