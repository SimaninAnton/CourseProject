soggie commented on 22 Jan 2018
My operating system is (include version):
Distributor ID: Ubuntu
Description: Ubuntu 16.04.3 LTS
Release: 16.04
Codename: xenial
I installed Certbot with (certbot-auto, OS package manager, pip, etc):
certbot-auto, as per https://certbot.eff.org/#ubuntuxenial-nginx
I ran this command and it produced this output:
Basically, I control nginx using systemctl. However, a quick look at certbot-nginx's code reveals that when it restarts, it manually calls the command nginx directly, and there's no way I can disable or change that. Pre and post hooks don't even work because of that.
Certbot's behavior differed from what I expected because:
Expected behaviour is to provide an option to override the restart command, so we don't call restart multiple times.
Here is a Certbot log showing the issue (if available):
Logs are stored in /var/log/letsencrypt by default. Feel free to redact domains, e-mail and IP addresses as you see fit.
Not sure which part of the logs are relevant for this issue.
Here is the relevant nginx server block or Apache virtualhost for the domain I am configuring:
Not applicable.