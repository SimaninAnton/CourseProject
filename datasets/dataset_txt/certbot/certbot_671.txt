keigel2001 commented on 14 Mar 2018
My operating system is (include version):
Debian Stretch 9.4
I installed Certbot with (certbot-auto, OS package manager, pip, etc):
certbot-auto (0.22.0)
I ran this command and it produced this output:
./certbot-auto certonly --rsa-key-size 4096 --manual --preferred-challenges=dns-01 --manual-auth-hook /opt/eff.org/certbot/certbot_dns_authenticate.sh --manual-cleanup-hook /opt/eff.org/certbot/certbot_dns_cleanup.sh -d 'mydomain.tld','*.mydomain.tld' --server https://acme-v02.api.letsencrypt.org/directory
Certbot's behavior differed from what I expected because:
Yesterday I obtained a new wildcard certificate with the help of certbot. Everything went fine and it's working with NGINX and Dovecot like expected. But when I tried my script which is chaining it into a special form for my ZNC, I couldn't connect.
After debugging I noticed that the linebreaks differ from the certs I was obtaining in the past.
Namely chain.pem (and because of this also fullchain.pem) are different. The rest is like excepted.
previous chain.pem:
-----BEGIN CERTIFICATE-----LF
xxxLF
yyyLF
-----END CERTIFICATE-----LF
new chain.pem:
LF
-----BEGIN CERTIFICATE-----CRLF
xxxCRLF
yyyCRLF
-----END CERTIFICATE-----
Especially the missing linebreak at the end is breaking my application and I don't think it's like this on purpose. Resulting of this change the fullchain.pem is also different now.
1