jldeen commented on 25 Jan 2019 â€¢
edited
If you're having trouble using Certbot and aren't sure you've found a bug or
request for a new feature, please first try asking for help at
https://community.letsencrypt.org/. There is a much larger community there of
people familiar with the project who will be able to more quickly answer your
questions.
My operating system is (include version):
Ubuntu 18.0.4.1 LTS
I installed Certbot with (certbot-auto, OS package manager, pip, etc):
using certbot-auto via git repo (installed via git clone https://github.com/certbot/certbot.git)
I ran this command and it produced this output:
sudo ./certbot-auto --no-bootstrap
Creating virtual environment...
Installing Python packages...
Command "/opt/eff.org/certbot/venv/bin/python2.7 -u -c "import setuptools, tokenize;file='/tmp/pip-3yySnw-build/setup.py';f=getattr(tokenize, 'open', open)(file);code=f.read().replace('\r\n', '\n');f.close();exec(compile(code, file, 'exec'))" install --record /tmp/pip-oamDAe-record/install-record.txt --single-version-externally-managed --compile --install-headers /opt/eff.org/certbot/venv/include/site/python2.7/wheel" failed with error code 1 in /tmp/pip-3yySnw-build/
Traceback (most recent call last):
File "/tmp/tmp.cfxY1NQimR/pipstrap.py", line 177, in 
exit(main())
File "/tmp/tmp.cfxY1NQimR/pipstrap.py", line 164, in main
shell=True)
File "/usr/lib/python2.7/subprocess.py", line 223, in check_output
raise CalledProcessError(retcode, cmd, output=output)
subprocess.CalledProcessError: Command 'pip install --no-index --no-deps -U --no-cache-dir /tmp/pipstrap-eTH3eH/pip-9.0.1.tar.gz /tmp/pipstrap-eTH3eH/setuptools-29.0.1.tar.gz /tmp/pipstrap-eTH3eH/wheel-0.29.0.tar.gz' returned non-zero exit status 1
Certbot's behavior differed from what I expected because:
I expect the correct output:
Requesting to rerun ./certbot-auto with root privileges...
Creating virtual environment...
Installing Python packages...
Installation succeeded.
Saving debug log to /var/log/letsencrypt/letsencrypt.log
Plugins selected: Authenticator apache, Installer apache

Which names would you like to activate HTTPS for?
Here is a Certbot log showing the issue (if available):
Logs are stored in /var/log/letsencrypt by default. Feel free to redact domains, e-mail and IP addresses as you see fit.
NA
Here is the relevant nginx server block or Apache virtualhost for the domain I am configuring:
NA
Additional relevant information:
Originally hopped on issue #6682 but was asked to open a new issue. This first began today with the update to 0.30.1. I upgraded pip accordingly and now have 19.0.1 installed. To troubleshoot I ran the following series of commands, which worked.
sudo rm certbot-auto
wget https://dl.eff.org/certbot-auto
export VIRTUALENV_NO_DOWNLOAD=1
chmod a+x certbot-auto
./certbot-auto --no-bootstrap --no-self-upgrade
This leads me to believe something is broken when upgrade to 0.30.1. I also have blown away venv via sudo rm -rf /opt/eff.org/certbot/venv
1