jobst commented on 28 Jun 2017 â€¢
edited
When you run the command
/PATH/certbot-auto renew --non-interactive --no-bootstrap --no-self-upgrade --post-hook "apachectl graceful"
it produces two different outputs (see below) depending if you run it from cron or the commandline, this is probably due to a mix-match of STDERR and STDOUT.
I have not had the pleasure of a real renewal to see what happens then as I only just started using certbot.
So it displays the messages "Cert not yet due for renewal" when running as CRON (in file renewal.py) from function "should_renew()" first and then "Processing ..." from function "handle_renewal_request()" second. If running from commandline all is fine, the order is correct.
This is a annoying especially if you have a longer list of domains as "Cert not yet due for renewal" does NOT contain the domain name and you can't figure out what belongs to what.
My operating system is (include version):
CentOS 6.9
I installed Certbot with (certbot-auto, OS package manager, pip, etc):
certbot-auto, no yum packages for CentOS
I ran this command and it produced this two different outputs:
/PATH/certbot-auto renew --non-interactive --no-bootstrap --no-self-upgrade --post-hook "apachectl graceful"
Certbot's behavior differed from what I expected because:
When run from commandline:
-------------------------------------------------------------------------------
Processing /etc/letsencrypt/renewal/DOMAIN1.com.conf
-------------------------------------------------------------------------------
Cert not yet due for renewal
-------------------------------------------------------------------------------
Processing /etc/letsencrypt/renewal/DOMAIN2.com.conf
-------------------------------------------------------------------------------
Cert not yet due for renewal
-------------------------------------------------------------------------------
Processing /etc/letsencrypt/renewal/DOMAIN3.com.conf
-------------------------------------------------------------------------------
Cert not yet due for renewal
When run from CRON:
Cert not yet due for renewal
Cert not yet due for renewal
Cert not yet due for renewal

-------------------------------------------------------------------------------
Processing /etc/letsencrypt/renewal/DOMAIN1.com.conf
-------------------------------------------------------------------------------

-------------------------------------------------------------------------------
Processing /etc/letsencrypt/renewal/DOMAIN2.com.conf
-------------------------------------------------------------------------------

-------------------------------------------------------------------------------
Processing /etc/letsencrypt/renewal/DOMAIN3.com.conf
-------------------------------------------------------------------------------
Here is a Certbot log showing the issue (if available):
N/A
Here is the relevant nginx server block or Apache virtualhost for the domain I am configuring:
N/A