TheoJL commented on 4 Jul 2017
I've just upgraded to Certbot 0.14.2 and in the middle of the upgrade I got this message that said "The default certbot cron hooks have been disabled!". I don't really know what that means.
Using certbot renew --dry-run will output some errors regarding the hooks, so something must have happened here I guess?
My crontab looks like this
0 0 * * * certbot renew --post-hook "service apache2 reload" >> /var/log/le-renew.log
My operating system is (include version):
Ubuntu 16.04.2
Apache 2.4.18
Certbot 0.14.2
I installed Certbot with (certbot-auto, OS package manager, pip, etc):
I believe it was certbot-auto
I ran this command and it produced this output:
sudo certbot renew --dry-run
Processing /etc/letsencrypt/renewal/www.testsite.se.conf
-------------------------------------------------------------------------------
Cert not due for renewal, but simulating renewal for dry run
Running pre-hook command: /bin/run-parts /etc/letsencrypt/pre-hook.d/
Hook command "/bin/run-parts /etc/letsencrypt/pre-hook.d/" returned error code 1
Error output from run-parts:
run-parts: failed to open directory /etc/letsencrypt/pre-hook.d/: No such file or directory

Renewing an existing certificate
Performing the following challenges:
tls-sni-01 challenge for www.testsite.se
Waiting for verification...
Cleaning up challenges
Dry run: skipping renewal hook command: /bin/run-parts /etc/letsencrypt/renew-hook.d/

-------------------------------------------------------------------------------
new certificate deployed with reload of apache server; fullchain is
/etc/letsencrypt/live/www.testsite.se/fullchain.pem
-------------------------------------------------------------------------------
** DRY RUN: simulating 'certbot renew' close to cert expiry
**          (The test certificates below have not been saved.)

Congratulations, all renewals succeeded. The following certs have been renewed:
  /etc/letsencrypt/live/www.testsite.se/fullchain.pem (success)
** DRY RUN: simulating 'certbot renew' close to cert expiry
**          (The test certificates above have not been saved.)
Running post-hook command: /bin/run-parts /etc/letsencrypt/post-hook.d/
Hook command "/bin/run-parts /etc/letsencrypt/post-hook.d/" returned error code 1
Error output from run-parts:
run-parts: failed to open directory /etc/letsencrypt/post-hook.d/: No such file or directory
There are some errors in this output
Certbot's behavior differed from what I expected because:
Yes, there shouldn't be hook errors in my output above, right?
Here is a Certbot log showing the issue (if available):
Logs are stored in /var/log/letsencrypt by default. Feel free to redact domains, e-mail and IP addresses as you see fit.
If you need the log I'll share it.
Here is the relevant nginx server block or Apache virtualhost for the domain I am configuring:
not relevant
1