j4m35 commented on 23 Jul 2016 â€¢
edited
I've just installed Certbot on my Gentoo system; using the following packages so that the GIT version will be pulled:
=app-crypt/certbot-apache-9999
=app-crypt/certbot-9999
=app-crypt/acme-9999
When I run certbot:
# certbot --apache
An unexpected error occurred:
TypeError: 'NoneType' object has no attribute '__getitem__'
Please see the logfiles in /var/log/letsencrypt for more details.
And the log is as follows:
# cat letsencrypt.log
2016-07-23 15:30:43,953:DEBUG:certbot.main:Root logging level set at 20
2016-07-23 15:30:43,954:INFO:certbot.main:Saving debug log to /var/log/letsencrypt/letsencrypt.log
2016-07-23 15:30:43,962:DEBUG:certbot.main:certbot version: 0.9.0.dev0
2016-07-23 15:30:43,962:DEBUG:certbot.main:Arguments: ['--apache']
2016-07-23 15:30:43,963:DEBUG:certbot.main:Discovered plugins: PluginsRegistry(PluginEntryPoint#apache,PluginEntryPoint#webroot,PluginEntryPoint#null,PluginEntryPoint#manual,PluginEntryPoint#standalone)
2016-07-23 15:30:43,965:DEBUG:certbot.plugins.selection:Requested authenticator apache and installer apache
2016-07-23 15:30:44,307:DEBUG:certbot.main:Exiting abnormally:
Traceback (most recent call last):
  File "/usr/lib/python-exec/python2.7/certbot", line 9, in <module>
    load_entry_point('certbot==0.9.0.dev0', 'console_scripts', 'certbot')()
  File "/usr/lib64/python2.7/site-packages/certbot/main.py", line 770, in main
    return config.func(config, plugins)
  File "/usr/lib64/python2.7/site-packages/certbot/main.py", line 504, in run
    installer, authenticator = plug_sel.choose_configurator_plugins(config, plugins, "run")
  File "/usr/lib64/python2.7/site-packages/certbot/plugins/selection.py", line 184, in choose_configurator_plugins
    authenticator = installer = pick_configurator(config, req_inst, plugins)
  File "/usr/lib64/python2.7/site-packages/certbot/plugins/selection.py", line 24, in pick_configurator
    (interfaces.IAuthenticator, interfaces.IInstaller))
  File "/usr/lib64/python2.7/site-packages/certbot/plugins/selection.py", line 76, in pick_plugin
    verified.prepare()
  File "/usr/lib64/python2.7/site-packages/certbot/plugins/disco.py", line 219, in prepare
    return [plugin_ep.prepare() for plugin_ep in self._plugins.itervalues()]
  File "/usr/lib64/python2.7/site-packages/certbot/plugins/disco.py", line 105, in prepare
    self._initialized.prepare()
  File "/usr/lib64/python2.7/site-packages/certbot_apache/configurator.py", line 191, in prepare
    self.vhosts = self.get_virtual_hosts()
  File "/usr/lib64/python2.7/site-packages/certbot_apache/configurator.py", line 573, in get_virtual_hosts
    new_vhost = self._create_vhost(path)
  File "/usr/lib64/python2.7/site-packages/certbot_apache/configurator.py", line 540, in _create_vhost
    filename = get_file_path(self.aug.get("/augeas/files%s/path" % get_file_path(path)))
  File "/usr/lib64/python2.7/site-packages/certbot_apache/configurator.py", line 1805, in get_file_path
    avail_fp = vhost_path[6:]
TypeError: 'NoneType' object has no attribute '__getitem__'
Would appreciate any help in the matter. Thanks.