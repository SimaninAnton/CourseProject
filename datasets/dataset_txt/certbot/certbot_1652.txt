starchy commented on 8 Nov 2016
This was spotted on older clients still using the letsencrypt-auto command line. Our cron jobs:
/opt/letsencrypt/letsencrypt-auto certonly --config /etc/letsencrypt/cli.ini --agree-tos --renew-by-default --expand
failed with:
An unexpected error occurred:
Bug in pythondialog: expected an empty output from u'infobox', but got: u'Error opening terminal: unknown.\n'Please see the logfile 'certbot.log' for more details.
Running interactively shows the client opening a curses dialog (where previous versions did not), although there were only an information notices displayed:

| Saving debug log to /var/log/letsencrypt/letsencrypt.log             │
│ Starting new HTTPS connection (1): acme-v01.api.letsencrypt.org      │
│ Renewing an existing certificate                                     │
│ Performing the following challenges:                                 │
│ http-01 challenge for irc.eff.org                                    │
│ Using the webroot path /var/www/letsencrypt for all unmatched        │
│ domains.                                                             │
│ Waiting for verification...                                          │
│ Cleaning up challenges                                               │
│ Generating key (2048 bits):                                          │
│ /etc/letsencrypt/keys/0004_key-certbot.pem                           │
│ Creating CSR: /etc/letsencrypt/csr/0004_csr-certbot.pem  |

Adding the --non-interactive switch resolves the issue, but this is a breaking change for many existing pre-certbot cronjobs.