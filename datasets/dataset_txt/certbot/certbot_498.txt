Vercoutere commented on 18 Jun 2018
My operating system is (include version):
Ubuntu 18.04
I installed Certbot with (certbot-auto, OS package manager, pip, etc):
OS package manager (apt)
I ran this command and it produced this output:
certbot --nginx -d example.com
(note that the issues isn't about this specific error)
Problem in /etc/nginx/sites-available/example.com: tried to insert directive "['ssl_protocols', 'TLSv1', 'TLSv1.1', 'TLSv1.2']" but found conflicting "['ssl_protocols', 'TLSv1.2']".

IMPORTANT NOTES:
 - Unable to install the certificate
 - Congratulations! Your certificate and chain have been saved at:
   /etc/letsencrypt/live/example.com/fullchain.pem
   Your key file has been saved at:
   /etc/letsencrypt/live/example.com/privkey.pem
   Your cert will expire on 2018-09-15. To obtain a new or tweaked
   version of this certificate in the future, simply run certbot again
   with the "certonly" option. To non-interactively renew *all* of
   your certificates, run "certbot renew"
Certbot's behavior differed from what I expected because:
Both the post and deploy hook are ran and provide the RENEWED_DOMAINS variable, even though there was an error when trying to update the Nginx server block for the example.com domain.
I'm unaware of any way to detect issues encountered by the Nginx plugin. Perhaps a "finish" hook could be added, which would only be triggered after all plugin logic is handled.