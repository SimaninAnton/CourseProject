Contributor
adferrand commented on 23 Jan 2019 â€¢
edited
Issue #6682 enlighted a breakage on certbot-auto since version 19.0 of pip has been released that contains a bug. Issue on upstream as been filled here pypa/pip#6158 and bug fix version is incoming.
What I want to study here, is how to avoid that this kind of breakage breaks certbot-auto. It impacted us because by default, virtualenv will try upon its creation to update its fundamental components like pip or setuptools to the latest version available on PyPI. So a temporary fix on our side is to set the --no-download to virtualenv to disable the automated update, and use the modules packages in the OS distribution instead.
I think this is not a complete solution, as it makes certbot-auto be sticked with potentially very old modules, that would gain some benefit to be updated nonetheless. For pip at least, we are covered to avoid too old pip versions, but if its logic is triggered, it will still get the latest pip version, so we are again on the same situation.
In fact, we use pinned versions for every other certbot dependencies exactly for this purpose, avoid to have unexpected breakage in recent releases in some modules.
I propose to do the same for pip and pin its version. This could be done through the pipstrap process.
What do you think?
cc @bmw @ohemorange
1