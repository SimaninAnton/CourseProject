Member
bmw commented on 9 Jan 2018 â€¢
edited by ohemorange
LE_PYTHON is always set during phase 2 because this variable is exported. Even worse, at this point we can't differentiate between the case where this value was set by the user and one where it was set by a previous version of the script. This is a problem because we won't know which Python executable to use to run Certbot and whether an unsupported value was manually set by the user or not. As the script is right now, this can cause us to create the venv using Python 2.6 or continue to use Python 2.6 to run fetch.py.
A couple potential fixes are:
Fix 1:
Before we ever set --cb-auto-has-root or --le-auto-phase2, if LE_PYTHON is set, complain about deprecation and tell people to use a new var like CB_PYTHON.
When bootstrapping for Python 3, overwrite/unset LE_PYTHON.
Fix 2:
Quietly overwrite/unset LE_PYTHON
The properties I would like are:
If in the future, when someone manually sets LE_PYTHON to Python 2.6, we tell them their python is too old like we do for other versions.
If we can't tell whether the value was user set or not, we ignore the value. There is a tradeoff to be made between printing a warning about this and just doing it quietly. By printing a warning, how many users will get a warning/cron email when most of them haven't set LE_PYTHON as it isn't formally documented anyway.