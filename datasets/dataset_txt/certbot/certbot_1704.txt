jberkel commented on 24 Oct 2016 •
edited
Thanks for adding IDN support. It works well, but got some errors during installation.
The file's path is /etc/apache2/sites-available/motî.net-le-ssl.conf
Using current certbot master (d54cb76), error occur in 3 different places in reverter.py:
2016-10-24 11:55:56,510:DEBUG:certbot.error_handler:Encountered exception:
Traceback (most recent call last):
  File "/home/jan/certbot/certbot/client.py", line 374, in deploy_certificate
    fullchain_path=fullchain_path)
  File "/home/jan/certbot/certbot-apache/certbot_apache/configurator.py", line 230, in deploy_cert
    vhost = self.choose_vhost(domain)
  File "/home/jan/certbot/certbot-apache/certbot_apache/configurator.py", line 324, in choose_vhost
    vhost = self.make_vhost_ssl(vhost)
  File "/home/jan/certbot/certbot-apache/certbot_apache/configurator.py", line 788, in make_vhost_ssl
    self._copy_create_ssl_vhost_skeleton(avail_fp, ssl_fp)
  File "/home/jan/certbot/certbot-apache/certbot_apache/configurator.py", line 882, in _copy_create_ssl_vhost_skeleton
    self.reverter.register_file_creation(False, ssl_fp)
  File "/home/jan/certbot/certbot/reverter.py", line 383, in register_file_creation
    new_fd.write("{0}{1}".format(path, os.linesep))
UnicodeEncodeError: 'ascii' codec can't encode character u'\xee' in position 32: ordinal not in range(128)
Traceback (most recent call last):
  File "/home/jan/certbot/venv/bin/certbot", line 11, in <module>
    load_entry_point('certbot', 'console_scripts', 'certbot')()
  File "/home/jan/certbot/certbot/main.py", line 766, in main
    return config.func(config, plugins)
  File "/home/jan/certbot/certbot/main.py", line 514, in run
    lineage.chain, lineage.fullchain)
  File "/home/jan/certbot/certbot/client.py", line 375, in deploy_certificate
    self.installer.save()  # needed by the Apache plugin
  File "/home/jan/certbot/certbot-apache/certbot_apache/augeas_configurator.py", line 130, in save
    self.save_notes)
  File "/home/jan/certbot/certbot/reverter.py", line 206, in add_to_checkpoint
    self.config.in_progress_dir, save_files, save_notes)
  File "/home/jan/certbot/certbot/reverter.py", line 252, in _add_to_checkpoint_dir
    notes_fd.write(save_notes)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xee' in position 49: ordinal not in range(128)
Traceback (most recent call last):
  File "/home/jan/certbot/certbot/client.py", line 374, in deploy_certificate
    fullchain_path=fullchain_path)
  File "/home/jan/certbot/certbot-apache/certbot_apache/configurator.py", line 230, in deploy_cert
    vhost = self.choose_vhost(domain)
  File "/home/jan/certbot/certbot-apache/certbot_apache/configurator.py", line 324, in choose_vhost
    vhost = self.make_vhost_ssl(vhost)
  File "/home/jan/certbot/certbot-apache/certbot_apache/configurator.py", line 808, in make_vhost_ssl
    self.save()
  File "/home/jan/certbot/certbot-apache/certbot_apache/augeas_configurator.py", line 130, in save
    self.save_notes)
  File "/home/jan/certbot/certbot/reverter.py", line 206, in add_to_checkpoint
    self.config.in_progress_dir, save_files, save_notes)
  File "/home/jan/certbot/certbot/reverter.py", line 238, in _add_to_checkpoint_dir
    op_fd.write(filename + os.linesep)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xee' in position 32: ordinal not in range(128)