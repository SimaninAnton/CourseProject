md5i commented on 21 Dec 2017
My operating system is (include version):
Linux 4.14.0, Debian unstable
I installed Certbot with (certbot-auto, OS package manager, pip, etc):
sudo apt-get install python-certbot-apache
I ran this command and it produced this output:
$ sudo certbot --apache
Traceback (most recent call last):
File "/usr/bin/certbot", line 11, in
load_entry_point('certbot==0.19.0', 'console_scripts', 'certbot')()
File "/usr/lib/python2.7/dist-packages/pkg_resources/init.py", line 572, in load_entry_point
return get_distribution(dist).load_entry_point(group, name)
File "/usr/lib/python2.7/dist-packages/pkg_resources/init.py", line 2752, in load_entry_point
return ep.load()
File "/usr/lib/python2.7/dist-packages/pkg_resources/init.py", line 2405, in load
return self.resolve()
File "/usr/lib/python2.7/dist-packages/pkg_resources/init.py", line 2411, in resolve
module = import(self.module_name, fromlist=['name'], level=0)
File "/usr/lib/python2.7/dist-packages/certbot/main.py", line 11, in
from acme import jose
File "/usr/lib/python2.7/dist-packages/acme/jose/init.py", line 37, in
from acme.jose.interfaces import JSONDeSerializable
File "/usr/lib/python2.7/dist-packages/acme/jose/interfaces.py", line 9, in
from acme.jose import util
File "/usr/lib/python2.7/dist-packages/acme/jose/util.py", line 5, in
import OpenSSL
File "/usr/lib/python2.7/dist-packages/OpenSSL/init.py", line 8, in
from OpenSSL import crypto, SSL
File "/usr/lib/python2.7/dist-packages/OpenSSL/crypto.py", line 12, in
from cryptography import x509
File "/usr/lib/python2.7/dist-packages/cryptography/x509/init.py", line 8, in
from cryptography.x509.base import (
File "/usr/lib/python2.7/dist-packages/cryptography/x509/base.py", line 16, in
from cryptography.x509.extensions import Extension, ExtensionType
File "/usr/lib/python2.7/dist-packages/cryptography/x509/extensions.py", line 18, in
from cryptography.hazmat.primitives import constant_time, serialization
File "/usr/lib/python2.7/dist-packages/cryptography/hazmat/primitives/constant_time.py", line 9, in
from cryptography.hazmat.bindings._constant_time import lib
AttributeError: 'module' object has no attribute '_init_cffi_1_0_external_module'
Certbot's behavior differed from what I expected because:
It raised an exception.
Here is a Certbot log showing the issue (if available):
Logs are stored in /var/log/letsencrypt by default. Feel free to redact domains, e-mail and IP addresses as you see fit.
Here is the relevant nginx server block or Apache virtualhost for the domain I am configuring:
<VirtualHost _default_:8000>
  DocumentRoot "/var/web"
  <Directory "/var/web">
    Options Indexes FollowSymLinks
    AllowOverride None
    Require all granted
  </Directory>

  <Directory "/var/web/git">
    Allow from all
    AllowOverride all
    Order allow,deny
    Options ExecCGI
    <Files gitweb.cgi>
      SetHandler cgi-script
    </Files>
  </Directory>

  DirectoryIndex gitweb.cgi
  SetEnv GITWEB_CONFIG /etc/gitweb.conf
</VirtualHost>