sruckh commented on 15 May 2018
If you're having trouble using Certbot and aren't sure you've found a bug or
request for a new feature, please first try asking for help at
https://community.letsencrypt.org/. There is a much larger community there of
people familiar with the project who will be able to more quickly answer your
questions.
My operating system is (include version):
CentOS 7.5
I installed Certbot with (certbot-auto, OS package manager, pip, etc):
OS package:
python2-certbot-0.23.0-1.el7.noarch
certbot-0.23.0-1.el7.noarch
I ran this command and it produced this output:
sudo certbot certificates
Traceback (most recent call last):
File "/bin/certbot", line 5, in
from pkg_resources import load_entry_point
File "/usr/lib/python2.7/site-packages/pkg_resources.py", line 3011, in
parse_requirements(requires), Environment()
File "/usr/lib/python2.7/site-packages/pkg_resources.py", line 626, in resolve
raise DistributionNotFound(req)
pkg_resources.DistributionNotFound: urllib3>=1.21.1,<1.23
Certbot's behavior differed from what I expected because:
Prior to CentOS 7.5 update the 'certificates' command used to list out the certificates which had been generated, and not prints out error.
Here is a Certbot log showing the issue (if available):
Logs are stored in /var/log/letsencrypt by default. Feel free to redact domains, e-mail and IP addresses as you see fit.
2018-05-11 21:03:11,631:DEBUG:certbot.log:Exiting abnormally:
Traceback (most recent call last):
File "/bin/certbot", line 9, in
load_entry_point('certbot==0.23.0', 'console_scripts', 'certbot')()
File "/usr/lib/python2.7/site-packages/certbot/main.py", line 1266, in main
return config.func(config, plugins)
File "/usr/lib/python2.7/site-packages/certbot/main.py", line 1157, in certonly
lineage = _get_and_save_cert(le_client, config, domains, certname, lineage)
File "/usr/lib/python2.7/site-packages/certbot/main.py", line 118, in _get_and_save_cert
lineage = le_client.obtain_and_enroll_certificate(domains, certname)
File "/usr/lib/python2.7/site-packages/certbot/client.py", line 350, in obtain_and_enroll_certificate
cert, chain, key, _ = self.obtain_certificate(domains)
File "/usr/lib/python2.7/site-packages/certbot/client.py", line 294, in obtain_certificate
orderr = self._get_order_and_authorizations(csr.data, self.config.allow_subset_of_names)
File "/usr/lib/python2.7/site-packages/certbot/client.py", line 330, in _get_order_and_authorizations
authzr = self.auth_handler.handle_authorizations(orderr, best_effort)
File "/usr/lib/python2.7/site-packages/certbot/auth_handler.py", line 66, in handle_authorizations
self._choose_challenges(aauthzrs)
File "/usr/lib/python2.7/site-packages/certbot/auth_handler.py", line 108, in _choose_challenges
combinations)
File "/usr/lib/python2.7/site-packages/certbot/auth_handler.py", line 407, in gen_challenge_path
return _find_smart_path(challbs, preferences, combinations)
File "/usr/lib/python2.7/site-packages/certbot/auth_handler.py", line 444, in _find_smart_path
_report_no_chall_path(challbs)
File "/usr/lib/python2.7/site-packages/certbot/auth_handler.py", line 483, in _report_no_chall_path
raise errors.AuthorizationError(msg)
AuthorizationError: Client with the currently selected authenticator does not support any combination of challenges that will satisfy the CA
Here is the relevant nginx server block or Apache virtualhost for the domain I am configuring:
N/A; at this point just trying to list certificates