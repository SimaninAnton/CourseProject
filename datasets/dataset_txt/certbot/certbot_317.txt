Member
bmw commented on 11 Dec 2018
This would have prevented #6563.
My thought would be to just use the same versions that we pin in certbot-auto which can be found at https://github.com/certbot/certbot/blob/master/letsencrypt-auto-source/pieces/dependency-requirements.txt.
My thought would be to continue to install acme/certbot from the local files though. This allows us to do things like offer our rolling tag based on master and seems most conventional as otherwise the Dockerfile basically ignores the build context.
The problem this causes is the packages in our repo root don't have hashes and pip gets mad when you enforce hashes on some packages but not all. To resolve this I think we either need to:
Install package dependencies first in a separate pip install command and then install acme/certbot.
Remove hashes from the file. We probably want to do this at runtime because we do want the file with hashes in certbot-auto. This is the approach taken at
certbot/tools/pip_install.py
Line 51 in 353d092
 search = re.search(r'^(\S*==\S*).*$', line) 
.
I think I personally prefer the 1st option.