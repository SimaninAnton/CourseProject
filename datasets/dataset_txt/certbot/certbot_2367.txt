ied206 commented on 25 Feb 2016
Hello, I found current letsencrypt-auto has an issue with WSGIDaemonProcess config.
This is part of my apache2 config in /etc/apache2/sites-enabled/003-ctf.conf, which connects to django using WSGI.
WSGIDaemonProcess kctf python-path=/var/www/ctf:/var/www/ctf/kctfenv/lib/python2.7/site-packages
WSGIProcessGroup kctf
WSGIScriptAlias / /var/www/ctf/kctf/wsgi.py
This config forms default http connection.
When letsencrypt is run, it copies .conf file to another .conf file, then add ssl configurations, then restarting apache2 instantly.
However, WSGIDaemonProcess cannot be duplicated in .conf files, so letsencrypt-auto faces reboot failure and fall back.
This is because WSGIDaemonProcess which has same group name must exist in 'one' file.
If it exists in http conf file, it must be not in https conf file.
Currently, before running letsencrypt-auto, I must comment WSGIDaemonProcess temporary.
After running letsencrypt-auto, I uncomment WSGIDaemonProcess in http conf file and restart once more.
This way, WSGIDaemonProcess is commented in https conf file, so apache2 do not suffer from restart failure.
I hope letsencrypt gets better by fixing this problem.