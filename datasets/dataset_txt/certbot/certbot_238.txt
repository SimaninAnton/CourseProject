Co6aka commented on 8 Mar 2019
If you're having trouble using Certbot and aren't sure you've found a bug or
request for a new feature, please first try asking for help at
https://community.letsencrypt.org/. There is a much larger community there of
people familiar with the project who will be able to more quickly answer your
questions.
My operating system is (include version):
$ lsb_release -a
No LSB modules are available.
Distributor ID: Ubuntu
Description: Ubuntu 18.04.2 LTS
Release: 18.04
Codename: bionic
$ uname -a
Linux [my_computer_name_here] 4.20.14-042014-generic #201903051334 SMP Tue Mar 5 18:36:32 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux
I installed Certbot with (certbot-auto, OS package manager, pip, etc):
APT (Synaptic) from Ubuntu Repository (ppa:certbot/certbot)
Have tried complete removal and reinstall; same results.
Same results with manual option on another identically-provisioned computer.
I ran this command and it produced this output:
$ sudo certbot --nginx -vvvv -d [entered_my_domain_here]
Root logging level set at -20
Saving debug log to /var/log/letsencrypt/letsencrypt.log
Requested authenticator nginx and installer nginx
Single candidate plugin: * nginx
Description: Nginx Web Server plugin
Interfaces: IAuthenticator, IInstaller, IPlugin
Entry point: nginx = certbot_nginx.configurator:NginxConfigurator
Initialized: <certbot_nginx.configurator.NginxConfigurator object at 0x7f0a8083fac8>
Prep: True
Selected authenticator <certbot_nginx.configurator.NginxConfigurator object at 0x7f0a8083fac8> and installer <certbot_nginx.configurator.NginxConfigurator object at 0x7f0a8083fac8>
Plugins selected: Authenticator nginx, Installer nginx
Enter email address (used for urgent renewal and security notices) (Enter 'c' to
cancel): [entered_my_email_address_here]
Sending GET request to https://acme-v02.api.letsencrypt.org/directory.
Starting new HTTPS connection (1): acme-v02.api.letsencrypt.org:443
Segmentation fault
ALSO TRIED:
$ sudo certbot --manual -vvvv certonly
Root logging level set at -20
Saving debug log to /var/log/letsencrypt/letsencrypt.log
Requested authenticator manual and installer None
Single candidate plugin: * manual
Description: Manual configuration or run your own shell scripts
Interfaces: IAuthenticator, IPlugin
Entry point: manual = certbot.plugins.manual:Authenticator
Initialized: <certbot.plugins.manual.Authenticator object at 0x7f3e78c0fa58>
Prep: True
Selected authenticator <certbot.plugins.manual.Authenticator object at 0x7f3e78c0fa58> and installer None
Plugins selected: Authenticator manual, Installer None
Enter email address (used for urgent renewal and security notices) (Enter 'c' to
cancel): [entered_my_email_address_here]
Sending GET request to https://acme-v02.api.letsencrypt.org/directory.
Starting new HTTPS connection (1): acme-v02.api.letsencrypt.org:443
Segmentation fault
Certbot's behavior differed from what I expected because:
Crashes every time with "Segmentation fault" message, without and with "-vvvv" option.
Here is a Certbot log showing the issue (if available):
WITH NGINX OPTION:
2019-03-07 19:01:19,737:DEBUG:certbot.main:certbot version: 0.31.0
2019-03-07 19:01:19,739:DEBUG:certbot.main:Arguments: ['--nginx', '-vvvv', '-d', '[my_domain_here]']
2019-03-07 19:01:19,740:DEBUG:certbot.main:Discovered plugins: PluginsRegistry(PluginEntryPoint#manual,PluginEntryPoint#nginx,PluginEntryPoint#null,PluginEntryPoint#standalone,PluginEntryPoint#webroot)
2019-03-07 19:01:19,751:DEBUG:certbot.log:Root logging level set at -20
2019-03-07 19:01:19,752:INFO:certbot.log:Saving debug log to /var/log/letsencrypt/letsencrypt.log
2019-03-07 19:01:19,752:DEBUG:certbot.plugins.selection:Requested authenticator nginx and installer nginx
2019-03-07 19:01:20,518:DEBUG:certbot.plugins.selection:Single candidate plugin: * nginx
Description: Nginx Web Server plugin
Interfaces: IAuthenticator, IInstaller, IPlugin
Entry point: nginx = certbot_nginx.configurator:NginxConfigurator
Initialized: <certbot_nginx.configurator.NginxConfigurator object at 0x7f0a8083fac8>
Prep: True
2019-03-07 19:01:20,522:DEBUG:certbot.plugins.selection:Selected authenticator <certbot_nginx.configurator.NginxConfigurator object at 0x7f0a8083fac8> and installer <certbot_nginx.configurator.NginxConfigurator object at 0x7f0a8083fac8>
2019-03-07 19:01:20,523:INFO:certbot.plugins.selection:Plugins selected: Authenticator nginx, Installer nginx
2019-03-07 19:01:33,178:DEBUG:acme.client:Sending GET request to https://acme-v02.api.letsencrypt.org/directory.
2019-03-07 19:01:33,180:DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): acme-v02.api.letsencrypt.org:443
WITH MANUAL OPTION:
2019-03-07 19:11:11,483:DEBUG:certbot.main:certbot version: 0.31.0
2019-03-07 19:11:11,484:DEBUG:certbot.main:Arguments: ['--manual', '-vvvv']
2019-03-07 19:11:11,485:DEBUG:certbot.main:Discovered plugins: PluginsRegistry(PluginEntryPoint#manual,PluginEntryPoint#nginx,PluginEntryPoint#null,PluginEntryPoint#standalone,PluginEntryPoint#webroot)
2019-03-07 19:11:11,494:DEBUG:certbot.log:Root logging level set at -20
2019-03-07 19:11:11,495:INFO:certbot.log:Saving debug log to /var/log/letsencrypt/letsencrypt.log
2019-03-07 19:11:11,496:DEBUG:certbot.plugins.selection:Requested authenticator manual and installer None
2019-03-07 19:11:11,496:DEBUG:certbot.plugins.selection:Single candidate plugin: * manual
Description: Manual configuration or run your own shell scripts
Interfaces: IAuthenticator, IPlugin
Entry point: manual = certbot.plugins.manual:Authenticator
Initialized: <certbot.plugins.manual.Authenticator object at 0x7f3e78c0fa58>
Prep: True
2019-03-07 19:11:11,498:DEBUG:certbot.plugins.selection:Selected authenticator <certbot.plugins.manual.Authenticator object at 0x7f3e78c0fa58> and installer None
2019-03-07 19:11:11,498:INFO:certbot.plugins.selection:Plugins selected: Authenticator manual, Installer None
2019-03-07 19:11:20,580:DEBUG:acme.client:Sending GET request to https://acme-v02.api.letsencrypt.org/directory.
2019-03-07 19:11:20,583:DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): acme-v02.api.letsencrypt.org:443
Here is the relevant nginx server block or Apache virtualhost for the domain I am configuring:
I prefer to not publish that publicly.