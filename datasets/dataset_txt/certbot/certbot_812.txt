Member
bmw commented on 12 Jan 2018 â€¢
edited
My operating system is (include version):
Ubuntu 16.04
I installed Certbot with (certbot-auto, OS package manager, pip, etc):
Dev instructions (I was on commit 5d58a3d so this is unrelated to HTTP01 support in Nginx)
I ran this command and it produced this output:
Starting with the default Nginx config on this system I ran:
sudo certbot -a webroot -w /var/www/html/ -d example.org -i nginx --no-redirect
sudo certbot -a webroot -w /var/www/html/ -d abc.example.org  -d def.example.org -i nginx --no-redirect
which gave me:
nginx: [emerg] duplicate listen options for [::]:443 in /etc/nginx/sites-enabled/default:200
Encountered exception:
Traceback (most recent call last):
  File "/home/bmw/src/certbot/certbot/client.py", line 462, in deploy_certificate
    self.installer.restart()
  File "/home/bmw/src/certbot/certbot-nginx/certbot_nginx/configurator.py", line 687, in restart
    nginx_restart(self.conf('ctl'), self.nginx_conf)
  File "/home/bmw/src/certbot/certbot-nginx/certbot_nginx/configurator.py", line 919, in nginx_restart
    "nginx restart failed:\n%s\n%s" % (out.read(), err.read()))
MisconfigurationError: nginx restart failed:



Calling registered functions
Rolling back to previous server configuration...
Reporting to user: We were unable to install your certificate, however, we successfully restored your server to its prior configuration.