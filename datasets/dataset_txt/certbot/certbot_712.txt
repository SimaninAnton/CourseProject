Pseudodevincent commented on 25 Feb 2018 â€¢
edited
If you're having trouble using Certbot and aren't sure you've found a bug or
request for a new feature, please first try asking for help at
https://community.letsencrypt.org/. There is a much larger community there of
people familiar with the project who will be able to more quickly answer your
questions.
My operating system is (include version):
Debian 9.3
4.9.0-4-grsec-amd64
I installed Certbot with (certbot-auto, OS package manager, pip, etc):
sudo apt-get install python-certbot-apache
I ran this command and it produced this output:
sudo certbot renew
Saving debug log to /var/log/letsencrypt/letsencrypt.log
Processing /etc/letsencrypt/renewal/example1.com.conf
Cert not yet due for renewal
Processing /etc/letsencrypt/renewal/example2.com.conf
Cert not yet due for renewal
Processing /etc/letsencrypt/renewal/example3.com.conf
Cert not yet due for renewal
Processing /etc/letsencrypt/renewal/example4.com.conf
Cert is due for renewal, auto-renewing...
Erreur de segmentation
Certbot's behavior differed from what I expected because:
It was working well before
Here is a Certbot log showing the issue (if available):
From syslog:
Feb 24 21:43:30 ns330342 kernel: [26612.430473] grsec: From 81.249.218.220: denied RWX mmap of by /usr/bin/certbot[certbot:30586] uid/euid:0/0 gid/egid:0/0, parent /usr/bin/sudo[sudo:30585] uid/euid:0/0 gid/egid:0/0
Feb 24 21:43:30 ns330342 kernel: [26612.442346] certbot[30586]: segfault at 0 ip 00000389df0e3c0b sp 000003c20e2899d8 error 6 in libffi.so.6.0.4[389df0de000+7000]
Feb 24 21:43:30 ns330342 kernel: [26612.451877] grsec: From 81.249.218.220: Segmentation fault occurred at (nil) in /usr/bin/certbot[certbot:30586] uid/euid:0/0 gid/egid:0/0, parent /usr/bin/sudo[sudo:30585] uid/euid:0/0 gid/egid:0/0
Feb 24 21:43:31 ns330342 kernel: [26612.461546] grsec: From 81.249.218.220: denied resource overstep by requesting 4096 for RLIMIT_CORE against limit 0 for /usr/bin/certbot[certbot:30586] uid/euid:0/0 gid/egid:0/0, parent /usr/bin/sudo[sudo:30585] uid/euid:0/0 gid/egid:0/0
Feb 24 21:43:31 ns330342 kernel: [26612.511813] grsec: From 81.249.218.220: Segmentation fault occurred at 0000000000007779 in /usr/bin/sudo[sudo:30585] uid/euid:0/0 gid/egid:0/0, parent /bin/bash[bash:30563] uid/euid:1000/1000 gid/egid:1000/1000
Logs are stored in /var/log/letsencrypt by default. Feel free to redact domains, e-mail and IP addresses as you see fit.
Here is the relevant nginx server block or Apache virtualhost for the domain I am configuring: