Member
bmw commented on 11 Dec 2018
While #6580 suggests a simple way to pin Python dependencies in our main Docker image, doing it each for each of our DNS plugins is slightly more work but also valuable to avoid the same problem.
The way we pin these dependencies elsewhere is by using https://github.com/certbot/certbot/blob/master/tools/dev_constraints.txt which is a catch all list of all dependencies. Maybe we use this catch all file that we initially made just for our dev setup, but I'm not sure it will work because it's not in the build context of the Dockerfile which is its directory and everything it contains. Maybe we can change the build context on Docker Hub? Even so, using this dev file feels a little hacky to me.
Another way we could approach is this is creating new files in each DNS plugin directory pinning the dependencies it has. These dependencies can be found by running pip freeze and I think that all of our packages and dependencies already pinned in #6580 should be removed these files.
While this works, I'd like to avoid us having multiple sets of dependencies we have to remember to update so after doing this, I think we should also rework the scripts in tools to use these new files as well. https://github.com/certbot/certbot/blob/master/tools/merge_requirements.py could be used to merge this into a single file and handle shared dependencies.