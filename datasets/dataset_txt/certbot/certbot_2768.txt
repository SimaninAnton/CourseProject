vasilevich commented on 8 Dec 2015
Apologize in advance, I would edit it myself but lack the knowledge in python.
the HTTP redirect is implemented wrong:
example of current implementation
SERVER{
if(its http)
{redirect to HTTP}
listen 443 ssl;
}
problem: http traffic will never reach this block due to listen 443.
instead you should make an entirely new block
with the exact same server names:
server{
listen 80; #is default anyway
server names exactly like in the edited block...
return ...what's in the if;
}