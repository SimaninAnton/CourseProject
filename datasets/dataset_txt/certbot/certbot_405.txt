ethanj commented on 7 Sep 2018
STATUS
I figured out the cause of my issue, but certbot should be fixed so this is way more obvious.
What I did
I added a cron job as follows
0 3 * * * /usr/bin/certbot renew -n --pre-hook "service nginx stop" --post-hook "service nginx start"
The cron log show it running with no output other than the following single line
...
Sep 6 03:00:01 ip-172-31-34-208 CROND[16715]: (root) CMD (/usr/bin/certbot renew -n --pre-hook "service nginx stop" --post-hook "service nginx start")
...
The Certbot log has no contents generated from the cron job.
I figured out that the pre and post hooks needed to have full paths as follows
0 3 * * * /usr/bin/certbot renew -n --pre-hook "/sbin/service nginx stop" --post-hook "/sbin/service nginx start"
Now it works, and generates correct output in the Certbot log.
What should have happened?
There should be an error generated in the Certbot log showing that the pre-hook failed, rather than having no log output at all (regardless of verbosity setting).