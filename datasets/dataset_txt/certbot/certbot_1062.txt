chrylis commented on 13 Jul 2017
I'm using certbot 0.16.0 on Arch (upgraded from 0.12.0 because of this problem, which is still there).
I administer a TLD with a number of hostnames, many of which aren't live at any given time and which can't trivially be given distinct challenge texts (they're staging containers for a blue-green CD pipeline that's public-facing). In order to generate certificates, I need to use DNS challenges. However, the renew command hard-forces noninteractive mode (cli.py:561), with absolutely no way to override it. Since DNS challenges require interactive mode (and I'm manually updating the TXT records anyway), there's simply no way to renew the certificates.
I commented out line 561 with no obvious deleterious effects; the interactive challenge protocol went through normally, and I got a renewed certificate.
This is a nasty gotcha with no clear rationale and no clear workaround. My proposed resolution is to simply drop the restrictions on the renew subcommand.