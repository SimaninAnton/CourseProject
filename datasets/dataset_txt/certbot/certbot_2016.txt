tinganho commented on 11 Jun 2016
I've got some slight problem dockerizing certbot. I try to dockerize certbot by letting it install itself on a ubuntu container.
These are the commands I run:
RUN mkdir -p /opt/letsencrypt
RUN curl -sL https://dl.eff.org/certbot-auto > /opt/letsencrypt/certbot-auto
RUN chmod a+x /opt/letsencrypt/certbot-auto
RUN /opt/letsencrypt/certbot-auto --os-packages-only
But it aborts when the interactive prompt comes up:
The following extra packages will be installed:
  binutils cpp cpp-4.8 gcc-4.8 gcc-4.8-base libasan0 libatomic1 libc-dev-bin
  libc6 libc6-dev libcloog-isl4 libexpat1 libexpat1-dev libgcc-4.8-dev
  libgmp10 libgomp1 libisl10 libitm1 libmpc3 libmpfr4 libpython-dev
  libpython-stdlib libpython2.7 libpython2.7-dev libpython2.7-minimal
  libpython2.7-stdlib libquadmath0 libssl1.0.0 libstdc++6 libtsan0
  linux-libc-dev python-minimal python-pkg-resources python-setuptools
  python2.7 python2.7-dev python2.7-minimal zlib1g-dev
Suggested packages:
  augeas-doc binutils-doc cpp-doc gcc-4.8-locales gcc-multilib make
  manpages-dev autoconf automake1.9 libtool flex bison gdb gcc-doc
  gcc-4.8-multilib gcc-4.8-doc libgcc1-dbg libgomp1-dbg libitm1-dbg
  libatomic1-dbg libasan0-dbg libtsan0-dbg libquadmath0-dbg augeas-tools
  glibc-doc python-doc python-tk python-distribute python-distribute-doc
  python2.7-doc binfmt-support
Recommended packages:
  libssl-doc python-pip
The following NEW packages will be installed:
  augeas-lenses binutils cpp cpp-4.8 dialog gcc gcc-4.8 libasan0 libatomic1
  libaugeas0 libc-dev-bin libc6-dev libcloog-isl4 libexpat1-dev libffi-dev
  libgcc-4.8-dev libgmp10 libgomp1 libisl10 libitm1 libmpc3 libmpfr4
  libpython-dev libpython-stdlib libpython2.7 libpython2.7-dev
  libpython2.7-minimal libpython2.7-stdlib libquadmath0 libssl-dev libtsan0
  linux-libc-dev python python-dev python-minimal python-pkg-resources
  python-setuptools python-virtualenv python2.7 python2.7-dev
  python2.7-minimal zlib1g-dev
The following packages will be upgraded:
  ca-certificates gcc-4.8-base libc6 libexpat1 libssl1.0.0 libstdc++6
6 upgraded, 42 newly installed, 0 to remove and 42 not upgraded.
Need to get 54.5 MB of archives.
After this operation, 137 MB of additional disk space will be used.
Do you want to continue? [Y/n] Abort
My goal is to dockerize certbot and haproxy and then auto renew by standalone
./certbot-auto certonly --standalone --agree-tos --email $EMAIL --renew-by-default --rsa-key-size 4096 --standalone-supported-challenges http-01 $OPTION_LIST
It worked before with letsencrypt-auto. I had ./letsencrypt-auto --help to install letsencrypt. And it installed everything when I ran docker build.