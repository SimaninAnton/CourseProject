veerendra2 commented on 15 Mar 2017
My operating system is (include version):
Linux 10.0.0.169 2.6.32-642.11.1.el6.centos.plus.x86_64 #1 SMP Sat Nov 19 13:48:44 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux
I installed Certbot with (certbot-auto, OS package manager, pip, etc):
sudo yum install python-certbot-apache
wget https://dl.eff.org/certbot-auto
chmod a+x ./certbot-auto
pip versions: all are showing 9.0
Default python version is 2.7
[root@10 ~]# which pip2.6
/usr/bin/pip2.6
[root@10 ~]# which pip2.7
/usr/bin/pip2.7
[root@10 ~]# pip2.6 -V
pip 9.0.1 from /usr/lib/python2.6/site-packages (python 2.6)
[root@10 ~]# pip -V
pip 9.0.1 from /usr/lib/python2.7/site-packages (python 2.7)
I ran this command and it produced this output:
./certbot-auto --apache
------------Truncating Ouput ------------
    c/call_python.c:190: error: ‘state’ undeclared (first use in this function)
    c/call_python.c:196: warning: implicit declaration of function ‘fprintf’
    c/call_python.c:196: warning: incompatible implicit declaration of built-in function ‘fprintf’
    c/call_python.c:196: error: ‘stderr’ undeclared (first use in this function)
    In file included from c/_cffi_backend.c:6413:
    c/cffi1_module.c: At top level:
    c/cffi1_module.c:22: error: expected ‘)’ before ‘*’ token
    c/cffi1_module.c:76: error: expected declaration specifiers or ‘...’ before ‘PyObject’
    c/cffi1_module.c:77: error: expected declaration specifiers or ‘...’ before ‘PyObject’
    c/cffi1_module.c: In function ‘make_included_tuples’:
    c/cffi1_module.c:79: error: ‘Py_ssize_t’ undeclared (first use in this function)
    c/cffi1_module.c:79: warning: statement with no effect
    c/cffi1_module.c:79: error: expected ‘;’ before ‘num’
    c/cffi1_module.c:86: error: ‘num’ undeclared (first use in this function)
    c/cffi1_module.c:86: error: lvalue required as increment operand
    c/cffi1_module.c:86: warning: statement with no effect
    c/cffi1_module.c:88: error: ‘included_ffis’ undeclared (first use in this function)
    c/cffi1_module.c:88: warning: assignment makes pointer from integer without a cast
    c/cffi1_module.c:89: error: ‘included_libs’ undeclared (first use in this function)
    c/cffi1_module.c:89: warning: assignment makes pointer from integer without a cast
    c/cffi1_module.c:93: warning: statement with no effect
    c/cffi1_module.c:95: error: ‘PyObject’ undeclared (first use in this function)
    c/cffi1_module.c:95: error: ‘included_ffi’ undeclared (first use in this function)
    c/cffi1_module.c:95: error: invalid operands to binary * (have ‘void **’ and ‘void **’)
    c/cffi1_module.c:95: error: ‘included_lib’ undeclared (first use in this function)
    c/cffi1_module.c:95: warning: left-hand operand of comma expression has no effect
    c/cffi1_module.c:95: warning: statement with no effect
    c/cffi1_module.c:96: error: ‘m’ undeclared (first use in this function)
    c/cffi1_module.c:96: error: invalid operands to binary * (have ‘void **’ and ‘void **’)
    c/cffi1_module.c:96: warning: implicit declaration of function ‘PyImport_ImportModule’
    c/cffi1_module.c:96: warning: statement with no effect
    c/cffi1_module.c:100: warning: implicit declaration of function ‘PyObject_GetAttrString’
    c/cffi1_module.c:100: warning: statement with no effect
    c/cffi1_module.c:104: warning: pointer/integer type mismatch in conditional expression
    c/cffi1_module.c:104: warning: statement with no effect
    c/cffi1_module.c:111: warning: implicit declaration of function ‘PyObject_TypeCheck’
    c/cffi1_module.c:111: error: ‘FFI_Type’ undeclared (first use in this function)
    c/cffi1_module.c:112: error: ‘Lib_Type’ undeclared (first use in this function)
    c/cffi1_module.c:112: warning: comparison between pointer and integer
    c/cffi1_module.c:114: error: lvalue required as increment operand
    c/cffi1_module.c:114: warning: statement with no effect
    c/cffi1_module.c:119: error: ‘PyExc_ImportError’ undeclared (first use in this function)
    c/cffi1_module.c: At top level:
    c/cffi1_module.c:128: error: expected ‘=’, ‘,’, ‘;’, ‘asm’ or ‘__attribute__’ before ‘*’ token
    c/cffi1_module.c:150: error: expected ‘=’, ‘,’, ‘;’, ‘asm’ or ‘__attribute__’ before ‘*’ token
    c/_cffi_backend.c:6434: error: expected ‘=’, ‘,’, ‘;’, ‘asm’ or ‘__attribute__’ before ‘init_cffi_backend’
    error: command 'gcc' failed with exit status 1
    
    ----------------------------------------
Command "/root/.local/share/letsencrypt/bin/python2.7 -u -c "import setuptools, tokenize;__file__='/tmp/pip-build-3JGvB2/cffi/setup.py';exec(compile(getattr(tokenize, 'open', open)(__file__).read().replace('\r\n', '\n'), __file__, 'exec'))" install --record /tmp/pip-s40VuD-record/install-record.txt --single-version-externally-managed --compile --install-headers /root/.local/share/letsencrypt/include/site/python2.7/cffi" failed with error code 1 in /tmp/pip-build-3JGvB2/cffi
You are using pip version 8.0.3, however version 9.0.1 is available.
You should consider upgrading via the 'pip install --upgrade pip' command.
=====================================================

Certbot has problem setting up the virtual environment.

We were not be able to guess the right solution from your pip 
output.

Consult https://certbot.eff.org/docs/install.html#problems-with-python-virtual-environment
for possible solutions.
You may also find some support resources at https://certbot.eff.org/support/ .
Certbot's behavior differed from what I expected because:
It should work without errors
Here is a Certbot log showing the issue (if available):
Logs are stored in /var/log/letsencrypt by default. Feel free to redact domains, e-mail and IP addresses as you see fit.
I could not find /var/log/letsencrypt log file