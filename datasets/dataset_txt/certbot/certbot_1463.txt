terrycloth commented on 21 Jan 2017
My system setup:
Fedora 25 Server (64-bit)
certbot 0.9.3
openssl 1.0.2j
What I did:
Using the domains config line, I successfully generated a certificate for all my domains and subdomains at once, but it apparently causes a problem for renewing them. certbot complains that you can't specify individual domains, even though no domains are specified on the command line.
↪  sudo certbot renew  --pre-hook "systemctl stop nginx.service"  \
    --post-hook "systemctl start nginx.service"
Saving debug log to /var/log/letsencrypt/letsencrypt.log
No renewals attempted, so not running post-hook
Currently, the renew verb is only capable of renewing all installed
certificates that are due to be renewed; individual domains cannot
be specified with this action. If you would like to renew specific
certificates, use the certonly command. The renew verb may provide
other options for selecting certificates to renew in the future.

<exit code 1>
When I comment out the domains line in cli.ini, certbot renew behaves as expected.
↪  sudo certbot renew  --pre-hook "systemctl stop nginx.service"  \
    --post-hook "systemctl start nginx.service"
Saving debug log to /var/log/letsencrypt/letsencrypt.log

-----------------------------------------------------------------------
Processing /etc/letsencrypt/renewal/<MY_DOMAIN>.conf
-----------------------------------------------------------------------
Cert not yet due for renewal

The following certs are not due for renewal yet:
  /etc/letsencrypt/live/<MY_DOMAIN>/fullchain.pem (skipped)
No renewals were attempted.
No renewals attempted, so not running post-hook