FgfdCBVCbnsebtgf commented on 7 Nov 2018
Certbot was installed using your instructions (no plug in version).
Trying to run: certbot --apache
Failed to find executable /root/certbot-renew in PATH: /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games
renew-hook command /root/certbot-renew exists, but is not executable.
I manually made chmod +X /root/certbot-renew and then it runs but gives this error:
certbot --apache
Saving debug log to /var/log/letsencrypt/letsencrypt.log
The apache plugin is not working; there may be problems with your existing configuration.
The error was: PluginError('There has been an error in parsing the file /etc/apache2/sites-enabled/mysite.conf on line 13: Syntax error',)
In the log appears:
2018-11-07 12:56:11,283:DEBUG:certbot.main:certbot version: 0.26.1
2018-11-07 12:56:11,284:DEBUG:certbot.main:Arguments: ['--apache']
2018-11-07 12:56:11,285:DEBUG:certbot.main:Discovered plugins: PluginsRegistry(PluginEntryPoint#apache,PluginEntryPoint#manual,PluginEntryPoint#null,PluginEntryPoint#sta$
2018-11-07 12:56:11,301:DEBUG:certbot.log:Root logging level set at 20
2018-11-07 12:56:11,302:INFO:certbot.log:Saving debug log to /var/log/letsencrypt/letsencrypt.log
2018-11-07 12:56:11,304:DEBUG:certbot.plugins.selection:Requested authenticator apache and installer apache
2018-11-07 12:56:11,525:DEBUG:certbot_apache.configurator:Apache version is 2.4.18
2018-11-07 12:56:12,111:DEBUG:certbot.plugins.disco:Other error:(PluginEntryPoint#apache): There has been an error in parsing the file /etc/apache2/sites-enabled/bestbat$
Traceback (most recent call last):
File "/usr/lib/python3/dist-packages/certbot/plugins/disco.py", line 132, in prepare
self._initialized.prepare()
File "/usr/lib/python3/dist-packages/certbot_apache/configurator.py", line 234, in prepare
self.check_parsing_errors("httpd.aug")
File "/usr/lib/python3/dist-packages/certbot_apache/augeas_configurator.py", line 77, in check_parsing_errors
raise errors.PluginError(msg)
certbot.errors.PluginError: There has been an error in parsing the file /etc/apache2/sites-enabled/bestbatteriesonline.conf on line 13: Syntax error
I discovered that these lines of commands inside the mysite.conf must be commented to allow certbot to work:
            #RewriteCond %{HTTP_HOST} !=""
            #RewriteCond %{HTTP_HOST} ^www.mysite.com
            #RewriteRule (.*) https://mysite.com$1 [R=301,L]
            #SSLProxyEngine on   
Since the certbot runs automatically to renew the certificate, can you please fix this problem. Thank you.