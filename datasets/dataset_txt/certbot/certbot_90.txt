Member
bmw commented on 23 Aug 2019 â€¢
edited
With the resolution of #7322, we now seem to have a way to do this safely. The solution is not only to check that Nginx supports disabling TLS session tickets, but also to only do so if the version of OpenSSL used by Nginx is 1.0.2l or greater.
The best way to get the version of OpenSSL used by Nginx, as found by Erica, is:
Parsing openssl version from nginx -V. Printing openssl version info was added in Nginx 1.8.0, so that should be fine, as long as we remember to check for the "running with" parenthetical.
For error handling, I talked about this with people and right now we're thinking that:
If for some reason we fail to determine the OpenSSL version, we should keep session tickets at their default of enabled. Doing anything else isn't worth potentially breaking people's servers.
This could potentially be done in a later PR, but we should set up test farm tests that check that we can determine the OpenSSL version used by Nginx on all systems the tests are run on.
The combination of these two things should stop us from breaking people's servers if something changes around us detecting these versions and will let us know if this detection is broken on a major system that we support.