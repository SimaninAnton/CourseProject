vbotka commented on 3 Aug 2018 â€¢
edited
My operating system is (include version):
uname -a
FreeBSD srv.example.com 11.2-RELEASE FreeBSD 11.2-RELEASE #0 r335510: Fri Jun 22 04:32:14 UTC 2018 root@releng2.nyi.freebsd.org:/usr/obj/usr/src/sys/GENERIC amd64
I installed Certbot with (certbot-auto, OS package manager, pip, etc):
py27-certbot-0.25.1,1
I ran this command and it produced this output:
$ ll /usr/local/etc | grep letsencrypt
drwxr-xr-x 11 root wheel 512 Aug 3 08:39 letsencrypt/
$ date
Fri Aug 3 08:40:45 UTC 2018
$ certbot certonly --standalone --dry-run -d example.com
Saving debug log to /var/log/letsencrypt/letsencrypt.log
Plugins selected: Authenticator standalone, Installer None
Cert not due for renewal, but simulating renewal for dry run
Renewing an existing certificate
Performing the following challenges:
tls-sni-01 challenge for example.com
Waiting for verification...
Cleaning up challenges
IMPORTANT NOTES:
The dry run was successful.
$ ll /usr/local/etc | grep letsencrypt
drwxr-xr-x 11 root wheel 512 Aug 3 08:41 letsencrypt/
Certbot's behavior differed from what I expected because:
"certbot certonly --dry-run ..." changed the modification time of the directory letsencrypt. There are no changes inside the directory letsencrypt, hence there is no reason to change the mtime. Probably it would be good to wipe out the changes with utime after the operation when the dir is needed for a temporary purpose.
IDS complains about changed mtime.
Here is a Certbot log showing the issue (if available):
Logs are stored in /var/log/letsencrypt by default. Feel free to redact domains, e-mail and IP addresses as you see fit.
Here is the relevant nginx server block or Apache virtualhost for the domain I am configuring: