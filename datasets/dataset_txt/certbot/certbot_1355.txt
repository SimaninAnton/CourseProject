zenny commented on 7 Mar 2017 â€¢
edited
I am having multiple alias hosts problem similar to #1042 with a Debian8 Jessie server running nginx. Certbot version is 0.9.3-1~bpo8+2 installed using apt from jessie-backports.
I have four domains pointing to the same site and all DNS entries points to the same domain (All others except FIRST-DOMAIN.ORG are aliases).
The certs were issued three months back with the same vhosts config. But it failed when trying to renew the LE certs. The supposedly problematic FIRSTDOMAIN.ORG as of below is reachable from the Internet. Therefore. I tried to obtain certificate manually, yet one of the alias domain fails as of below:
# certbot certonly -n --text --agree-tos --authenticator webroot --server https://acme-v01.api.letsencrypt.org/directory --rsa-key-size 4096 --email noreply@SECOND-DOMAIN.COM -d FIRST-DOMAIN.ORG -d www.FIRST-DOMAIN.ORG -d FIRSTDOMAIN.ORG -d www.FIRSTDOMAIN.ORG -d SECOND-DOMAIN.COM -d www.SECOND-DOMAIN.COM -d SECONDDOMAIN.COM -d www.SECONDDOMAIN.COM --webroot-path /usr/local/ispconfig/interface/acme
Saving debug log to /var/log/letsencrypt/letsencrypt.log
Starting new HTTPS connection (1): acme-v01.api.letsencrypt.org
Obtaining a new certificate
Performing the following challenges:
http-01 challenge for FIRST-DOMAIN.ORG
http-01 challenge for www.FIRST-DOMAIN.ORG
http-01 challenge for FIRSTDOMAIN.ORG
http-01 challenge for www.FIRSTDOMAIN.ORG
http-01 challenge for SECOND-DOMAIN.COM
http-01 challenge for www.SECOND-DOMAIN.COM
http-01 challenge for SECONDDOMAIN.COM
http-01 challenge for www.SECONDDOMAIN.COM
Using the webroot path /usr/local/ispconfig/interface/acme for all unmatched domains.
Waiting for verification...
Cleaning up challenges
Unable to clean up challenge directory /usr/local/ispconfig/interface/acme/.well-known/acme-challenge
Failed authorization procedure. FIRSTDOMAIN.ORG (http-01): urn:acme:error:connection :: The server could not connect to the client to verify the domain :: Could not connect to www.FIRSTDOMAIN.ORG
IMPORTANT NOTES:
The following errors were reported by the server:
Domain: FIRSTDOMAIN.ORG
Type: connection
Detail: Could not connect to www.FIRSTDOMAIN.ORG
To fix these errors, please make sure that your domain name was
entered correctly and the DNS A record(s) for that domain
contain(s) the right IP address. Additionally, please check that
your computer has a publicly routable IP address and that no
firewalls are preventing the server from communicating with the
client. If you're using the webroot plugin, you should also verify
that you are serving files from the webroot path you provided.