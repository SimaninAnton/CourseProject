albertotb commented on 10 Dec 2015
When running ./letsencrypt-auto I get this error:
Traceback (most recent call last):
  File "/home/alberto/.local/share/letsencrypt/bin/letsencrypt", line 7, in <module>
    from letsencrypt.cli import main
  File "/home/alberto/.local/share/letsencrypt/lib/python2.7/site-packages/letsencrypt/cli.py", line 30, in <module>
    from letsencrypt import client
  File "/home/alberto/.local/share/letsencrypt/lib/python2.7/site-packages/letsencrypt/client.py", line 20, in <module>
    from letsencrypt import continuity_auth
  File "/home/alberto/.local/share/letsencrypt/lib/python2.7/site-packages/letsencrypt/continuity_auth.py", line 9, in <module>
    from letsencrypt import proof_of_possession
  File "/home/alberto/.local/share/letsencrypt/lib/python2.7/site-packages/letsencrypt/proof_of_possession.py", line 5, in <module>
    from cryptography import x509
  File "/home/alberto/.local/share/letsencrypt/lib/python2.7/site-packages/cryptography/x509/__init__.py", line 7, in <module>
    from cryptography.x509.base import (
  File "/home/alberto/.local/share/letsencrypt/lib/python2.7/site-packages/cryptography/x509/base.py", line 15, in <module>
    from cryptography.x509.extensions import Extension, ExtensionType
  File "/home/alberto/.local/share/letsencrypt/lib/python2.7/site-packages/cryptography/x509/extensions.py", line 18, in <module>
    from cryptography.hazmat.primitives import constant_time, serialization
  File "/home/alberto/.local/share/letsencrypt/lib/python2.7/site-packages/cryptography/hazmat/primitives/constant_time.py", line 7, in <module>
    import hmac
  File "/home/alberto/anaconda/lib/python2.7/hmac.py", line 8, in <module>
    from operator import _compare_digest as compare_digest
ImportError: cannot import name _compare_digest
I tracked it down to this issue http://stackoverflow.com/questions/26535043/python-flask-error-importerror-cannot-import-name-compare-digest. In fact, if I do
source ~/.local/share/letsencrypt/bin/activate
python --version
I get that the Python version is 2.7.6. However, outside that virtualenv my Python version is 2.7.11 (Anaconda dist). However letsencrypt-auto is creating a virtualenv with my system Python version (from /usr/bin/python). After creating the virtualenv, as it can be seen in the log, correctly tries to import the newer hmac.py from Anaconda (Python 2.7.11) and the mismatch occurs. How can I fix this?