Member
bmw commented on 20 May 2019 â€¢
edited
If Certbot was distributed as a snap, how would plugins work?
@basak said he'd get us some more info here, but some things for us to look into/consider are:
External virtual environment
We could create a virtual environment outside of the Certbot snap installation which Certbot could then pick up and use. Some questions that come to mind for me if we went this route are:
How would dependencies that are already included in Certbot core be handled? For instance, every plugin currently has to depend on Certbot. Would a 2nd copy be installed in the venv? What about the Python version in the snap and upgrades to it?
Would paths to things like shared libraries work when the venv is loaded from the snap?
What would we do with our own optionally installed plugins?
Add interface to snapd
This is something that Robie suggested. The way this would work is we'd add interfaces to snapd itself and users would need an updated version of the snap software to use the Certbot snap. In addition to just needing to know more about how snap interfaces work, my questions are:
Can whatever Certbot/plugin code that uses these interfaces be used outside of the snap system or is it snap specific?
How up-to-date are the various packaged versions of snapd? In particular I'd be curious about Debian, EPEL 7, RHEL/EPEL 8, OpenSuSe, and older versions of Ubuntu?
Would plugins also need classic confinement or could they use Certbot's? If the latter, are the snap maintainers OK with 3rd party plugins inheriting Certbot's classic confinement?
Content snaps
This is something else that Robie suggested. In addition to just needing to know more about how these work, my main questions are:
Can whatever Certbot/plugin code that uses these interfaces be used outside of the snap system or is it snap specific?
Would plugins also need classic confinement or could they use Certbot's? If the latter, are the snap maintainers OK with 3rd party plugins inheriting Certbot's classic confinement?
We change how Certbot plugins work
#6613