Member
pde commented on 3 Apr 2016
I have some renewal conf files that have started erroring since we've cleaned up renewal config entries. Here's one such file:
cert = /etc/letsencrypt/live/isnot.org/cert.pem
privkey = /etc/letsencrypt/live/isnot.org/privkey.pem
chain = /etc/letsencrypt/live/isnot.org/chain.pem
fullchain = /etc/letsencrypt/live/isnot.org/fullchain.pem

# Options used in the renewal process
[renewalparams]
apache_enmod = a2enmod
standalone_supported_challenges = "tls-sni-01,http-01"
account = a015e247a80f161ed2a1918624eecadc
apache_handle_modules = True
apache_server_root = /etc/apache2
apache_dismod = a2dismod
apache_handle_sites = True
authenticator = apache
apache_le_vhost_ext = -le-ssl.conf
apache_challenge_location = /etc/apache2
nginx_server_root = /etc/nginx
installer = apache
nginx_ctl = nginx
apache_vhost_root = /etc/apache2/sites-available
The error is:
2016-04-02 19:31:38,725:WARNING:letsencrypt.renewal:Attempting to renew cert from /etc/letsencrypt/renewal/isnot.org.conf produced an unexpected error: 'server'. Skipping.
2016-04-02 19:31:38,726:DEBUG:letsencrypt.renewal:Traceback was:
Traceback (most recent call last):
  File "/home/ubuntu/letsencrypt/letsencrypt/renewal.py", line 344, in renew_all_lineages
    main.obtain_cert(lineage_config, plugins, renewal_candidate)
  File "/home/ubuntu/letsencrypt/letsencrypt/main.py", line 513, in obtain_cert
    _, action = _auth_from_domains(le_client, config, domains, lineage)
  File "/home/ubuntu/letsencrypt/letsencrypt/main.py", line 90, in _auth_from_domains
    renewal.renew_cert(config, domains, le_client, lineage)
  File "/home/ubuntu/letsencrypt/letsencrypt/renewal.py", line 236, in renew_cert
    original_server = lineage.configuration["renewalparams"]["server"]
  File "/home/ubuntu/letsencrypt/venv/local/lib/python2.7/site-packages/configobj.py", line 554, in __getitem__
    val = dict.__getitem__(self, key)
KeyError: 'server'