rasa commented on 22 Mar 2016
Running
letsencrypt certonly --dry-run -c example.ini --text
with this config
<VirtualHost *:443>
    ServerName example.com
    Redirect "/" "https://www.example.com/"
    DocumentRoot /home/example/www/example.com
    Include /etc/letsencrypt/options-ssl-apache.conf
    SSLCertificateFile /etc/letsencrypt/live/example.com/cert.pem
    SSLCertificateKeyFile /etc/letsencrypt/live/example.com/privkey.pem
    SSLCertificateChainFile /etc/letsencrypt/live/example.com/chain.pem
</VirtualHost>
<VirtualHost *:443>
    ServerName www.example.com
    DocumentRoot /home/example/www/example.com
    Include /etc/letsencrypt/options-ssl-apache.conf
    SSLCertificateFile /etc/letsencrypt/live/example.com/cert.pem
    SSLCertificateKeyFile /etc/letsencrypt/live/example.com/privkey.pem
    SSLCertificateChainFile /etc/letsencrypt/live/example.com/chain.pem
</VirtualHost>
I got this error
We were unable to find a vhost with a ServerName or Address of example.com.
To fix it, I changed the config to
<VirtualHost *:443>
    ServerName example.com
    ServerAlias www.example.com
<If "%{HTTP_HOST} != 'www.example.com'">
    Redirect "/" "https://www.example.com/"
</If>
    DocumentRoot /home/example/www/example.com
    Include /etc/letsencrypt/options-ssl-apache.conf
    SSLCertificateFile /etc/letsencrypt/live/example.com/cert.pem
    SSLCertificateKeyFile /etc/letsencrypt/live/example.com/privkey.pem
    SSLCertificateChainFile /etc/letsencrypt/live/example.com/chain.pem
</VirtualHost>
which is a much better solution.