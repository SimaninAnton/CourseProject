own3mall commented on 10 Feb 2017
Is there a way to force Certbot to overwrite existing SSL certificates (that were not originally generated or tracked by Certbot) upon successful verification?
I'm trying to integrate Let's Encrypt into the Easy Hosting Control Panel (http://ehcpforce.tk).
Currently, the panel creates symlinks in the directories used by Certbot to the server's generic SSL certificate before making a certbot certificate request. These symlinks will be used as a fallback in the nginx or apache2 template for the domain in-case anything goes wrong with the certbot certificate generation. In this way, a security certificate will always exist and nginx won't crash complaining that one doesn't exist if certbot's process fails.
When I use the following command:
/usr/local/bin/certbot certonly --quiet --webroot --agree-tos --email myemail@weeee.com -d domain.com -d www.domain.com -w /var/www/vhosts/{RESTOFPATH}
Certbot sees that a folder exists in /etc/letsencrypt/live/domain.com, so instead of deleting the symlinks in that folder that point to a generic (invalid and self signed) certificate that I manually configured before certbot's run, it creates a new folder /etc/letsencrypt/live/domain.com-0001
Any chance it can overwrite what is in /etc/letsencrypt/live/domain.com
I do this because the control panel works by building a template file. Subdomains and domains may not be added to the master template until the run is over. As such, I want to run all certbot requests post template generation and an nginx reload or apache2 reload. The templates will find a certificate no matter what the result of certbot is.
I suppose I could script this myself, but it would be nice to have the option to overwrite what is there.
2