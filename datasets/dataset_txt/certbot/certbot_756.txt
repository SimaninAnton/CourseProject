Contributor
jsha commented on 2 Feb 2018
This code in certbot-apache/certbot_apache/configurator.py has a few problems:
It refers to certificates as "cert". Our style is to spell out "certificate" in documentation and errors whenever possible (command line flags are an exception since they're set in stone). See #4519.
It conflates two errors unnecessarily: Can't find SSLCertificateFile and can't find SSLCertificateKeyFile.
It doesn't mention the missing directives by name, when that would be easy to do.
Proposed: Break the if not path["cert_path"] or not path["cert_key"]: into two clauses, and each one should print an error like "Could not find SSLCertificateFile directive in %s."
        path = {"cert_path": self.parser.find_dir("SSLCertificateFile",
                                                  None, vhost.path),
                "cert_key": self.parser.find_dir("SSLCertificateKeyFile",
                                                 None, vhost.path)}

        # Only include if a certificate chain is specified
        if chain_path is not None:
            path["chain_path"] = self.parser.find_dir(
                "SSLCertificateChainFile", None, vhost.path)

        if not path["cert_path"] or not path["cert_key"]:
            # Throw some can't find all of the directives error"
            logger.warning(
                "Cannot find a cert or key directive in %s. "
                "VirtualHost was not modified", vhost.path)
            # Presumably break here so that the virtualhost is not modified
            raise errors.PluginError(
                "Unable to find cert and/or key directives")