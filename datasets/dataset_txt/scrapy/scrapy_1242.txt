esegal commented on Apr 27, 2015
This is a bug in scrapy.contrib.downloadermiddleware.redirect
I asked scrapy to crawl http://www.pcaobus.org:
scrapy fetch http://www.pcaobus.org
I get a redirect loop.
Here's the headers summary:
Request:
GET / HTTP/1.0 http://www.pcaobus.org/
Host: www.pcaobus.org
Response:
HTTP/1.0 301 OK
Location: http://pcaobus.org/
Request:
GET / HTTP/1.0 http://pcaobus.org/
Host: www.pcaobus.org
Response:
HTTP/1.0 301 OK
Location: http://pcaobus.org/
Notice how the host header didn't change, eventhough the URL did.
I've was able to fix it by adding line 25 to scrapy/contrib/downloadermiddleware/redirect.py
    24     def _redirect(self, redirected, request, spider, reason):
    25             redirected.headers.pop('Host', None)
    .
    .
    .