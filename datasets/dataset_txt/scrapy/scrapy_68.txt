botzill commented on Sep 1, 2019 â€¢
edited
I have a spider that is using proxy and I see when finshed this:
{'bans/error/twisted.web._newclient.ResponseNeverReceived': 5580,
 'downloader/exception_count': 5580,
 'downloader/exception_type_count/twisted.web._newclient.ResponseNeverReceived': 5580,
 'downloader/request_bytes': 10857668,
 'downloader/request_count': 17877,
 'downloader/request_method_count/GET': 1,
 'downloader/request_method_count/POST': 17876,
 'downloader/response_bytes': 173289486,
 'downloader/response_count': 12297,
 'downloader/response_status_count/200': 11799,
 'downloader/response_status_count/502': 498,
 'elapsed_time_seconds': 1574.070208,
 'finish_reason': 'finished',
 'finish_time': datetime.datetime(2019, 9, 1, 10, 23, 37, 55794),
 'item_scraped_count': 10669,
 'log_count/DEBUG': 53156,
 'log_count/ERROR': 5580,
 'log_count/INFO': 50,
 'memusage/max': 257974272,
 'memusage/startup': 53932032,
 'proxies/dead': 16,
 'proxies/good': 17,
 'proxies/mean_backoff': 49.755788241608414,
 'proxies/reanimated': 2,
 'proxies/unchecked': 0,
 'request_depth_max': 10,
 'response_received_count': 11799,
 'retry/count': 498,
 'retry/reason_count/502 Bad Gateway': 498,
 'scheduler/dequeued': 17877,
 'scheduler/dequeued/memory': 17877,
 'scheduler/enqueued': 17877,
 'scheduler/enqueued/memory': 17877,
 'start_time': datetime.datetime(2019, 9, 1, 9, 57, 22, 985586)}
2019-09-01 13:23:37 [scrapy.core.engine] INFO: Spider closed (finished)
I did update the retry download middleware retry to include these exceptions as well :
class RetryMiddleware(retry.RetryMiddleware):
    EXCEPTIONS_TO_RETRY = retry.RetryMiddleware.EXCEPTIONS_TO_RETRY + (
        ConnectBindError,
        ResponseNeverReceived
    )
So, does this mean that this error will be retried automatically?
because I see 'retry/count': 498 is less then ResponseNeverReceived count.
Thx!