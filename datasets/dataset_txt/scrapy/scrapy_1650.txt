Member
shaneaevans commented on Sep 9, 2011
Reported by cdeyoung on Trac http://dev.scrapy.org/ticket/323
In the constructor of the FormRequest? class in scrapy/http/request.form.py -- in the IF statement that handles the "formdata" argument -- there is a line that says:
    self.method = 'POST'
That line either shouldn't be there, falling back to the base class's method variable, or it should be handled differently if you want FormRequest? to default to POST rather that GET, as the Response base class does. Currently, you are hard-coding FormRequest? objects to be submitted via POST, and that isn't always valid. You should still allow the developer to specify method='GET' when using a FormRequest? object, I think.
If you want FormRequest? to default to submitting forms via POST, then I would recommend the following change, or something like it:
class FormRequest(Request):
    __slots__ = ()
    def __init__(self, *args, **kwargs):
        formdata = kwargs.pop('formdata', None)
        method = kwargs.pop('method', 'POST')

        super(FormRequest, self).__init__(*args, **kwargs)

        if formdata:
            self.method = method
            ...