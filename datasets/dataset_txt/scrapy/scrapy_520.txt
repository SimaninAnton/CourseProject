tuangeek commented on Oct 21, 2017 â€¢
edited
If I try to override the "Connection" in the headers with either custome_settings
custom_settings = {
        'DEFAULT_REQUEST_HEADERS': {
            'Connection' : 'Keep-Alive'
        }
}
or within the request headers
headers = {}
 headers['Connection'] : 'Keep-Alive'
 headers['User-Agent'] : 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/61.0.3163.100 Safari/537.36'

for url in urls:
     yield scrapy.Request(url, headers=headers, callback = self.parse)
It will result with a request with two "Connection"s in the header.
GET http://example.com HTTP/1.1
Connection: close
Connection: Keep-Alive
User-Agent: Scrapy/1.4.0 (+http://scrapy.org)
Accept-Encoding: gzip,deflate