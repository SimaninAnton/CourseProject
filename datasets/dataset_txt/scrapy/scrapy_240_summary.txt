Request URL changed during redirect result in 400 error