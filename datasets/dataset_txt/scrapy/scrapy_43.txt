django-kz commented on Oct 21, 2019
I am just learning your great library, but as I got OffsiteMiddleware doesn't filter out all foreign links.
For example, I am scrapping "whitneymiller.com" website, I am collecting all "a" tags within pages and putting them into parse method
def parse(self, response):
        self._parsed_urls.append(response.url)
        print("Parsing: ", response)
        sel = Selector(response)
        urls = sel.xpath("//*/a/@href").extract()
        for url in urls:
            full_url = response.urljoin(url)
            print("Requesting crawl of: ", full_url)
            self._requested_urls.append(full_url)
            yield scrapy.Request(response.urljoin(url), callback=self.parse)
-->
my settings for spider are as follows :
process = CrawlerProcess({
        'LOG_LEVEL': 'CRITICAL',
        'DEPTH_LIMIT': 100,
        'DEPT_STATS': True,
        'CONCURRENT_REQUESTS_PER_DOMAIN': 10,
        'DOWNLOADER_MIDDLEWARES':
            {
                "scrapy.downloadermiddlewares.retry.RetryMiddleware": 500,
                "scrapy.spidermiddlewares.offsite.OffsiteMiddleware": 550
            },
    })
and allowed domains are :
allowed_domains=['whitneymiller.com']
As I see my crawler parses links like "https://www.linkedin.com/cws/share?token&isFramed=false&url=https%3A%2F%2Fwhitneymiller.com%2Frecipe%2Fsmoked-chicken-wings-with-caramelized-onions%2F"
Am I doing something wrong or for OffsiteMiddleware links like that looks local for the specified domain?