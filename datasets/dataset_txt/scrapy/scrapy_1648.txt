Member
pablohoffman commented on Sep 9, 2011
Originally reported in Trac by Daniel: http://dev.scrapy.org/ticket/111
diff --git a/scrapy/tests/test_utils_response.py b/scrapy/tests/test_utils_response.py
--- a/scrapy/tests/test_utils_response.py
+++ b/scrapy/tests/test_utils_response.py
@@ -62,11 +62,16 @@
         response = Response(url='http://example.org', body=body)
         self.assertEqual(get_meta_refresh(response), (1, 'http://example.org/newpage'))

         # entities in the redirect url
         body = """<meta http-equiv="refresh" content="3; url=&#39;http://www.example.com/other&#39;">"""
         response = Response(url='http://example.com', body=body)
         self.assertEqual(get_meta_refresh(response), (3, 'http://www.example.com/other'))

+        # entities in the redirect url with single quotes
+        body = """<meta http-equiv="refresh" content='3; url=&#39;http://www.example.com/other&#39;'>"""
+        response = Response(url='http://example.com', body=body)
+        self.assertEqual(get_meta_refresh(response), (3, 'http://www.example.com/other'))
+
         # relative redirects
         body = """<meta http-equiv="refresh" content="3; url=other.html">"""
         response = Response(url='http://example.com/page/this.html', body=body)