Arfrever commented on Jun 14, 2012
uses_query list in urlparse module has been removed in 2.7 branch of Python:
http://hg.python.org/cpython/rev/79e6ff3d9afd
scrapy/xlib/urlparse_monkeypatches.py should be modified to not use uses_query when it does not exist.
$ python2.7 setup.py build
Traceback (most recent call last):
  File "setup.py", line 87, in <module>
    version = __import__('scrapy').__version__
  File "/tmp/scrapy/scrapy/__init__.py", line 18, in <module>
    from scrapy.xlib import urlparse_monkeypatches
  File "/tmp/scrapy/scrapy/xlib/urlparse_monkeypatches.py", line 1, in <module>
    from urlparse import urlparse, uses_netloc, uses_query
ImportError: cannot import name uses_query
Suggested fix:
--- scrapy/xlib/urlparse_monkeypatches.py
+++ scrapy/xlib/urlparse_monkeypatches.py
@@ -1,7 +1,13 @@
-from urlparse import urlparse, uses_netloc, uses_query
+from urlparse import urlparse, uses_netloc
+
+try:
+    # Python <2.7.4
+    from urlparse import uses_query
+except ImportError:
+    uses_query = None

 # workaround for http://bugs.python.org/issue7904
 if urlparse('s3://bucket/key').netloc != 'bucket':
     uses_netloc.append('s3')
-if urlparse('s3://bucket/key?key=value').query != 'key=value':
+if uses_query is not None and urlparse('s3://bucket/key?key=value').query != 'key=value':
     uses_query.append('s3')