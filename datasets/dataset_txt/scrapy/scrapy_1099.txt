Contributor
starrify commented on Oct 29, 2015
Issue Description
Incorrectly picked URL in scrapy.http.FormRequest.from_response when there is a <base> tag.
How to Reproduce the Issue & Version Used
[pengyu@GLaDOS tmp]$ python2
Python 2.7.10 (default, Sep  7 2015, 13:51:49) 
[GCC 5.2.0] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> import scrapy
>>> scrapy.__version__
u'1.0.3'
>>> html_body = '''
... <html>
...     <head>
...         <base href="http://b.com/">
...     </head>
...     <body>
...         <form action="test_form">
...         </form>
...     </body>
... </html>
... '''
>>> response = scrapy.http.TextResponse(url='http://a.com/', body=html_body)
>>> request = scrapy.http.FormRequest.from_response(response)
>>> request.url
'http://a.com/test_form'
Expected Result
request.url shall be 'http://b.com/test_form'
Suggested Fix
The issue can be fixed by fixing a few lines in scrapy/http/request/form.py