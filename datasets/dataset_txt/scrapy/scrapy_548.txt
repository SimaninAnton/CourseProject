rlucca commented on Aug 31, 2017
Hi there,
I was expecting the response.request.url to be the same url of the original request here. Or I'm thinking wrong? I saw this problem when I was doing some fixes in one of my spiders.
$ scrapy shell 'http://www.maneyonline.com'
2017-08-30 18:23:58 [scrapy.utils.log] INFO: Scrapy 1.4.0 started (bot: scrapybot)
2017-08-30 18:23:58 [scrapy.utils.log] INFO: Overridden settings: {'LOGSTATS_INTERVAL': 0, 'EDITOR': '/usr/bin/vim', 'DUPEFILTER_CLASS': 'scrapy.dupefilters.BaseDupeFilter'}
2017-08-30 18:23:58 [scrapy.middleware] INFO: Enabled extensions:
['scrapy.extensions.memusage.MemoryUsage',
 'scrapy.extensions.telnet.TelnetConsole',
 'scrapy.extensions.corestats.CoreStats']
2017-08-30 18:23:58 [scrapy.middleware] INFO: Enabled downloader middlewares:
['scrapy.downloadermiddlewares.httpauth.HttpAuthMiddleware',
 'scrapy.downloadermiddlewares.downloadtimeout.DownloadTimeoutMiddleware',
 'scrapy.downloadermiddlewares.defaultheaders.DefaultHeadersMiddleware',
 'scrapy.downloadermiddlewares.useragent.UserAgentMiddleware',
 'scrapy.downloadermiddlewares.retry.RetryMiddleware',
 'scrapy.downloadermiddlewares.redirect.MetaRefreshMiddleware',
 'scrapy.downloadermiddlewares.httpcompression.HttpCompressionMiddleware',
 'scrapy.downloadermiddlewares.redirect.RedirectMiddleware',
 'scrapy.downloadermiddlewares.cookies.CookiesMiddleware',
 'scrapy.downloadermiddlewares.httpproxy.HttpProxyMiddleware',
 'scrapy.downloadermiddlewares.stats.DownloaderStats']
2017-08-30 18:23:58 [scrapy.middleware] INFO: Enabled spider middlewares:
['scrapy.spidermiddlewares.httperror.HttpErrorMiddleware',
 'scrapy.spidermiddlewares.offsite.OffsiteMiddleware',
 'scrapy.spidermiddlewares.referer.RefererMiddleware',
 'scrapy.spidermiddlewares.urllength.UrlLengthMiddleware',
 'scrapy.spidermiddlewares.depth.DepthMiddleware']
2017-08-30 18:23:58 [scrapy.middleware] INFO: Enabled item pipelines:
[]
2017-08-30 18:23:58 [scrapy.extensions.telnet] DEBUG: Telnet console listening on 127.0.0.1:6023
2017-08-30 18:23:58 [scrapy.core.engine] INFO: Spider opened
2017-08-30 18:23:58 [scrapy.downloadermiddlewares.redirect] DEBUG: Redirecting (302) to <GET http://www.tandfonline.com/> from <GET http://www.maneyonline.com>
2017-08-30 18:23:59 [scrapy.downloadermiddlewares.redirect] DEBUG: Redirecting (302) to <GET http://www.tandfonline.com/?cookieSet=1> from <GET http://www.tandfonline.com/>
2017-08-30 18:23:59 [scrapy.downloadermiddlewares.redirect] DEBUG: Redirecting (302) to <GET http://www.tandfonline.com/> from <GET http://www.tandfonline.com/?cookieSet=1>
2017-08-30 18:24:00 [scrapy.core.engine] DEBUG: Crawled (200) <GET http://www.tandfonline.com/> (referer: None)
2017-08-30 18:24:00 [traitlets] DEBUG: Using default logger
2017-08-30 18:24:00 [traitlets] DEBUG: Using default logger
[s] Available Scrapy objects:
[s]   scrapy     scrapy module (contains scrapy.Request, scrapy.Selector, etc)
[s]   crawler    <scrapy.crawler.Crawler object at 0x7feb48de3b90>
[s]   item       {}
[s]   request    <GET http://www.maneyonline.com>
[s]   response   <200 http://www.tandfonline.com/>
[s]   settings   <scrapy.settings.Settings object at 0x7feb48de3990>
[s]   spider     <DefaultSpider 'default' at 0x7feb48736610>
[s] Useful shortcuts:
[s]   fetch(url[, redirect=True]) Fetch URL and update local objects (by default, redirects are followed)
[s]   fetch(req)                  Fetch a scrapy.Request and update local objects 
[s]   shelp()           Shell help (print this help)
[s]   view(response)    View response in a browser
In [1]: print request.url
http://www.maneyonline.com

In [2]: print response.url
http://www.tandfonline.com/

In [3]: print response.request.url
http://www.tandfonline.com/