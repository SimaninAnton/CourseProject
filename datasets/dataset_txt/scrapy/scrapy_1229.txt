Contributor
redapple commented on May 12, 2015
Reported by several users using S3 exporter and JsonItemExporter.
It looks like the docs for FEED_EXPORT_FIELDS do not match current behaviour:
When omitted, Scrapy uses fields defined in Item subclasses a spider is yielding. If raw dicts are used as items Scrapy tries to infer field names from the exported data - currently it uses field names from the first item.
        if self.fields_to_export is None:
            if include_empty and not isinstance(item, dict):
                field_iter = six.iterkeys(item.fields)
            else:
                field_iter = six.iterkeys(item)
https://github.com/scrapy/scrapy/blob/master/scrapy/exporters/__init__.py#L59
This following line fetching settings for FEED_EXPORT_FIELDS returns an empty list [] when setting is absent, and not None as one would expect (a bug in settings.getlist() IMO)
self.export_fields = settings.getlist('FEED_EXPORT_FIELDS')
https://github.com/scrapy/scrapy/blob/master/scrapy/extensions/feedexport.py#L154