Member
kmike commented on Feb 17, 2016
E.g. for this page
http://naftir.com/index.php/%D9%85%D8%AE%D8%A7%D8%B2%D9%86-%D8%B0%D8%AE%DB%8C%D8%B1%D9%87
scrapy.utils.response.get_base_url raises the following exception in Pyhton 3:
File "/Users/kmike/svn/scrapy/scrapy/utils/response.py", line 30, in get_base_url
    response.encoding)
  File "/Users/kmike/envs/dl/lib/python3.5/site-packages/w3lib-1.13.0-py3.5.egg/w3lib/html.py", line 287, in get_base_url
    baseurl = moves.urllib.parse.urljoin(baseurl, m.group(1).encode(encoding))
  File "/usr/local/Cellar/python3/3.5.1/Frameworks/Python.framework/Versions/3.5/lib/python3.5/urllib/parse.py", line 415, in urljoin
    base, url, _coerce_result = _coerce_args(base, url)
  File "/usr/local/Cellar/python3/3.5.1/Frameworks/Python.framework/Versions/3.5/lib/python3.5/urllib/parse.py", line 114, in _coerce_args
    return _decode_args(args) + (_encode_result,)
  File "/usr/local/Cellar/python3/3.5.1/Frameworks/Python.framework/Versions/3.5/lib/python3.5/urllib/parse.py", line 98, in _decode_args
    return tuple(x.decode(encoding, errors) if x else '' for x in args)
  File "/usr/local/Cellar/python3/3.5.1/Frameworks/Python.framework/Versions/3.5/lib/python3.5/urllib/parse.py", line 98, in <genexpr>
    return tuple(x.decode(encoding, errors) if x else '' for x in args)
UnicodeDecodeError: 'ascii' codec can't decode byte 0xd9 in position 28: ordinal not in range(128)