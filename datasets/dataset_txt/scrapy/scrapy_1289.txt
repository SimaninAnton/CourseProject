Member
kmike commented on Feb 27, 2015
S3DownloadHandler tries to connect to s3 on startup, with 1s timeout. This can be seen in Scrapy logs - note 1s delay between "Enabled extensions" and "Enabled downloader middlewares" messages:
2015-02-27 04:49:42+0500 [scrapy] INFO: Scrapy 0.25.1 started (bot: scrapybot)
2015-02-27 04:49:42+0500 [scrapy] INFO: Optional features available: ssl, http11, boto, django
2015-02-27 04:49:42+0500 [scrapy] INFO: Overridden settings: {'DEFAULT_ITEM_CLASS': 'dirbot.items.Website', 'NEWSPIDER_MODULE': 'dirbot.spiders', 'SPIDER_MODULES': ['dirbot.spiders']}
2015-02-27 04:49:42+0500 [scrapy] INFO: Enabled extensions: LogStats, TelnetConsole, CloseSpider, CoreStats, SpiderState
2015-02-27 04:49:43+0500 [scrapy] INFO: Enabled downloader middlewares: HttpAuthMiddleware, DownloadTimeoutMiddleware, UserAgentMiddleware, RetryMiddleware, DefaultHeadersMiddleware, MetaRefreshMiddleware, HttpCompressionMiddleware, RedirectMiddleware, CookiesMiddleware, ChunkedTransferMiddleware, DownloaderStats
With s3 download handler commented out the delay disappears.
What do you think about making .conn attribute lazy? It won't be possible to raise NotConfigured exception earlier, but users will get an error later.
Another option is to disable s3 handler by default, but it is more intrusive.