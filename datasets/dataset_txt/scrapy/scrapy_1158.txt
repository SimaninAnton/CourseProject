teddb commented on Aug 9, 2015
The following post had been brought up previously, but can someone post an explanation?
Very tricky problem that I don't know how to debug. I have a spider which is a 3-level deep:
def parse(self, response):
    # some treatment
    # a loop
         request = scrapy.Request(url=<calculated_url>, callback=parseChapter)
         request.meta['item'] = # a dictionary containing some data of the just parsed page
         yield request

def parseChapter(self, response):
    # some treatment
    # a loop
         request = scrapy.Request(url=<calculated_url>, callback=parseCategory)
         request.meta['item'] = # a dictionary containing some data of the just parsed page
         # print request.meta['item'] is good and different in every iteration
         yield request

def parseCategory(self, response):
    # print response.meta['item'] is not good because it displays the same value many times
    # for every new call of parseChapter, meta['item'] received is always the same
    # some treatment
The weird thing is that the passed dictionary in the meta of the request is the same in parseCategory, and response.url into parseCateogry is fine.
This problem I'm talking about happens only in the callback parseCategory, it does work well in parseChapter (passed meta is good and different for every new call)
Can you help me out with this?