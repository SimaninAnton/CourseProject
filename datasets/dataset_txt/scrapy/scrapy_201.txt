mohmad-null commented on Feb 25, 2019 â€¢
edited
page = b'\x00\x00ws:ExceptionReport></ows:ExceptionReport>\x00'
response = XmlResponse(
 url='http://example.com',
 body=page,
 encoding='utf-8'
)
if hasattr(response, 'selector'):
 pass
This crashes with the below traceback.
Given I'm doing a simple "hasattr" for the selector, I don't think it should be crashing out but should be returnin False.
scrapy==1.5.0
lxml==4.1.1
Traceback:
   File "c:\proj\src\spider_aux_funcs.py", line 1335, in get_resp_content_type
  if hasattr(response, 'selector'):
   File "c:\proj\venv\lib\site-packages\scrapy\http\response\text.py", line 115, in selector
  self._cached_selector = Selector(self)
   File "c:\proj\venv\lib\site-packages\scrapy\selector\unified.py", line 71, in __init__
  super(Selector, self).__init__(text=text, type=st, root=root, **kwargs)
   File "c:\proj\venv\lib\site-packages\parsel\selector.py", line 180, in __init__
  root = self._get_root(text, base_url)
   File "c:\proj\venv\lib\site-packages\parsel\selector.py", line 191, in _get_root
  return create_root_node(text, self._parser, base_url=base_url)
   File "c:\proj\venv\lib\site-packages\parsel\selector.py", line 43, in create_root_node
  root = etree.fromstring(body, parser=parser, base_url=base_url)
   File "src\lxml\etree.pyx", line 3230, in lxml.etree.fromstring (src\lxml\etree.c:81056)
   File "src\lxml\parser.pxi", line 1871, in lxml.etree._parseMemoryDocument (src\lxml\etree.c:121236)
   File "src\lxml\parser.pxi", line 1759, in lxml.etree._parseDoc (src\lxml\etree.c:119912)
   File "src\lxml\parser.pxi", line 1125, in lxml.etree._BaseParser._parseDoc (src\lxml\etree.c:114159)
   File "src\lxml\parser.pxi", line 598, in lxml.etree._ParserContext._handleParseResultDoc (src\lxml\etree.c:107724)
   File "src\lxml\parser.pxi", line 709, in lxml.etree._handleParseResult (src\lxml\etree.c:109433)
   File "src\lxml\parser.pxi", line 638, in lxml.etree._raiseParseError (src\lxml\etree.c:108287)
   File "http://example.com", line 1
 lxml.etree.XMLSyntaxError: Document is empty, line 1, column 1