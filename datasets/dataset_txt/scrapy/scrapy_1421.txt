yanpeipan commented on Apr 2, 2014
I want to change the url of current request,add dynamic apikeys
I write a demo used replace,but it not work.
here is my code:
middlewares.py
class ProxyMiddleware(object):
  def process_request(self, request, spider):
    request = request.replace(url = "%s&apikey=00d8ef49d1c2b3bb028acddd75481b31" % request.url)
    request.meta['proxy'] = 'http://24.143.198.188:80'
settings.py
DOWNLOADER_MIDDLEWARES = {
    'scrapy.contrib.downloadermiddleware.httpproxy.HttpProxyMiddleware': 110,
    'Scrapy.middlewares.ProxyMiddleware': 100
    }