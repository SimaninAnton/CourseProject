Contributor
StasDeep commented on Aug 11, 2018
Description
When testing callbacks with the same URL, only one callback is tested.
Reproduce
class DemoSpider(Spider):
    name = 'demo_spider'

    def returns_item_with_url(self, response):
        """ method which returns request
        @url http://scrapy.org
        @returns items 1 1
        """
        return TestItem(url=response.url)

    def returns_item_with_name(self, response):
        """ method which returns request
        @url http://scrapy.org
        @returns items 1 1
        """
        return TestItem(name='scrapy')
Then run scrapy check.
You'll get the following output:
.
----------------------------------------------------------------------
Ran 1 contract in 0.894s

OK
Reason
This is default behavior for crawlers to filter same URLs.
Solution
Use dont_filter in requests returned by ContractsManager.