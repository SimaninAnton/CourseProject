flagist0 commented on Jun 21, 2016
Scrapy FAQ points out that to enable DFO you have to set DEPTH_PRIORITY to 1.
But it works the opposite way. If I understand it correctly, the problem is here:
request.priority -= depth * self.prio.
Request's priority is decreased by its depth, putting it to the end of the queue.
So to enable DFO you have to replace '-=' with '+=' or to set DEPTH_PRIORITY to -1 (which is counter-intuitive).