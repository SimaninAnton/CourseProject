why is process_request called twice?