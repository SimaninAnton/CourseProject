Contributor
warvariuc commented on Jun 12, 2012
Some webpages (google, facebook) have meta refresh tag inside noscript:
<noscript> <meta http-equiv="refresh" content="0; URL=/homedepot?_fb_noscript=1" /> </noscript>
Fix:
diff --git a/scrapy/utils/response.py b/scrapy/utils/response.py
index 85d0b60..03c353b 100644
--- a/scrapy/utils/response.py
+++ b/scrapy/utils/response.py
@@ -41,7 +41,6 @@ def get_meta_refresh(response):
     """Parse the http-equiv refrsh parameter from the given response"""
     if response not in _metaref_cache:
         text = response.body_as_unicode()[0:4096]
-        text = _noscript_re.sub(u'', text)
         text = _script_re.sub(u'', text)
         _metaref_cache[response] = html.get_meta_refresh(text, response.url, \
             response.encoding)