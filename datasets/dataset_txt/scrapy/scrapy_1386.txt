idella commented on Jul 8, 2014
platform linux2 -- Python 2.7.6 -- py-1.4.20 -- pytest-2.5.2
plugins: twisted
collected 1008 items / 14 skipped

================================= FAILURES==========================
______________________________________________________________ RequestTest.test_ajax_url _______________________________________________________________

self = <scrapy.tests.test_http_request.RequestTest testMethod=test_ajax_url>

    def test_ajax_url(self):
        # ascii url
        r = self.request_class(url="http://www.example.com/ajax.html#!key=value")
>       self.assertEqual(r.url, "http://www.example.com/ajax.html?_escaped_fragment_=key%3Dvalue")
E       AssertionError: 'http://www.example.com/ajax.html?_escaped_fragment_=key=value' != 'http://www.example.com/ajax.html?_escaped_fragment_=key%3Dvalue'

../../../../work/scrapy-0.24.1-python2_7/scrapy/tests/test_http_request.py:111: AssertionError
____________________________________________________________ FormRequestTest.test_ajax_url _____________________________________________________________

self = <scrapy.tests.test_http_request.FormRequestTest testMethod=test_ajax_url>

    def test_ajax_url(self):
        # ascii url
        r = self.request_class(url="http://www.example.com/ajax.html#!key=value")
>       self.assertEqual(r.url, "http://www.example.com/ajax.html?_escaped_fragment_=key%3Dvalue")
E       AssertionError: 'http://www.example.com/ajax.html?_escaped_fragment_=key=value' != 'http://www.example.com/ajax.html?_escaped_fragment_=key%3Dvalue'

../../../../work/scrapy-0.24.1-python2_7/scrapy/tests/test_http_request.py:111: AssertionError
___________________________________________________________ XmlRpcRequestTest.test_ajax_url ____________________________________________________________

self = <scrapy.tests.test_http_request.XmlRpcRequestTest testMethod=test_ajax_url>

    def test_ajax_url(self):
        # ascii url
        r = self.request_class(url="http://www.example.com/ajax.html#!key=value")
>       self.assertEqual(r.url, "http://www.example.com/ajax.html?_escaped_fragment_=key%3Dvalue")
E       AssertionError: 'http://www.example.com/ajax.html?_escaped_fragment_=key=value' != 'http://www.example.com/ajax.html?_escaped_fragment_=key%3Dvalue'

../../../../work/scrapy-0.24.1-python2_7/scrapy/tests/test_http_request.py:111: AssertionError
________________________________________________________ [doctest] scrapy.utils.url.escape_ajax ________________________________________________________
080     """
081     Return the crawleable url according to:
082     http://code.google.com/web/ajaxcrawling/docs/getting-started.html
083 
084     >>> escape_ajax("www.example.com/ajax.html#!key=value")
Expected:
    'www.example.com/ajax.html?_escaped_fragment_=key%3Dvalue'
Got:
    'www.example.com/ajax.html?_escaped_fragment_=key=value'

/mnt/gen2/TmpDir/portage/dev-python/scrapy-0.24.1/work/scrapy-0.24.1-python2_7/scrapy/utils/url.py:84: DocTestFailure
========= 4 failed, 1001 passed, 17 skipped in 229.15 seconds ========
sed -e s':test_ajax_url:_&:' -i scrapy/tests/test_http_request.py takes out the first 3 failures. 4th. is a single doctest fail.