Djayb6 commented on Aug 26, 2015
On scrapy 0.24.6 I successfully subclassed the default's downloader like so:
import scrapy
from scrapy.utils.httpobj import urlparse_cached


class WebsiteDownloader(scrapy.core.downloader.Downloader):

    def _get_slot_key(self, request, spider):
        if 'download_slot' in request.meta:
            return request.meta['download_slot']

        return request.meta['website_id'] if not request.meta.get('social_request') \
            else urlparse_cached(request).hostname or ''
However when I updated scrapy to 1.0.3, I got the following error:
File "/usr/local/lib/python2.7/site-packages/scrapy/crawler.py", line 71, in crawl
    self.engine = self._create_engine()
  File "/usr/local/lib/python2.7/site-packages/scrapy/crawler.py", line 83, in _create_engine
    return ExecutionEngine(self, lambda _: self.stop())
  File "/usr/local/lib/python2.7/site-packages/scrapy/core/engine.py", line 65, in __init__
    downloader_cls = load_object(self.settings['DOWNLOADER'])
  File "/usr/local/lib/python2.7/site-packages/scrapy/utils/misc.py", line 44, in load_object
    mod = import_module(module)
  File "/usr/local/Cellar/python/2.7.8_2/Frameworks/Python.framework/Versions/2.7/lib/python2.7/importlib/__init__.py", line 37, in import_module
    __import__(name)
  File "/Users/me/dev/spider/downloader.py", line 7, in <module>
    class WebsiteDownloader(scrapy.core.downloader.Downloader):
exceptions.AttributeError: 'module' object has no attribute 'downloader'
Woudl I have an idea of what's going on ? Thank you