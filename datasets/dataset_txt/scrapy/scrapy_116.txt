mntolia commented on Jul 12, 2019 â€¢
edited
In my Scrapy spider class, I have several functions to parse different types of URLs. It comes to a point where if a regex search is not found it will call the parse_product() function directly with the current response as a parameter and return the data from that function else it must send a form request with the parse_product() as the callback.
The issue is that the data is not coming in the output in the first case.
In the Scrapy documentation, it says I need to return a dictionary in the callback function for it to show in the output but only the items returned from the form request made in the else statement are there in the output.
   def parse_variation(self, response):
        self.logger.info("Parsing Variation")
        url_search = re.findall(variation_request_url_pattern, str(response.body))
        if not url_search:
            self.logger.info("URL SEARCH IS EMPTY")
            data = self.parse_product(response)
            #No Output with this statement
            return data
        else: 
            for url in url_search:
               yield FormRequest(url=url, body=body callback=self.parse_product)


    def parse_product(self, response):
        self.logger.info("Parsing Product")
        data = {}
        data["url"] = response.url
        data["name"] = response.xpath(title_xpath).extract_first()
        return data
Only the output from the Form Requests in the else statement comes. Why is it that?