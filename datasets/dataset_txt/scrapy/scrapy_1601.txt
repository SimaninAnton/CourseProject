amir-f commented on Apr 25, 2012
I'm new to Scrapy. I have this issue with the 0.14 version:
There is a MySpider(BaseSpider) with a start url which points to a simple HTML webpage stored in UTF-8.
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
</head>
</html>
The server doesn't return encoding in its headers and inside the HtmlResponse._body_declared_encoding none of the regexes match.
So, when the code reaches my MySpider.parse method, I end up with '\xef\xbb\xbf' (UTF-8 byte order mark) left at the beginning of the response.body with ascii being the inferred encoding of the response.