brianclements commented on 28 Aug 2014
I started from a clean slate of no images and no running containers. Over the past number of weeks I've been only using fig to code/build/test a number of containers/dockerfiles at once. I will run a custom script that removes all running containers and untagged images and then will run fig build && fig up. The entire command is dkcleanup --reset && fig build && fig up. From the looks of the output of docker images, only my tagged images remain, all with relatively the same sizes (most of what I'm tweaking is scripts and config, not big installation files). However over the course of a couple weeks, I managed to fill up my /var dir with about 13GB of orphaned containers in /var/lib/docker/vfs and /var/lib/docker/volumes. Deleting every image and every container did not remove them, so I had to do it manually.
Am I using the wrong combination of fig commands to do my code/build/test process? My hunch is that fig will do tagging and renaming and leave orphans when it should be doing some removal of containers and/or volumes instead. Any ideas?