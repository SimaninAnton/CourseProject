jonathon-love commented on 4 Nov 2018
hi,
i have a tornado websocket handler, and in async def on_message(...) i want to call a long running function with loop.run_in_executor(...), so i call asyncio.get_event_loop(), but this throws the exception:
RuntimeError: There is no current event loop in thread 'Thread-5'.
but i don't understand this, because my application is a simple, single-threaded application, and there must be an even loop running for on_message(...) to be called. if i call print(threading.current_thread().name) from on_message(), i get MainThread.
to begin the io loop in the first place, i just go:
loop = asyncio.get_event_loop()  # this `.get_event_loop()` works!
...
print(threading.current_thread().name)  # this also outputs `MainThread`
...
loop.run_forever()
i've read up on other issues like this, but they all seem to do unusual things with threads, like this one.
what am i doing wrong?
with thanks