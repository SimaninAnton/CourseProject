yurivict commented on 14 Nov 2014
This testcase fails with kqueue, and passes with select:
# testcase.py
import zmq
from zmq.eventloop import ioloop, zmqstream
import mock

def x(transport):
  socket = transport.ctx.socket(zmq.REQ)
  stream = zmqstream.ZMQStream(socket, io_loop=ioloop.IOLoop.current())

x(mock.Mock())
Failure with kqueue:
  File "/usr/local/lib/python2.7/site-packages/tornado/platform/kqueue.py", line 41, in register
    self._control(fd, events, select.KQ_EV_ADD)
  File "/usr/local/lib/python2.7/site-packages/tornado/platform/kqueue.py", line 61, in _control
    fd, filter=select.KQ_FILTER_READ, flags=flags))
  TypeError: fileno() returned a non-integer
Version 4.0.2