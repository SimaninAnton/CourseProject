christippett commented on 6 Mar 2018
Version
Python: 3.4.3
Tornado: 5.0
Issue
I use the raven Python library that has Tornado as a requirement. When installing raven in a new environment, a newer version of Tornado was installed (5.0) which resulted in the following exception:
  File "/opt/python/run/venv/local/lib/python3.4/site-packages/raven/transport/tornado.py", line 17, in <module>
    from tornado.httpclient import AsyncHTTPClient, HTTPClient
  File "/opt/python/run/venv/local/lib64/python3.4/site-packages/tornado/httpclient.py", line 49, in <module>
    from tornado import gen, httputil, stack_context
  File "/opt/python/run/venv/local/lib64/python3.4/site-packages/tornado/gen.py", line 1295, in <module>
    _wrap_awaitable = asyncio.ensure_future
AttributeError: 'module' object has no attribute 'ensure_future'
The previous version of Tornado I was using (4.5.3) does not have this error. Downgrading Tornado from 5.0 to 4.5.3 resolves the problem.
Looking into the issue, I believe it's caused by Tornado's incompatibility with using an older version of Python's asyncio. Should the import for ensure_future for Python version <3.4.4
be from asyncio import async as ensure_future ?