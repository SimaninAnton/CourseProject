gclinch commented on 26 Jun 2013
When calling the following, a 'FileNotFoundError' is raised as expected:
from tornado.process import Subprocess
Subprocess("non_existant_binary", stdout=Subprocess.STREAM)
However the STREAM pipe is left open. After many calls of this nature, Subprocess switches to raising 'OSError: [Errno 24] Too many open files' from a _pipe_cloexec() call.
I believe Subprocess should catch the exception from Popen, close any in/out/err pipes and then re-raise the Popen exception to the caller.