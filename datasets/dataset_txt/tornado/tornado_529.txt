wil93 commented on 25 Mar 2016
I am using tornado and I declared a RequestHandler with a single parameter like this:
class StuffHandler(RequestHandler):
    def get(self, stuff_name):
        ...

app = Application([
    (r'/stuff/(.*)/public', StuffHandler)
])
Now I added another handler for '/stuff/(.*)/private', which requires the user to be authenticated:
class PrivateStuffHandler(RequestHandler):
    @tornado.web.authenticated
    def get(self, stuff_name):
        ...
This of course will cause get_current_user() to be called before get(). The problem is that, in order for get_current_user() to run, I need to know the stuff_name parameter.
So I thought that I may use the prepare() or the initialize() method, which is called before get_current_user(). However, I can't seem to access stuff_name from those methods. I tried putting stuff_name as a parameter but it didn't work, then I tried calling self.get_argument("stuff_name") but it didn't work either.
Why can't I access an URL parameter from the prepare() method?
I am now looking at the source code here: https://github.com/tornadoweb/tornado/blob/8fb0164ea63d2603e743fbd47d760b1e6df96a54/tornado/web.py#L1413L1422
Shouldn't the line 1422 be changed from
result = self.prepare()
to:
result = self.prepare(*self.path_args, **self.path_kwargs)
?