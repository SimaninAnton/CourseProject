sbrandtb commented on 20 Jul 2018
Just tried Tornado 5.1 for the first time and am wondering if I'm doing something wrong when waiting for the future of the finish method:
import tornado.ioloop
import tornado.web

class MainHandler(tornado.web.RequestHandler):
    async def get(self):
        print('before')
        await self.finish("Hello, world")
        print('after')

def make_app():
    return tornado.web.Application([
        (r"/", MainHandler),
    ])

if __name__ == "__main__":
    app = make_app()
    app.listen(8888)
    tornado.ioloop.IOLoop.current().start()
It seems like the future is never resolved. after is not printed and interrupting the application outputs:
KeyboardInterrupt
ERROR:asyncio:Task was destroyed but it is pending!
task: <Task pending coro=<MainHandler.get() running at main.py:7> wait_for=<Future pending cb=[<TaskWakeupMethWrapper object at 0x7f0cb0b25e28>()]> cb=[IOLoop.add_future.<locals>.<lambda>() at /home/sebastian/.virtualenvs/tempenv-2fc3210213e1f/lib/python3.6/site-packages/tornado/ioloop.py:719]>
Python 3.6, Ubuntu