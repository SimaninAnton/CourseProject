radiantone commented on 25 Jul 2017
Tornado 4.5.1
My repeatable test uses the dask.distributed package. Easy to produce. Steps below.
ubuntu@ip-10-186-18-141:$ virtualenv --python=python2.7 dask
ubuntu@ip-10-186-18-141:$ dask/bin/pip install distributed
Terminal Window 1
ubuntu@ip-10-186-18-141:$ dask/bin/dask-scheduler
distributed.scheduler - INFO - -----------------------------------------------
distributed.scheduler - INFO - Scheduler at: tcp://10.186.18.141:8786
distributed.scheduler - INFO - http at: 0.0.0.0:9786
distributed.scheduler - INFO - Local Directory: /tmp/scheduler-4EtKTp
distributed.scheduler - INFO - -----------------------------------------------
Terminal Window 2
ubuntu@ip-10-186-18-141:$ dask/bin/python
from distributed import Client
from distributed import Client
c = Client("localhost:8786")
hangs forever
The problem occurs only when the import statement "from distributed import Client" occurs twice.
Perhaps some tornado module is not re-entrant?
Here is where it hangs:
tornado.TCPClient.connect call in distributed/comm/tcp.py