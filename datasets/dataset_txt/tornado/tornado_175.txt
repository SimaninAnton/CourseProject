volinthius commented on 12 Jun 2018
Toro has Lock.locked() but tornado.locks.Lock is missing this method. It could be implemented with the following change:
diff --git a/tornado/locks.py b/tornado/locks.py
index 9566a45..f4faefc 100644
--- a/tornado/locks.py
+++ b/tornado/locks.py
@@ -412,6 +412,9 @@ class Semaphore(_TimeoutGarbageCollector):
                     lambda _: io_loop.remove_timeout(timeout_handle))
         return waiter
 
+    def locked(self):
+        return self._value == 0
+
     def __enter__(self):
         raise RuntimeError(
             "Use Semaphore like 'with (yield semaphore.acquire())', not like"
@@ -511,6 +514,9 @@ class Lock(object):
         except ValueError:
             raise RuntimeError('release unlocked lock')
 
+    def locked(self):
+        return self._block.locked()
+
     def __enter__(self):
         raise RuntimeError(
             "Use Lock like 'with (yield lock)', not like 'with lock'")