salientgreen commented on 26 Oct 2013
Traceback (most recent call last):
File "MEDIA_APP/server.py", line 50, in
main();
File "MEDIA_APP/server.py", line 36, in main
tornado.options.parse_command_line()
File "/var/www/media_server/venv/local/lib/python2.7/site-packages/tornado/options.py", line 511, in parse_command_line
return options.parse_command_line(args, final=final)
File "/var/www/media_server/venv/local/lib/python2.7/site-packages/tornado/options.py", line 252, in parse_command_line
self.run_parse_callbacks()
File "/var/www/media_server/venv/local/lib/python2.7/site-packages/tornado/options.py", line 313, in run_parse_callbacks
callback()
File "/var/www/media_server/venv/local/lib/python2.7/site-packages/tornado/stack_context.py", line 331, in wrapped
raise_exc_info(exc)
File "/var/www/media_server/venv/local/lib/python2.7/site-packages/tornado/stack_context.py", line 302, in wrapped
ret = fn(_args, *_kwargs)
File "/var/www/media_server/venv/local/lib/python2.7/site-packages/tornado/log.py", line 179, in enable_pretty_logging
channel.setFormatter(LogFormatter())
File "/var/www/media_server/venv/local/lib/python2.7/site-packages/tornado/log.py", line 79, in init
self._color = color and _stderr_supports_color()
File "/var/www/media_server/venv/local/lib/python2.7/site-packages/tornado/log.py", line 54, in _stderr_supports_color
if curses and sys.stderr.isatty():
AttributeError: 'UnicodeStdout' object has no attribute 'isatty'
I patched this locally to resolve the issue. I'm not positive this is the best way to handle it but the server runs.
Before
51
52    def _stderr_supports_color():
53        color = False
54        if curses and sys.stderr.isatty():
55            try:
56                curses.setupterm()
After
51
52    def _stderr_supports_color():
53        color = False
54        if curses and hasattr(sys.stdout, "isatty") and sys.stderr.isatty():
55            try:
56                curses.setupterm()