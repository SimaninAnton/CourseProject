ghost commented on 27 Jul 2011
We're seeing this exception occur at some relatively rare frequency. No idea how to reproduce it, but the stack trace seems to indicate it's happening at some point during a connection timeout.
Uncaught exception KeyError(<object object at 0xd62a10>,):
 Traceback (most recent call last):
   File "/usr/local/lib/python2.7/dist-packages/tornado/ioloop.py", line 370, in _run_callback
     callback()
   File "/usr/local/lib/python2.7/dist-packages/tornado/stack_context.py", line 159, in wrapped
     callback(*args, **kwargs)
   File "/usr/local/lib/python2.7/dist-packages/tornado/iostream.py", line 235, in wrapper
     callback(*args)
   File "/usr/local/lib/python2.7/dist-packages/tornado/stack_context.py", line 183, in wrapped
     callback(*args, **kwargs)
   File "/usr/local/lib/python2.7/dist-packages/tornado/stack_context.py", line 96, in __exit__
     return self.context.__exit__(type, value, traceback)
   File "/usr/lib/python2.7/contextlib.py", line 35, in __exit__
     self.gen.throw(type, value, traceback)
   File "/usr/local/lib/python2.7/dist-packages/tornado/simple_httpclient.py", line 265, in cleanup
     callback(HTTPResponse(self.request, 599, error=e))
   File "/usr/local/lib/python2.7/dist-packages/tornado/simple_httpclient.py", line 113, in _on_fetch_complete
     del self.active[key]
 KeyError: <object object at 0xd62a10>
It appears _on_fetch_complete() is being called twice for the same key.