Contributor
gagern commented on 7 Aug 2013
RFC 2388 Section 4.4 states:
if the file name of the sender's operating system is not in US-ASCII, the file name might be approximated, or encoded using the method of RFC 2231.
The current tornado.httputil._parse_header implementation does not allow for the second of these alternatives: it does not properly decode a header of the form
Content-Disposition: form-data; name="fieldname";
 file*=utf-8''T%C3%A4st.txt
The same holds for non-ascii names of form fields. You can use the email.utils.decode_params function to perform this kind of decoding, as well as handle the continuations described in that same RFC.
This report here is the counterpart to urllib3/urllib3#119, where this bug caused a test to fail once a proper standards-conforming encoding was implemented.