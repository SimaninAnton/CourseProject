emaste-r commented on 11 Aug 2017
now i need to send post xml data...
it is ok when i use requests...
 r = requests.post(url, headers=headers, data=send_xml, verify=False)
 prepay_result_dic = cls.trans_xml_to_dict(r.content)
but how can i change requests lib to tornado.httpclient.AsyncHTTPClient
@tornado.gen.coroutine
def post_asyn_url(url, payload={}, headers={}):
    """
    异步post url，主要是为了取代requests库...
    :param url: "http://www.google.com/"
    :param payload: {'userId': user_id}
    :return: response
    """
    import urllib
    http_client = tornado.httpclient.AsyncHTTPClient()
    payload = urllib.urlencode(payload)
    response = yield tornado.gen.Task(http_client.fetch, url, method="POST", headers=headers, body=payload, validate_cert=False)
    raise tornado.gen.Return(response)
the code above brings errror:
TypeError: not a valid non-string sequence or mapping object