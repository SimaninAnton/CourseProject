afzoun commented on 24 Nov 2019 â€¢
edited
Hi.
I am using tornado 6.0.3 with python 3.7
I get this RuntimeWarning that I don't know how to fix.
Task was destroyed but it is pending!
task: <Task pending coro=<WebSocketProtocol13.write_message.<locals>.wrapper() running at /home/python3.7/site-packages/tornado/websocket.py:1102>>
/usr/lib/python3.7/asyncio/base_events.py:604: RuntimeWarning: coroutine 'WebSocketProtocol13.write_message.<locals>.wrapper' was never awaited
Here's my code where I am using write_message:
`
def handle_events():
message = redis.get_message()

if message:

    message = json.loads(message['data'])

    data = {

        'time': message.get('time')

    }

    for connection in connections:

        connection.write_message(json.dumps(data))

    threading.Timer(1, handle_events).start()`
I should mention that it's working and I am not losing any messages, but I feel this is dangerous.
1