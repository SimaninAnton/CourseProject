dcowgill commented on 25 Nov 2010
RequestHandler.flush conveniently has built-in support for HEAD requests, but RequestHandler.finish doesn't add the Etag header to the response unless the method is GET.
This conditional:
if (self._status_code == 200 and self.request.method == "GET" and
    "Etag" not in self._headers):
should probably be testing self.request.method in ["GET", "HEAD"] instead.