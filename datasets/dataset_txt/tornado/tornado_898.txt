mrsinham commented on 6 Sep 2013
If I call a websocket created by tornado behind a proxy (Squid in this case), I have this error :
2013-09-06 15:09:23,834 Exception in callback <functools.partial object at 0x134da48>
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/tornado/ioloop.py", line 458, in _run_callback
    callback()
  File "/usr/local/lib/python2.7/dist-packages/tornado/stack_context.py", line 331, in wrapped
    raise_exc_info(exc)
  File "/usr/local/lib/python2.7/dist-packages/tornado/stack_context.py", line 302, in wrapped
    ret = fn(*args, **kwargs)
  File "/usr/local/lib/python2.7/dist-packages/tornado/iostream.py", line 341, in wrapper
    callback(*args)
  File "/usr/local/lib/python2.7/dist-packages/tornado/stack_context.py", line 331, in wrapped
    raise_exc_info(exc)
  File "/usr/local/lib/python2.7/dist-packages/tornado/stack_context.py", line 302, in wrapped
    ret = fn(*args, **kwargs)
  File "/usr/local/lib/python2.7/dist-packages/tornado/httpserver.py", line 327, in _on_headers
    self.request_callback(self._request)
  File "/usr/local/lib/python2.7/dist-packages/tornado/web.py", line 1567, in __call__
    handler = spec.handler_class(self, request, **spec.kwargs)
  File "/usr/local/lib/python2.7/dist-packages/tornado/websocket.py", line 102, in __init__
    **kwargs)
  File "/usr/local/lib/python2.7/dist-packages/tornado/web.py", line 143, in __init__
    self.clear()
  File "/usr/local/lib/python2.7/dist-packages/tornado/web.py", line 253, in clear
    self.set_header("Connection", "Keep-Alive")
  File "/usr/local/lib/python2.7/dist-packages/tornado/websocket.py", line 268, in _not_supported
    raise Exception("Method not supported for Web Sockets")
Exception: Method not supported for Web Sockets
Everything is fine without the proxy. Any idea ? Thanks !