psyvision commented on 12 Oct 2017 â€¢
edited
I have been investigating an issue with AWS Application Load Balancers forwarding traffic to a JupyterHub instance (that uses Tornado) - and it appears that the AWS ALB can forward traffic with the following header:
X-Forwarded-Proto: https,https
However, Tornado only appears to be able to support a singular value:
tornado/tornado/httpserver.py
Line 286 in d4094a0
 # AWS uses X-Forwarded-Proto 
It seems a similar issue affected ASP.NET at one point:
aspnet/BasicMiddleware#18
Although Mozilla document it as only having a single value:
https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Forwarded-Proto