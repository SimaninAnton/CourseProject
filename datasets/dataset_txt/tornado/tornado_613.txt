patapra commented on 25 Aug 2015
hi,
tornado v4.2
im seeing an issue where the HTTPHeaders obj doesn't support the setdefault method on builtin dicts. The issue is that setdefault bypasses your custom setitem, so any key-value set using it will not exist in self._as_list (which is used in get_all()).
Just a suggestion: since you guys are attempting to alter the key names and values when setting an item, subclassing the collections MutableMapping abc (instead of dict) may provide better compatibility with a builtin dict.