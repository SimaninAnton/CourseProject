eromoe commented on 12 Aug 2016 â€¢
edited
I am using ipython 5.0 and jupyter 4.3
my code :
import tornado.ioloop
import tornado.httputil
import tornado.httpclient
from tornado import gen
import pycurl

@gen.coroutine
def foo():
    tornado.httpclient.AsyncHTTPClient.configure(
        "tornado.curl_httpclient.CurlAsyncHTTPClient")
    http_client = tornado.httpclient.AsyncHTTPClient()
    http_request = tornado.httpclient.HTTPRequest(
        "http://sina.com",
        proxy_host="localhost",
        proxy_port=1920
    )
    response = yield http_client.fetch(http_request)
    print response.code

tornado.ioloop.IOLoop.instance().run_sync(foo)
No matter the foo raise Exception or not, it got error:
RuntimeErrorTraceback (most recent call last)
<ipython-input-4-2a54a0147edd> in <module>()
----> 1 tornado.ioloop.IOLoop.instance().run_sync(foo)

c:\python27\lib\site-packages\tornado\ioloop.pyc in run_sync(self, func, timeout)
    450         if timeout is not None:
    451             timeout_handle = self.add_timeout(self.time() + timeout, self.stop)
--> 452         self.start()
    453         if timeout is not None:
    454             self.remove_timeout(timeout_handle)

c:\python27\lib\site-packages\zmq\eventloop\ioloop.pyc in start(self)
    160     def start(self):
    161         try:
--> 162             super(ZMQIOLoop, self).start()
    163         except ZMQError as e:
    164             if e.errno == ETERM:

c:\python27\lib\site-packages\tornado\ioloop.pyc in start(self)
    750     def start(self):
    751         if self._running:
--> 752             raise RuntimeError("IOLoop is already running")
    753         self._setup_logging()
    754         if self._stopped:

RuntimeError: IOLoop is already running

## if request success  , here does print code  200
then cause:
The kernel appears to have died. It will restart automatically.