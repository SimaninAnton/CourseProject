How can I make streaming_callback a coroutine?