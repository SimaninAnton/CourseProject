Some code snippet need to refactoring?