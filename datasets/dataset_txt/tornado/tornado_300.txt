hellflame commented on 6 Aug 2017 â€¢
edited
problems
when I first open the webpage from tornado, everything is fine, but when I change the code, trigger the auto reload, refreshing the page will be extremely slow (I can even wait all day long), while opening another browser to visit the page, everything is fine again, but after auto reload, it stuck again too.
after refreshing the page, there will be many half closed TCP connections. they won't be closed until I shut down the tornado project.
proof:
(after autoreload, I refreshed twice)
if check with wireshark, tornado really is not sending FIN to close the connection, is it intentionally ? or there is other reason to cause this
python version: 2.7.10
tornado version: 4.5.1
os: mac os 10.12.6
after some little test, the problems starts at v4.5.0, and it is ok in v4.4.0 (I Just checked that two version)
test code:
import tornado.ioloop as ioloop
import tornado.web as web
import sys

class HelloService(web.RequestHandler):
    def get(self):
        return self.write("Check")

routes = [(r'/', HelloService)]
settings = {
        'debug': True,
        'autoreload': True,
        'serve_traceback': True,
    }

app = web.Application(handlers=routes, **settings)

if __name__ == '__main__':
    port = 5000
    if len(sys.argv) == 2 and sys.argv[1].isdigit():
        port = int(sys.argv[1])
    address = '127.0.0.1'
    app.listen(port, address=address)
    ioloop.IOLoop.current().start()