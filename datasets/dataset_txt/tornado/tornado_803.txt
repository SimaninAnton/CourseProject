jooadam commented on 11 Jul 2014
I got this under Tornado 3.2.2:
Exception in thread Thread-1:
Traceback (most recent call last):
  ...
  File ".../server.py", line 28, in respond
    request.finish()
  File ".../tornado/web.py", line 888, in finish
    self.flush(include_footers=True)
  File ".../tornado/web.py", line 851, in flush
    self.request.write(headers + chunk, callback=callback)
  File ".../tornado/httpserver.py", line 501, in write
    self.connection.write(chunk, callback=callback)
  File ".../tornado/httpserver.py", line 234, in write
    self.stream.write(chunk, self._on_write_complete)
  File ".../tornado/iostream.py", line 229, in write
    self._handle_write()
  File ".../tornado/iostream.py", line 564, in _handle_write
    _merge_prefix(self._write_buffer, num_bytes)
  File ".../tornado/iostream.py", line 1023, in _merge_prefix
    if len(deque) == 1 and len(deque[0]) <= size:
TypeError: object of type 'NoneType' has no len()
Tornado is running behind Nginx, handlers are marked as asynchronous and queued for later response.