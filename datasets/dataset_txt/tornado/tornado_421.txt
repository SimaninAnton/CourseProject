btdlin commented on 5 Nov 2016
Hi, seeing this stream closed error in a non-blocking call. I think the data has been sent back, but for some reason stream is not closed and then caused timeout. Any idea? Thanks in advance.
Traceback (most recent call last):
  File "/Users/dlin/virtualenvs/realtime-recs-1/lib/python3.5/site-packages/thriftpy/tornado.py", line 103, in io_exception_context
    yield
  File "/Users/dlin/virtualenvs/realtime-recs-1/lib/python3.5/site-packages/thriftpy/tornado.py", line 145, in flush
    return self.stream.write(frame_length + frame)
  File "/Users/dlin/virtualenvs/realtime-recs-1/lib/python3.5/site-packages/tornado/iostream.py", line 377, in write
    self._check_closed()
  File "/Users/dlin/virtualenvs/realtime-recs-1/lib/python3.5/site-packages/tornado/iostream.py", line 885, in _check_closed
    raise StreamClosedError(real_error=self.error)
tornado.iostream.StreamClosedError: Stream is closed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dlin/virtualenvs/realtime-recs-1/lib/python3.5/site-packages/thriftpy/tornado.py", line 191, in handle_stream
    self._processor.send_result(oprot, api, result, seqid)
  File "/Users/dlin/virtualenvs/realtime-recs-1/lib/python3.5/site-packages/thriftpy/thrift.py", line 280, in send_result
    oprot.trans.flush()
  File "/Users/dlin/virtualenvs/realtime-recs-1/lib/python3.5/site-packages/thriftpy/tornado.py", line 145, in flush
    return self.stream.write(frame_length + frame)
  File "/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/contextlib.py", line 77, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/dlin/virtualenvs/realtime-recs-1/lib/python3.5/site-packages/thriftpy/tornado.py", line 107, in io_exception_context
    message=str(e))
thriftpy.transport.TTransportException: TTransportException(type=4, message='Stream is closed')
2016-11-04 21:49:20 INFO     thriftpy.tornado: client disconnected 127.0.0.1:55021```