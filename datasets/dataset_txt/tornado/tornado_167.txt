ZoeShaw101 commented on 23 Jun 2018
open function task
class WebSocketHandler(tornado.websocket.WebSocketHandler):
 open_sockets = set()

 def __init__(self, *args, **kwargs):
  self._consumer = NewConsumer()
  self._producer = Producer()
  super(WebSocketHandler, self).__init__(*args, **kwargs)

 def open(self):
  print 'websocket is opened!'
  self._consumer.start()
  self._producer.start()
  self.set_nodelay(True)
  type(self).open_sockets.add(self)
It seems wrong
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/tornado/websocket.py", line 494, in _run_callback
    result = callback(*args, **kwargs)
TypeError: open() takes exactly 1 argument (2 given)
After I changed to this, it worked
class WebSocketHandler(tornado.websocket.WebSocketHandler):
 open_sockets = set()

 def __init__(self, *args, **kwargs):
  self._consumer = NewConsumer()
  self._producer = Producer()
  super(WebSocketHandler, self).__init__(*args, **kwargs)

 def open(self, *args):
  print 'websocket is opened!'
  self._consumer.start()
  self._producer.start()
  self.set_nodelay(True)
  type(self).open_sockets.add(self)
 