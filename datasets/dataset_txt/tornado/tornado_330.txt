krishnanms commented on 29 May 2017
Experiencing content-encoding issues while sending GZIP content with CurlAsyncHTTPClient configuration.
Tornado version: 4.4.1
Pycurl version: 7.43.0
Used:
tornado.httpclient.AsyncHTTPClient.configure('tornado.curl_httpclient.CurlAsyncHTTPClient')
HTTP Response headers:
Content-Encoding: gzip
X-Http-Reason: OK
Vary: Accept-Language, Accept-Encoding
Etag: "499f294a5c4d50afe7f9bd2297e68624d7666edc"
Pragma: no-cache
Cache-Control: no-cache, no-store, max-age=0
Date: Mon, 29 May 2017 16:34:41 GMT
P3p: CP="None specified"
Content-Type: text/html; charset=UTF-8
HTTP Body (redacted):
52dd
<!DOCTYPE html>


<html...
Looks like tornado already has decompressed the response, but has not removed the Content-Encoding: gzip header. This doesn't happen if I don't configure tornado to use the CurlAsyncHTTPClient. I see the X-Consumed-Content-Encoding: gzip header correctly being set.