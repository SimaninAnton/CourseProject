jokey2k commented on 11 Jul 2010
After wondering why my DB Connections explode, I found that the close handling after a request is not done properly, the close is called on a list.
Here's a patch to fix that:
--- a/tornado/wsgi.py
+++ b/tornado/wsgi.py
@@ -219,11 +219,15 @@ class WSGIContainer(object):
data["status"] = status
data["headers"] = response_headers
return response.append
   response.extend(self.wsgi_application(
           WSGIContainer.environ(request), start_response))
   body = "".join(response)
   if hasattr(response, "close"):
       response.close()
   app_iter = self.wsgi_application(
       WSGIContainer.environ(request), start_response)
   try:
       for resp in app_iter:
           response.extend(resp)
   finally:
       body = "".join(response)
       if hasattr(app_iter, "close"):
           app_iter.close()
 if not data: raise Exception("WSGI app did not call start_response")

 status_code = int(data["status"].split()[0])