kommit commented on 30 Nov 2010
I'm running a test server under Windows, the code is using the sample code in the source code:
from tornado import httpserver
from tornado import ioloop

def handle_request(request):
    message = "You requested %s\n" % request.uri
    request.write("HTTP/1.1 200 OK\r\nContent-Length: %d\r\n\r\n%s" % (
    len(message), message))
    request.finish()

http_server = httpserver.HTTPServer(handle_request)
http_server.listen(8888)
ioloop.IOLoop.instance().start()
when i use the apache benchmark tool to make lots of requests, the memory usage keeps increasing.
I read the source code of httpserver.py, and I think the instance of HTTPConnection will never deleted. Even the client connection has been closed.
I also tried to added a del method to the HTTPConnection class to print a message, but it is never called.
Is it a problem? Or did I misunderstand the server / python garbage collection?