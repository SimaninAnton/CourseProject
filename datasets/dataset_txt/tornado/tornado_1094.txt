Contributor
phihag commented on 22 Feb 2012
Since the local port is not included in the return value of full_url, applications relying on that function break when running on non-standard ports. The local port can be determined with
self.request.connection.stream.socket.getsockname()[1]
full_url should include the port iff it is non-standard. It may be useful to provide that value via a property local_port on HTTPRequests for use by applications which must know their local port.