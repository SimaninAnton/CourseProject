Contributor
chinyue commented on 24 May 2013
Before 3.0, cookie expiration is formatted by using email.utils. Starts from 3.0, cookie expiration is formatted using time.strftime, which formats according to locale and the result is invalid expiration to many browsers.
>>> import time
>>> import calendar
>>> import email.utils
>>> import datetime
>>> dt = datetime.datetime.utcnow()
>>> time.strftime("%a, %d %b %Y %H:%M:%S GMT", dt.utctimetuple())
'Fri, 24 May 2013 02:22:55 GMT'
>>> email.utils.formatdate(calendar.timegm(dt.utctimetuple()), localtime=False, usegmt=True)
'Fri, 24 May 2013 02:22:55 GMT'
With locale set:
>>> import locale
>>> locale.setlocale(locale.LC_ALL, 'zh_TW.UTF-8')
'zh_TW.UTF-8'
>>> time.strftime("%a, %d %b %Y %H:%M:%S GMT", dt.utctimetuple())
'\xe4\xba\x94, 24  5 2013 02:22:55 GMT'
>>> email.utils.formatdate(calendar.timegm(dt.utctimetuple()), localtime=False, usegmt=True)
'Fri, 24 May 2013 02:22:55 GMT'