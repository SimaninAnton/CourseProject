bdrung commented on 14 Dec 2018
I am trying to build salt 2018.3.3 against tornado 4.5.3 for Debian. tornado 4.5.3 builds with the test succeeded (except four, see #2536) after renaming it from tornado to tornado4 (to make it co-installable). The test suite for salt fails:
https://launchpadlibrarian.net/401405967/buildlog_ubuntu-disco-amd64.salt_2018.3.3+dfsg1-1~wip20181213~ubuntu19.04.1~ppa1_BUILDING.txt.gz
Current thread 0x00007f1f5d3bc740 (most recent call first):
  File "/usr/lib/python3.7/abc.py", line 139 in __instancecheck__
  File "/usr/lib/python3.7/inspect.py", line 226 in isawaitable
  File "/usr/lib/python3/dist-packages/tornado4/gen.py", line 1279 in convert_yielded
  File "/usr/lib/python3.7/functools.py", line 824 in wrapper
  File "/usr/lib/python3/dist-packages/tornado4/gen.py", line 1142 in handle_yield
  File "/usr/lib/python3/dist-packages/tornado4/gen.py", line 1000 in __init__
  File "/usr/lib/python3/dist-packages/tornado4/gen.py", line 319 in wrapper
  File "/usr/lib/python3/dist-packages/tornado4/gen.py", line 1280 in convert_yielded
[....]
  File "/usr/lib/python3.7/functools.py", line 824 in wrapper
  File "/usr/lib/python3/dist-packages/tornado4/gen.py", line 1142 in handle_yield
  ...
Hereby I request help for debugging the issue. The stacktrace points to tornado as culprit. Here are the changes that I did to it: https://salsa.debian.org/python-team/modules/python-tornado/commits/tornado4