Contributor
afq984 commented on 21 Jan 2016
I think it is about the str/bytes problem, maybe other iostream types may be affected
Consider the following code:
from tornado.ioloop import IOLoop
from tornado.process import Subprocess
from tornado.log import enable_pretty_logging


async def ping():
    proc = Subprocess(['ping', 'www.tornadoweb.org'], stdout=Subprocess.STREAM)
    await proc.stdout.read_until('data.')
    while True:
        line = await proc.stdout.read_until('ms')
        _, _, time = line.rpartition('time=')
        print(time)



if __name__ == '__main__':
    enable_pretty_logging()
    loop = IOLoop.current()
    loop.add_callback(ping)
    loop.start()
It gives:
[W 160121 16:04:03 iostream:651] error on read: a bytes-like object is required, not 'str'
and then:
[E 160121 16:05:29 ioloop:629]
tornado.iostream.StreamClosedError: Stream is closed
was testing using python 3.5.1