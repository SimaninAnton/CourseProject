hackrole commented on 23 Jan 2015
I write my unittest like this due to some experices on django unit-teset. but it not works. I saw the header and the body seems not handled, and I can't find any example or tutorial about this.
from os import path
from tornado.testing import AsyncHTTPTestCase

class ImageTestCase(AsyncHTTPTestCase):

    def test_post_return_ok(self):
        fpath = path.join(path.dirname(__file__), 'test.jpg')
        f = open(fpath)

        url = "/img"
        data = {
            "image": f,
        }

        response = self.fetch(url, method="POST",  body=data)
        print response.request.header
        print response.request.body
this result is somethind like this:
ipdb> response.request.body
'image=%3Copen+file+%27%2Fhome%2Fdaipeng%2Fprojects%2Fnext_chat%2Fnchat%2Ftests%2Ftest.jpg%27%2C+mode+%27r%27+at+0x360e150%3E'

ipdb> response.request.headers
{'Content-Type': 'application/x-www-form-urlencoded', 'Connection': 'close', 'Content-Length': '191', 'Host': u'localhost:42321', 'Accept-Encoding': 'gzip'}