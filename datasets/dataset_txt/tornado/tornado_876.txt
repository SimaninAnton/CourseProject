thehesiod commented on 19 Nov 2013
tornado's default jsonification of the response doesn't support datetime conversion due to the underlying JSON implementation. I propose fixing this oversight with what the following monkey patch achieves. I think the underlying JSON implementation is what really should be fixed, but at least tornado with this patch will behave in a reasonable manner for datetime objects.
import json, datetime
from tornado import escape
DT_HANDLER = lambda obj: obj.isoformat() if isinstance(obj, datetime.datetime) or isinstance(obj, datetime.date) else None
def json_encode(value):
return json.dumps(value, default=DT_HANDLER).replace("</", "</")
escape.json_encode = json_encode