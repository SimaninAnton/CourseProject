Arfrever commented on 2 Jun 2012
tornado/test/runtests.py is now too strict. It should ignore ImportWarnings, which would occur for namespace packages generated by setuptools.
$ PYTHONPATH="." python2.7 tornado/test/runtests.py
Traceback (most recent call last):
  File "tornado/test/runtests.py", line 59, in <module>
    tornado.testing.main()
  File "/tmp/tornado-2.3/tornado/testing.py", line 381, in main
    unittest.main(defaultTest="all", argv=argv)
  File "/usr/lib64/python2.7/unittest/main.py", line 94, in __init__
    self.parseArgs(argv)
  File "/usr/lib64/python2.7/unittest/main.py", line 149, in parseArgs
    self.createTests()
  File "/usr/lib64/python2.7/unittest/main.py", line 158, in createTests
    self.module)
  File "/usr/lib64/python2.7/unittest/loader.py", line 128, in loadTestsFromNames
    suites = [self.loadTestsFromName(name, module) for name in names]
  File "/usr/lib64/python2.7/unittest/loader.py", line 113, in loadTestsFromName
    test = obj()
  File "tornado/test/runtests.py", line 34, in all
    return unittest.defaultTestLoader.loadTestsFromNames(TEST_MODULES)
  File "/usr/lib64/python2.7/unittest/loader.py", line 128, in loadTestsFromNames
    suites = [self.loadTestsFromName(name, module) for name in names]
  File "/usr/lib64/python2.7/unittest/loader.py", line 91, in loadTestsFromName
    module = __import__('.'.join(parts_copy))
  File "/tmp/tornado-2.3/tornado/test/twisted_test.py", line 31, in <module>
    from twisted.internet.defer import Deferred
  File "/usr/lib64/python2.7/site-packages/twisted/internet/defer.py", line 25, in <module>
    from twisted.python import log, failure, lockfile
  File "/usr/lib64/python2.7/site-packages/twisted/python/log.py", line 17, in <module>
    from zope.interface import Interface
  File "/usr/lib64/python2.7/site-packages/zope/__init__.py", line 2, in <module>
    import pkg_resources
  File "/usr/lib64/python2.7/site-packages/pkg_resources.py", line 2756, in <module>
    add_activation_listener(lambda dist: dist.activate())
  File "/usr/lib64/python2.7/site-packages/pkg_resources.py", line 705, in subscribe
    callback(dist)
  File "/usr/lib64/python2.7/site-packages/pkg_resources.py", line 2756, in <lambda>
    add_activation_listener(lambda dist: dist.activate())
  File "/usr/lib64/python2.7/site-packages/pkg_resources.py", line 2259, in activate
    map(declare_namespace, self._get_metadata('namespace_packages.txt'))
  File "/usr/lib64/python2.7/site-packages/pkg_resources.py", line 1848, in declare_namespace
    _handle_ns(packageName, path_item)
  File "/usr/lib64/python2.7/site-packages/pkg_resources.py", line 1805, in _handle_ns
    loader = importer.find_module(packageName)
  File "/usr/lib64/python2.7/pkgutil.py", line 186, in find_module
    file, filename, etc = imp.find_module(subname, path)
ImportWarning: Not importing directory '/usr/lib64/python2.7/site-packages/peak': missing __init__.py