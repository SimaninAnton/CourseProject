Network with shared weights and a max function