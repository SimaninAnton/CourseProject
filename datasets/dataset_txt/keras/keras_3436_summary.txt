Mismatch with ndim when using functional API