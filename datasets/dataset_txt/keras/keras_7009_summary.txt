Feeding training data in batches