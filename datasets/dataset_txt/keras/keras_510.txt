Contributor
stanpcf commented on 22 Dec 2018
param cache_dir=None in keras.utils.get_file is inconsistent with keras.backend.
code in keras.utils.get_file
if cache_dir is None:
    cache_dir = os.path.join(os.path.expanduser('~'), '.keras')
if md5_hash is not None and file_hash is None:
    file_hash = md5_hash
    hash_algorithm = 'md5'
datadir_base = os.path.expanduser(cache_dir)
if not os.access(datadir_base, os.W_OK):
    datadir_base = os.path.join('/tmp', '.keras')
the datadir_base will first choose ~/.keras, then choose /tmp/.keras
while in keras.backend
# Set Keras base dir path given KERAS_HOME env variable, if applicable.
# Otherwise either ~/.keras or /tmp.
if 'KERAS_HOME' in os.environ:
    _keras_dir = os.environ.get('KERAS_HOME')
else:
    _keras_base_dir = os.path.expanduser('~')
    if not os.access(_keras_base_dir, os.W_OK):
        _keras_base_dir = '/tmp'
    _keras_dir = os.path.join(_keras_base_dir, '.keras')
_keras_dir will first choose KERAS_HOME, then choose ~/.keras, last choose /tmp/.keras
So when we set KERAS_HOME and KERAS_HOME is not ~/.keras, models and datasets will still be in ~/.keras(when the cache_dir is default value) while the config file keras.json in KERAS_HOME
the func get_file() should be consistent with keras.backend when cache_dir is default(default cache_dir=None).