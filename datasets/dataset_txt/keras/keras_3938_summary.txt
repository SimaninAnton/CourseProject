Embedding with TensorFlow very slow: converts indices to dense gradients