yyaodong commented on 7 Sep 2015
Hi All,
I want to save the model which shows the best result on validation set during model.fit() process. I create a callback that uses model.save_weights to save the best model to a hdf5 file. However, after the whole training is finished, by re-constructing the best model via model.load_weights, I cannot repeat that best result on the validation set anymore. The reconstructed model does not produce the same performance that it shows in the fitting process. The bias exists in model.set_weights and model.get_weights as well.
My current solution is to use the copy.deepcopy function to copy the whole "model" when a model with better performance is found. But it largely deteriorates the speed. I was wondering is this a bug or I miss some basic things of the "model" during re-construction?
Thanks you very much.
Yang