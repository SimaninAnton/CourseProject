Switch to a modular backend for Theano and TensorFlow support