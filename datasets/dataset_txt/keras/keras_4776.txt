mmoradik commented on 14 Jul 2016
I am new in keras. I have some problem working with merge.
Assuming that I have 3 models. model1 has 4 outputs (px1,py1,px2,py2). model 2 and models 3 each has two outputs. (x1,y1) and (x2,y2) are outputs of each one of them respectively.
My question is how I can merge these models to have two outputs x,y:
x=px1_x1+px2_x2
y=py1_y1+py2_y2
Through the following code, the output of final model has 4 dimension representing (px1_x1, px2_x2, py1_y1, py2_y2). How can I reshape this output and sum to reach to x and y.
or is there any way to merge only some outputs of a model with other model?
model1=Sequential()
model1.add(Dense(input_dim=10, output_dim=2*2))
model1.add(Activation('softmax'))
model2=Sequential()
model2.add(Dense(input_dim=10, output_dim=2))
model2.add(Activation('tanh'))
model3=Sequential()
model3.add(Dense(input_dim=10, output_dim=2))
model3.add(Activation('tanh'))
merged_expert=Merge([model2,model3],mode='concat')
merged = Merge([model1, merged_expert], mode='mul')
final_model = Sequential()
final_model.add(merged)