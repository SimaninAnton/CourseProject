apapiu commented on 7 Oct 2016 â€¢
edited
Say I have a pertained model like the VGG16. If I want to select only the first few convolutional blocks I can so something like:
from keras.applications import VGG16
vgg16 = VGG16(include_top=False, input_tensor=input)

conv_output = vgg16.get_layer("block4_pool").output 
feature_extractor = Model(vgg16.input, conv_output)
Is there a way to use the same API to slice a middle part of a model (including weights) ? I've tried something like:
model_top = Model(input = vgg16.get_layer("block5_conv1").input, 
                  output=vgg16.get_layer("block5_conv3").output)
but got an error:
Exception: Graph disconnected: cannot obtain value for tensor input_6 at layer "input_6". The      following previous layers were accessed without issue: []