Imorton-zd commented on 1 Feb 2016
When using cnn or lstm to perform text classification muti times, the accuracy of every time is different and vary considerably. For instance, the accuracy of first time is 0.8, then the second time becomes 0.75. In every experiment, the codes are all the same. The main part of my codes as following:
        tokenizer = Tokenizer(nb_words=max_features)
        X_train = tokenizer.sequences_to_matrix(X_train, mode='binary')
        X_test = tokenizer.sequences_to_matrix(X_test, mode='binary')

        X_train = np.reshape(X_train, (2*n, 1, max_features))    
        X_test = np.reshape(X_test, (1200, 1, max_features))

        print('X_train shape:', X_train.shape)
        print('X_test shape:', X_test.shape)

        print('Build model...')
        model = Sequential()
        model.add(LSTM(lstm_output_dims, input_shape=(1, max_features)))
        model.add(Dense(hidden_dims))
        model.add(Activation('relu'))
        model.add(Dropout(0.5))    
        model.add(Dense(1))
        model.add(Activation('sigmoid'))

        model.compile(loss='binary_crossentropy',optimizer='adam',class_mode="binary")

        print("Train...")
        hist = model.fit(X_train, y_train, nb_epoch=nb_epoch, batch_size=batch_size, verbose=1,shuffle=True, show_accuracy=True,  validation_data=(X_test, y_test))

        print (hist.history)
        print ('train number %s, %s end!\n'%(2*n,d))
        ti =  time.strftime( ISOTIMEFORMAT, time.localtime() )
        f.write('time:%s\n'%ti) 
        f.write('%s bow lstm accuracy: %s %s\n'%(d, max(hist.history['val_acc']), hist.history['val_acc']))