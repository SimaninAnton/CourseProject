rakshajalan commented on 3 Jul 2017 â€¢
edited
I have used embedded sequences as input to conv1D its working fine Now I want to pass it to Conv2D for another model.I am new to keras so dont know how to reshape output of embedding layer?
Here is my code :
embedding_layer = Embedding(len(word_index) + 1,
EMBEDDING_DIM,
weights=[embedding_matrix],
input_length=MAX_SENT_LENGTH,
trainable=True)
sentence_input = Input(shape=(MAX_SENT_LENGTH,), dtype='int32')
embedded_sequences = embedding_layer(sentence_input)
x= Conv2D(32, kernel_size=(3, 3),padding="valid",activation="relu",strides=1)(embedded_sequences)
Error:ValueError: Input 0 is incompatible with layer conv2d_1: expected ndim=4, found ndim=3
Tensor dimensions:
MAX_SENT_LENGTH=100,Embeding dim:300
MAX_SENTENCES IN DOCUMENT=20
sentence_input shape : (?, 100)
embedded_sequences shape: (?, 100, 300)
x_train shape: (8000, 20, 100)