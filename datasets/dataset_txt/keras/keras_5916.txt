snakeztc commented on 19 Feb 2016
The model that I am trying to build is as follows:
So I constructed the following model using Keras:
    model = Sequential()
    model.add(Embedding(nb_words, hidden_size, mask_zero=True))
    model.add(LSTM(hidden_size, return_sequences=True))
    model.add(Dropout(0.2))

    model.add(TimeDistributedMerge(mode='ave'))
    model.add(Dense(hidden_size, init='lecun_uniform'))
    model.add(Activation('relu'))
    model.add(Dropout(0.2))

    model.add(Dense(self.domain.actions_num, init='lecun_uniform'))
    model.add(Activation('linear'))
    model.compile(loss='mse', optimizer="adam")
So the problem is that I want to use mask_zero because each input sequence have different length. However, I got the error:
AssertionError: Cannot connect non-masking layer to layer with masked output.
So is it possible to have mean pooling with masking? Do I need to implement my own layer? Thanks!
3