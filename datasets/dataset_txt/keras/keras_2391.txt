xn8812 commented on 14 May 2017
Hi, is it possible to specify the initial state for a stateful recurrent layer? For example, I have the following code, will this work?
conv_lstm = ConvLSTM2D(128, (3,3), stateful=True)
x = Input(batch_shape=(1,1,32, 32, 3))
if need_initial_flag == True:
    h_tm1 = Input(batch_shape=(1,32, 32, 3))
    y = conv_lstm(x, initial_state=[h_tm1, h_tm1])
else:
    y = conv_lstm(x)
The idea is to have the need_initial_flag turned on in the beginning of a sequence and then turned off.
I am not sure if the logic is correct for Keras implementation. Thanks! @farizrahman4u