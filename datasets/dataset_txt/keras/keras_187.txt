gustavz commented on 6 Jun 2019
System information
Have I written custom code (as opposed to using example directory): yes
OS Platform and Distribution (e.g., Linux Ubuntu 16.04): macOS
TensorFlow backend (yes / no): yes
TensorFlow version: v1.12.1-1845-g27cfc61581 1.14.1-dev20190514
Keras version: using tf.keras
Python version: 3.7.3
CUDA/cuDNN version: -
GPU model and memory: -
When fitting a Keras (TF backend) LSTM encoder-decoder model (or any model with Timedistributed(Dense(1)) layer at the end)
model = Sequential()
model.add(LSTM(200, activation='relu', input_shape=(72,3)))
model.add(RepeatVector(24))
model.add(LSTM(200, activation='relu', return_sequences=True))
model.add(TimeDistributed(Dense(int(100), activation='relu')))
model.add(TimeDistributed(Dense(1)))
model.compile(loss='mse', optimizer='adam')
with a batch_size>1 I see the following Error:
keras InvalidArgumentError: Incompatible shapes: [100,24,1] vs. [100,24]
where in this case 100 is the batch_size and 24 is length of the output sequence.
The training data has the shape: [samples, time_steps, n_features], so something like:
X_train:(13641, 72, 3) and y_train:(13641, 24, 1)