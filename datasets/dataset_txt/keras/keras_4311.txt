Contributor
linxihui commented on 26 Sep 2016 â€¢
edited
Hi @fchollet
I notice that in the current keras recurrent network only save the last hidden states for stateful
RNN (from keras.backend.rnn
    states = [T.squeeze(state[-1]) for state in states]
    return last_output, outputs, states
)
However, sometimes, it would be necessary to get all the states out. For example, by looking into the gates between steps, one can understand how information is passing through the RNN. This is specially important in natural language.
I suggest change the above code to
last_states = [T.squeeze(state[-1]) for state in states]
return last_output, outputs, last_states, states
and save the states as an attribute of the Recurrent class. In addition, step in Recurrent can also return i, o, f (in LSTM). However, looks like for tensorflow, other change may have to be made.
What do you think?
1