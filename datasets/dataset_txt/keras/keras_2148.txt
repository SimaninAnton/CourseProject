Contributor
titu1994 commented on 13 Jun 2017 â€¢
edited
I've recently finished implementing MobileNets for Keras, and was wondering if it could be added to Keras proper or the Deep Learning Models repository.
Weights for ImageNet are available, and ported over (from the Tensorflow checkpoints) from the tf-slim repository.
There is an issues with adding it to Keras. Namely :
Use of custom DepthwiseConvolution2D layer (1st part of SeparableConvolution2D). While I have tested the Keras model on random images, and ensured it works, we would have to add another layer to Keras, and the accompanying tests.
EDIT The model has 1001 output classes, but decode_predictions accepts only 1000 classes. I got around this limitation by selecting just the first 1000 predictions in predict_imagenet.py
@fchollet I've considered adding this to contrib, but the main benefit of having this model in Keras proper is its efficiency. I found it to be far faster and easier to fine tune as compared to InceptionV3 or ResNet50, which can't even be loaded onto smaller GPUs (such as mine with only 4 GB of memory), with only a minimal loss in performance.
Other benefits are obvious as to deployment on mobile devices (with the Keras integration into tensorflow 1.2 being almost complete in the latest RC, I imagine it would be trivial to train on Keras and export to Tensorflow and then to Android / iOS (hopefully)).
Relevant Paper - MobileNets: Efficient Convolutional Neural Networks for Mobile Vision Applications
Repository - https://github.com/titu1994/MobileNetworks
Weights were ported from repository - https://github.com/Zehaos/MobileNet
2