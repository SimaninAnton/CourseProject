ygorcanalli commented on 7 Aug 2017 â€¢
edited
I'm using a dataset for binary classification that classes are -1 (negative) or 1 (positive), and the function utils.to_categorical understand all values as positive. I've solved the problem using a handmade encoding function:
def encode_target(y):
    y_encoded = np.zeros( (y.shape[0], 2) )
    
    y_neg_index = y == -1
    y_pos_index = y == 1
    
    y_encoded[y_neg_index,0] = 1
    y_encoded[y_pos_index,1] = 1

    return y_encoded
I'ts also possible reescale the target to [0, 1], but is intresting for usability that the native keras function can deal with it.