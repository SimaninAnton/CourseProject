Mask, hidden states and cost functions for sequence to sequence learning