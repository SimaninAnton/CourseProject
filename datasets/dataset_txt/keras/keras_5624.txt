cmishra commented on 30 Mar 2016
I'm trying to use ImageDataGenerator to preprocess the MNIST dataset. It's unsuccessful with the error message being:
Traceback (most recent call last):
File "/home/cm5ky/Dropbox/College/4_Fourth_Year/deep learning/MNIST/assess_performance/test.py", line 14, in
generator.fit(all_x_train)
File "/home/cm5ky/anaconda3/lib/python3.5/site-packages/keras/preprocessing/image.py", line 294, in fit
X -= self.mean
TypeError: Cannot cast ufunc subtract output from dtype('float64') to dtype('uint8') with casting rule 'same_kind'
Changing line 294 in image.py glow X -= self.mean to X = X - self.mean resolved my issue. My numpy version is 1.10.4.
The error can be reproduced with:
from keras.datasets import mnist
from keras.preprocessing.image import ImageDataGenerator
(all_x_train, all_y_train), ignore = mnist.load_data()
generator = ImageDataGenerator()
generator.fit(all_x_train)