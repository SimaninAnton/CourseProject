Tcorpion commented on 8 Oct 2016 â€¢
edited
I am new in Keras. Even my following code is referenced from https://keras.io/ , i still do not know how to fix it. Anyone can help me?
# this return a tensor
inputs = Input(shape=(784,),dtype='float32')
# a layer instance is callable on a tensor, and returns a tensor
X=Dense(64,activation='relu')(inputs)
X=Dense(64,activation='relu')(X)
predictions=Dense(10,activation='softmax')(X)
model=Model(input=inputs,output=predictions)

print('Compiling')
#sgd = SGD(lr=0.01, decay=1e-6, momentum=0.9, nesterov=True)
model.compile(optimizer='rmsprop',
              loss='categorical_crossentropy',
              metrics=['accuracy'])             

print('Loading data')
train_X,train_Y=load_minist.load_data_V2('training.pkl')
valid_X,valid_Y=load_minist.load_data_V2('validation.pkl')
early_stop = EarlyStopping(monitor='val_acc', patience=2, verbose=1, mode='max')

print('Begin Training')
model.fit(train_X,train_Y,
          batch_size=32,nb_epoch=20,
          validation_data=(valid_X,valid_Y),
          callbacks=[early_stop])
the running error is :
Exception: Error when checking model input: the list of Numpy arrays that you are passing to your model is not the size the model expected. Expected to see 1 arrays but instead got the following list of 50000 arrays: [array([ 0. , 0. , 0. , 0. , 0. ,
0. , 0. , 0. , 0. , 0. ,
0. , 0. , 0. , 0. ...
Process finished with exit code 1
// The shape of data is as following
// print np.shape(train_X)
// (50000, 784)
// print np.shape(train_Y)
// (50000, 10)
// print np.shape(valid_X)
// (10000, 784)
// print np.shape(valid_Y)
// (10000, 10)