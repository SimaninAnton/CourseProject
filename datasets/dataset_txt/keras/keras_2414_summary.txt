Better error messaging when passing an invalid type to functional api