premrajnarkhede commented on 8 Dec 2016
Hi I am consistently getting error "Exception: Error when checking model input: expected dense_input_1 to have shape (None, 3) but got array with shape (3, 1)" with fit_generator while just fit is working fine
`from keras.models import Sequential
from keras.layers import Dense, Activation
import numpy as np
from keras.optimizers import RMSprop,SGD
model = Sequential()
model.add(Dense(3, input_dim=3))
model.add(Activation('sigmoid'))
model.add(Dense(3))
model.add(Activation('sigmoid'))
model.add(Dense(3, activation='softmax'))
model.compile(optimizer=RMSprop(lr=0.01),
loss='categorical_crossentropy',
metrics=['accuracy'])
def generator1():
i=0
inputData=[]
outputData=[]
while i<10:
inputData.append([False,True,False])
outputData.append([False,True,False])
i=i+1
yield np.array([False,True,False]),np.array([False,True,False])
#yield np.array(inputData),np.array(outputData)
model.fit_generator(generator1(),samples_per_epoch=10, nb_epoch=10)`
Tried sending batches as well as individual entries.