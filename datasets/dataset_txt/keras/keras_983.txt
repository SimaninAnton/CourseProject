jaishirb commented on 7 Jun 2018
HI, i have a problem while loading the model, this is exactly what python says:
ValueError: Unknown layer: Merge
Please, help to fix that, seems like something is not defined.
This is the error:
File "python3.6/site-packages/keras/engine/saving.py", line 261, in load_model
model = model_from_config(model_config, custom_objects=custom_objects)
File "python3.6/site-packages/keras/engine/saving.py", line 335, in model_from_config
return deserialize(config, custom_objects=custom_objects)
File "python3.6/site-packages/keras/layers/init.py", line 55, in deserialize
printable_module_name='layer')
File "python3.6/site-packages/keras/utils/generic_utils.py", line 145, in deserialize_keras_object
list(custom_objects.items())))
File "python3.6/site-packages/keras/engine/network.py", line 1036, in from_config
process_layer(layer_data)
File "python3.6/site-packages/keras/engine/network.py", line 1022, in process_layer
custom_objects=custom_objects)
File "python3.6/site-packages/keras/layers/init.py", line 55, in deserialize
printable_module_name='layer')
FIle "python3.6/site-packages/keras/utils/generic_utils.py", line 138, in deserialize_keras_object
': ' + class_name)
ValueError: Unknown layer: Merge
Script:
if name == 'main':
parser = argparse.ArgumentParser()
parser.add_argument('model', help='Path to model')
parser.add_argument('input_path', help='Path to image or directory')
parser.add_argument('-o', '--output_path', help='Output directory')
parser.add_argument('-b', '--batch_size', help='Batch size for running the network')
parser.add_argument('-c', '--crop', dest='crop', default=False, action='store_true',
help='Crop out black borders after rotating')
args = parser.parse_args()
print('Loading model...')
model_location = load_model(args.model, custom_objects={'angle_error': angle_error}) #here is the problem, when loading the model. That is not a path problem, is a problem with keras with Merge layout.

output_path = args.output_path if args.output_path else args.input_path

print('Processsing input image(s)...')
process_images(model_location, args.input_path, output_path, args.batch_size, args.crop)