mattroos commented on 1 Jun 2017 â€¢
edited
Example file image_ocr.py is giving me the mis-match dimension error below, after compilation. I've browsed the code but see nothing wrong. I'm using updated versions of theano, keras, and cuda. Maybe @mbhenry can help?
Epoch 1/20
Traceback (most recent call last):
File "image_ocr.py", line 489, in
train(run_name, 0, 20, 128)
File "image_ocr.py", line 484, in train
callbacks=[viz_cb, img_gen], initial_epoch=start_epoch)
File "/usr/local/lib/python2.7/dist-packages/Keras-2.0.4-py2.7.egg/keras/legacy/interfaces.py", line 88, in wrapper
return func(*args, **kwargs)
File "/usr/local/lib/python2.7/dist-packages/Keras-2.0.4-py2.7.egg/keras/engine/training.py", line 1899, in fit_generator
class_weight=class_weight)
File "/usr/local/lib/python2.7/dist-packages/Keras-2.0.4-py2.7.egg/keras/engine/training.py", line 1639, in train_on_batch
outputs = self.train_function(ins)
File "/usr/local/lib/python2.7/dist-packages/Keras-2.0.4-py2.7.egg/keras/backend/theano_backend.py", line 1196, in call
return self.function(*inputs)
File "/usr/local/lib/python2.7/dist-packages/theano/compile/function_module.py", line 898, in call
storage_map=getattr(self.fn, 'storage_map', None))
File "/usr/local/lib/python2.7/dist-packages/theano/gof/link.py", line 325, in raise_with_op
reraise(exc_type, exc_value, exc_trace)
File "/usr/local/lib/python2.7/dist-packages/theano/compile/function_module.py", line 884, in call
self.fn() if output_subset is None else
ValueError: GpuElemwise. Input dimension mis-match. Input 1 (indices start at 0) has shape[1] == 28, but the output's size on that axis is 32.
Apply node that caused the error: GpuElemwise{add,no_inplace}(GpuReshape{3}.0, InplaceGpuDimShuffle{x,0,x}.0)
Toposort index: 523
Inputs types: [GpuArrayType(float32, (False, False, False)), GpuArrayType(float32, (True, False, True))]
Inputs shapes: [(32, 32, 28), (1, 28, 1)]
Inputs strides: [(3584, 112, 4), (112, 4, 4)]
Inputs values: ['not shown', 'not shown']
Outputs clients: [[GpuElemwise{Composite{exp((i0 - i1))}}[](GpuElemwise{add,no_inplace}.0, InplaceGpuDimShuffle{0,1,x}.0), GpuElemwise{Composite{(i0 + (i1 * EQ(i2, i3) * i4))}}[](GpuElemwise{Composite{(((i0 / i1) + i2) * i3)}}[].0, GpuArrayConstant{[[[-1.]]]}, InplaceGpuDimShuffle{0,1,x}.0, GpuElemwise{add,no_inplace}.0, InplaceGpuDimShuffle{0,1,x}.0), GpuCAReduceCuda{maximum}{2}(GpuElemwise{add,no_inplace}.0)]]
HINT: Re-running with most Theano optimization disabled could give you a back-trace of when this node was created. This can be done with by setting the Theano flag 'optimizer=fast_compile'. If that does not work, Theano optimizations can be disabled with 'optimizer=None'.
HINT: Use the Theano flag 'exception_verbosity=high' for a debugprint and storage map footprint of this apply node.