Custom loss always returns NaN and I don't see why