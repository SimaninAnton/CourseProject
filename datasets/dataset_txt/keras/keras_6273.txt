dscohen commented on 12 Dec 2015
I've been trying to create a stacked BLSTM but haven't had much success in Keras.
print('Build model...')
model = Graph()
model.add_input(name='input', input_shape=(maxlen,), dtype=int)
model.add_node(Embedding(max_features, 256, input_length=maxlen),
               name='embedding', input='input')
model.add_node(LSTM(128,return_sequences=True), 
               name='f1', input='embedding')
model.add_node(LSTM(128, go_backwards=True,return_sequences=True), 
               name='b1', input='embedding')

model.add_node(LSTM(128),
               name='f2' , inputs=['f1','b1')
model.add_node(LSTM(128, go_backwards=True),
               name='b2', inputs=['f1','b1'])

model.add_node(Dense(1, activation='sigmoid'), name='sigmoid', inputs=['f2','b2'])
model.add_output(name='output', input='sigmoid')
But whenever I try to compile, it will crash due to graph cycles. The traceback is pretty long so I attached it as a file. From trying to work around it, it's the 2nd BLSTM layer that causes this only when taking inputs ['f1','b1']. I can add a reshape node between the 1st and 2nd BLSTM layer, but then I get a warning about backprop not working through the graph.
error.txt
1