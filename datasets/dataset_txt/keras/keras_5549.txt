RukinoSaki commented on 8 Apr 2016
featuer=K.function([model.layers[0].input],model.layers[21].get_output(train=False)) trainfeature=feature(X_train)
then, it raised error assert type(inputs) in {list, tuple} ,AssertionError
My X_train is float32,(380L,1L,160L,160L)
another question:
if i use featuer=theano.function([model.layers[0].input],model.layers[21].get_output(train=False)),
it raised error
MemoryError: Error allocating 1189933056 bytes of device memory (out of memory). Apply node that caused the error: GpuAllocEmpty(Shape_i{0}.0, Shape_i{0}.0, Elemwise{Composite{((i0 + i1) - i2)}}.0, Elemwise{Composite{((i0 + i1) - i2)}}.0) Toposort index: 55 Inputs types: [TensorType(int64, scalar), TensorType(int64, scalar), TensorType(int64, scalar), TensorType(int64, scalar)] Inputs shapes: [(), (), (), ()] Inputs strides: [(), (), (), ()] Inputs values: [array(382L, dtype=int64), array(32L, dtype=int64), array(156L, dtype=int64), array(156L, dtype=int64)] Outputs clients: [[GpuDnnConv{algo='small', inplace=True}(GpuContiguous.0, GpuContiguous.0, GpuAllocEmpty.0, GpuDnnConvDesc{border_mode='valid', subsample=(1, 1), conv_mode='conv', precision='float32'}.0, Constant{1.0}, Constant{0.0})]]
Backtrace when the node is created(use Theano flag traceback.limit=N to make it longer): File "C:\Users\Tori\Anaconda2\lib\site-packages\keras\layers\core.py", line 679, in get_output X = self.get_input(train) File "C:\Users\Tori\Anaconda2\lib\site-packages\keras\layers\core.py", line 175, in get_input previous_output = self.previous.get_output(train=train) File "C:\Users\Tori\Anaconda2\lib\site-packages\keras\layers\convolutional.py", line 312, in get_output X = self.get_input(train) File "C:\Users\Tori\Anaconda2\lib\site-packages\keras\layers\core.py", line 175, in get_input previous_output = self.previous.get_output(train=train) File "C:\Users\Tori\Anaconda2\lib\site-packages\keras\layers\core.py", line 679, in get_output X = self.get_input(train) File "C:\Users\Tori\Anaconda2\lib\site-packages\keras\layers\core.py", line 175, in get_input previous_output = self.previous.get_output(train=train) File "C:\Users\Tori\Anaconda2\lib\site-packages\keras\layers\convolutional.py", line 317, in get_output filter_shape=self.W_shape) File "C:\Users\Tori\Anaconda2\lib\site-packages\keras\backend\theano_backend.py", line 610, in conv2d subsample=strides)
HINT: Use the Theano flag 'exception_verbosity=high' for a debugprint and storage map footprint of this apply node.
if you know the problem, plz tell me and thank you very much