loss function doesn't ignore large masked values