Contributor
Dapid commented on 20 Apr 2016 â€¢
edited
Loading a functional API model from yaml doesn't work, as it is mussing predict_function. Example:
from keras.layers import Input, Dense
from keras.models import Model
from keras.models import model_from_yaml

import numpy as np

inputs = Input(shape=(784,))

x = Dense(64, activation='relu')(inputs)
x = Dense(64, activation='relu')(x)
predictions = Dense(10, activation='softmax')(x)

model = Model(input=inputs, output=predictions)
model.compile(optimizer='rmsprop',
              loss='categorical_crossentropy',
              metrics=['accuracy'])
yaml = model.to_yaml()

model = model_from_yaml(yaml)
model.predict(np.random.random((20, 784)))
It spits: 'Model' object has no attribute 'predict_function'
Adding it by hand seems to be enough to make it work:
model.predict_function = None
model._function_kwargs = dict()