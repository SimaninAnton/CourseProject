AnnHae commented on 30 Mar 2017
Hi,
I tried using the InceptionV3 model with a custom input tensor like described in the doc (see also this thread: https://groups.google.com/forum/#!topic/keras-users/G9C55N7e8S4). Here's my code:
from keras.applications.inception_v3 import InceptionV3
from keras.layers import Input
import keras.backend as K
import numpy as np

K.set_image_data_format('channels_first')

input_tensor = Input(shape=(3,224, 224))  # this assumes K.image_data_format() == 'channels_first'
model = InceptionV3(input_tensor=input_tensor, weights='imagenet', include_top=True)

def get_dummy_data(batch_size,input_shape,n_classes):   
    imgs = np.zeros((batch_size,input_shape[0],input_shape[1],input_shape[2]))
    labels = np.zeros((batch_size,n_classes))   
    return imgs, labels
   
train_imgs, train_labels = get_dummy_data(10,(3,224,224),1000)


# compile the model (should be done *after* setting layers to non-trainable)
model.compile(optimizer='rmsprop', loss='categorical_crossentropy')

# train the model on the new data for a few epochs
model.fit(x=train_imgs,y=train_labels)
but it yields an error:
ValueError: The model expects 0 input arrays, but only received one array. Found: array with shape (10, 3, 224, 224)
The error vanishes when I give the input tensor a name and provide the training data as a dict, however then I get a MissingInputError in theano.gof.fg.
From the discussion at google/keras-users and my own investigations I think it has to do with the fact, that the provided input_tensor is not a placeholder and doesn't appear in model._feed_input_names, whereas the default input when not using the input_tensor option is a placeholder.
Check that you are up-to-date with the master branch of Keras. You can update with:
pip install git+git://github.com/fchollet/keras.git --upgrade --no-deps
If running on Theano, check that you are up-to-date with the master branch of Theano. You can update with:
pip install git+git://github.com/Theano/Theano.git --upgrade --no-deps
Provide a link to a GitHub Gist of a Python script that can reproduce your issue (or just copy the script here if it is short).