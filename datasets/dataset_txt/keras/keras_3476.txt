indra215 commented on 13 Jan 2017 â€¢
edited
Hi,
I want to train a LSTM that learns given a frame of video, predict the next frame of the video. I extracted 20 frames from each video and each frame is passed through a CNN to get a 512 dimensional feature embedding for the frame i.e., each frame is now represented by a 512 dimensional feature vector and I have 20 frames for each video.
So my input has shape of X_train = (no_videos, 20, 512) and similarly my output has shape of Y_train = (no_videos,20,512) which are the shifted frames.
My model looks like this but I am getting this error,
model = Sequential()
model.add(LSTM(128, input_shape=X_train.shape[1:], return_sequences=True))

sgd = SGD(lr=0.01, decay=1e-6, momentum=0.9, nesterov=True)
model.compile(loss='mean_squared_error', optimizer='sgd')
print(model.summary())

model.fit(X_train, Y_train, nb_epoch=5, batch_size=batchSize)
Traceback (most recent call last):
  File "learn_embedding_vids.py", line 37, in <module>
    model.fit(X_train, Y_train, nb_epoch=5, batch_size=batchSize)
  File "/drive2/dhruv/anaconda/anaconda2/lib/python2.7/site-packages/keras/models.py", line 627, in fit
    sample_weight=sample_weight)
  File "/drive2/dhruv/anaconda/anaconda2/lib/python2.7/site-packages/keras/engine/training.py", line 1052, in fit
    batch_size=batch_size)
  File "/drive2/dhruv/anaconda/anaconda2/lib/python2.7/site-packages/keras/engine/training.py", line 983, in _standardize_user_data
    exception_prefix='model target')
  File "/drive2/dhruv/anaconda/anaconda2/lib/python2.7/site-packages/keras/engine/training.py", line 111, in standardize_input_data
    str(array.shape))
Exception: Error when checking model target: expected lstm_1 to have shape (None, 20, 128) but got array with shape (500, 20, 512)
Can someone please help me how to train this model ?
Thanks in advance.