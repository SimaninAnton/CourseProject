zlian2016 commented on 29 May 2019
An error occur: '' keras Currently save requires model to be a graph network. '' when I try to save model using model.save(). Here is my code.
class Encoder(tf.keras.Model):
def init(self):
super(Encoder, self).init()
self.fc = tf.keras.layers.Dense(units=EMBEDDING_DIM, input_shape=(1, 4096))
def call(self, inputs, training=None, mask=None):
    return self.fc(inputs)
... ...
... ...
encoder = Encoder()
optimizer = tf.train.AdamOptimizer()
variables = encoder.variables + embedding.variables + decoder.variables
gradients = tape.gradient(batch_loss, variables)
optimizer.apply_gradients(zip(gradients, variables), tf.train.get_or_create_global_step())
encoder.save(filepath='./encoder.h5', overwrite=False, include_optimizer=True)
I need some help! Thanks in advance!