FallenShard commented on 6 Feb 2017
Greetings,
I've been trying to implement the Fast Neural Style paper. I've made the transform net and appended VGG16 etc. In addition, I've also added custom regularizers to some layers in the network to calculate loss. Therefore, the objective function objective(y_true, y_pred) that I'm using is set to return 0 and the training is done with custom regularizers only, which provide the loss.
However, there's a problem when I try to load the model with load_model after I've serialized it with model.save(). The error that appears is related to DisconnectedInputError when Theano can't compute the gradients. I believe this comes from the fact that loss is zero when the model loads itself and therefore has no additional loss from regularizers. Passing in custom_objects doesn't help either, in fact, custom regularizer classes are completely ignored (their constructors are not called).
If I try not to save/load the model, training actually works. However, I can't train everything in one go, as it takes a long time. Similarly, saving weights only doesnt help as I still need the optimizer state to continue.
Is there a way to resolve this issue? I suppose I can provide a minimal python script, however it would be quite long.
I'm using the latest Keras version (1.2.1) and windows 10 with theano GPU support.