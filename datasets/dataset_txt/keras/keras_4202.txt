ishank26 commented on 10 Oct 2016 â€¢
edited
Hi,
I'm trying to model a stateful LSTM for TTS system. I've added-
batch_input_shape=(batch_size, timesteps, features), stateful=True
However, I'm getting ValueError: dimension mismatch in args to gemm (2000,64)x(64,64)->(5,64) with the following setup-
X_train.shape= (55, 2000, 425), y_train.shape= (55, 2000, 199)

####model####
n_input=425
n_output=199
size=2000
batch=5
no_epochs=2

model = Sequential()
model.add(LSTM(64, return_sequences=True, batch_input_shape=(size, size, n_input), activation="linear", stateful=True))
model.add(SimpleRNN(n_output,return_sequences=True, activation='tanh', stateful=True))

sgd = SGD(lr=0.01, decay=1e-6, momentum=0.9, nesterov=True)
model.compile(optimizer=sgd, loss='mean_squared_error' ,metrics=['accuracy'])

model.fit(X_train, y_train, batch_size=batch, nb_epoch=no_epochs)
Any ideas? Thanks!