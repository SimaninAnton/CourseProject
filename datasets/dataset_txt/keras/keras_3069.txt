freesunshine0316 commented on 5 Mar 2017 â€¢
edited
Hi,
I implemented a neural language model, which has an embedding layer, an LSTM layer and a Dense layer with softmax activation. Basically it looks like this (not the actual code):
model = Sequantial()
model.add(Embedding())
model.add(LSTM(return_sequence=True, stateful=True))
model.add(TimeDistributed(Dense(, activation='softmax')))
Right now, the model has been successfully trained.
During prediction I feed the network one word each time (batch_size=1, and step_size=1), and only want the LSTM layer's output (vector h) as a numpy array object, how can I get this?
======================
I've tried model.get_layer('lstm_1').output, but it is a tensor object.
When I try model.get_layer('lstm_1').output.eval(session=K.get_session(),feed_dict={K.learning_phase():0}), I got the following error:
tensorflow.python.framework.errors_impl.InvalidArgumentError: You must feed a value for placeholder tensor 'word' with dtype int32 and shape [1,1]
[[Node: word = Placeholderdtype=DT_INT32, shape=[1,1], _device="/job:localhost/replica:0/task:0/gpu:0"]]