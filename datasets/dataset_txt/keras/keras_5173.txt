ssdf93 commented on 14 May 2016
...
qa_model=Model(input=[question_input, answer_input], output=[similarity_value])
good_output = qa_model([question_input, good_answers])
bad_output = qa_model([question_input, bad_answers])
mergedoutput = merge([good_output, bad_output],mode='concat')
training_model = Model(input=[question_input, good_answer_input, bad_answer_input], output=mergedoutput)
training_model.compile(loss=lambda y_true, y_pred: y_pred, optimizer='adam')
pred=training_model.predict([questions,good_answers,bad_answers])
It is OK, when i test qa_model alone
qa_model.compile(loss=lambda y_true, y_pred: y_pred, optimizer='adam')
pred=qa_model.predict([questions,good_answers])
but something wrong with training_model
  File "/Users/Documents/sources/insuranceQA-master/rnn.py", line 186, in build_model
    training_model = Model(input=[question_input, good_answer_input, bad_answer_input], output=mergedoutput)
  File "/Library/Frameworks/Python.framework/Versions/3.4/lib/python3.4/site-packages/keras/engine/topology.py", line 1571, in __init__
    'Keras tensors. Found: ' + str(x))
Exception: Output tensors to a Model must be Keras tensors. Found: Join.0
the full description can be found in This Page