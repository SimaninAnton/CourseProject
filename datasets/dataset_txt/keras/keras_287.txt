iamshri8 commented on 11 Apr 2019
Hello,
I am trying to implement YOLO in Windows ML. I have the following problems -
Windows ML format is NCHW whereas keras is NHWC for both output and input shape.
So , initially I took the yolo model from ONNX zoo and tried to generate bounding boxes values in Windows ML.
I could successfully do it as yolo output shape from ONNX zoo is NCHW and could generate bounding box values in NCHW order. ( as most of them have worked with NCHW order)
So, now I want to convert the Darknet YOLO models to ONNX , for which the intermediate framework is keras ( as searched every where on google) it is the yad2k script. So, in Keras as standard shape is NHWC. It is converted like this.
And I converted the keras model to ONNX using keras2onnx script.
Here, they have channels_first_input enabled as while converting to ONNX , the model converted to shape NCHW. But output shape is still the same NHWC.
So, now it is difficult for me to handle this shape difference in Windows ML. So, could someone help me to change this output shape to NCHW in keras ?