AdityaGudimella commented on 1 Jun 2016
inp_left = Input(shape=input_shape, dtype='int32', name='input_left')
teacher = Input(shape=teacher_shape, dtype='int32', name='teacher')
inp_right = Input(shape=input_shape, dtype='int32', name='input_right')

shared_embed = Embedding(embed_shape, 128, input_length=input_shape[0], name='shared_embed')
embed_left = shared_embed(inp_left)
embed_mid = shared_embed(teacher)
embed_right = Embedding(embed_shape, 128, input_length=input_shape[0], name='embed_right')(inp_right)

left1 = GRU(input_shape[0], return_sequences=True, name='left1')(embed_left)
encoder = GRU(input_shape[0], name='encoder')(left1)
encoder_reshape = Reshape((input_shape[0], 1))(encoder)
merge_input_teacher = merge([encoder_reshape, embed_mid], mode='concat', concat_axis=-1)

mid_1 = GRU(128, return_sequences=True)(merge_input_teacher)

summing_layer = merge([mid_1, embed_right], mode='sum')

model = Model(input=[inp_left, teacher, inp_right], output=summing_layer)

model.compile('adam', 'mse', metrics=['accuracy'])

import keras.backend as K
encoder_f = K.function([model.input], encoder)
throws the error:
TypeError                                 Traceback (most recent call last)
<ipython-input-34-6fc71480d7df> in <module>()
----> 1 encoder_f = K.function([model.input], encoder)

/Users/Aditya/anaconda/lib/python2.7/site-packages/keras/backend/theano_backend.pyc in function(inputs, outputs, updates, **kwargs)
    515                 msg = "Invalid argument '%s' passed to K.function" % key
    516                 raise ValueError(msg)
--> 517     return Function(inputs, outputs, updates=updates, **kwargs)
    518 
    519 

/Users/Aditya/anaconda/lib/python2.7/site-packages/keras/backend/theano_backend.pyc in __init__(self, inputs, outputs, updates, **kwargs)
    501                                         allow_input_downcast=True,
    502                                         on_unused_input='warn',
--> 503                                         **kwargs)
    504 
    505     def __call__(self, inputs):

/Users/Aditya/anaconda/lib/python2.7/site-packages/theano/compile/function.pyc in function(inputs, outputs, mode, updates, givens, no_default_updates, accept_inplace, name, rebuild_strict, allow_input_downcast, profile, on_unused_input)
    303         fn = orig_function(inputs, outputs,
    304                            mode=mode,
--> 305                            accept_inplace=accept_inplace, name=name)
    306     else:
    307         # note: pfunc will also call orig_function -- orig_function is

/Users/Aditya/anaconda/lib/python2.7/site-packages/theano/compile/function_module.pyc in orig_function(inputs, outputs, mode, accept_inplace, name, profile, on_unused_input, output_keys)
   1755     mode = theano.compile.mode.get_mode(mode)
   1756 
-> 1757     inputs = list(map(convert_function_input, inputs))
   1758     if outputs is not None:
   1759         if isinstance(outputs, (list, tuple)):

/Users/Aditya/anaconda/lib/python2.7/site-packages/theano/compile/function_module.pyc in convert_function_input(input)
   1836             else:
   1837                 raise TypeError("Invalid input syntax: %s (check "
-> 1838                                 "documentation or use an In instance)" % orig)
   1839         elif isinstance(input[0], (SymbolicInput, SymbolicInputKit)):
   1840             if len(input) == 1:

TypeError: Invalid input syntax: [input_left, teacher, input_right] (check documentation or use an In instance)
Please make sure that the boxes below are checked before you submit your issue. Thank you!
[ - ] Check that you are up-to-date with the master branch of Keras. You can update with:
pip install git+git://github.com/fchollet/keras.git --upgrade --no-deps
[ - ] If running on Theano, check that you are up-to-date with the master branch of Theano. You can update with:
pip install git+git://github.com/Theano/Theano.git --upgrade --no-deps
[ - ] Provide a link to a GitHub Gist of a Python script that can reproduce your issue (or just copy the script here if it is short).