debadridtt commented on 11 Sep 2018 â€¢
edited
I've used ImageDataGenerator and flow_from_directory for training and validation. Now I have some new images in a test folder (all images are inside the same folder only), on which I want to predict. But when I use .predict_generator I get:
Found 0 images belonging to 0 class
So I tried these solutions:
Keras: How to use predict_generator with ImageDataGenerator? This didn't work out, because its trying on validation set only.
How to predict the new image by using model.predict? module image not found
How to get predictions with predict_generator on streaming test data in Keras? This also didn't work out.
My train data is basically stored in 4 separate folders, i.e. 4 specific classes, validation also stored in same way and works out pretty well.
So in my test folder I have around 300 images, on which I want to predict and make a dataframe, like this:
  image_name    class
     gghh.jpg       1
     rrtq.png       2
     1113.jpg       1
     44rf.jpg       4
     tyug.png       1
     ssgh.jpg       3
I have also used this following code:
img = image.load_img(pred_dir, target_size=(28, 28))
img_tensor = image.img_to_array(img)
img_tensor = np.expand_dims(img_tensor, axis=0)
img_tensor /= 255.
cnn.predict(img_tensor)
But I get this error: [Errno 13] Permission denied: 'D:\Datasets\Trell\images\new_images\testing'
But I haven't been able to predict_generator on my test images. So how can I predict on my new images using Keras. I have googled a lot, searched on Kaggle Kernels also but haven't been able to get a solution.