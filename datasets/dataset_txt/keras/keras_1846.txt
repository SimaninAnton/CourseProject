Contributor
inexxt commented on 27 Jul 2017
I'm trying to save the (Sequential) model to file inside callback, in the on_epoch_begin (or on_batch_begin) method.
While it does work during saving, when I try to load_model(file) later, I'm getting h5py exception
OSError: Unable to open file (File signature not found)
At the same time, saving inside on_batch/epoch_end methods works fine.
The reason I'm trying to do that is to check how much the weights changed during update.
Although I could do the saving only in the on_end methods, it requires me to write separate code for first epoch, saving weighs that the model is initialized with.