Contributor
ipod825 commented on 11 Aug 2015
I failed to add an Embedding layer on Graph model.
Here's the code that works:
from keras.models import Sequential, Graph
from keras.layers.core import Dense
from keras.layers.embeddings import Embedding
lookup = Sequential()
lookup.add(Embedding(2, 1))
lookup.compile(loss='binary_crossentropy', optimizer='sgd')
And here's the code that fails:
from keras.models import Sequential, Graph
from keras.layers.core import Dense
from keras.layers.embeddings import Embedding
model = Graph()
model.add_input('input')
model.add_node(Embedding(2,1), input='input', name='emb')
model.add_output(name='output', input='emb')
model.compile('sgd', {'output':'binary_crossentropy'})
The error message is:
Traceback (most recent call last):
  File "./test.py", line 16, in 
    model.compile('sgd', {'output':'binary_crossentropy'})
  File "/usr/local/lib/python2.7/dist-packages/keras/models.py", line 525, in compile
    y_train = output.get_output(True)
  File "/usr/local/lib/python2.7/dist-packages/keras/layers/embeddings.py", line 62, in get_output
    out = self.W[X]
  File "/usr/local/lib/python2.7/dist-packages/theano/tensor/var.py", line 474, in **getitem**
    return self.take(args[axis], axis)
  File "/usr/local/lib/python2.7/dist-packages/theano/tensor/var.py", line 506, in take
    return theano.tensor.subtensor.take(self, indices, axis, mode)
  File "/usr/local/lib/python2.7/dist-packages/theano/tensor/subtensor.py", line 2290, in take
    return take(a, indices.flatten(), axis, mode).reshape(shape, ndim)
  File "/usr/local/lib/python2.7/dist-packages/theano/tensor/subtensor.py", line 2268, in take
    return advanced_subtensor1(a, indices)
  File "/usr/local/lib/python2.7/dist-packages/theano/gof/op.py", line 509, in **call**
    node = self.make_node(_inputs, *_kwargs)
  File "/usr/local/lib/python2.7/dist-packages/theano/tensor/subtensor.py", line 1608, in make_node
    raise TypeError('index must be integers')
TypeError: index must be integers
Bleeding edge theao is used.