Implementation of margin-based ranking loss