Contributor
dieuwkehupkes commented on 4 Oct 2016 â€¢
edited
load_model seems to fail when a model has multiple output layers that have more than one metric, like:
metrics = {'output1': ['mse', 'binary_accuracy'], 'output2': ['mse', 'binary_accuracy']}
The issue is reproduced in this script:
https://gist.github.com/dieuwkehupkes/6c2d861832a5015b739ce503ec3e11ad
I solved the problem by adding the following lines to the deserialize function in load_model (in models.py) after line 110 (for key, value in obj.items():):
deserialized[key] = []
                if type(value) is list:
                    for element in value:
                        if element in custom_objects:
                            deserialized[key].append(custom_objects[value])
                        else:
                            deserialized[key].append(element)
This works for the layers/models that I am using locally, but when I run the testsuit it gives an error in test_convolutional.py:
tests/keras/layers/test_convolutional.py::test_atrous_conv_2d <- keras/utils/test_utils.py FAILED
I don't really have time to look into that now (I might later) but if someone has an idea, please let me know.