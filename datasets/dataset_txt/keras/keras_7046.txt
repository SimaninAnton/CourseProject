lemuriandezapada commented on 29 Apr 2015
Hey guys so I'm trying to feed a bunch of 2d (batches,seq_len) indices of text sequences into the model in an attempt to try to predict the next word. This leads to a 3d output of (batches,seq_len,vocab_size) time distributed softmax.
model = Sequential()
model.add(Embedding(vocabsize,128)) 
model.add(GRU(128, 128, return_sequences=True))
model.add(Reshape(seqlen,128))
model.add(Dense(128,vocabsize))
model.add(Reshape(seqlen,vocabsize))
model.add(Activation('time_distributed_softmax'))
So far so good. Running the model.predict_probas(sequences) yields a (batches,seq_len,vocab_size) output matrix. Problem is that doing the model.fit(sequences, bin_sequences, batch_size= 4) gives me the theano error of:
('Bad input argument to theano function with name "build/bdist.linux-x86_64/egg/keras/models.py:66" at index 1(0-based)', 'Wrong number of dimensions: expected 2, got 3 with shape (4, 16, 15423).')
Even though the model does output a 3d array, theano still expects a 2d array. Or am I overlooking something?
Is there any way to deal with multiple multi-dimensional time sequences then?