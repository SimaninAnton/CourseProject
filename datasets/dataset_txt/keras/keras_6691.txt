Tuyki commented on 3 Sep 2015
Greetings,
I am now learning Keras and find it an excellent framework!
I also have a question regarding the Embedding layer. Although I am aware of the way an embedding layer works, I do not yet quite understand the input/output dimensions of it in Keras.
Here's a toy example of mine: Say, I have 10 entities, for each of which I need a 5D dense representation. And out of the representations I want to calculate an output. (which doesn't make any sense I just want to understand the way how it works)
So the codes are:
model = Sequential()
model.add(Embedding(10, 5))
model.add(Dense(5, 1, init='uniform', activation = 'linear', W_regularizer = l2(0.01)))
sgd = SGD(lr = 0.1, decay = 0.01, momentum = 0.5, nesterov = False)
model.compile(loss='mean_squared_error', optimizer=sgd)
x = np.random.choice(np.arange(10), 10, replace = False).reshape(10, 1)
y = np.random.randn(10).reshape(10, 1)
model.fit(x, y, nb_epoch=100, batch_size=3)
so the error is:
"TypeError: ('Bad input argument to theano function with name "build/bdist.linux-x86_64/egg/keras/models.py:400" at index 1(0-based)', 'Wrong number of dimensions: expected 3, got 2 with shape (3, 1).')"
As stated in the documentation, the output of embedding layer is a 3D tensor of shape (nb_samples, maxlen, output_dim). How should I reshape (.add(Reshape(10, 5)) doesn't work for me) the output of the embedding layer? And what does this "maxlen" stand for?
Many thanks
Kind regards,
T