HerocypheR commented on 10 Dec 2018
Hi everyone. I have an issue i couldnt find on the internet. Also i tried a lot different models to find solution, but i coulndt create a model with vector output.
Let we have 2589 images with shape 1287 rows and 69 columns (Actually these arent images, but we can see as images.).
Also each images has an vector output with shape 1287x1. Actually each row of input has a output value range between 1-7. I mean, for example for a given image ouput is like [1,2,1,5,6,....1,7,3,5,4] (1287x1)
Here my codes :
X_train = train_input.reshape(train_input.shape[0],train_input.shape[1],train_input.shape[2],1)
Xs = X_train.shape

ys = y_train.shape

input_layer     = Input(shape=(Xs[1],Xs[2],Xs[3]))
conv1           = Conv2D(64,kernel_size=(3,3),padding="same",activation="relu")(input_layer)
pool1           = MaxPooling2D(pool_size=(2,2),padding="same")(conv1)
flat            = Flatten()(pool1)
hidden1         = Dense(100, activation='relu')(flat)
output_layer    = Dense(1287, activation='sigmoid')(hidden1)
model           = Model(inputs=input_layer, outputs=output_layer)

print Xs
print ys
print model.summary()
model.compile(loss='categorical_crossentropy', optimizer='adam')
model.fit(X_train,y_train,epochs=10)
Output image below :
Firstly i used softmax output with one-hot encoded class labels. But when i one-hot encoded classes, y_train becomes matrix.
How i can model Keras CNN with vector output like above ? I tried losses to "MSE", but im not sure its true.
I hope u can help me. Thanks very much