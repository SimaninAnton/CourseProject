eyaler commented on 27 Feb 2016
i am running master imdb_lstm.py example
works for:
3f905e4
broken by:
73e563e
i can run by reducing LSTM(128) to LSTM(64)
error message for LSTM(128):
C:\Anaconda34\python.exe C:/Users/eyaler/Dropbox/python/keras-lstm/lstm.py
Using Theano backend.
DEBUG: nvcc STDOUT mod.cu
Creating library C:/Users/eyaler/AppData/Local/Theano/compiledir_Windows-10-10.0.10586-Intel64_Family_6_Model_94_Stepping_3_GenuineIntel-3.4.4-64/tmp40r8j54g/m91973e5c136ea49268a916ff971b7377.lib and object C:/Users/eyaler/AppData/Local/Theano/compiledir_Windows-10-10.0.10586-Intel64_Family_6_Model_94_Stepping_3_GenuineIntel-3.4.4-64/tmp40r8j54g/m91973e5c136ea49268a916ff971b7377.exp
Using gpu device 0: GeForce GTX 970 (CNMeM is enabled with initial size: 70.0% of memory, CuDNN 4004)
C:\Anaconda34\lib\site-packages\theano\tensor\signal\downsample.py:5: UserWarning: downsample module has been moved to the pool module.
warnings.warn("downsample module has been moved to the pool module.")
Loading data...
20000 train sequences
5000 test sequences
Pad sequences (samples x time)
X_train shape: (20000, 100)
X_test shape: (5000, 100)
Build model...
C:\Anaconda34\lib\site-packages\theano\sandbox\cuda\cuda_ndarray.cuh(17) : warning C4005: 'PyString_Check' : macro redefinition
C:\Anaconda34\lib\site-packages\numpy\core\include\numpy/npy_3kcompat.h(63) : see previous definition of 'PyString_Check'
C:\Anaconda34\lib\site-packages\theano\sandbox\cuda\cuda_ndarray.cuh(18) : warning C4005: 'PyString_FromString' : macro redefinition
C:\Anaconda34\lib\site-packages\numpy\core\include\numpy/npy_3kcompat.h(65) : see previous definition of 'PyString_FromString'
C:\Anaconda34\lib\site-packages\theano\sandbox\cuda\cuda_ndarray.cuh(19) : warning C4005: 'PyString_AsString' : macro redefinition
C:\Anaconda34\lib\site-packages\numpy\core\include\numpy/npy_3kcompat.h(72) : see previous definition of 'PyString_AsString'
C:\Anaconda34\lib\site-packages\theano\sandbox\cuda\cuda_ndarray.cuh(20) : warning C4005: 'PyString_FromStringAndSize' : macro redefinition
C:\Anaconda34\lib\site-packages\numpy\core\include\numpy/npy_3kcompat.h(66) : see previous definition of 'PyString_FromStringAndSize'
C:\Anaconda34\lib\site-packages\theano\sandbox\cuda\cuda_ndarray.cuh(21) : warning C4005: 'PyString_Size' : macro redefinition
C:\Anaconda34\lib\site-packages\numpy\core\include\numpy/npy_3kcompat.h(74) : see previous definition of 'PyString_Size'
C:\Anaconda34\lib\site-packages\theano\sandbox\cuda\cuda_ndarray.cuh(17) : warning C4005: 'PyString_Check' : macro redefinition
C:\Anaconda34\lib\site-packages\numpy\core\include\numpy/npy_3kcompat.h(63) : see previous definition of 'PyString_Check'
C:\Anaconda34\lib\site-packages\theano\sandbox\cuda\cuda_ndarray.cuh(18) : warning C4005: 'PyString_FromString' : macro redefinition
C:\Anaconda34\lib\site-packages\numpy\core\include\numpy/npy_3kcompat.h(65) : see previous definition of 'PyString_FromString'
C:\Anaconda34\lib\site-packages\theano\sandbox\cuda\cuda_ndarray.cuh(19) : warning C4005: 'PyString_AsString' : macro redefinition
C:\Anaconda34\lib\site-packages\numpy\core\include\numpy/npy_3kcompat.h(72) : see previous definition of 'PyString_AsString'
C:\Anaconda34\lib\site-packages\theano\sandbox\cuda\cuda_ndarray.cuh(20) : warning C4005: 'PyString_FromStringAndSize' : macro redefinition
C:\Anaconda34\lib\site-packages\numpy\core\include\numpy/npy_3kcompat.h(66) : see previous definition of 'PyString_FromStringAndSize'
C:\Anaconda34\lib\site-packages\theano\sandbox\cuda\cuda_ndarray.cuh(21) : warning C4005: 'PyString_Size' : macro redefinition
C:\Anaconda34\lib\site-packages\numpy\core\include\numpy/npy_3kcompat.h(74) : see previous definition of 'PyString_Size'
Traceback (most recent call last):
File "C:/Users/eyaler/Dropbox/python/keras-lstm/lstm.py", line 52, in
class_mode="binary")
File "C:\Anaconda34\lib\site-packages\keras\models.py", line 547, in compile
mod.cu
mod.cu(9609) : fatal error C1061: compiler limit : blocks nested too deeply
['nvcc', '-shared', '-O3', '-use_fast_math', '-arch=sm_52', '-Xlinker', '/DEBUG', '-D HAVE_ROUND', '-m64', '-Xcompiler', '-DCUDA_NDARRAY_CUH=m18715462c72ed6afcd7ca5d52813ce90,-DNPY_NO_DEPRECATED_API=NPY_1_7_API_VERSION,/Zi,/MD', '-IC:\Users\eyaler\AppData\Local\Theano\compiledir_Windows-10-10.0.10586-Intel64_Family_6_Model_94_Stepping_3_GenuineIntel-3.4.4-64\cuda_ndarray', '-IC:\Anaconda34\lib\site-packages\numpy\core\include', '-IC:\Anaconda34\include', '-IC:\Anaconda34\lib\site-packages\theano\gof', '-IC:\Anaconda34\lib\site-packages\theano\sandbox\cuda', '-o', 'C:\Users\eyaler\AppData\Local\Theano\compiledir_Windows-10-10.0.10586-Intel64_Family_6_Model_94_Stepping_3_GenuineIntel-3.4.4-64\tmpjn1b5rys\m4ede61e241807f1f7e84ac7a20c0e454.pyd', 'mod.cu', '-LC:\Users\eyaler\AppData\Local\Theano\compiledir_Windows-10-10.0.10586-Intel64_Family_6_Model_94_Stepping_3_GenuineIntel-3.4.4-64\cuda_ndarray', '-LC:\Anaconda34\libs', '-LC:\Anaconda34', '-lcudart', '-lcublas', '-lcuda_ndarray', '-lpython34']
self.train = K.function(train_ins, [train_loss], updates=updates)
File "C:\Anaconda34\lib\site-packages\keras\backend\theano_backend.py", line 449, in function
return Function(inputs, outputs, updates=updates)
File "C:\Anaconda34\lib\site-packages\keras\backend\theano_backend.py", line 441, in init
allow_input_downcast=True, **kwargs)
File "C:\Anaconda34\lib\site-packages\theano\compile\function.py", line 320, in function
output_keys=output_keys)
File "C:\Anaconda34\lib\site-packages\theano\compile\pfunc.py", line 479, in pfunc
output_keys=output_keys)
File "C:\Anaconda34\lib\site-packages\theano\compile\function_module.py", line 1777, in orig_function
defaults)
File "C:\Anaconda34\lib\site-packages\theano\compile\function_module.py", line 1641, in create
input_storage=input_storage_lists, storage_map=storage_map)
File "C:\Anaconda34\lib\site-packages\theano\gof\link.py", line 690, in make_thunk
storage_map=storage_map)[:3]
File "C:\Anaconda34\lib\site-packages\theano\gof\vm.py", line 1003, in make_all
no_recycling))
File "C:\Anaconda34\lib\site-packages\theano\sandbox\cuda__init_.py", line 257, in make_thunk
compute_map, no_recycling)
File "C:\Anaconda34\lib\site-packages\theano\gof\op.py", line 970, in make_thunk
no_recycling)
File "C:\Anaconda34\lib\site-packages\theano\gof\op.py", line 879, in make_c_thunk
output_storage=node_output_storage)
File "C:\Anaconda34\lib\site-packages\theano\gof\cc.py", line 1200, in make_thunk
keep_lock=keep_lock)
File "C:\Anaconda34\lib\site-packages\theano\gof\cc.py", line 1143, in compile
keep_lock=keep_lock)
File "C:\Anaconda34\lib\site-packages\theano\gof\cc.py", line 1595, in cthunk_factory
key=key, lnk=self, keep_lock=keep_lock)
File "C:\Anaconda34\lib\site-packages\theano\gof\cmodule.py", line 1142, in module_from_key
module = lnk.compile_cmodule(location)
File "C:\Anaconda34\lib\site-packages\theano\gof\cc.py", line 1506, in compile_cmodule
preargs=preargs)
File "C:\Anaconda34\lib\site-packages\theano\sandbox\cuda\nvcc_compiler.py", line 396, in compile_str
'for cmd', ' '.join(cmd))
Exception: ('The following error happened while compiling the node', GpuJoin(TensorConstant{0}, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0, GpuAlloc{memset_0=True}.0), '\n', 'nvcc return status', 2, 'for cmd', 'nvcc -shared -O3 -use_fast_math -arch=sm_52 -Xlinker /DEBUG -D HAVE_ROUND -m64 -Xcompiler -DCUDA_NDARRAY_CUH=m18715462c72ed6afcd7ca5d52813ce90,-DNPY_NO_DEPRECATED_API=NPY_1_7_API_VERSION,/Zi,/MD -IC:\Users\eyaler\AppData\Local\Theano\compiledir_Windows-10-10.0.10586-Intel64_Family_6_Model_94_Stepping_3_GenuineIntel-3.4.4-64\cuda_ndarray -IC:\Anaconda34\lib\site-packages\numpy\core\include -IC:\Anaconda34\include -IC:\Anaconda34\lib\site-packages\theano\gof -IC:\Anaconda34\lib\site-packages\theano\sandbox\cuda -o C:\Users\eyaler\AppData\Local\Theano\compiledir_Windows-10-10.0.10586-Intel64_Family_6_Model_94_Stepping_3_GenuineIntel-3.4.4-64\tmpjn1b5rys\m4ede61e241807f1f7e84ac7a20c0e454.pyd mod.cu -LC:\Users\eyaler\AppData\Local\Theano\compiledir_Windows-10-10.0.10586-Intel64_Family_6_Model_94_Stepping_3_GenuineIntel-3.4.4-64\cuda_ndarray -LC:\Anaconda34\libs -LC:\Anaconda34 -lcudart -lcublas -lcuda_ndarray -lpython34', '[GpuJoin(TensorConstant{0}, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>, <CudaNdarrayType(float32, row)>)]')
Process finished with exit code 1