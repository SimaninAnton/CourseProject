jojonki commented on 12 Mar 2017
Hi all,
I am a new user of Keras. I want to implement a LSTM. Before I use my data, I created dummy data for test. But it failed because of input dimensions difference. I do not know where my code declared 3-dim in this model.
python 3.5.2
keras 1.2.0 (Theano)
from keras.layers import Input, Dense
from keras.models import Sequential
from keras.layers import LSTM
from keras.optimizers import RMSprop, Adadelta
from keras.layers.wrappers import TimeDistributed
import numpy as np

in_size = 100
out_size = 10
nb_hidden = 8

model = Sequential()
model.add(LSTM(nb_hidden, 
               name='lstm',
               activation='tanh',
               return_sequences=True,
               input_shape=(None, in_size)))
model.add(TimeDistributed(Dense(out_size, activation='softmax')))

adadelta = Adadelta(clipnorm=1.)
model.compile(optimizer=adadelta,
              loss='categorical_crossentropy',
              metrics=['accuracy'])

# create dummy data
data_size = 300
train = np.zeros((data_size, in_size,), dtype=np.float32)
labels = np.zeros((data_size, out_size,), dtype=np.float32)
model.fit(train, labels)
Then it outputs error below.
ValueError: Error when checking model input: expected lstm_input_6 to have 3 dimensions, but got array with shape (300, 100