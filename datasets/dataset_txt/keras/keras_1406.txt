gaborlegradi commented on 15 Dec 2017 â€¢
edited
Hi,
I would like to use the robust image augmentation tool of Keras for my PWS segmenter. Unfortunately, Keras can not handle images of more than 4 channels. The following code works fine with 4 channels. However, with 5 channels it results in the following error:
[...] ValueError: NumpyArrayIterator is set to use the data format convention "channels_last" (channels on axis 3), i.e. expected either 1, 3 or 4 channels on axis 3. However, it was passed an array with shape (11, 88, 320, 5) (5 channels).
data_gen_args = dict(
vertical_flip=True,
horizontal_flip=True,
height_shift_range=0.05,
fill_mode='nearest',
)
image_datagen = ImageDataGenerator(**data_gen_args)
mask_datagen = ImageDataGenerator(**data_gen_args)
seed = 1
image_datagen.fit(x_trainOK, augment=True, seed=seed)
mask_datagen.fit(x_ref, augment=True, seed=seed)
segmenter_upsampling.compile(optimizer='rmsprop', loss=['categorical_crossentropy'])
epochs = 3200
initial_epoch = 0
segmenter_upsampling.fit_generator(
zip(
image_datagen.flow(x_trainOK, y=None, batch_size=11, seed=seed),
mask_datagen.flow(x_ref, y=None, batch_size=11, seed=seed)
), steps_per_epoch=(len(x_trainOK) // 11), epochs=epochs, verbose=2,
initial_epoch=initial_epoch)