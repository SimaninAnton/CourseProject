HC-2016 commented on 15 Oct 2016
The MSE function defined in objectives.mean_squared_error seems to deal with scalar output. It gets wrong results when output is a tensor with more than one dimension.
originï¼š
def mean_squared_error(y_true, y_pred):
return K.mean(K.square(y_pred - y_true), axis=-1)
revision:
def mean_squared_error(y_true, y_pred):
if y_true.ndim <= 1:
return K.mean(K.square(y_pred - y_true), axis=-1) # for scalar or vector
else:
return K.mean(K.sum(K.square(y_pred - y_true), axis=range(1, y_true.ndim)), axis=-1) # for tensor