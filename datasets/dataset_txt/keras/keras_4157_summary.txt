Errors when evaluating a tensor in custom loss function?