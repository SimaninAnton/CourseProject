logloglog commented on 10 May 2015
I am trying to implement a XOR-problem solving network and can't seem to get it to work. Here's my code:
model = Sequential()
model.add(Dense(2,2))
model.add(Activation('sigmoid'))
model.add(Dense(2,1))
model.add(Activation('softmax'))
X = numpy.array([[0,0],[0,1],[1,0],[1,1]])
y = numpy.array([[0],[1],[1],[0]])
model.compile(loss='categorical_crossentropy', optimizer='sgd')
model.fit(X, y, nb_epoch=5, batch_size=32)
No matter what input I try, the answer to predict_classes is always array([0]), with predict_proba result always being array([[ 1.]]).
I have tried other setups, with tanh activation, loss='mean_absolute_error', optimizer='rmsprop', nb_epoch=20, batch_size=16, but there was no difference.