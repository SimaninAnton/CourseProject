kevkid commented on 13 May 2016
I have a model that I am trying to train where the loss does not go down. I have a custom image set that I am using. These images are 106 x 106 px (black and white) and I have two (2) classes, Bargraph or Gels. These two classes are very different. I have run the Cifar10 dataset and it did reduce the loss, but I am very confused as to why my model will always predict only one class for everything.
Xtrain is a numpy array of images (which are numpy arrays), Ytrain is a numpy array of arrays ([0,1] or [1,0]) the shapes look like this:
np.shape(Xtrain)
Out[58]: (2000, 1, 106, 106)

np.shape(Ytrain)
Out[59]: (2000, 2)
Here is my model:
model = Sequential()
model.add(Convolution2D(32, 16, 16, border_mode='same',name='conv1', input_shape = (1, 106, 106)))
first_layer = model.layers[0]
model.add(Activation("relu"))
model.add(MaxPooling2D(pool_size=(2, 2)))

#2
model.add(Convolution2D(64, 15, 15, border_mode='same',name='conv2'))
model.add(Activation("relu"))
model.add(MaxPooling2D(pool_size=(2, 2)))

#3
model.add(Convolution2D(128, 14, 14, border_mode='same',name='conv3'))
model.add(Activation("relu"))

#flatten
model.add(Flatten())
model.add(Dense(2))
model.add(Activation('softmax'))

rms = RMSprop()
sgd = SGD(lr=0.000001, decay=1e-6, momentum=1.9)
model.compile(loss='categorical_crossentropy', optimizer=sgd,metrics=["accuracy"])
model.fit(Xtrain[950:1050], Ytrain[950:1050], batch_size=32, nb_epoch=20,
          verbose=1, validation_split=0.2,
          callbacks=[EarlyStopping(monitor='val_loss', patience=0)])
Right now I am just doing very small training sets (I tried doing 1000 examples as well, with similar results).
I have also tried RMS and SDG with large and small learning rates.
What else can I try ?
Check that you are up-to-date with the master branch of Keras. You can update with:
pip install git+git://github.com/fchollet/keras.git --upgrade --no-deps
If running on Theano, check that you are up-to-date with the master branch of Theano. You can update with:
pip install git+git://github.com/Theano/Theano.git --upgrade --no-deps