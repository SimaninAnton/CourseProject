Contributor
EderSantana commented on 1 Oct 2015
Guys,
Check this example of a stateful GRU (hidden stated is not wiped out after everybatch) on the text generation example. It makes the initial state a shared variable and updated after each batch:
https://github.com/EderSantana/seya/blob/master/seya/layers/recurrent.py#L94-L96
It is also included a callback to reset it:
https://github.com/EderSantana/seya/blob/master/seya/callbacks.py#L22-L40
The full example is here:
https://github.com/EderSantana/seya/blob/master/examples/stateful_text_generation.py
Let me know what you guys think. Specially if worked on your computer or not :D
I'd also appreciate some feedback on the logic and how to improve it.
Note one thing for instance, a batch_size is required when initializing the network. This forces a maximum value on the input batch length.