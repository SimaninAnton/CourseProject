lileiNPU commented on 24 Mar 2019
Hello everyone,
I am new to python. I am getting an error when I call a Python-generated COM component in the VB.net language (import keras in the COM component), but when I comment out the import keras in the component, the program works fine. How can I solve this problem?
Python:
import pythoncom
#must install pipywin32
class PythonUtilities2:
reg_clsctx = pythoncom.CLSCTX_LOCAL_SERVER
public_methods = ['SplitString']
reg_progid = 'PythonDemos2.Utilities'
#use "print (pythoncom.CreateGuid())" generate a new clsid
#print(pythoncom.CreateGuid())
_reg_clsid_ = '{CF48ABB5-D7F9-4BBB-9B75-3ECFFDE92A93}'

def SplitString(self, val):
    import math
    import keras
    print(val)
    return val
if name=='main':
print ('Registering COM server...')
import win32com.server.register
win32com.server.register.UseCommandLine(PythonUtilities2)
VB.net:
Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
Dim PythonUtils = CreateObject("PythonDemos2.Utilities")
Dim response = PythonUtils.SplitString("Hello from VB")
End Sub
ERROR:
“System.Runtime.InteropServices.COMException”类型的未经处理的异常在 Microsoft.VisualBasic.dll 中发生
其他信息: Unexpected Python Error: Traceback (most recent call last):
File "C:\Users\Daxika\AppData\Local\Programs\Python\Python36\lib\site-packages\win32com\server\policy.py", line 278, in Invoke
return self._invoke_(dispid, lcid, wFlags, args)
File "C:\Users\Daxika\AppData\Local\Programs\Python\Python36\lib\site-packages\win32com\server\policy.py", line 283, in invoke
return S_OK, -1, self._invokeex_(dispid, lcid, wFlags, args, None, None)
File "C:\Users\Daxika\AppData\Local\Programs\Python\Python36\lib\site-packages\win32com\server\policy.py", line 586, in invokeex
return func(*args)
File "N:\testCOM\python_com_2.py", line 14, in SplitString
import keras
File "C:\Users\Daxika\AppData\Local\Programs\Python\Python36\lib\site-packages\keras_init_.py", line 3, in
from . import utils
File "C:\Users\Daxika\AppData\Local\Programs\Python\Python36\lib\site-packages\keras\utils_init_.py", line 6, in
from . import conv_utils
File "C:\Users\Daxika\AppData\Local\Programs\Python\Python36\lib\site-packages\keras\utils\conv_utils.py", line 3, in
from .. import backend as K
File "C:\Users\Daxika\AppData\Local\Programs\Python\Python36\lib\site-packages\keras\backend_init_.py", line 82, in
sys.stderr.write('Using TensorFlow backend.\n')
AttributeError: 'NoneType' object has no attribute 'write'
1