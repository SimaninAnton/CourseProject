talentlei commented on 30 Jan 2016
I use LSTM to do a sequence labeling task, but I got the same acc and cal_acc for each epoch.
here is my code:
def moduleRnn(self):
model = Sequential()
model.add(LSTM(output_dim=64,input_length=self.seq_len,batch_input_shape=(16,1,200),input_dim=self.embed_length,return_sequences=True,stateful=False ))
#model.add(LSTM(output_dim=16,return_sequences=True,stateful=False ))
model.add(Dropout(0.2))
model.add(TimeDistributedDense(output_dim=self.labs_len))
model.add(Activation('softmax'))
model.compile(loss="categorical_crossentropy" , optimizer='rmsprop' , class_mode='categorical')
#model.fit(self.train,self.train_lab,batch_size=16,nb_epoch=3,verbose=1, validation_split=0.1,show_accuracy=True)
model.fit(self.X_train,self.Y_train,batch_size=16,nb_epoch=15,verbose=1,show_accuracy=True,validation_split=0.2)
score = model.evaluate(self.X_test,self.Y_test,batch_size=16)
print score
Anyone meets the same problem? please help me