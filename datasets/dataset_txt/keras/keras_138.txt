cmp1 commented on 5 Jul 2019
I am trying to fit an LSTM-RNN using a time series generator based on on a pandas dataframe. When I attempt to train the model, I get the following error:
_"
Epoch 1/20
Exception in thread Thread-12:
Traceback (most recent call last):
File "/threading.py", line 801, in __bootstrap_inner
self.run()
File "/threading.py", line 754, in run
self.__target(*self.__args, **self.__kwargs)
File "/export/hda3/borglet/remote_hdd_fs_dirs/0.colab_kernel_tensorflow_gpu_chrisprice.kernel.chrisprice.157145873468.14b334fb3717c109/mount/server/colab_notebook.par/google3/third_party/py/keras/utils/data_utils.py", line 633, in data_generator_task
generator_output = next(self.generator)
TypeError: TimeseriesGenerator object is not an iterator
"
Please see my code below
from keras.models import Sequential
from keras.layers import Dense, LSTM
n_input = 1
train_data_gen = sq.TimeseriesGenerator(x_train_scaled, y_train_scaled,
length=n_input, sampling_rate=1, batch_size=8)
model = Sequential()
model.add(LSTM(8, input_shape=(no_samples, 3)))
model.add(Dense(8))
model.compile(loss='mean_squared_error', optimizer='adam')
model.fit_generator(train_data_gen, epochs=20, steps_per_epoch=25)