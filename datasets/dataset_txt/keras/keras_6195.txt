hft7h11 commented on 28 Dec 2015
The code below breaks for stateful networks. I have tried manually editing the JSON to add in the batch_input_shape but that hasn't worked.
save -
json_string = model.to_json()
open(fullNetFileName+'.json', 'w').write(json_string)
model.save_weights(fullNetFileName+'.h5')
load -
model = model_from_json(open(modelArch).read())
model.load_weights(modelWeights)
However now I get the following error:
Exception: If a RNN is stateful, a complete input_shape must be provided (including batch size).