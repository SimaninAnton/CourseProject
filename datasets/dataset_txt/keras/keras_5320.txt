dvector89 commented on 28 Apr 2016 â€¢
edited
Hi, everyone.
I'm building a model for measuring the similarity of two sentences. I want to use a CNN network to encode the sentences pair to vectors pair, then measure the similarity of two vectors. The code i write like this ,but it cannot work.
def build_model():
sent1 = Input(shape=(word_num, word_embedding_size))
sent2 = Input(shape=(word_num, word_embedding_size))
shared_cnn = Convolution1D(nb_filter=nb_filter,
                                             filter_length= filter_length,
                                             border_mode='valid',
                                             activation='relu',
                                             subsample_length=1,
                                             inpute_shape=(word_num, word_embedding_size))

shared_cnn = MaxPooling1D(pool_length=2)(shared_cnn)
shared_cnn = Flatten()(shared_cnn)
shared_cnn = Dense(hidden_dim, activation='rely')
sent1_cnn = shared_cnn(sent1)
sent2_cnn = shared_cnn(sent2)
merged = merge([sent1_cnn, sent2_cnn], mode='concat', concat_axis=1)
predict = Dense(1,activation='sigmoid')(merged)
model = Model(input=[sent1, sent2], output=predict)
model.compile(loss='mean_squared_error', optimizer='adam')
return model. 