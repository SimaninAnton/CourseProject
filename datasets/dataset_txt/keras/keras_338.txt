Contributor
kondela commented on 11 Mar 2019
I am trying to build a siamese network for recommending visually similar items. My goal is to have two inputs, shared pre-trained ResNet50 architecture (+ 512 dense layer) which is connected to one another 512 dense layer. It's heavily inspired by official keras siamese mnist example It seems that my implementation sometimes works, however, most of the time loss decreases while accuracy stays the same. When I created new AWS EC2 instance and ran it for the first time the decreased and accuracy increased very rapidly, after I ran the script second time (without doing any changes) it got stuck at 50% (Â±1%). Now no matter what I do the accuracy does not change (although loss decreases).
I have spent last 2 weeks debugging this issue. It seems to be related to batch-normalization, but I could be wrong. Also, it seems that I am not the only one having this issue here or here
I am attaching Jupyter Notebook with the entire script here (easy to follow and easy to reproduce).
ANY help is much appreciated. If this is not a bug related to Keras than I apologise.