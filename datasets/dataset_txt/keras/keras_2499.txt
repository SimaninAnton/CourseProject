TimothyFitz commented on 2 May 2017
Renaming layer 0 or layer 2 in this model causes get_config and thus save to fail with the reason below.
from keras.models import Model
from keras.layers import Input, Dense

inp_layer = Input((10,))
middle_layer = Dense(10)(inp_layer)
out_layer = Dense(10)(middle_layer)
model = Model(inp_layer, out_layer)
model.layers[0].name = "renamed_layer"
model.get_config()
Results in:
Traceback (most recent call last):
  File "./repro.py", line 10, in <module>
    model.get_config()
  File "lib\site-packages\keras\engine\topology.py", line 2336, in get_config
    new_node_index = node_conversion_map[node_key]
KeyError: 'renamed_layer_ib-0'
Renaming the middle layer doesn't cause problems. Reproduces with 2.0.4 and c430b6c