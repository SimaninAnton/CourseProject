Member
farizrahman4u commented on 23 Oct 2015
I am trying to add 2 new merge modes, cosine and dot:
cosine merge:
elif self.mode == 'cos':
l1 = self.layers[0].get_output(train)
l2 = self.layers[1].get_output(train)
output, _ = theano.scan(lambda v1,v2 : T.dot(v1,v2)/T.sqrt(T.dot(v1,v1) * T.dot(v2,v2)) , sequences= [r1, r2], outputs_info = None)
return output
dot merge:
elif self.mode == 'dot':
l1 = self.layers[0].get_output(train)
l2 = self.layers[1].get_output(train)
output, _ = theano.scan(lambda v1,v2 : T.dot(v1,v2), sequences= [r1, r2], outputs_info = None)
return output
else:
raise Exception('Unknown merge mode')
What would be their corresponding output shapes?