PedroCardoso commented on 24 Dec 2015
I am trying to do a tagging system with LSTM, and have had an error that I can't explain.
I've reduced the problem to the simplest form, and the errors is always there.
model = Sequential()
model.add(Embedding(5000, 3, mask_zero=True, input_length=100))
model.add(LSTM(128, return_sequences=True))
model.add(Dropout(0.3))
model.add(TimeDistributedDense(3))
model.compile(loss='categorical_crossentropy',
          optimizer='sgd')
And the error is :
TypeError: ('An update must have the same type as the original shared variable (shared_var=<TensorType(float32, matrix)>, shared_var.type=TensorType(float32, matrix), update_val=Elemwise{sub,no_inplace}.0, update_val.type=TensorType(float64, matrix)).', 'If the difference is related to the broadcast pattern, you can call the tensor.unbroadcast(var, axis_to_unbroadcast[, ...]) function to remove broadcastable dimensions.')
Using Theano as backend, with the latest git version.
1