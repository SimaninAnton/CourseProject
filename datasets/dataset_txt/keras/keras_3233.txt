thingumajig commented on 12 Feb 2017
Hello,
I want to implement sequence labeling on LSTMs with residual connections.
But it is not clear how to make residual connection after last LSTM/GRU:
.....
x1 = LSTM(128, return_sequences=True)(prev)
x2 = LSTM(128, return_sequences=True)(x1)

shortcut = merge([x1,x2], mode="sum")
x3 = LSTM(128, return_sequences=True)(shortcut)

shortcut = merge([shortcut, x3], mode="sum")
last= LSTM(128, return_sequences=False)(shortcut)

# last merge before Dense layer: 
# next shortcut causing problem with shapes because return_sequences=false.
# Flatten? Reshape? Lamda? 
shortcut = merge([shortcut, last], mode="sum")


predictions = Dense(classes)(shortcut)
.....