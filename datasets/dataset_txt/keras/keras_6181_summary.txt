many-to-many mapping for variable length sequences with masking