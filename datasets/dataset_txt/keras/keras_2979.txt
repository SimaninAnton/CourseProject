Contributor
bstriner commented on 15 Mar 2017
It looks like the merge layers are not reporting correct output shapes, which shows up in the model summary.
Adding two (None,3) tensors should result in one (None,3) tensor, not two.
from keras.layers import Add
print Add().compute_output_shape(((None,3), (None,3)))
((None, 3), (None, 3))
Trivial fix if we restrict adding to tensors of the same shape. Non-trivial if we support broadcasting, so (None, 4, 1) + (None, 1, 5) = (None, 4, 5).
Cheers
Check that you are up-to-date with the master branch of Keras. You can update with:
pip install git+git://github.com/fchollet/keras.git --upgrade --no-deps
If running on TensorFlow, check that you are up-to-date with the latest version. The installation instructions can be found here.
If running on Theano, check that you are up-to-date with the master branch of Theano. You can update with:
pip install git+git://github.com/Theano/Theano.git --upgrade --no-deps
Provide a link to a GitHub Gist of a Python script that can reproduce your issue (or just copy the script here if it is short).