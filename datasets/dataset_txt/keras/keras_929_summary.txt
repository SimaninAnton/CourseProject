Custom loss function which can save model weights, support subprocess calls and numpy operations