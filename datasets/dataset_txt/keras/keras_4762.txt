Fheanor commented on 18 Jul 2016 â€¢
edited
Hello everyone,
I am not a good deeplearning user so I might say some confusing things but I hope you will understand my problem.
I need to do some process on 64*64 image I planned to use 2D convolution layers but I have trouble the 4D vector input.
My model looks like that :
    model = Sequential()


    model.add(Convolution2D(32, 3, 3, border_mode='same', input_shape=(1, 64, 64)))
# now model.output_shape == (None, 32, 64, 64)
    model.add(Activation('relu'))
    model.add(MaxPooling2D(pool_size=(2,2)))
# add a 3x3 convolution on top, with 32 output filters:
    model.add(Convolution2D(16, 3, 3, border_mode='same'))
# now model.output_shape == (None, 16, 64, 64)
    model.add(Convolution2D(8, 3, 3, border_mode='same'))
# now model.output_shape == (None, 8, 64, 64)

    model.add(Flatten())

#some dense layers...
First, I load my images as follow :
 `           #Loading image
            img = Image.open(file)
            img = np.array(img)

            #Gray scaling
            l = 64
            height = 0
            width = 0
            line = [[0 for xx in xrange(64)] for gg in xrange(64)]
            while height < l:
                while width < l:
                    line[height][width] =( 0.21*float(img[height][width][0]) + 0.72*float(img[height][width][1]) + 0.07*float(img[height][width][2]) )
                    width = width + 1
                    array = []
                height = height + 1
I would like to train my model with ~30k images. I want to call the fit function with 128 images.
But I saw that to use convolution 2D layers, you need to give a 4D dimension vector with samples and channels values. But I don't really know what values I should put into these variables. Could you explain me or suggest me what I should give for these values ?
Also, because I want to train my model every 128 images, I might give to the fit function a 5D vector that should looks something like that :
v = ['number of images = 128'][sample value for the i image][channel value for the i image][image height][image width]
Am I right ?
Anyway, thank you very much for your help