shashankg7 commented on 17 Jun 2016
I am trying to train a word2vec skipgram model. I have written the following model for the same:
    model1 = Sequential()
    model1.add(Embedding(90000, 100))
    #model1.add(Reshape(100,))

    model2 = Sequential()
    model2.add(Embedding(90000, 100))
    #model2.add(Reshape(100,))

    model = Sequential()
    model.add(Merge([model1, model2], mode='dot'))
    model.add(Activation('sigmoid'))
    model.compile(loss='binary_crossentropy', optimizer='adam')
    X = np.array(self.skg[0])
    y = np.array(self.skg[1])
    pdb.set_trace()
    Xc = X[:, 0]
    Xw = X[:, 1]
    Xc = map(lambda x:x[0], Xc)
    Xw = map(lambda x:x[0], Xw)
    model.fit([Xc, Xw], y, batch_size=32, nb_epoch=10, shuffle='batch')
Xc is list of indices for main word and Xw is list of indices for context word. When I run this model I am getting the following error :
File "preprocess.py", line 69, in word2vec
model.add(Merge([model1, model2], mode='dot'))
File "/usr/local/lib/python2.7/dist-packages/keras/engine/topology.py", line 1119, in init
self.add_inbound_node(layers, node_indices, tensor_indices)
File "/usr/local/lib/python2.7/dist-packages/keras/engine/topology.py", line 543, in add_inbound_node
Node.create_node(self, inbound_layers, node_indices, tensor_indices)
File "/usr/local/lib/python2.7/dist-packages/keras/engine/topology.py", line 155, in create_node
output_shapes = to_list(outbound_layer.get_output_shape_for(input_shapes))
File "/usr/local/lib/python2.7/dist-packages/keras/engine/topology.py", line 1308, in get_output_shape_for
tensordot_output = np.tensordot(np.zeros(tuple(shape1[1:])),
TypeError: an integer is required
Now I am not sure what this means.