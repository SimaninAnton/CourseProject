madhavsund commented on 26 Aug 2016
While running examples/image_ocr.py
I got following error....
Using Theano backend.
Using gpu device 0: GeForce GTX TITAN X (CNMeM is disabled, cuDNN not available)
Untaring file...
Layer (type) Output Shape Param # Connected to
the_input (InputLayer) (None, 1, 64, 512) 0
conv1 (Convolution2D) (None, 16, 64, 512) 160 the_input[0][0]
max1 (MaxPooling2D) (None, 16, 16, 128) 0 conv1[0][0]
conv2 (Convolution2D) (None, 16, 16, 128) 2320 max1[0][0]
max2 (MaxPooling2D) (None, 16, 8, 64) 0 conv2[0][0]
reshape (Reshape) (None, 128, 64) 0 max2[0][0]
permute (Permute) (None, 64, 128) 0 reshape[0][0]
timedistributed_1 (TimeDistribute(None, 64, 32) 4128 permute[0][0]
gru1 (GRU) (None, 64, 512) 837120 timedistributed_1[0][0]
gru1_b (GRU) (None, 64, 512) 837120 timedistributed_1[0][0]
merge_1 (Merge) (None, 64, 512) 0 gru1[0][0]
gru1_b[0][0]
gru2 (GRU) (None, 64, 512) 1574400 merge_1[0][0]
gru_1 (GRU) (None, 64, 512) 1574400 merge_1[0][0]
merge_2 (Merge) (None, 64, 1024) 0 gru2[0][0]
gru_1[0][0]
timedistributed_2 (TimeDistribute(None, 64, 28) 28700 merge_2[0][0]
softmax (Activation) (None, 64, 28) 0 timedistributed_2[0][0]
Total params: 4858348
Epoch 1/50
WARNING: probably bad CudaNdarray_set_dim arguments: self->ndim=3, idx=1 stride=-32
Traceback (most recent call last):
File "image_ocr.py", line 442, in
callbacks=[viz_cb, img_gen])
File "/usr/local/lib/python2.7/dist-packages/Keras-1.0.7-py2.7.egg/keras/engine/training.py", line 1441, in fit_generator
class_weight=class_weight)
File "/usr/local/lib/python2.7/dist-packages/Keras-1.0.7-py2.7.egg/keras/engine/training.py", line 1219, in train_on_batch
outputs = self.train_function(ins)
File "/usr/local/lib/python2.7/dist-packages/Keras-1.0.7-py2.7.egg/keras/backend/theano_backend.py", line 672, in call
return self.function(*inputs)
File "/usr/local/lib/python2.7/dist-packages/theano/compile/function_module.py", line 879, in call
storage_map=getattr(self.fn, 'storage_map', None))
File "/usr/local/lib/python2.7/dist-packages/theano/gof/link.py", line 325, in raise_with_op
reraise(exc_type, exc_value, exc_trace)
File "/usr/local/lib/python2.7/dist-packages/theano/compile/function_module.py", line 866, in call
self.fn() if output_subset is None else
AssertionError: Can't store in size_t for the bytes requested 512 * 4
Apply node that caused the error: GpuAllocEmpty(TensorConstant{65}, Elemwise{Composite{Switch(EQ(i0, i1), ((i2 * i0) // (i3 * i0)), i0)}}.0, TensorConstant{512})
Toposort index: 179
Inputs types: [TensorType(int64, scalar), TensorType(int64, scalar), TensorType(int64, scalar)]
Inputs shapes: [(), (), ()]
Inputs strides: [(), (), ()]
Inputs values: [array(65), array(-32), array(512)]
Outputs clients: [[GpuIncSubtensor{InplaceSet;:int64:}(GpuAllocEmpty.0, GpuFromHost.0, Constant{1})]]
Kindly help me.
Please make sure that the boxes below are checked before you submit your issue. Thank you!
[√ ] Check that you are up-to-date with the master branch of Keras. You can update with:
pip install git+git://github.com/fchollet/keras.git --upgrade --no-deps
[√] If running on Theano, check that you are up-to-date with the master branch of Theano. You can update with:
pip install git+git://github.com/Theano/Theano.git --upgrade --no-deps
Provide a link to a GitHub Gist of a Python script that can reproduce your issue (or just copy the script here if it is short).