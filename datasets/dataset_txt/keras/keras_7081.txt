Contributor
patyork commented on 31 Mar 2015
The SimpleRNN layer seem to require a tensor3 input of shape (batch_size, time_steps, features). However, Keras as a whole seems to expect only matrix inputs/outputs.
model = Sequential()
#model.add(Dense(20, 5, init='uniform', activation='tanh'))
model.add(SimpleRNN(5, 20, activation='sigmoid'))

sgd = SGD(lr=0.1, decay=1e-6, momentum=0.9, nesterov=True)
model.compile(loss='mse', optimizer='sgd')
/usr/local/lib/python2.7/dist-packages/keras/layers/recurrent.pyc in output(self, train)
     47         X = self.get_input(train) # shape: (nb_samples, time (padded with zeros at the end), input_dim)
     48         # new shape: (time, nb_samples, input_dim) -> because theano.scan iterates over main dimension
---> 49         X = X.dimshuffle((1,0,2))
     50 
     51         x = T.dot(X, self.W) + self.b

/usr/local/lib/python2.7/dist-packages/theano/tensor/var.pyc in dimshuffle(self, *pattern)
    332             pattern = pattern[0]
    333         op = theano.tensor.basic.DimShuffle(list(self.type.broadcastable),
--> 334                                             pattern)
    335         return op(self)
    336 

/usr/local/lib/python2.7/dist-packages/theano/tensor/elemwise.pyc in __init__(self, input_broadcastable, new_order, inplace)
    139                     raise ValueError(("new_order[%d] is %d, but the input "
    140                         "only has %d axes.") %
--> 141                         (i, j, len(input_broadcastable)))
    142                 if j in new_order[(i + 1):]:
    143                     raise ValueError((

ValueError: new_order[2] is 2, but the input only has 2 axes.```