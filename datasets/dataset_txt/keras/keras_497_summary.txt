error in adam when performing matrix multiplication with batch of matrices in loss function