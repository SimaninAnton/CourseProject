Contributor
mmmikael commented on 6 Feb 2016
Following the discussion in #1636, it looks like 'join' merge mode is broken.
The example below returns the error ValueError: merge_mode="join" only works with named inputs. while inputs are actually named.
Problematic example:
g = Graph()
g.add_input(name='input_a', input_shape=(in_dim,))
g.add_input(name='input_b', input_shape=(in_dim,))
g.add_node(Dense(128), name='input_a+', input='input_a')
g.add_node(Dense(128), name='input_b+', input='input_b')
g.add_node(Lambda(euclidean_distance),
           inputs=['input_a+', 'input_b+'],
           merge_mode='join',
           name='d')
g.add_output(name='output', input='d')
According to @farizrahman4u:
Join mode hasn't been updated since you changed the naming scheme. Join mode still looks for the tensor's name instead of the layer's name.