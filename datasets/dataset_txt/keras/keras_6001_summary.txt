Proper way of making a data generator which can handle multiple workers