jwarren1984 commented on 12 Nov 2016 â€¢
edited
It's not clear what min_delta is meant to do; should it be cumulative (i.e., the cumulative change in the monitor value over the past patience epochs not exceeding min_delta) or not (an individual change being less than min_delta)? In either case, it doesn't seem to work properly.
if self.monitor_op(current - self.min_delta, self.best):
            self.best = current
            self.wait = 0
As you can see, if current is simply staying around self.min_delta above self.best , then the conditional is satisfied and self.wait is reset to zero and the thing never stops. Also, it appears that self.best can be reset to current even if current is worse than self.best, as long as it's within self.min_delta of self.best. This is consistent with my experience, and I can't imagine that this is the intended behavior. If I am mistaken, I apologize for raising this issue.
I think it would make more sense to use some sort of relative tolerance over a window of epochs, such that if the percentage change in the metric over that window is less than some tolerance value the training stops. Thoughts?