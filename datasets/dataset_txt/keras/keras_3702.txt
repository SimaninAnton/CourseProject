tiagocalumbi commented on 12 Dec 2016
Hi, guys!
How do I can create a new metric in Keras?
I need to capture the values argmax of the y_true and y_predit, then, I have to compare some values inside of the interval capture.
I did without the variable Symbolic, but I have doubt when I use them. Can anyone help?
    interval = K.variable(50)
    k_true_max = K.argmax(th_true, axis=1)
    k_pred_max = K.argmax(th_pred, axis=1)

    label = th_true.eval()
    output = th_pred.eval()

    label = k_true_max.eval() #np.argmax(label, axis=1)
    output = k_pred_max.eval() #np.argmax(output, axis=1)

    sampleError = []

    print(label)
    print(output)
    for sampleIndex in range(len(label)):
        sampleLabel = label[sampleIndex]

        part_a = K.greater_equal(output[sampleIndex], sampleLabel - interval).eval() #a >= b
        part_b = K.lesser_equal(output[sampleIndex], sampleLabel + interval).eval()  #a <= b

        if(K.and_(part_a, part_b).eval()):
            sampleError.append(0)
        else:
            print(output[sampleIndex], sampleLabel)
            sampleError.append(1)

    print('result ', sampleError)
    print('mean ', np.mean(sampleError))
Please make sure that the boxes below are checked before you submit your issue. Thank you!
[ x] Check that you are up-to-date with the master branch of Keras. You can update with:
pip install git+git://github.com/fchollet/keras.git --upgrade --no-deps
[x ] If running on Theano, check that you are up-to-date with the master branch of Theano. You can update with:
pip install git+git://github.com/Theano/Theano.git --upgrade --no-deps
[x ] Provide a link to a GitHub Gist of a Python script that can reproduce your issue (or just copy the script here if it is short).