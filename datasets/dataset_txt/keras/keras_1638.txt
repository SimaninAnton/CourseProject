jiayi-wei commented on 26 Sep 2017 â€¢
edited
Hi! I have been struggling to address this problem, while I cannot really figure it out. I will appreciate any suggestion for my peculiar situation. Thank you very much! My network structure is as following:
conv1 = LeakyReLU(alpha=0.3)(conv2d(x, 48, 5, 1, 'linear', name+'conv1'))
pool1 = dropout(pool(conv1, 2, 2, name+'pool1'), 0.25)

conv2 = LeakyReLU(alpha=0.3)(conv2d(pool1, 64, 5, 1, 'linear', name+'conv2'))
pool2 = dropout(pool(conv2, 2, 1, name+'pool2'), 0.25)

conv3 = LeakyReLU(alpha=0.3)(conv2d(pool2, 128, 5, 1, 'linear', name+'conv3'))
pool3 = dropout(pool(conv3, 2, 2, name+'pool3'), 0.25)

conv4 = LeakyReLU(alpha=0.3)(conv2d(pool3, 160, 5, 1, 'linear', name+'conv4'))
pool4 = dropout(pool(conv4, 2, 1, name+'pool4'), 0.25)

conv5 = LeakyReLU(alpha=0.3)(conv2d(pool4, 192, 5, 1, 'linear', name+'conv5'))
pool5 = dropout(pool(conv5, 2, 2, name+'pool5'), 0.25) 

conv6 = LeakyReLU(alpha=0.3)(conv2d(pool5, 192, 5, 1, 'linear', name+'conv6'))
pool6 = dropout(pool(conv6, 2, 1, name+'pool6'), 0.25)

local_connect1 = dropout(local_connect(pool6, 192, 5, 1, 'relu', name+'local_connect1'), 0.25)

Flat = Flatten()(local_connect1)

dense1 = dropout(dense(Flat, 3072, 'relu', name+'dense1'), 0.25)
dense2 = dropout(dense(dense1, 3072, 'relu', name+'dense2'), 0.25)

dense3_1 = K.softmax(Reshape((65,))(dense(dense2, 65, 'relu', name+'dense3_1')))
dense3_2 = K.softmax(Reshape((65,))(dense(dense2, 65, 'relu', name+'dense3_2')))
dense3_3 = K.softmax(Reshape((65,))(dense(dense2, 65, 'relu', name+'dense3_3')))
dense3_4 = K.softmax(Reshape((65,))(dense(dense2, 65, 'relu', name+'dense3_4')))
dense3_5 = K.softmax(Reshape((65,))(dense(dense2, 65, 'relu', name+'dense3_5')))
dense3_6 = K.softmax(Reshape((65,))(dense(dense2, 65, 'relu', name+'dense3_6')))
dense3_7 = K.softmax(Reshape((65,))(dense(dense2, 65, 'relu', name+'dense3_7')))

dense3 = Concatenate(axis=1)([dense3_1, dense3_2, dense3_3, dense3_4, dense3_5, dense3_6,dense3_7]) 
return dense3
What is more, if i replace the last two lines with
return dense3_1, dense3_2, dense3_3, dense3_4, dense3_5, dense3_6, dense3_7
The problem wiil be like this :
TypeError: Output tensors to a Model must be Keras tensors. Found: Tensor("Softmax:0", shape=(?, 65), dtype=float32)
I know that if I use this mothed to build my multi-output model, I could make it. However, I really want to the wrong place in my above code. Thx for any help!
1