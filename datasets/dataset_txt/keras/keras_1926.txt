Contributor
achalshah20 commented on 14 Jul 2017 â€¢
edited
Hi All,
I am running following code for model checkpoint.
filepath="weights-improvement-{epoch:02d}-{val_SNR:.2f}.hdf5"
        modelCheck = ModelCheckpoint(self.args.logname +"/"+filepath, monitor='val_SNR', verbose=1,save_best_only=True, mode='max',save_weights_only=True)

    
        print("Starting training... It will take a while")
        model.fit(X_train,
                  Y_train,
                  epochs=self.args.epochs,
                  callbacks=[tensorboardCallback,modelCheck],
                  validation_data=(X_val,Y_val),
                  batch_size=self.args.batch_size)
And below code for loading weights
        model = self.create_model() # This will build my dnn model
        model.load_weights("One of the weight improvement files")
I am getting this error:
ValueError: You are trying to load a weight file containing 1 layers into a model with 19 layers.
So, modelcheckpoint only stores weight improvement? It doesn't save the actual weights of all the layers after each epoch?