JoaoLages commented on 28 Aug 2018 â€¢
edited
I am facing a really strange bug, using TF backend. I have the need to load multiple keras models in the same script, as this example:
model1 =  Model(...)
model1.compile(...)
model1.load_weights('model.h5', by_name=True)  # This works!!

model2 =  Model(...)
model2.compile(...)
model2.load_weights('model.h5', by_name=True)  # This DOES NOT work!!
So far I have only tested examples where model1 and model2 are exactly the same, but I think it should happen with different models. It should be correlated with how the computation graph is being initialized in the background, so that load_weights always tries to assign weights to the first model created in the script (perhaps??). I have tested that the weights of the second model do not changed by checking them before and after the function call.