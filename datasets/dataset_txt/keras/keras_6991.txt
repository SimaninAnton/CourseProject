gaoyuankidult commented on 29 May 2015
What is the reason to input self.U to non-sequence parameter of scan and then pass it to _step? Can we directly use self.U in _step function ? e.g. return self.activation(x_t + T.dot(h_tm1, self.U))
    def _step(self, x_t, h_tm1, u):
        '''
            Variable names follow the conventions from: 
            http://deeplearning.net/software/theano/library/scan.html
        '''
        return self.activation(x_t + T.dot(h_tm1, u))
      outputs, updates = theano.scan(
            self._step, # this will be called with arguments (sequences[i], outputs[i-1], non_sequences[i])
            sequences=x, # tensors to iterate over, inputs to _step
            # initialization of the output. Input to _step with default tap=-1.
            outputs_info=T.unbroadcast(alloc_zeros_matrix(X.shape[1], self.output_dim), 1),
            non_sequences=self.U, # static inputs to _step
            truncate_gradient=self.truncate_gradient
        )