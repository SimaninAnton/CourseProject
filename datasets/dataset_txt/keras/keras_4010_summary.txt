Writing a custom RNN layer