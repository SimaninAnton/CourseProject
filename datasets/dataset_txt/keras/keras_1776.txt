kjanjua26 commented on 9 Aug 2017 â€¢
edited
I am trying to give my own dataset to the image_ocr code.
I have created arrays: x and y. My image paths and their corresponding gt is in a csv file.
x is given the dimension of images as: [nb_samples, w, h, c]
y is given the labels which is a string, the gt.
Here is the code I am using to pre-process:
`for i in range(0,len(read_file)):
path = read_file['path'][i]
label = read_file['gt'][i]
path = path.strip('\n')
img = cv2.imread(path,0)
#Re-sizing the images
#height = 64, width = 128
#res_img = cv2.resize(img, (128,64))
#cv2.imwrite(i,res_img)
h,w = img.shape
x.append(img)
y.append(label)
size = img.size
"""
print "Height: ", h #Height
print "Width: ", w #Width
print "Channel: ", c #Channel
print "Size: ", size
print "\n"
"""
print "H: ", h
print "W: ", w
print "S: ", size
x = np.array(x).astype(np.float32)
y = np.array(y)
x_train, x_test, y_train, y_test = train_test_split(x,y,test_size=0.3,random_state=42)
x_train = np.array(x_train).astype(np.float32)
y_train = np.array(y_train)
x_train = np.array(x_train)
x_test = np.array(x_test)
y_test = np.array(y_test)
print "Printing the shapes. \n"
print "X_train shape: ", x_train.shape
print "Y_train shape: ", y_train.shape
print "X_test shape: ", x_test.shape
print "Y_test shape: ", y_test.shape
print "\n"`
It is followed by the keras image_ocr code. The total code is here: https://gist.github.com/kjanjua26/b46388bbde9ded5cf1f077a9f0dedc4f
The error when I run this is:
ValueError: The model expects 4 input arrays, but only received one array. Found: array with shape (7, 64, 128, 1)
P.S: Using tensorflow backend and python 2.7, running on Titan X. Everything is up to date.
Any help??