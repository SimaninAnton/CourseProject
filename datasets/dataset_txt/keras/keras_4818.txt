afuller187 commented on 8 Jul 2016
Hello,
I am attempting to train the exact network in the cifar10 example but with input image sizes of 299x299x3, instead of 32x32x3. I kept the original network the same as the example except for a few changes:
img_rows, img_cols = 299, 299
X_train shape: (10000L, 3L, 299L, 299L) #only used 10,000 because only 10,000 could fit on memory
I get an error when running model.fit that goes like this:
"RuntimeError: BaseGpuCorrMM: Failed to allocate output of 32 x 32 x 299 x 299
Apply node that caused the error: GpuCorrMM{half, (1, 1)}(GpuContiguous.0, GpuContiguous.0)
Toposort index: 61
Inputs types: [CudaNdarrayType(float32, 4D), CudaNdarrayType(float32, 4D)]
Inputs shapes: [(32, 3, 299, 299), (32, 3, 3, 3)]
Inputs strides: [(268203, 89401, 299, 1), (27, 9, 3, 1)]
Inputs values: ['not shown', 'not shown']
Outputs clients: [[GpuElemwise{Add}[(0, 0)](GpuCorrMM{half, %281, 1%29}.0, GpuReshape{4}.0)]]
HINT: Re-running with most Theano optimization disabled could give you a back-trace of when this node was created. This can be done with by setting the Theano flag 'optimizer=fast_compile'. If that does not work, Theano optimizations can be disabled with 'optimizer=None'.
HINT: Use the Theano flag 'exception_verbosity=high' for a debugprint and storage map footprint of this apply node."
As far as I can see, it seems like an issue with the dimensions I gave model.fit. However, I cannot see what else needs to be changed.
Thank you in advance for any help!
Cheers