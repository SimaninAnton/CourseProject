christopher5106 commented on 28 May 2019
Hi,
I'm saving a model to disk:
from keras.models import Sequential
from keras.layers import Dense
model = Sequential()
model.add(Dense(12, input_dim=8, activation='relu'))
model.add(Dense(8, activation='relu'))
model.add(Dense(1, activation='sigmoid'))
model.compile(loss='binary_crossentropy', optimizer='adam', metrics=['accuracy'])
model.save("model.h5")
print("Saved model to disk")
Then, removing one layer
import h5py
h = h5py.File("model.h5")
del h["model_weights/dense_2"]
h.close()
and re-importing by name:
from keras.models import Sequential
from keras.layers import Dense
model = Sequential()
model.add(Dense(12, input_dim=8, activation='relu'))
model.add(Dense(8, activation='relu'))
model.add(Dense(1, activation='sigmoid'))
model.compile(loss='binary_crossentropy', optimizer='adam', metrics=['accuracy'])
model.load_weights("model.h5", by_name=True)
gives me:
KeyError: "Unable to open object (object 'dense_2' doesn't exist)"
What is the reason for this ? The option by_name=True should accept that some layers are absent ?