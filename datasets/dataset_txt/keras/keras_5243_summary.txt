Something goes wrong when i use functional api