ghost commented on 29 Jan 2018
When we predict using keras model for single instance, I'm getting a wrong output. But when I do in batch i.e. (As a complete instances as a one array), I'm getting the right output.
Predicting Single Instance Code
from model import keras_model, params
import pickle
from keras.preprocessing.sequence import pad_sequences
from utils import data_utils

#Loading tokenizer from pickle
with open('build/tokenizer.pkl', 'rb') as handle:
    tokenizer = pickle.load(handle)


#Preprocessing new text instance
text_input = "author=Noah Baumbach featuring Ben Stiller, Adam Driver, Naomi Watts, Amanda Seyfried"

preprocessed_input = data_utils.preprocess_instance(text_input)

print(preprocessed_input)

sequence = tokenizer.texts_to_sequences(text_input)
predict_instance = pad_sequences(sequence,maxlen=params.max_length)

print(predict_instance)

#Loading saved keras model with compile
model = keras_model.load_model('build/cnn_model')

#Predicting the new instance
res = model.predict(predict_instance, verbose=1, steps=1)
print(res.argmax(axis=-1))
Output:
[2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
2 2 2 2 2 2 2 2 2 2 2]
Why this many predictions happen ? I'm expecting only one output, instead I got many ? How can we solve this ?