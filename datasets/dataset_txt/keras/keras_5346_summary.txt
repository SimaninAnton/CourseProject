Custom loss function leads to -inf loss