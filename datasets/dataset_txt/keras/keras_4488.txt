maxbry commented on 30 Aug 2016
I have two networks, one with embedding input, one with matrix input:
input_emb = Input(shape=(input_len,), dtype='int32', name='input_emb')
input_mat = Input(shape=(input_len, mat), dtype='int32', name='input_mat')

emb = Embedding(input_shape=(max_len,), input_dim=input_dim_emb, output_dim=embedding_size)(input_emb)
mat = TimeDistributed(Dense(embedding_size))(input_mat)

com = merge([emb, mat], mode='sum', output_shape=(max_len, embedding_size))

gru = GRU(gru_dim, ...)(emb) # really fast
gru = GRU(gru_dim, ...)(com) # really slow
If I used my combined data, the network is really really slow. If I just remove the merge part, the network is really really fast. Why does using merge make the network so slow?