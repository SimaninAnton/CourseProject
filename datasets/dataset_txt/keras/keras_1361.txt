bfmat commented on 1 Jan 2018 â€¢
edited
I am trying to create a neural network that includes an LSTM layer followed by two dense layers. I am creating the model like so:
model = Sequential()
model.add(LSTM(10, input_shape=(None, 2), return_sequences=False))
model.add(Dense(4, activation='tanh'))
model.add(Dense(1, activation='tanh'))
I am providing training data where X is of shape (1, 229, 2) and Y is of shape (1, 229). This means (as far as I understand) that the training data is in a single batch, containing a sequence of length 229 time steps. For each time step, the input is a two-element array, and the output is a single number.
Unfortunately, this produces the error: expected dense_2 to have shape (None, 1) but got array with shape (1, 229). This seems like the LSTM layer is returning the outputs for all of its time steps, but this is specifically not the case because return_sequences is False! And if I change it to True, I get a different error: expected dense_2 to have 3 dimensions, but got array with shape (1, 229).
Does anybody know what I'm doing wrong? I'm not entirely sure the input_shape of (None, 2) is correct.