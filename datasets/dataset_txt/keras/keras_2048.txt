kesinger commented on 29 Jun 2017
This is ultimately a 'doctor it hurts when I do this problem', but I'm running into an error in to_json when there are multiple model inputs and one of the inputs is not used in the outputs.
Here's an example:
class MinRep(object):
    def __init__(self,a,b):
        self.a = a
        self.b = b
        self.build()
    def build(self):
        self.c = Lambda(lambda x: x[:, :, :, :1])(self.a)
        self.d = Add()([self.b, self.c])
        self.model = Model(inputs=[self.a, self.b], outputs=self.c)
a = Input(shape=(256,512,6,))
b = Input(shape=(256,512,1,))
fs = MinRep(a,b)
open("fns.json","w").write(fs.model.to_json())
I get this error:
Traceback (most recent call last):
  File "./anotherrepro.py", line 24, in <module>
    open("fns.json","w").write(fs.model.to_json())
  File "/Users/jake/ten1.2/lib/python3.6/site-packages/keras/engine/topology.py", line 2618, in to_json
    model_config = self._updated_config()
  File "/Users/jake/ten1.2/lib/python3.6/site-packages/keras/engine/topology.py", line 2585, in _updated_config
    config = self.get_config()
  File "/Users/jake/ten1.2/lib/python3.6/site-packages/keras/engine/topology.py", line 2370, in get_config
    new_node_index = node_conversion_map[node_key]
KeyError: 'input_2_ib-0'
If I change the output to self.d (so that the output depends on both input parameters), it works fine.