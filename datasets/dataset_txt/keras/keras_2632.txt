Contributor
AndreiCostinescu commented on 17 Apr 2017
Hi,
when using a model which in the summary output should display the "Connected to" column, I don't get any output there.
I am using keras 2.0.3 with the tensorflow backend.
The issue seems to be in utils/layer_utils.py in the print_layer_summary_with_connections internal function of the print_summary function. The condition "if node_key not in relevant_nodes" is never true, because node_key is a string and relevant nodes is a list containing keras.engine.topology.Node, not strings...
When removing the condition, the summary displays the content of the "Connected to" column.
Does anybody else have this issue? Is it only a tensorflow issue, meaning that with the theano backend it doesn't occur?
A small script for replicating the problem:
import keras
from keras.layers import Input
from keras.layers.core import Activation
from keras.layers.convolutional import Convolution2D, MaxPooling2D, ZeroPadding2D
from keras.layers.merge import Concatenate
from keras.layers.normalization import BatchNormalization
from keras.models import Model

if __name__=="__main__":
    input1 = Input(shape=(112, 224, 3), name="input1")
    input2 = Input(shape=(112, 224, 3), name="input2")
    x = Concatenate(axis=1, input_shape=[(112, 224, 3), (112, 224, 3)])([input1, input2])
    x = ZeroPadding2D(padding=(2, 2), input_shape=(224, 224, 3))(x)
    x = Convolution2D(filters=96, kernel_size=(11, 11), strides=(4, 4), name="conv1")(x)
    x = BatchNormalization()(x)
    x = Activation("relu")(x)
    output = MaxPooling2D(pool_size=(3, 3), strides=(2, 2), name="pool1")(x)
    
    model = Model([input1, input2], output)
    model.compile(optimizer=keras.optimizers.SGD(), loss=keras.losses.categorical_crossentropy)
    model.summary()
I will try to fix this issue. Please let me know if this issue also occurs for others..
1