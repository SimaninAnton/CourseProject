Matrix multiplication for trainable weights