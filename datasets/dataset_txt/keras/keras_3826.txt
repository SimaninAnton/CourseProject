xypan1232 commented on 27 Nov 2016 â€¢
edited
model = Sequential()
model.add(Merge([cnn_model1, cnn_model2], mode='concat', concat_axis=-1))
model.add(LSTM(nbfilter*2, return_sequences=False))
model.add(Dense(nbfilter*2, activation='relu'))
It gives the following errors:
File "deepstr.py", line 695, in get_cnn_network
#model.add(LSTM(nbfilter*2, return_sequences=False))
File "/usr/local/lib/python2.7/dist-packages/Keras-1.0.4-py2.7.egg/keras/models.py", line 145, in add
output_tensor = layer(self.outputs[0])
File "/usr/local/lib/python2.7/dist-packages/Keras-1.0.4-py2.7.egg/keras/engine/topology.py", line 441, in call
self.assert_input_compatibility(x)
File "/usr/local/lib/python2.7/dist-packages/Keras-1.0.4-py2.7.egg/keras/engine/topology.py", line 382, in assert_input_compatibility
str(K.ndim(x)))
Exception: Input 0 is incompatible with layer lstm_1: expected ndim=3, found ndim=2
Can anyone give some suggestions on it? Thanks
Please make sure that the boxes below are checked before you submit your issue. Thank you!
Check that you are up-to-date with the master branch of Keras. You can update with:
pip install git+git://github.com/fchollet/keras.git --upgrade --no-deps
If running on Theano, check that you are up-to-date with the master branch of Theano. You can update with:
pip install git+git://github.com/Theano/Theano.git --upgrade --no-deps
Provide a link to a GitHub Gist of a Python script that can reproduce your issue (or just copy the script here if it is short).