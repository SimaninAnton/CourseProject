Slow training due to 'on_batch_end()' and 'TimeDistributedDense()'