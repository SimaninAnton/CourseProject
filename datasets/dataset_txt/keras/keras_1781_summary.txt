Encounter "ValueError: None values not supported" when using custom loss function