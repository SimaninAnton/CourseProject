resplendentfrever commented on 4 Mar 2016
Hello,
I am trying to merge the output of two LSTM and then predict the polarity of a word in the sentence.
So my X-train has dimension (No of sentences,maxlen,word_embedding_dim) and Y_Train has dimension(No of sentences,no of classes).
here is my code:
left = Sequential()
left.add(LSTM(output_dim=600, input_shape=(80,600),return_sequences=True))
left.add(TimeDistributedDense(600))
right = Sequential()
right.add(LSTM(output_dim=600, input_shape=(80,600),return_sequences=True))
right.add(TimeDistributedDense(600))
model = Sequential()
model.add(Merge([left, right],mode='sum'))
model.add(TimeDistributedDense(4))
model.add(Activation('softmax'))
model.compile(loss='categorical_crossentropy',optimizer='rmsprop')
model.fit([X_left, X_right], Y_train, nb_epoch=100,validation_split=0.2,show_accuracy=True)
~
But i am getting this issue:
TypeError: ('Bad input argument to theano function with name "/usr/local/lib/python2.7/dist-packages/keras/backend/theano_backend.py:380" at index 2(0-based)', 'Wrong number of dimensions: expected 3, got 2 with shape (128, 4).')
Please help me out