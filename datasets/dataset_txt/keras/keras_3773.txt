mhubrich commented on 4 Dec 2016 â€¢
edited
Hello,
In my opinion, the metrics fmeasure, matthews_correlation, precision and recall all don't work batchwise. In general, this is the case for all metrics which incorporate true/false positives/negatives.
Here is a small and easy counterexample:
Let's assume we have just 4 samples: two negatives and two positives. Also, our batch size is 2:
Batch Label Prediction
1 0 0
1 0 1
2 1 0
2 1 1
Now we want to calculate the recall aka. TP-rate in batchwise manner. For the first batch, we have a TP-rate of 0 (since we don't have any true positives). For the second batch, we have a TP-rate of 0.5. Finally, we take the mean over all batches and end with recall=TP-rate=mean(0 + 0.5) = 0.25.
But: as we easily can see the correct recall over the entire dataset is 0.5. The problem with the batchwise calculation is that we wrongly incorporated the first batch.