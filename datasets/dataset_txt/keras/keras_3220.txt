sun-peach commented on 13 Feb 2017 â€¢
edited
Hi, dear all,
I am using keras 1.1.0 (I have to use this one because one key library only works with this version). I have two sub-networks taking two streams of input. These two inputs are synchronized and padded zeros. I use masking layer for each sub-network. On top of these two networks, I use merge. However, it seems that the merge does not support masking data.
The code is like this:
    x1,branch1,O1 = arch_to_model(E1_arch,dropout,arch_default,in_dict=I1_shape)
    ## branch 2
    x2,branch2,O2 = arch_to_model(E2_arch,dropout,arch_default,in_dict=I2_shape)
    ## combine and classification
    ### combine
    branches = merge([O1,O2],mode='concat', concat_axis=-1)
    ### classifier
    E1_dim = E1_arch[E1_depth]["num"]
    E2_dim = E2_arch[E2_depth]["num"]
    C_shape = {"feature_dim":E1_dim+E2_dim,"timestep_len":I1_shape["timestep_len"]}
    _,classifier,_ = arch_to_model(C_arch,dropout,arch_default,in_dict=C_shape,masking=None)
    classification = classifier(branches)
The "arch_to_model" is a defined function to convert the input dictionary (contain the architecture information, like layer number, activation function name and so on.) to desired models
It shows error at the last line like this:
Exception: Layer input_3 does not support masking, but was passed an input_mask: All{2}.0
Could anyone tell me how can I fix this problem? Thank you very much!