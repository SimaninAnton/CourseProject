ghost commented on 18 Sep 2016
Please make sure that the boxes below are checked before you submit your issue. Thank you!
Check that you are up-to-date with the master branch of Keras. You can update with:
pip install git+git://github.com/fchollet/keras.git --upgrade --no-deps
If running on Theano, check that you are up-to-date with the master branch of Theano. You can update with:
pip install git+git://github.com/Theano/Theano.git --upgrade --no-deps
Provide a link to a GitHub Gist of a Python script that can reproduce your issue (or just copy the script here if it is short).
The example in https://keras.io/getting-started/faq/#how-can-i-freeze-keras-layers does not work.
The example fails with both TF and theano.
Both models will do whatever you put in the second layer.trainable line.
Code to try:
from keras.layers import Input, Dense, Dropout, Activation, Flatten
from keras.layers import Convolution2D, MaxPooling2D, MaxPooling2D
from keras.layers import Reshape, Deconvolution2D
from keras.models import Model
import numpy as np

x = Input(shape=(32,))
layer = Dense(32)
layer.trainable = False
y = layer(x)
frozen_model = Model(x, y)
frozen_model.compile(optimizer='rmsprop', loss='mse')
#**** both models do whatever you put in the next line
layer.trainable = True
trainable_model = Model(x, y)
trainable_model.compile(optimizer='rmsprop', loss='mse')

data = labels = np.vstack((np.zeros((500,32)), np.ones((500,32))))
print layer.get_weights()[0][0]
frozen_model.fit(data, labels)
print layer.get_weights()[0][0]
trainable_model.fit(data, labels)
print layer.get_weights()[0][0]