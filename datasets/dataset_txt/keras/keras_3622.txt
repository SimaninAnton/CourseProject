Sunnydreamrain commented on 22 Dec 2016 â€¢
edited
Hi all,
It is really weird. I can run the mnist_hierarchical_rnn.py for the first few times. But after a while I ran it again, it produces an error. I tried it on another machine. The same thing happens. (I am using the theano backend)
I thought it might be an error related to input shape. So I skip the usage of timedistributed wrapper and used backend (theano) to reshape the input. But the error exists.
It is really weird that I can run the program at first.
Here is the error,
File "mnist_hierarchical_rnn.py", line 68, in
encoded_rows = TimeDistributed(LSTM(output_dim=row_hidden,input_length=col))(x)
File "/usr/local/lib/python2.7/dist-packages/keras/engine/topology.py", line 569, in call
self.add_inbound_node(inbound_layers, node_indices, tensor_indices)
File "/usr/local/lib/python2.7/dist-packages/keras/engine/topology.py", line 632, in add_inbound_node
Node.create_node(self, inbound_layers, node_indices, tensor_indices)
File "/usr/local/lib/python2.7/dist-packages/keras/engine/topology.py", line 164, in create_node
output_tensors = to_list(outbound_layer.call(input_tensors[0], mask=input_masks[0]))
File "/usr/local/lib/python2.7/dist-packages/keras/layers/wrappers.py", line 129, in call
y = self.layer.call(X) # (nb_samples * timesteps, ...)
File "/usr/local/lib/python2.7/dist-packages/keras/layers/recurrent.py", line 201, in call
input_shape = K.int_shape(x)
File "/usr/local/lib/python2.7/dist-packages/keras/backend/theano_backend.py", line 128, in int_shape
raise Exception('Not a Keras tensor:', x)
Exception: ('Not a Keras tensor:', Reshape{3}.0)
Any advice?
Thanks.