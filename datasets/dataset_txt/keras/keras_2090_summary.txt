Functional API does not support dynamic RNN input state, while Sequential does