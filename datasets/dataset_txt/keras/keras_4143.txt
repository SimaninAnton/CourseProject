Tristacheng commented on 17 Oct 2016 â€¢
edited
Hi, there!
`
#creat cnn model
model = Sequential()
model.add(Convolution3D(nb_filters[0], kernel_size[0], kernel_size[1],kernel_size[2],W_regularizer = l2(0.005),
                        activation = act_function , input_shape=input_shape))                  
model.add(MaxPooling3D(pool_size=pool_size)) 

model.add(Convolution3D(nb_filters[1], kernel_size[0], kernel_size[1], kernel_size[2],W_regularizer = l2(0.005),
                           activation = act_function))
model.add(MaxPooling3D(pool_size=pool_size))


model.add(Convolution3D(nb_filters[2], kernel_size[0], kernel_size[1], kernel_size[2],W_regularizer = l2(0.005),
                            activation = act_function))                    
model.add(MaxPooling3D(pool_size=pool_size))    


model.add(Convolution3D(nb_filters[3], kernel_size[0], kernel_size[1], kernel_size[2],W_regularizer = l2(0.005),
                        activation = act_function))
model.add(Flatten())


model.add(Dense(full_connect, W_regularizer = wr, b_regularizer = l2(0.05),activation = act_function))   
model.add(Dense(nb_classes,activation = act_function))
model.add(Activation('softmax'))
`
The model works fine, but when I try to get the output of full-connect layer like below, it comes out the error, my GPU is GTX1080 8G, please help me to solve it, I don't know why it happen.
`
## define theano funtion to get output of FC layer
    get_feature = K.function([model.layers[0].input,K.learning_phase()],[model.layers[9].output])

    FC_train_feature = get_feature([X_train,1])[0]

    FC_test_feature = get_feature([X_test,0])[0]
`