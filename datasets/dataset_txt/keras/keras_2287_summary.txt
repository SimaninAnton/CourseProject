batch training but online prediction