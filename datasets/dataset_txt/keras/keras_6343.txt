Contributor
ekerazha commented on 3 Dec 2015
After the fix for issue #1125 and #1130, I'm still trying to use a stateful RNN. This is my code
in_out_neurons = 1
hidden_neurons = 10
batch_size = 10

model = Sequential()
model.add(GRU(hidden_neurons, batch_input_shape=(batch_size, 5, in_out_neurons), return_sequences=True, stateful=True))
model.add(Dropout(0.2))
model.add(TimeDistributedDense(in_out_neurons))
model.add(Activation("linear"))
model.compile(loss="mean_squared_error", optimizer="rmsprop")
and I get this error on compile
ValueError: setting an array element with a sequence.
This is the traceback
model.compile(loss="mean_squared_error", optimizer="rmsprop")

models.py", line 372, in compile
self.y_train = self.get_output(train=True)

containers.py", line 73, in get_output
return self.layers[-1].get_output(train)

core.py", line 517, in get_output
X = self.get_input(train)

core.py", line 107, in get_input
return self.previous.get_output(train=train)

core.py", line 797, in get_output
X = self.get_input(train)

core.py", line 107, in get_input
return self.previous.get_output(train=train)

core.py", line 493, in get_output
X = self.get_input(train)

core.py", line 107, in get_input
return self.previous.get_output(train=train)

recurrent.py", line 79, in get_output
K.set_value(self.states[i], states[i])

theano_backend.py", line 345, in set_value
x.set_value(np.asarray(value, dtype=x.dtype))

numeric.py", line 474, in asarray
return array(a, dtype, copy=False, order=order)
Thanks