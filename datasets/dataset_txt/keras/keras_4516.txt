lomizandtyd commented on 26 Aug 2016 â€¢
edited
My target is to reproduce the result in " LSTM Char CNN" Network.. For language modeling
It has four stacked layers.
l1 : Char Embedding 
l2 : Convolution 1D
l3 : Lambda
l4 : Highway
l5 : LSTM
l6 : classifier (optional)
My inputs is a word sequence.
Each word is represented by a character sequence.
So the input shape is :
(nb_sentence, nb_words, words_ids)
After l1;
(nb_sentence, nb_words, nb_chars, char_ids)
After l2 and l3:
(use cnn to extract the features from chars in a word)
(nb_sentence, nb_words, words_features)
l4 ~ : hyper nn for hyper features..
And I build the network in keras by :
model = Sequential()

# l1
model.add(TimeDistributed(Embedding(max_char_id, char_embedding_feature, input_length=nb_chars), input_shape=(nb_words, nb_chars)))

# l2 and l3, use "max" to get the features across chars' axis
model.add(TimeDistributed(Convolution1D(128, 3, border_mode='valid')))
model.add(Lambda(lambda x: K.max(x, axis=-2)))

# l4, highway 
model.add(TimeDistributed(Highway()))

# l5, LSTM
model.add(LSTM(128, return_sequences=True))

# l6, classifier
model.add(TimeDistributed(Dense(max_word_id)))
model.add(Activation('softmax'))
The problem is :
l3 raised a error:
Exception: Input 0 is incompatible with layer timedistributed_12: expected ndim=4, found ndim=3
I don't know how to figure out the problem...
Thank you all guys. Sorry for early post issue...