Reitmania commented on 14 Jun 2017 â€¢
edited
Dear all, I've been struggling with setting up a multi-input to one output LSTM in KERAS.
`
KPIA_input = Input(shape=(len(datasetX_new),3), dtype='int32', name='KPIA_input')
x = Embedding(output_dim=512, input_dim=10000, input_length=len(datasetX_new))(KPIA_input)
KPIB_input = Input(shape=(len(dataset2X_new),3), dtype='int32', name='KPIB_input')
x2 = Embedding(output_dim=512, input_dim=10000, input_length=len(dataset2X_new))(KPIB_input)
    
merged_KPI = keras.layers.concatenate([x, x2]) 
    
lstm_out = LSTM(32, input_shape=(10000,3), return_sequences=True)(merged_KPI)

x = Dense(64, activation='relu')(lstm_out)
x = Dense(64, activation='relu')(x)

main_output = Dense(1, activation='sigmoid', name='main_output')(x)

model = Model(inputs=[KPIA_input, KPIB_input], outputs=[main_output])

model.compile(optimizer='rmsprop', loss='binary_crossentropy',
          loss_weights=[1., 0.2])
`
Whatever I do, I receive "ValueError: Input 0 is incompatible with layer lstm_1: expected ndim=3, found ndim=4" for:
lstm_out = LSTM(32, input_shape=(10000,3), return_sequences=True)(merged_KPI)
where is my mistake? The two datasets comprise ~12000 datarows for a window of 3.