Imorton-zd commented on 8 Apr 2016
def train_merge_model(train_q,train_a):

    print('Build model...')
    model0 = Sequential()
    model0.add(LSTM(lstm_output_dims,input_shape=(maxlen,embedding_dims)))
    model0.add(Dropout(0.5))

    model1 = Sequential()
    model1.add(LSTM(lstm_output_dims,input_shape=(maxlen,embedding_dims)))
    model1.add(Dropout(0.5))

    modelmerge = Sequential()
    modelmerge.add(Merge([model0, model1], mode='sum'))
    modelmerge.add(Dropout(0.5))

    modelmerge.add(Dense(1))
    modelmerge.add(Activation('sigmoid')) 
    modelmerge.compile(loss='mse', optimizer='rmsprop')

    hist = modelmerge.fit([train_q,train_a], label, batch_size=batch_size, nb_epoch=10, verbose=1, show_accuracy=True)
    print (hist.history)
I want to get the the output of lstm layer in model0. I know how to get the internal output in the simple model without merging, like:
get_feature = theano.function([modelmerge.layers[0].input],modelmerge.layers[0].get_output(train=False),
                              allow_input_downcast=False)
feature = get_feature(trains)
However, the inputs of my merging model have two styles of input. Please give me some suggestions!