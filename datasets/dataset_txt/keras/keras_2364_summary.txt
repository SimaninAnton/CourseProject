How to implement a custom Keras loss function, which uses an external routine