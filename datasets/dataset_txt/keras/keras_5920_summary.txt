minibatch handling could be more efficient if dataset was stored as shared variable?