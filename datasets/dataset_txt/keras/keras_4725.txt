ghost commented on 25 Jul 2016
Hi,
I'm trying to create a model, containing stack convolutions and LSTM cells. To do this, I should distribute the CNN layers over time, and then add the LSTM cell. A small version of this could be like this:
`NN_model = Sequential()
CNN_model.add(ZeroPadding2D((1,1),input_shape=(3,100,100)))
CNN_model.add(Convolution2D(32, 3, 3, activation='relu'))
CNN_model.add(MaxPooling2D((2,2), strides=(2,2)))
CNN_model.add(Flatten())
CNN_model.add(Dense(256, activation='relu'))
TD_input = Input(shape=(INPUT_LEN,3,100,100))
TD_LAYERS = []
ly_temp = TimeDistributed(CNN_model.layers[1])(TD_input)
list.insert(TD_LAYERS,0, ly_temp)
for ly in range(1,5):
ly_temp = TimeDistributed(CNN_model.layers[ly])(TD_LAYERS[ly-1])
list.insert(TD_LAYERS,ly, ly_temp)
Layer1_LSTM1 = LSTM(128,return_sequences=False)(TD_LAYERS[4])
Layer1_DO1 = Dropout(0.5)(Layer1_LSTM1)
Layer1_Dense1 = Dense(OUTPUT_LEN)(Layer1_DO1)
Layer1_Activation = Activation('softmax', name='output1')(Layer1_Dense1)
TD_model = Model(input = TD_input, output = Layer1_Activation)
`
When I want to train this model, I get this error:
this shared variable already has an update expression', (convolution2d_1_W, GpuFromHost.0)
Any idea why I see this error?
Thanks,
Sadegh