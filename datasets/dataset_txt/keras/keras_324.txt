Jamesswiz commented on 20 Mar 2019 â€¢
edited
I want to add orthogonal regularisation on output activation (Y) of a dense layer.
i.e., min || Y'Y - I ||_F
def regOrth(Y):
     m = K.batch_dot(K.transpose(Y), Y) - K.eye(Y.shape[2])
     return K.sqrt(K.sum(K.square(K.abs(m)))
The output has shape (batch_size, W, H), and I want each (WxH) matrix to have orthogonal columns.
I can't use K.transpose due to batch size as first dim. Is there a backend function similar to K.batch_dot.
How can I achieve this?