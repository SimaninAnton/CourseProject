Contributor
ahundt commented on 12 Feb 2017
There isn't much documentation on how to run a keras model with image tensors loaded from a TFRecord, there is the keras as a simplified interface to tensorflow blog post, but it loads up all the images as a numpy array.
Since I already have TFRecords loaded from a function read_tfrecord_and_decode_into_image_annotation_pair_tensors() and tensors storing my images I don't think I need to go back to a feed dict. However, when I try to call sess.run, Keras expects a numpy array feed_dict for the keras.model.layers.Input() as I encountered in this error.
How do I use keras models with a keras.layers.Input() node, input tensor images, TFRecords, and queue runners together?
some of the key code lines:
        coord = tf.train.Coordinator()
        threads = tf.train.start_queue_runners(sess=sess,coord=coord)
        
        print('starting training...')

        # 10 epochs
        for i in xrange(11127 * number_of_epochs):
        
            cross_entropy, summary_string, _ = sess.run([ cross_entropy_sum,
                                                        merged_summary_op,
                                                        train_step ],
                                                        feed_dict={K.learning_phase(): 1})
            
            print("Current loss: " + str(cross_entropy))
            
            summary_string_writer.add_summary(summary_string, i)
            
            if i % 11127 == 0:
                save_path = saver.save(sess, FLAGS.save_dir + "model_fcn8s_epoch_" + str(i) + ".ckpt")
                print("Model saved in file: %s" % save_path)
I will update with more details once tf is reinstalled, though I don't think the error is key to these questions as it is primarily about Keras + TF integration.
10