wouterbulten commented on 17 May 2018
When using sample weights its important to use weighted_metrics instead of metrics to get the correct accuracy. However, the current implementation of load/save_model does not take these metrics in to account.
Current implementations:
save_model only saves metrics, see https://github.com/keras-team/keras/blob/master/keras/engine/saving.py#L144
load_model only sets metrics, see https://github.com/keras-team/keras/blob/master/keras/engine/saving.py#L286
This problem only occurs after a loading a model and then trying to continue training (or using one of the weighted metrics). Ideally, the weighted metrics should also be saved and subsequently loaded.
2