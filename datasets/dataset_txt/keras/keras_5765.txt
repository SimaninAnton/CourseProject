XuesongYang commented on 14 Mar 2016
Hi guys,
I am trying to add BatchNormalization layer on top of the lstm layer. However I am always get the error as follows:
Build graph of the model...
Traceback (most recent call last):
File "trans_bilstm_asr.py", line 124, in
model.add_node(BatchNormalization(), name='batch_norm_forward', input='embedding')
File "keras/layers/containers.py", line 440, in add_node
layer.set_previous(self.nodes[input])
File "keras/layers/core.py", line 144, in set_previous
assert self.supports_masked_input(), 'Cannot connect non-masking layer to layer with masked output.'
AssertionError: Cannot connect non-masking layer to layer with masked output.
the snippet of my code
model.add_node(LSTM(output_dim=256), name='forward', input='embedding') model.add_node(BatchNormalization(), name='batch_norm_forward', input='embedding')
Thanks.
Please make sure that the boxes below are checked before you submit your issue. Thank you!
Check that you are up-to-date with the master branch of Keras. You can update with:
pip install git+git://github.com/fchollet/keras.git --upgrade --no-deps
If running on Theano, check that you are up-to-date with the master branch of Theano. You can update with:
pip install git+git://github.com/Theano/Theano.git --upgrade --no-deps
Provide a link to a GitHub Gist of a Python script that can reproduce your issue (or just copy the script here if it is short).