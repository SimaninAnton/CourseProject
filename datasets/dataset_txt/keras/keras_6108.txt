pyben commented on 17 Jan 2016
Hi. I'm implementing an SDA, this is base on this pull request. I tweak it a little bit to become an SDA.
But I got this error when I fine tune the model.
Traceback (most recent call last):
  File "imdb_sda.py", line 66, in <module>
    model.compile(loss='categorical_crossentropy', optimizer='rmsprop')
  File "/home/vagrant/.virtualenvs/spam/lib/python3.4/site-packages/keras/models.py", line 465, in compile
    train_loss)
  File "/home/vagrant/.virtualenvs/spam/lib/python3.4/site-packages/keras/optimizers.py", line 125, in get_updates
    grads = self.get_gradients(loss, params)
  File "/home/vagrant/.virtualenvs/spam/lib/python3.4/site-packages/keras/optimizers.py", line 47, in get_gradients
    grads = K.gradients(loss, params)
  File "/home/vagrant/.virtualenvs/spam/lib/python3.4/site-packages/keras/backend/theano_backend.py", line 398, in gradients
    return T.grad(loss, variables)
  File "/home/vagrant/.virtualenvs/spam/lib/python3.4/site-packages/theano/gradient.py", line 545, in grad
    handle_disconnected(elem)
  File "/home/vagrant/.virtualenvs/spam/lib/python3.4/site-packages/theano/gradient.py", line 532, in handle_disconnected
    raise DisconnectedInputError(message)
theano.gradient.DisconnectedInputError: grad method was asked to compute the gradient with respect to a variable that is not part of the computational graph of the cost, or is used only by a non-differentiable operator: <TensorType(float32, matrix)>
Backtrace when the node is created:
  File "/home/vagrant/.virtualenvs/spam/lib/python3.4/site-packages/keras/backend/theano_backend.py", line 34, in variable
    return theano.shared(value=value, name=name, strict=False)
As of now I got the latest version of Keras and Theano from the repository.
Here's the code. Thanks.