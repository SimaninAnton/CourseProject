juliohm commented on 18 Nov 2017
Although I have used Keras in the past, I always find myself struggling to understand the underlying (not necessarily documented) conventions in Keras layers. I decided to open this issue to ask basic questions about dimensions of input and output as I think they can be useful to other users of the package.
For the sake of clarity, consider the simplest scenario possible where we have a time series. The input to the neural net is a vector of size T representing a set of consecutive times. The output of the net is another vector of size P representing the predicted series with P steps ahead in the future.
A simple sequential model with fully connected layers is as follows:
model = Sequential([
    Dense(100, input_shape=(T,)),
    Dense(50),
    Dense(P, activation='linear')
])
If we fit this model with
X - Python list of Python lists x where each x in X is of size T
Y - Python list of Python lists y where each y in Y is of size P
Everything works as expected. Now we define a convolutional model as follows:
model = Sequential([
    Conv1D(100, kernel_size=10, input_shape=(T,)),
    Conv1D(50, kernel_size=20),
    Dense(P, activation='linear')
])
The fit method complains saying that
Input 0 is incompatible with layer conv1d_...: expected ndim=3, found ndim=2
If someone could give the ultimate answer explaining all the conventions that go into Keras layers dimensions, that would be super helpful to me and to other future users. Even better would be having a simple table documenting what are the expected dimensions and the meaning for each of these dimensions.
Another related issue I often have with using Keras is the fact that some methods expect Numpy arrays whereas others expect Python lists. From a user perspective, it is quite frustrating to get errors messages down deep in the Keras codebase about incorrect dimensions. Is there any documentation explaining what can and can't be passed as a design matrix?
I am sorry having to open an issue for this, but I think it is something that needs to be addressed much more seriously than what the current documentation provides. It definitely affects my productivity, and likely affects the productivity of many other users.
Thank you for the package, I really appreciate your work.
16
1