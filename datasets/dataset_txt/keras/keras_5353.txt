stevenhanjun commented on 25 Apr 2016 â€¢
edited
Here is my code
model = Sequential()
model.add(Convolution2D(32,5,5, border_mode='valid', input_shape=(1, 28, 28)))
model.add(Activation('relu'))
model.add(MaxPooling2D(pool_size=(2,2)))
model.add(Convolution2D(32,5,5))
model.add(Activation('relu'))
model.add(MaxPooling2D(pool_size=(2,2)))
model.add(Flatten())
model.add(Dense(256))
model.add(Activation('relu'))
model.add(Dropout(0.5))
model.add(Dense(11))
model.add(Activation('softmax'))
sgd = SGD(lr=0.1, decay=1e-6, momentum=0.9, nesterov=True)
model.compile(loss='categorical_crossentropy',optimizer=sgd)
model.fit(X_train, y_train,nb_epoch=2)
I want to get the output of the dense layer with 256 units, how I should modify the code.
I have tried these code
model_part=Model(input=[model.layers[0]], output=[model.layers[8]])
model_part.compile(loss='categorical_crossentropy',optimizer=sgd)
model_part.fit(X_train, y_train,nb_epoch=2)
but it returns an error.
Traceback (most recent call last):
File "/Users/hanjun/Desktop/Code/deep.py", line 60, in
model_part=Model(input=[model.layers[0]], output=[model.layers[8]])
TypeError: object() takes no parameters