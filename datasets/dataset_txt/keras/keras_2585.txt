codeheadshopon commented on 21 Apr 2017 â€¢
edited
I implemented a siamese network for question similarity prediction. Here is my code
def base_network(MAX_SEQUENCE_LENGTH_1):
    Q1 = Sequential()
    Q1.add(Embedding(nb_words + 1, EMBEDDING_DIM, weights=[word_embedding_matrix], input_length=MAX_SEQUENCE_LENGTH,
                     trainable=False,input_shape=(MAX_SEQUENCE_LENGTH_1,)))
    Q1.add(TimeDistributed(Dense(EMBEDDING_DIM, activation='relu')))
    # Q1.add(BatchNormalization())
    Q1.add(Dense(128, activation='relu'))
    Q1.add(Dropout(0.1))
    Q1.add(Dense(128, activation='relu'))
    return Q1
input_a = Input(shape=(MAX_SEQUENCE_LENGTH,))
input_b = Input(shape=(MAX_SEQUENCE_LENGTH,))
processed_a = base_network(input_a)
processed_b = base_network(input_b)
distance = Lambda(euclidean_distance,
                  output_shape=eucl_dist_output_shape)([processed_a, processed_b])
Error I am getting in the last line and the error is
TypeError: ('Not a Keras tensor:', <keras.models.Sequential object at 0x7f02975b4f10>)