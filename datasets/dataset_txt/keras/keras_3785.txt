jdelange commented on 2 Dec 2016
I cannot stack a classifier model on top of a (partly) pre-trained VGG16 model in Model Class API. There are several threads with people having the same problem Google Groups and StackoverFlow. I have tried all variants, but I keep getting a Graph disconnect error:
Exception: Graph disconnected: cannot obtain value for tensor input_2 at layer "
My last attempt:
from keras.applications.vgg16 import VGG16
from keras.models import Model
from keras.layers import Convolution2D, MaxPooling2D, ZeroPadding2D, GlobalAveragePooling2D
from keras.layers import Dropout, Flatten, Dense, Input

img_width, img_height = 150, 150

input_1 = Input(shape=(3, img_width, img_height))

vgg16_model = VGG16(include_top=False, weights='imagenet', input_tensor=input_1)

input_2 = Input(shape=vgg16_model.output_shape[1:])
x = GlobalAveragePooling2D()(input_2)
x = Dense(256, activation='relu')(x)
x = Dropout(0.5)(x)
predict = Dense(1, activation='sigmoid')(x)
top_model = Model(input=input_2, output=predict)

# load the best saved weights
#top_model.load_weights(os.path.join(data_path, 'VGG16Classifier.hdf5'))  
# add the model on top of the convolutional base

model = Model(input=input_1, output=top_model.output)
For info I am trying to re-create this Keras Blog , but with the Model Class API in order to later modify the VGG16 model.
Is there a bug that is preventing this from working? Thanks, Jan
Oh, and I am totally thrilled about Keras!!! Really impressive!
2