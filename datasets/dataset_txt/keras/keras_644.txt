nemanjaq commented on 2 Nov 2018
I'm trying to augment both images and masks. Images are working propely but masks fail.
Example:
It happens when mask is zoomed out and rotated. That black and white should be blue, like background.
I've tried to change fill_mode, but it doesn't work for constant and nearest. Wrap works, but it creates red areas where it shouldn't.
Code:
def augGenerator():

    gen = ImageDataGenerator(
            rotation_range=20,
            shear_range=0.2,
            zoom_range=0.2,
            horizontal_flip=True,
            )

    return gen   




def augmentImage(img, mask, img_size, aug_count):

    aug_images = [img]
    aug_masks = [mask]

    img = img.reshape(-1, img_size, img_size, 3)   
    mask = mask.reshape(-1, img_size, img_size, 3)   


    gen_img = augGenerator()
    gen_mask = augGenerator()

    
    seed = 1

    gen_img.fit(img, augment=True, seed=seed)
    gen_mask.fit(mask, augment=True, seed=seed)

    img_aug_iter = gen_img.flow(img,seed=seed)
    mask_aug_iter = gen_mask.flow(mask,seed=seed)

    aug_images += [next(img_aug_iter)[0] for i in range(aug_count)]
    aug_masks += [next(mask_aug_iter)[0] for i in range(aug_count)]


    return aug_images, aug_masks 