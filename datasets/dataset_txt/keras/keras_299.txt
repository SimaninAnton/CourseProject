paulbonnard commented on 2 Apr 2019 â€¢
edited
Hello,
i'm working on imagery with multiple channels. I would like to use a vgg model as part of a bigger gan model.
I would like to use for example tensor with shape (400,400,4) but vgg model only accept shape (400,400,3)
So i look at the keras documentation, it tolds that you can change the input layer with the command include_top = False and add a new layer as input but it doesn't work.
So i thought to add a new convolutionnal layer at the beggining of the vgg model with 3 filters as output but it doesn't work either ?
Did you already have a problem like mine ?
here is my code
`from keras import Input
from keras.applications import VGG19
from keras.layers.convolutional import Conv2D
from keras.models import Model
sh = (400,400,4)
input_layer = Input(shape = sh)
conv = Conv2D(filters=4, kernel_size=3, strides=2, padding='same')(input_layer)
v = VGG19(weights="imagenet", include_top = False ,input_tensor = conv)
output_layer = v.output
model = Model(inputs=[input_layer], outputs=[output_layer])`