Contributor
shoeffner commented on 11 Sep 2019
System information
Have I written custom code (as opposed to using example directory): yes
OS Platform and Distribution (e.g., Linux Ubuntu 16.04): macOS
TensorFlow backend (yes / no): yes
TensorFlow version: v1.14.0-rc1-22-gaf24dc91b5 1.14.0
Keras version: 2.3.0 88ca804 (current master branch)
Python version: 3.7.4
CUDA/cuDNN version: n/a
GPU model and memory: Intel HD graphics
Describe the current behavior
When storing a checkpoint using the ModelCheckpoint callback, a call to the undefined is_tensor_or_variable is performed.
  File ".../keras/losses.py", line 137, in get_config
    config[k] = K.eval(v) if is_tensor_or_variable(v) else v
NameError: name 'is_tensor_or_variable' is not defined
The function is used but not defined here:
keras/keras/losses.py
Line 137 in 88ca804
 config[k] = K.eval(v) if is_tensor_or_variable(v) else v 
Describe the expected behavior
I assume that this should be something like https://github.com/tensorflow/tensorflow/blob/e2a6861c2be77412d86bdf433b640ed7dd1de32c/tensorflow/python/keras/utils/tf_utils.py#L384, to act accordingly.
Code to reproduce the issue
import keras

inputs = keras.layers.Input(shape=(1, ))
outputs = keras.layers.Dense(1)(inputs)
model = keras.models.Model(inputs=inputs, outputs=outputs)
model.compile(optimizer='adam', loss=keras.losses.BinaryCrossentropy())

cb = keras.callbacks.ModelCheckpoint('chkpts', period=1)
model.fit([[0]], [[1]], callbacks=[cb])