Advice on how to implement this (a little bit complex) network