Changing the training loop causes the model to fail while saving