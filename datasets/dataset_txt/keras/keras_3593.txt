spallesen commented on 25 Dec 2016 â€¢
edited
Im trying the initial_epoch argument for resuming training on a model and get: Exception: Received unknown keyword arguments: {'initial_epoch': x} - not matter what number i set x to.
Example: I ran this example: https://github.com/fchollet/keras/blob/master/examples/imdb_cnn_lstm.py
and saved the model:
model.save('test_resume.h5')
In a new script i ran:
from keras.models import load_model
batch_size = 30
nb_epoch = 3

model = load_model('test_resume.h5')


model.fit(X_train, y_train, batch_size=batch_size, nb_epoch=nb_epoch,
          validation_data=(X_test, y_test), initial_epoch=3)
score, acc = model.evaluate(X_test, y_test, batch_size=batch_size)
print('Test score:', score)
print('Test accuracy:', acc)
This resulted in:
---------------------------------------------------------------------------
Exception                                 Traceback (most recent call last)
<ipython-input-4-4756947373dc> in <module>()
      7 
      8 model.fit(X_train, y_train, batch_size=batch_size, nb_epoch=nb_epoch,
----> 9           validation_data=(X_test, y_test), initial_epoch=1)
     10 score, acc = model.evaluate(X_test, y_test, batch_size=batch_size)
     11 print('Test score:', score)

C:\Program Files\Anaconda3\lib\site-packages\keras\keras\models.py in fit(self, x, y, batch_size, nb_epoch, verbose, callbacks, validation_split, validation_data, shuffle, class_weight, sample_weight, **kwargs)
    640         if kwargs:
    641             raise Exception('Received unknown keyword arguments: ' +
--> 642                             str(kwargs))
    643         return self.model.fit(x, y,
    644                               batch_size=batch_size,

Exception: Received unknown keyword arguments: {'initial_epoch': 3}