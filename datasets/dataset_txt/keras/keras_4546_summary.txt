how to get gradient without computation time wastes?