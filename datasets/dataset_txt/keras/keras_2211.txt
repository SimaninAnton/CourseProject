k-ele commented on 6 Jun 2017 •
edited
Hi,
I'm facing to the problem that I can't use the function which generates random numbers as arguments of fit_generator.




This is the exerpt of my code:
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
def generate_random_para():
rand=randint(5)
print('in random_para=%d' %rand)
return rand
def generate_arrays_from_file(names, path_to_train, path_to_target, img_size, nb_class, rand_para):
while True:
for name in names:
Xpath = path_to_train + "{}.jpg".format(name)
ypath = path_to_target + "{}.png".format(name)
X = load_data(Xpath, img_size, mode="data")
y = load_data(ypath, img_size, mode="label")
print('in gen para=%d' %rand_para)
yield (X, y)
hist=train_model.fit_generator(
generate_arrays_from_file(train_names,path_to_train,path_to_target,img_size, nb_class,generate_random_para()),
steps_per_epoch=train_nb_data,
epochs =args.epoch,
validation_data = generate_arrays_from_file(val_names,path_to_train,path_to_target,img_size, nb_class,10),
nb_val_samples=val_nb_data,
callbacks=[es_cb]
)
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
Output:
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
Epoch 1/3
in random_para=0
in gen para=0
1/1171 [..............................] - ETA: 1779s - loss: 3.5410 - acc: 0.0517
in gen para=0
2/1171 [..............................] - ETA: 920s - loss: 3.3217 - acc: 0.0486
in gen para=0
3/1171 [..............................] - ETA: 633s - loss: 3.2366 - acc: 0.0465
・
・
・
Epoch 2/3
in gen para=0
1/1171 [..............................] - ETA: 63s - loss: 3.0993 - acc: 0.8970
2/1171 [..............................] - ETA: 63s - loss: 3.1003 - acc: 0.6488
in gen para=0
3/1171 [..............................] - ETA: 64s - loss: 3.1004 - acc: 0.4495
・
・
・
Epoch 3/3
in gen para=0
1/1171 [..............................] - ETA: 64s - loss: 3.0993 - acc: 0.8970
in gen para=0
2/1171 [..............................] - ETA: 64s - loss: 3.1003 - acc: 0.6488
3/1171 [..............................] - ETA: 64s - loss: 3.1004 - acc: 0.4495
・
・
・
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++



As noted above, the random number from generate_random_para() is not changeable.
I would really appreciate it if you could tell me the reason.

Thank you