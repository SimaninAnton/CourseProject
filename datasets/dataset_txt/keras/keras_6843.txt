pralav commented on 19 Jul 2015
I would like to merge outputs of two different convolutions. Each input is of size (100x100) and the batch size is 128. The code is given below
    model = Sequential()
    model.add(Reshape(1, maxlen, embedding_size))
    model.add(Convolution2D(filters, 1, 5, embedding_size))
    model.add(Activation('relu'))
    model.add(MaxPooling2D(poolsize=(maxlen - 5 + 1, 1)))
    model.add(Flatten())

    model2 = Sequential()
    model2.add(Reshape(1, maxlen, embedding_size))
    model2.add(Convolution2D(filters, 1, 10, embedding_size))
    model2.add(Activation('relu'))
    model2.add(MaxPooling2D(poolsize=(maxlen - 10 + 1, 1)))
    model2.add(Flatten())
    complete_model = Sequential()
    complete_model.add(Merge([model,model2], mode='concat')
    complete_model.add(Dense(filters, 100))

    complete_model.add(Activation('relu'))
    complete_model.add(Dense(100, nb_classes))
    complete_model.add(Activation('softmax'))
    complete_model.compile(loss='categorical_crossentropy', optimizer='adadelta')
If i run the model / model2 alone without merging, it works, but when I merge, I get the following error:
File "/usr/local/lib/python2.7/site-packages/keras/models.py", line 413, in fit
    validation_split=validation_split, val_f=val_f, val_ins=val_ins, shuffle=shuffle, metrics=metrics)
  File "/usr/local/lib/python2.7/site-packages/keras/models.py", line 168, in _fit
    outs = f(*ins_batch)
  File "/usr/local/lib/python2.7/site-packages/theano/compile/function_module.py", line 514, in __call__
    allow_downcast=s.allow_downcast)
  File "/usr/local/lib/python2.7/site-packages/theano/tensor/type.py", line 171, in filter
    data.shape))
TypeError: ('Bad input argument to theano function with name "/usr/local/lib/python2.7/site-packages/keras/models.py:328"  at index 1(0-based)', 'Wrong number of dimensions: expected 4, got 2 with shape (128, 2).')
Thanks in advance!