How to correctly obtain TensorFlow tensors' shapes during runtime in order to infer output shapes?