Maximizing a custom loss function