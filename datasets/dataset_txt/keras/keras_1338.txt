xiaoyongzhu commented on 10 Jan 2018 â€¢
edited
Please make sure that the boxes below are checked before you submit your issue. If your issue is an implementation question, please ask your question on StackOverflow or join the Keras Slack channel and ask there instead of filing a GitHub issue.
Thank you!
[Yes] Check that you are up-to-date with the master branch of Keras. You can update with:
pip install git+git://github.com/keras-team/keras.git --upgrade --no-deps
[Yes] If running on TensorFlow, check that you are up-to-date with the latest version. The installation instructions can be found here.
Hi,
I am using the latest master branch in Keras and is trying to use the DenseNet implementation on a particular dataset. However, when training on the dataset, it throws the errors below:
Traceback (most recent call last):
  File "train_georgetest.py", line 233, in <module>
    validation_data=DataGenSequence(labels, partition['valid'], current_stat                                                                                    e='validation')
  File "/datadrive/xiaoyzhu/python3forvalidation/lib/python3.5/site-packages                                                                                    /keras/legacy/interfaces.py", line 91, in wrapper
    return func(*args, **kwargs)
  File "/datadrive/xiaoyzhu/python3forvalidation/lib/python3.5/site-packages                                                                                    /keras/engine/training.py", line 2164, in fit_generator
    class_weight=class_weight)
  File "/datadrive/xiaoyzhu/python3forvalidation/lib/python3.5/site-packages                                                                                    /keras/engine/training.py", line 1836, in train_on_batch
    outputs = self.train_function(ins)
  File "/datadrive/xiaoyzhu/python3forvalidation/lib/python3.5/site-packages                                                                                    /keras/backend/tensorflow_backend.py", line 2475, in __call__
    **self.session_kwargs)
  File "/datadrive/xiaoyzhu/python3forvalidation/lib/python3.5/site-packages                                                                                    /tensorflow/python/client/session.py", line 889, in run
    run_metadata_ptr)
  File "/datadrive/xiaoyzhu/python3forvalidation/lib/python3.5/site-packages                                                                                    /tensorflow/python/client/session.py", line 1096, in _run
    % (np_val.shape, subfeed_t.name, str(subfeed_t.get_shape())))
ValueError: Cannot feed value of shape (16, 14) for Tensor 'dense_1_target:0                                                                                    ', which has shape '(?, ?, ?, ?)'
and my model is built with the code below:
def build_model():
    """

    Returns: a model with specified weights

    """
    # define the model, use pre-trained weights for image_net
    base_model = DenseNet121(input_shape=(224, 224, 3),
                             weights='imagenet',
                             include_top=False,
                             pooling='avg')

    x = base_model.output
    predictions = Dense(14, activation='sigmoid')(x)
    model = Model(inputs=base_model.input, outputs=predictions)
    return model
However, if I change the base_model to a different one, such as Inception-ResNetv2, it works fine (at least start training process).
I suspect there might some implementation error in the newly committed DenseNet? The same code also works fine for the DenseNet in Keras_contrib (https://github.com/keras-team/keras-contrib/tree/master/keras_contrib/applications).
I am using Tensorflow 1.4.1, Keras from master branch, and Ubuntu 16.04.