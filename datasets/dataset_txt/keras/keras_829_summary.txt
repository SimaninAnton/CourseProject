How do i get gradients of some customized functions?