Contributor
rustonaut commented on 13 Dec 2016
Theano has a real 'bool' dtype from v0.9dev onward. Through K.mean does not know about it
and therefor will end up casting it float64 insted of floatX which is undesired and can lead to a exceptions depending on the setup. This happen e.g. when the binary_accuracy is used.
run with keras + theano v0.9dev + floatX="float32"
import keras.backend as K
import theano.tensor as T
m1 = T.imatrix('foo')
m2 = T.imatrix('bar')
cmped = K.equal(m1, m2)
assert cmped.dtype == "bool"   #<-- this is new had been int8 before
meaned = K.mean(cmped)
assert meaned.dtype == "float64" #<-- ups, this should be "float32" (floatX),
This break at last the binary_accuracy but possible other code, too.
I will make a simple pull request in a view minutes
Please make sure that the boxes below are checked before you submit your issue. Thank you!
[X ] Check that you are up-to-date with the master branch of Keras. You can update with:
pip install git+git://github.com/fchollet/keras.git --upgrade --no-deps
[X/- ] If running on Theano, check that you are up-to-date with the master branch of Theano. You can update with:
pip install git+git://github.com/Theano/Theano.git --upgrade --no-deps
[X ] Provide a link to a GitHub Gist of a Python script that can reproduce your issue (or just copy the script here if it is short).