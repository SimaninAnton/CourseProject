kleysonr commented on 30 Dec 2018
I'm trying to adapt the https://github.com/keras-team/keras/blob/master/examples/mnist_siamese.py to use a generator.
On the example, we have:
model.fit([tr_pairs[:, 0], tr_pairs[:, 1]], tr_y,
          batch_size=128,
          epochs=epochs,
          validation_data=([te_pairs[:, 0], te_pairs[:, 1]], te_y))
Trying to figure out the shape needed to be returned by the generator, I did:
np.array([tr_pairs[:, 0], tr_pairs[:, 1]]).shape
and getting
(2, 108400, 28, 28)
My generator is then returning this:
(data, labels) = my_generator
data.shape
(2, 6, 300, 300, 3)
labels.shape
(6,)
So, it's two arrays (for the nn inputs), with 6 images (batch_size) of 300x300x3 (RGB).
Below my fit_generator()
...
input_shape = (300, 300, 3)
...
model.fit_generator(kbg.generate(set='train'), 
                    steps_per_epoch=training_steps,
                    epochs=1,
                    verbose=1,
                    callbacks=[],
                    validation_data=kbg.generate(set='test'),
                    validation_steps=validation_steps,
                    use_multiprocessing=False,
                    workers=0)  
I guess I'm feeding the nn with the same shape, but I'm getting the following error:
ValueError: Error when checking model input: the list of Numpy arrays that you are passing to your model is not the size the model expected. Expected to see 2 array(s), but instead gotthe following list of 1 arrays: [array([[[[[0.49803922, 0.48235294, 0.55686275],
          [0.63137255, 0.61176471, 0.64313725],
          [0.8627451 , 0.84313725, 0.84313725],
          ...,
          [0.58823529, 0.64705882, 0.631...
What is it wrong ?
Kleyson Rios.