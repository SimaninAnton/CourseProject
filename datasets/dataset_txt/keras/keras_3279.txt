nikcheerla commented on 7 Feb 2017 •
edited
I'm trying to build a variational autoencoder that encodes and decodes music sequence data (of shape (50, 84)). Simultaneously, I want to predict the next element inside the music sequence (vector of shape (84,)). So I need to reuse a trainable decoder that maps from the latent space to the output space – for both encoding and next element prediction.
autoencode_output = TimeDistributed(decoder) (z)

x = GRU(64, dropout_W=0.1, dropout_U=0.1, return_sequences=True) (z)
x = GRU(12, dropout_W=0.1, dropout_U=0.1, return_sequences=False) (x)
next_output = decoder(x)

model = Model(input_img, [autoencode_output, next_output])
This is the relevant part of the code; I reuse the "decoder" model twice (in the TimeDistributed wrapper and also by itself). I keep on getting a 'this shared variable already has an update expression' error, however. When do these errors happen when reusing models, and what's the cleanest way to fix them?
Thanks!