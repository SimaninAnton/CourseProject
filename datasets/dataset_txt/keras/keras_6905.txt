ghost commented on 1 Jul 2015
Is it possible to stack Merge layers? The model compiles but the train methods breaks with
dimension mismatch in args to gemm
left_left = Sequential()
left_left.add(TimeDistributedDense(10, 20))

left_right = Sequential()
left_right.add(TimeDistributedDense(10, 20))

right_left = Sequential()
right_left.add(TimeDistributedDense(10, 20))

right_right = Sequential()
right_right.add(TimeDistributedDense(10, 20))

left = Sequential()
left.add(Merge([left_left, left_right], mode = 'sum'))

right = Sequential()
right.add(Merge([right_left, right_right], mode = 'sum'))

model = Sequential()
model.add(Merge([left, right], mode='concat'))
model.add(TImeDistributedDense(40, 100))
model.add(Activation('softmax'))
model.compile(loss='categorical_crossentropy', optimizer='sgd')

model.train([left_left_x, left_right_x, right_left_x, right_right_x], y)