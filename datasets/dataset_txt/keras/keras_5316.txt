Contributor
carlthome commented on 28 Apr 2016
When calling model.fit(...) an error occurs in standardize_input_data():
Exception: Error when checking model target: expected merge_2 to have shape (32, 1000, 1024) but got array with shape (352, 1000, 1024)
However, since simply adding return arrays before # check shapes compatibility and hoping the shapes are right, training works as expected so what's up? Quick guess: merge() should update self.internal_input_shapes or something.
batch_size = ...
timesteps = ...
features = ...
x, y = load_data()  # Both x and y have shape (n*batch_size, timesteps, features), where n : int > 0
input = Input(batch_shape=(batch_size, timesteps, features))
tdd1 = TimeDistributed(Dense(features))(input)
tdd2 = TimeDistributed(Dense(features))(input)
output1 = merge(
    inputs=[tdd1, tdd2],
    output_shape=(batch_size, timesteps, features),
    mode=lambda l: l[0])
output2 = merge(
    inputs=[tdd1, tdd2],
    output_shape=(batch_size, timesteps, features),
    mode=lambda l: l[1])
model = Model(input=[input], output=[output1, output2])
model.compile(...)
model.fit(x, y, batch_size)