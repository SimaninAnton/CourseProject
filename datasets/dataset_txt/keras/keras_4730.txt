McVilla commented on 23 Jul 2016 â€¢
edited
Hi , I'm new to keras and I want to process different size of sentences for learning a document embedding in CNN. I used zero-padding and mask_out in Embedding layer, but layers after Embedding layer doesn't support masking. Is there any way to solve it?
inputs = Input(shape=(1,max_len),dtype='int32')
x= Embedding(vocab_size, dim,weights = GloVe, mask_zero = True, input_length=max_len)(inputs)
x = Reshape((1,max_len,50))(x)
x = Convolution2D(nb_filter, n_gram, dim,init='glorot_uniform', activation='linear',border_mode='valid', subsample=(1,1))(x)
x = MaxPooling2D(pool_size=(2,1))(x1)
x = Flatten()(x)
out = Dense(10)(x)
Conv_sen= Model(inputs,out)
Conv_sen is a shared model, I want to use it to precess every sentences in a document for learning their own sentence embedding. The following merge will concatenate them to form a document embedding.
Inp_list = [None] * len(list_of_sentence)
for i in range(len(list_of_sentence)) :
Inp_list[j] = Input(shape=(1,max_len),dtype='int32')
sen_emb[j]= Conv_sen(Inp_list[j])
concat = merge(sen_emb, mode = 'concat')
By the way, the max words in a sentence is about 250, and the average length is about 30. Is it ok to use zero padding for every sentence?
Thanks.
Please make sure that the boxes below are checked before you submit your issue. Thank you!
Check that you are up-to-date with the master branch of Keras. You can update with:
pip install git+git://github.com/fchollet/keras.git --upgrade --no-deps
If running on Theano, check that you are up-to-date with the master branch of Theano. You can update with:
pip install git+git://github.com/Theano/Theano.git --upgrade --no-deps
Provide a link to a GitHub Gist of a Python script that can reproduce your issue (or just copy the script here if it is short).
1