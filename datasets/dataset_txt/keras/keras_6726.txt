Contributor
tboquet commented on 24 Aug 2015
Hello all,
I'm trying to fit a model using the poisson loss function and I get nan from the first epoch.
I'm merging 2 models with time dependant sequences/covariates and put a dense layer on the top.
left = Sequential()
left.add(Embedding(len(X_1), 256))
left.add(LSTM(256, 256))
left.add(Dropout(0.3))
left.add(Dense(256, 128))

right = Sequential()
right.add(LSTM(X_1.shape[2], 512, return_sequences=True))
right.add(Dropout(0.3))
right.add(LSTM(512, 256, return_sequences=False))
right.add(Dropout(0.1))
right.add(Dense(256,128))

model = Sequential()
model.add(Merge([left, right], mode='sum'))

model.add(Dense(128, 1))

model.compile(loss='poisson', optimizer='adam')
components = model.fit([X_1, X_2], y, batch_size=256,
                       nb_epoch=20, validation_split=0.1)
I've tried to convert my target variable to a 0-1 variable in order to use the binary crossentropy loss and it's working as expected.
I'm not sure of the behavior of the loss function if y_pred is 0. The log would be minus infinity and this could be the bug?
I'm not sure how to debug it so if you have some recommandations let me now :).
Thank you!