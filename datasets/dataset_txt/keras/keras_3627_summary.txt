How could i predict a layer's weights using the output of another network in an end to end way?