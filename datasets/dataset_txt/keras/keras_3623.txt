kukumayas commented on 22 Dec 2016 â€¢
edited
Hi,
I am trying to build a nested RNN, which can handle arbitrary number of sequences, and the length of each sequence is also arbitrary. The inner RNN works on sentence level, and the outer RNN works on paragraph level.
Here is my code:
inner_LSTM= Sequential()
inner_LSTM.add(Embedding(8195, 50, dropout=0.2))
inner_LSTM.add(LSTM(70,dropout_W=0.2, dropout_U=0.2))
inner_LSTM.add(Dense(70))
outer_LSTM = Sequential()
outer_LSTM.add(inner_LSTM)
outer_LSTM.add(LSTM(70, input_shape=(None,None, 70), dropout_W=0.2, dropout_U=0.2))
outer_LSTM.add(Dense(70))
Without the outer_LSTM, the inner_LSTM is working fine but when I try to add outer_LSTM, I get the following error:
Exception: Input 0 is incompatible with layer lstm_2: expected ndim=3, found ndim=2
Please let me know if my way to implement a nested RNN is wrong.