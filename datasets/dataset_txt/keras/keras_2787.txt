MaxPowerWasTaken commented on 31 Mar 2017 â€¢
edited
Full question with reproduceable code example at:
http://stackoverflow.com/questions/43129758/invalid-shape-for-y-for-keras-lstm-w-return-sequences-true-and-sklearn-api
In summary, I have a sequence-classification task where my X and target Y are the same shape (2D rows=locations columns=time intervals). If I reshape my X & Y to be 3D tensors I get an error
"ValueError('Invalid shape for y')"
thrown from the sklearn wrapper that y must be 2-D.
If I reshape X to be a 3D tensor but leave Y as 2-D, I get another error that
"model target: expected lstm_17 to have 3 dimensions."
Any help on how to do this sequence-to-sequence classification with the last LSTM layer having return_sequences=True would be much appreciated.
Check that you are up-to-date with the master branch of Keras. You can update with:
pip install git+git://github.com/fchollet/keras.git --upgrade --no-deps
If running on TensorFlow, check that you are up-to-date with the latest version. The installation instructions can be found here.
Provide a link to a GitHub Gist of a Python script that can reproduce your issue (or just copy the script here if it is short).
1