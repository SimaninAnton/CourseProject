dupsys commented on 3 Feb 2017
Building our model using an LSTM Recurrent Network
print('Building training model...')
hiddenStateSize = 256
hiddenLayerSize = 256
timesteps = 8
model = Sequential()
model.add(LSTM(hiddenStateSize, return_sequences = True, stateful=True,
batch_input_shape=(maxSequenceLength, len(char_2_id),1),forget_bias_init='one'))
model.add(Dropout(0.3))
model.add(TimeDistributed(Dense(hiddenLayerSize)))
model.add(TimeDistributed(Activation('relu')))
model.add(TimeDistributed(Dense(len(char_2_id))))
model.add(TimeDistributed(Activation('softmax')))
%time model.compile(loss='categorical_crossentropy', optimizer = RMSprop(lr=0.001), metrics=['accuracy'])
Print the details about the network model
print(model.summary())
Test a simple prediction on a batch for this model.
print("Sample input Batch size:"),
print(inputChars[0:32, :, :].shape)
print("Sample input Batch labels (nextChars):"),
print(nextChars[0:32, :, :].shape)
outputs = model.predict(inputChars[0:32, :, :])
print("Output Sequence size:"),
print(outputs.shape)
I got this error: ValueError: Error when checking : expected lstm_input_3 to have shape (173, 38, 1) but got array with shape (32, 173, 38)