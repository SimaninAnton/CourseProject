How is the update for "train_on_batch" determined?