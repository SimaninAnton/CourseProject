CNN training is slow on large inputs