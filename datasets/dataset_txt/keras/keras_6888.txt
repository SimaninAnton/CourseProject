felipefariax commented on 6 Jul 2015
It would be great to Reset or Reinitialize a model, in order to reapply the weights initializations of each layers. This would be helpful when we need to run the same model architecture several times to retrieve some metrics like accuracy, precision, recall, etc. If we have to recompile the same model each run, we will lose much time.
In my example, I need to run a gridsearch on some hyperparams and evaluate the model 30 times. Each recompile was taking around 1s.
I came up with a solution like this:
def reset_model(model):
for layer in model.layers:
if hasattr(layer, 'init'):
init = getattr(layer, 'init')
new_weights = init(layer.get_weights()[0].shape).get_value()
bias = shared_zeros(layer.get_weights()[1].shape).get_value()
layer.set_weights([new_weights, bias])
What do you think?
5