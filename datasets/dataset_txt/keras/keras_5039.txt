Contributor
jayanthkoushik commented on 2 Jun 2016 â€¢
edited
I'm trying to fine tune VGGNet using the code and weights from here: https://gist.github.com/baraldilorenzo/07d7802847aaad0a35d3. I do this by popping layers and adding my own.
model.layers.pop()
model.add(Dense(100))
This works fine for changing layers after the 'Flatten' layer. But trying to remove the Flatten layer and add it again fails.
>>> for _ in xrange(6):
>>>     model.layers.pop()
>>> model.add(Flatten())

...
/home/scratch/jayanthkoushik/transfer-nets/env/lib/python2.7/site-packages/keras/engine/topology.pyc in assert_input_compatibility(self, input)
    373                                         self.name + ': expected ndim >= ' +
    374                                         str(ndim) + ', found ndim=' +
--> 375                                         str(K.ndim(x)))
    376                 else:
    377                     if K.ndim(x) != spec.ndim:

Exception: Input 0 is incompatible with layer flatten_39: expected ndim >= 3, found ndim=2
I'm not sure what's special about Flatten that would cause this to happen. I'm using the latest build of both Theano and Keras.