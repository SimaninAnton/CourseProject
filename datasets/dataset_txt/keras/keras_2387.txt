Contributor
jpeg729 commented on 14 May 2017 â€¢
edited
I am working on timeseries data using the _generator methods.
My generator returns a tuple:
inputs of shape (batch_size, time_steps, input_features)
targets of shape (batch_size, time_steps, output_size)
My model is composed of RNN layers followed by a TimeDistributed(Dense) layer.
The model is stateful, and I use the TimeDistributed layer in order to produce a training point at every step of the way. Each batch follows on from the previous. Thus I get efficient use of training time with decent backpropagation through time except at the beginning of each batch.
When I use fit_generator it seems to work perfectly, but when I try to use predict_generator(generator, steps) I get predictions of the shape (batch_size times steps, time_steps, output_size).
Wouldn't it be more logical for the returned shape to be (steps, batch_size, time_steps, output_size)?
As it is I don't know how to untangle the batches and the steps.