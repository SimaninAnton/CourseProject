lemuriandezapada commented on 15 Jul 2015
Hey, so I'm trying to build a graph that has two nodes that eventually merge into one node. All recurrent nodes, of course :P
graph.add_node(SimpleRNN(input_dim=256, output_dim=128, activation='sigmoid', return_sequences = True), 
               name='outlayer0', 
               inputs=['inlayer0','inlayer1'],
               merge_mode='concat'
               )
Which leads to the inevitable error:
Apply node that caused the error: Reshape{2}(InplaceDimShuffle{1,0,2}.0, MakeVector.0)
Inputs types: [TensorType(float32, 3D), TensorType(int64, vector)]
Inputs shapes: [(99, 1, 256), (2,)]
Inputs strides: [(1024, 1024, 4), (8,)]
Inputs values: ['not shown', array([ 99, 128])]
Now, it works fine with merge_mode='sum' and the lower input size. But for some reason the merging fails. Both the input sizes are 128 each. Ideas?