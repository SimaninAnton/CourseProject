rogerchen1226 commented on 11 Nov 2016 â€¢
edited
Hi, please help me~~
I want to get the output of the final_model which merged two model, here is an example.
from keras.layers import Merge
left_branch = Sequential()
left_branch.add(Dense(32, input_dim=784))
right_branch = Sequential()
right_branch.add(Dense(32, input_dim=784))
merged = Merge([left_branch, right_branch], mode='concat')
final_model = Sequential()
final_model.add(merged)
final_model.add(Dense(100, activation='relu'))
final_model.add(Dropout(0.5))
final_model.add(Dense(10, activation='softmax'))
final_model.fit([left.X,right.X],train_y)
I try the document and only work on left_branch or right_branch by single input.
And I try to input the [left.X,right.X] in get_output function didn't work.
How to use the K.function in that situation. Please give me some suggestions, thank you.
from keras import backend as K
get_output= K.function([final_model.layers[1].input,K.learning_phase()],[final_model.layers[1].output,0])
layer_output = get_output([[left.X,right.X],0])[0]