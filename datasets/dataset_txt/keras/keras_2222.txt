danil-z commented on 5 Jun 2017
Hi folks, I read example https://github.com/fchollet/keras/blob/master/examples/stateful_lstm.py
and still confused how to change(reshape) my input shape so I could feed to stateful LSTM.
batch_size = 128
tsteps = 1

# X_train.shape = (107904, 10) 
# Y_train.shape = (107904, 2)
# 107904 % 128 == 0
# X_train and Y_train are both DataFrames

model = Sequential()
model.add(LSTM(50,
               input_shape=(tsteps, Y_train.shape[1]),
               batch_size=batch_size,
               return_sequences=True,
               stateful=True))
model.add(LSTM(50,
               return_sequences=False,
               stateful=True))
model.add(Dense(X_train.shape[1]))
model.compile(loss='mse', optimizer='rmsprop')
I'm getting error:
ValueError: Error when checking input: expected lstm_1_input to have 3 dimensions, but got array with shape (107904, 10)