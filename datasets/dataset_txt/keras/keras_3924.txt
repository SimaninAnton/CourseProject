Contributor
carlthome commented on 15 Nov 2016
This trivial model crashes and no exception is raised:
i = Input((timesteps, height, width, channels))
o = Masking()(i)
o = TimeDistributed(Flatten())(o)
model = Model(i, o)
ValueError: GpuElemwise. Input dimension mis-match. Input 1 (indices start at 0) has shape[2] == 60, but the output's size on that axis is 64.
Apply node that caused the error: GpuElemwise{Mul}[(0, 1)](GpuElemwise{Composite{((-i0) / i1)}}[(0, 0)].0, GpuFromHost.0)
Toposort index: 66
Inputs types: [CudaNdarrayType(float32, (True, True, False, False)), CudaNdarrayType(float32, 4D)]
Inputs shapes: [(1, 1, 64, 128), (64, 128, 60, 1)]
Inputs strides: [(0, 0, 128, 1), (7680, 60, 1, 0)]
Inputs values: ['not shown', 'not shown']
Outputs clients: [[GpuCAReduce{add}{0,1,1,1}(GpuElemwise{Mul}[(0, 1)].0)]]
In this particular case the batch size was 64 (but None in the model), height was 60, timesteps was 128 and both width and channels were 1.