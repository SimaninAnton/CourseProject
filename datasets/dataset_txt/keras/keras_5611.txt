dblN commented on 31 Mar 2016
model = Sequential()
model.add(MaxoutDense(output_dim=16, nb_feature=4, input_dim=8))
model.add(Dense(1, activation="sigmoid"))
model.compile(optimizer="sgd", loss="binary_crossentropy")

==> ValueError: Shape (4, 8, 16) must have rank 2
MaxoutDense calculates the output as below. X is 2D and self.W is 3D, but K.dot takes two 2D inputs. Hence, it raises the error like above.
output = K.max(K.dot(X, self.W) + self.b, axis=1)
I think it should be fixed like below.
splited_W = [self.W[i, :, :] for i in range(self.nb_feature)]
splited_z = [K.dot(X, W) for W in splited_W]
z = K.concatenate([K.expand_dims(_z) for _z in splited_z])
output = K.max(z, -1)
Check that you are up-to-date with the master branch of Keras. You can update with:
pip install git+git://github.com/fchollet/keras.git --upgrade --no-deps
If running on Theano, check that you are up-to-date with the master branch of Theano. You can update with:
pip install git+git://github.com/Theano/Theano.git --upgrade --no-deps
Provide a link to a GitHub Gist of a Python script that can reproduce your issue (or just copy the script here if it is short).