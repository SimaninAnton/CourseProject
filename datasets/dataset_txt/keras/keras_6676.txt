Contributor
blackyang commented on 8 Sep 2015
Hi there,
From Keras's documentation it says that:
For time-distributed data, there is one weight per sample per timestep, i.e. if your output data is shaped (nb_samples, timesteps, output_dim), your mask should be of shape (nb_samples, timesteps). This allows you to mask out or reweight individual output timesteps, which is useful in sequence to sequence learning.
However, I happened to find that the sample_weight should have shape (nb_samples, timesteps, 1), otherwise there will be some shape mismatch errors.
If we do prefer (nb_samples, timesteps), then there is a bug in:
https://github.com/fchollet/keras/blob/master/keras/models.py#L83-L85
Because we need to expand the shape of sample_weight