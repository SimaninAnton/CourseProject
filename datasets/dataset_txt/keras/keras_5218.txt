wailoktam commented on 9 May 2016
Hi, Can anyone help me with getting the shapes and dimension right when feeding vectors representing text to a CNN?
The input vectors are 127 matrices, each of dimension 100 (token number) x 100 (vector representing the token as generated by word2vec). They are stored in a 3d numpy array.
When doing the convolution layer, I first try:
Convolution2D(10, 3, 3, border_mode='same', input_shape=(100, 100))
which gives me:
Input 0 is incompatible with layer convolution2d_1: expected ndim=4, found ndim=3
The document tells me that 10 is the filter number and that from reading the tutorial on CNN:
http://cs231n.github.io/convolutional-networks/
2d convolution is possible for 2d input.
I consider it a historical problem due to cnn being first used with images, which has a channel dimension. I add 1 dimension to input shape and assign it the value 1 to get rid of the error message, without being certain that it is the right thing to do.
Convolution2D(10, 3, 3, border_mode='same', input_shape=(1, 100, 100))
But I cannot get very far.
I cannot add a softmax activation layer, getting this error message.
Exception: Cannot apply softmax to a tensor that is not 2D or 3D. Here, ndim=4
I need this activation layer to implement a cnn model mentioned in this paper:
http://arxiv.org/pdf/1508.01585v2.pdf
But for the time being, I skip it in order to proceed with debugging other parts of the program.
Then another error comes up from the following:
model.fit([leftData, rightData], labels, nb_epoch=10, batch_size=32)
The error message reads: Wrong number of dimensions: expected 3, got 2 with shape (32, 1)
It feels like whether I add or remove a dimension, I cannot make it fit the expectation of Keras on video/image data.
Any advice would be appreciated. Thanks in advance.
Please make sure that the boxes below are checked before you submit your issue. Thank you!
[O ] Check that you are up-to-date with the master branch of Keras. You can update with:
pip install git+git://github.com/fchollet/keras.git --upgrade --no-deps
[O ] If running on Theano, check that you are up-to-date with the master branch of Theano. You can update with:
pip install git+git://github.com/Theano/Theano.git --upgrade --no-deps
[O ] Provide a link to a GitHub Gist of a Python script that can reproduce your issue (or just copy the script here if it is short).
https://github.com/mynlp/qa/commit/05ac682c91ee656e90f4ccd5ea85396ef13c45a3