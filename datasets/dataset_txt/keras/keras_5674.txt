ErnstTmp commented on 25 Mar 2016
Hello,
I am trying to add a class weight to a graph model that is fitted by a generator. I have 3 classes, and the occurrence of the classes are in a ratio of 1:1:10. Whatever class_weight I chose, result is identical: only class 2 is chosen (the one occurring the most). Also, losses and final loss of the optimization are identical, and seem not take into account the class_weight. Am I doing something wrong or is this a bug?
The number of classes is 3, and the class_weight looks like this:
class_weight = {'output': {0:1000., 1:1000., 2:1.}}
The compile looks like this:
loss="categorical_crossentropy"
model.compile(optimizer=optimizer, loss={'output': loss})
The fit_generator looks like this:
    history = model.fit_generator(generator(X, y),
                      nb_worker=1,
                      samples_per_epoch=2,
                      verbose=1,
                      class_weight=class_weight,
                      nb_epoch=epoch)
Thanks a lot for your help,
Ernst
3