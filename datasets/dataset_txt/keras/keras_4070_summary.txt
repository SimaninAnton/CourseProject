Bidirectional wrapper with masking gives incorrect hidden states