skottapa commented on 31 Oct 2016
Hi,
I have just started collecting some image data for a project. Before collecting too much data wanted to run a simple autoencoder to see what features it was learning. used the following link as a starting point. https://blog.keras.io/building-autoencoders-in-keras.html
however I am getting the following error.
C:\Users\satish\Anaconda\Deep Test>python conv_autoencoder.py
Using Theano backend.
Using gpu device 0: GeForce 840M (CNMeM is enabled with initial size: 80.0% of memory, cuDNN 5103)
Found 113 images belonging to 2 classes.
Found 32 images belonging to 2 classes.
Traceback (most recent call last):
File "conv_autoencoder.py", line 68, in
validation_data=(valid_generator,valid_generator)
TypeError: fit() takes at least 3 arguments (6 given)
My code is as follows.
from keras.layers import Input, Dense, Convolution2D, MaxPooling2D, UpSampling2D
from keras.models import Model
import numpy as np
import os
import h5py
import numpy as np
from keras.preprocessing.image import ImageDataGenerator
from keras.models import Sequential
from keras.layers import Activation, Dropout, Flatten, Dense
img_width=140
img_height=140
train_data_dir=r'Photos\train'
valid_data_dir=r'Photos\validation'
input_img = Input(shape=(3, img_width, img_width))
x = Convolution2D(16, 3, 3, activation='relu', border_mode='same')(input_img)
x = MaxPooling2D((2, 2), border_mode='same')(x)
x = Convolution2D(8, 3, 3, activation='relu', border_mode='same')(x)
x = MaxPooling2D((2, 2), border_mode='same')(x)
x = Convolution2D(8, 3, 3, activation='relu', border_mode='same')(x)
encoded = MaxPooling2D((2, 2), border_mode='same')(x)
at this point the representation is (8, 4, 4) i.e. 128-dimensional
x = Convolution2D(8, 3, 3, activation='relu', border_mode='same')(encoded)
x = UpSampling2D((2, 2))(x)
x = Convolution2D(8, 3, 3, activation='relu', border_mode='same')(x)
x = UpSampling2D((2, 2))(x)
x = Convolution2D(16, 3, 3, activation='relu')(x)
x = UpSampling2D((2, 2))(x)
decoded = Convolution2D(1, 3, 3, activation='sigmoid', border_mode='same')(x)
autoencoder = Model(input_img, decoded)
autoencoder.compile(optimizer='adadelta', loss='binary_crossentropy')
valid_datagen = ImageDataGenerator(rescale=1./255)
train_datagen = ImageDataGenerator(rescale=1./255)
train_generator = train_datagen.flow_from_directory(
train_data_dir,
target_size=(img_width, img_height),
batch_size=32,
class_mode=None,
shuffle=False)
valid_generator = valid_datagen.flow_from_directory(
valid_data_dir,
target_size=(img_width, img_height),
batch_size=32,
class_mode=None,
shuffle=False)
autoencoder.fit((train_generator,train_generator),
nb_epoch=50,
batch_size=32,
shuffle=True,
validation_data=(valid_generator,valid_generator)
)
Appreciate any help as have been stuck at this point for the last day or so.
Thanks
SK
Please make sure that the boxes below are checked before you submit your issue. Thank you!
[ X] Check that you are up-to-date with the master branch of Keras. You can update with:
pip install git+git://github.com/fchollet/keras.git --upgrade --no-deps
[X ] If running on Theano, check that you are up-to-date with the master branch of Theano. You can update with:
pip install git+git://github.com/Theano/Theano.git --upgrade --no-deps
[X ] Provide a link to a GitHub Gist of a Python script that can reproduce your issue (or just copy the script here if it is short).