Custom loss function with varying input size