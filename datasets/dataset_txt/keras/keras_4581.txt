shashankg7 commented on 16 Aug 2016
I am trying to implement seq2seq model using keras. Now since the input and output sequence is of variable length I am padding both of them with a special token ("<s"). Now I want to mask these padded values, I am using the following model :
model = Sequential()
model.add(Masking(mask_value=vocab["<s"], input_shape=(inp_len, inp_dim)))
model.add(Embedding(inp_len, inp_dim))
model.add(RNN(hid_dim, return_sequence=True))
model.add(RepeatVector(out_len))
model.add(RNN(hid_dim, return_sequence=True))
model.add(TimeDistributed(Dense(out_size))
model.add(Activation('softmax'))
model.compile(loss='categorical_crossentropy', optimizer='adam',
metrics=['accuracy'])
When I run this model I am getting following error:
TypeError: index must be intergers in the embedding layer