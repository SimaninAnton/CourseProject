does my similairty matrix layer implementation right?