boozyguo commented on 1 Oct 2016
when using “activity_regularizer” in keras with theno backend, some error report:
Traceback (most recent call last):
File "D:/working/AI/keras/snn/deepS/sys/deeps_mlp.py", line 238, in
validation_data=(x_test, y_test))
File "C:\Anaconda2\lib\site-packages\keras\models.py", line 429, in fit
sample_weight=sample_weight)
File "C:\Anaconda2\lib\site-packages\keras\engine\training.py", line 1081, in fit
self._make_train_function()
File "C:\Anaconda2\lib\site-packages\keras\engine\training.py", line 698, in _make_train_function
training_updates = self.optimizer.get_updates(trainable_weights, self.constraints, self.total_loss)
File "C:\Anaconda2\lib\site-packages\keras\optimizers.py", line 321, in get_updates
grads = self.get_gradients(loss, params)
File "C:\Anaconda2\lib\site-packages\keras\optimizers.py", line 53, in get_gradients
grads = K.gradients(loss, params)
File "C:\Anaconda2\lib\site-packages\keras\backend\theano_backend.py", line 576, in gradients
return T.grad(loss, variables)
File "C:\Anaconda2\lib\site-packages\theano\gradient.py", line 436, in grad
raise TypeError("cost must be a scalar.")
TypeError: cost must be a scalar.
The model is very simple:
keras.regularizers.WeightRegularizer(l1=0.01, l2=0.01)
keras.regularizers.ActivityRegularizer(l1=0.01, l2=0.01)
model = Sequential()
model.add(Dense(16, input_shape=(inputsize,),W_regularizer=l1l2(0.01,0.01),b_regularizer=l1l2(0.01,0.01)))
model.add(Activation('relu'))
model.add(Dropout(0.8))
model.add(Dense(1,W_regularizer=l1l2(0.01,0.01),b_regularizer=l1l2(0.01,0.01),activity_regularizer=activity_l1l2(0.01,0.01)))
model.add(Activation('sigmoid'))
model.summary()
so, how can i use the "activity_regularizer" ?