Contributor
joelthchao commented on 4 Jan 2017 â€¢
edited
Environment:
keras version: 1.2.0, tensorflow version: 0.12.0
Run script in FAQ, both frozen_model and trainable_model are unable to train (i.e. weights won't update). Also, model.summary() produce wrong params count.
The root cause is that layer.trainable is set to False before layer is called (y = layer(x)),
and results in layer.weights == []. Is this behavior expected? Or at least should be documented?
the script should be modified to:
...
x = Input(shape=(32,))
layer = Dense(32)
y = layer(x)
layer.trainable = False

frozen_model = Model(x, y)
...