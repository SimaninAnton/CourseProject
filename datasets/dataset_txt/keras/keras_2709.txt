OssamaAlshabrawy commented on 7 Apr 2017 â€¢
edited
I have sequences of different lengths (e.g. 560000x128, 437000x128, 897000x128, etc)
I'm actually new to keras and to python as well. So I don't know exactly where is the problem in my first trial. I've loaded dummy data just to understand what's going on but I have an error. I'm using batch size = 1. So could you please help me to figure it out?
Here is my code:
import numpy as np
from keras.models import Sequential
from keras.layers import LSTM,Dense,Dropout
from keras.utils import to_categorical

## Loading dummy data
s1 = np.array([[1,2,3],[1,2,3],[1,2,3]])
s2 = [[4,5,6],[4,5,6]]
y1 = np.array(to_categorical([0,0,0],num_classes=2))
y2 = to_categorical([1,1],num_classes=2)
x_test = np.array([[1,3,2],[4,6,6],[1,2,3]])
y_test = np.array([0,1,0])

n_epochs=40

model = Sequential()
model.add(LSTM(100, input_shape=(None,3), return_sequences=True, activation='tanh', recurrent_activation='hard_sigmoid')) # 100 num of LSTM units
model.add(LSTM(100, activation='tanh', recurrent_activation='hard_sigmoid'))
model.add(Dense(2, activation='softmax'))

model.compile(loss='categorical_crossentropy',
              optimizer='adam',
              metrics=['accuracy'])

print(model.summary())

for _ in range(n_epochs):
    model.train_on_batch(s1,y1)
    model.train_on_batch(s2,y2)

scores = model.evaluate(x_test, y_test) # evaluate batch at a time..
print scores
And this is the error I've got:
Traceback (most recent call last):
  File "LSTM1.py", line 32, in <module>
    model.train_on_batch(s1,y1)
  File "/usr/lib/python2.7/site-packages/keras/models.py", line 933, in train_on_batch
    class_weight=class_weight)
  File "/usr/lib/python2.7/site-packages/keras/engine/training.py", line 1614, in train_on_batch
    check_batch_axis=True)
  File "/usr/lib/python2.7/site-packages/keras/engine/training.py", line 1307, in _stant's going on but I have an error. So could you please help me to figure it out?dardize_user_data
    _check_array_lengths(x, y, sample_weights)
  File "/usr/lib/python2.7/site-packages/keras/engine/training.py", line 229, in _check_array_lengths
    'and ' + str(list(set_y)[0]) + ' target samples.')
ValueError: Input arrays should have the same number of samples as target arrays. Found 1 input samples and 3 target samples.