hemanth2090 commented on 7 Oct 2015
Hi,
I am using graph model with one input and two outputs. I have several convolution and pooling layers. I want to obtain the weights after the first convolution layer (named as 'conv1'). I implemented the code given in the documentation. Here is the pertinent code for obtaining the weights.
model.fit({'input':X_train, 'output1':y1_train, 'output2':y2_train}, batch_size=128, nb_epoch=250)

# Save the model weights
model.save_weights('model_weights.h5', overwrite=True)

# Convolution Layer weights
get_conv_layer_output = theano.function([model.inputs[i].input for i in model.input_order], model.outputs['conv1'].get_output(train=False), on_unused_input='ignore')
    conv_output = get_conv_layer_output({'input':X_train})
    print("Printing conv1 layer weights: ",conv_output)
I got the following error.
File "train.py", line 269, in <module>
get_conv_layer_output = theano.function([model.inputs[i].input for i in model.input_order], model.outputs['conv1'].get_output(train=False), on_unused_input='ignore')
KeyError: 'conv1'
Can someone please tell me how I can save the weights after the convolution layer in a graph model?