Variable length multi input + custom layer + positive/negative sampling implementation difficulties