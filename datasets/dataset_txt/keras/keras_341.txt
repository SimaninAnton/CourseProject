Spiderixius commented on 11 Mar 2019
Background
Hello all. I am new to 1D CNN's and I am trying to feed my data to a 1D CNN model. The following is my data (Sensor data from a UWB device, data is in the below gist):
Number of columns in the dataframe: 53 
Number of rows in the dataframe: 615
The last column in the dataframe is the labels for each row. The data represents the amount of people the sensor is detecting, which currently only has two labels (1 person or 2 persons) and each row in the data represents a 1 second recoding. So goal is to create a model that is capable of receiving some data and saying whether this is data for 1 or 2 persons.
Code & Data
The source code and data can be found at the following gist: https://gist.github.com/Spiderixius/29e82017f6094da1e5d997726e85d364
The error I am having:
I get the following error:
Traceback (most recent call last):
  File "/home/spider/Documents/GithubProjects/OccupancySensing_Code/src/MachineLearning/CNN_1D.py", line 151, in <module>
    verbose=1)
  File "/home/spider/PycharmProjects/PeopleCounting/venv3/lib/python3.6/site-packages/keras/engine/training.py", line 952, in fit
    batch_size=batch_size)
  File "/home/spider/PycharmProjects/PeopleCounting/venv3/lib/python3.6/site-packages/keras/engine/training.py", line 789, in _standardize_user_data
    exception_prefix='target')
  File "/home/spider/PycharmProjects/PeopleCounting/venv3/lib/python3.6/site-packages/keras/engine/training_utils.py", line 138, in standardize_input_data
    str(data_shape))
ValueError: Error when checking target: expected dense_1 to have shape (2,) but got array with shape (1,)
The error points to:
# Enable validation to use ModelCheckpoint and EarlyStopping callbacks.
history = model_m.fit(X_train,
                      y_train,
                      batch_size=BATCH_SIZE,
                      epochs=EPOCHS,
                      callbacks=callbacks_list,
                      validation_split=0.2,
                      verbose=1)