Masks and weights in `weighted_objective`