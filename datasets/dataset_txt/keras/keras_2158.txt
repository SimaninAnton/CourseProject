Contributor
Shaofanl commented on 12 Jun 2017
Function preprocess_weights_for_loading in here is to load weights from Keras-1. The problem is that the function cannot dive into layer of type Model and cannot analyze the inner layers of that Model layer.
It identifies the type of weights by recognizing layer.__class__.__name__ for each pair of (layer, weights)
However, I have a model built with Keras-1 that is a combination of multiple sub-models:
sub_model1 = Model(...)
sub_model2 = Model(...)
sub_model3 = Model(...)
input = Input(...)
x = sub_model1(input)
x = sub_model2(x)
x = sub_model3(x)
model = Model(input, x)
When loaded with Keras-2, the structure of (layer, weights) list looks like this:
[(input_layer, []), (sub_model1, [all weights of sub_model1]), (sub_model3, [all weights of sub_model3]), (sub_model3, [all weights of sub_model3]) ]
And the layer.__class__.__name__ is Model for each sub_model. The problem is that the function cannot dive into layer of type Model and cannot analyze the inner layers of that Model layer. I believe the same will happen to Sequential.