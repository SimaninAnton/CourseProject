Contributor
ericwu09 commented on 23 Jul 2017 â€¢
edited
When I attempt to return the state of a ConvLSTM2D layer, I get the following error from the following code:
input = Input(shape=(None, 1, 40, 40))
output = ConvLSTM2D(filters=32, kernel_size=(3,3), padding='same', return_state=True)(input)
Error:
---------------------------------------------------------------------------
IndexError                                Traceback (most recent call last)
<ipython-input-68-b1658f95f57f> in <module>()
      1 input = Input(shape=(None, 1, 40, 40))
----> 2 output = ConvLSTM2D(filters=32, kernel_size=(3,3), padding='same', return_state=True)(input)
      3 
      4 #print output

/Library/Python/2.7/site-packages/keras/layers/recurrent.pyc in __call__(self, inputs, initial_state, **kwargs)
    260         # modify the input spec to include the state.
    261         if initial_state is None:
--> 262             return super(Recurrent, self).__call__(inputs, **kwargs)
    263 
    264         if not isinstance(initial_state, (list, tuple)):

/Library/Python/2.7/site-packages/keras/engine/topology.pyc in __call__(self, inputs, **kwargs)
    628                                    input_masks=previous_mask, output_masks=output_mask,
    629                                    input_shapes=input_shape, output_shapes=output_shape,
--> 630                                    arguments=user_kwargs)
    631 
    632             # Apply activity regularizer if any:

/Library/Python/2.7/site-packages/keras/engine/topology.pyc in _add_inbound_node(self, input_tensors, output_tensors, input_masks, output_masks, input_shapes, output_shapes, arguments)
    690         # Update tensor history, _keras_shape and _uses_learning_phase.
    691         for i in range(len(output_tensors)):
--> 692             output_tensors[i]._keras_shape = output_shapes[i]
    693             uses_lp = any([getattr(x, '_uses_learning_phase', False) for x in input_tensors])
    694             uses_lp = getattr(self, 'uses_learning_phase', False) or uses_lp

IndexError: list index out of range
Am I mis-specifying the input shape, or is this an implementation issue?
Thanks!