scotthuang1989 commented on 3 Mar 2018
keras can save checkpoint with ModelCheckpoint, then restore weights from checkpoint with load_weights,
Here is a scenario,
train a model 1000 epoch. save the weights to checkpoint file.
restore weight from checkpoint file, train another 1000 epochs.
In tensorflow the starting global step of 2nd training is 10001, but in keras, it seems that it reset the global steps(or, no such thing?).
So far, this behavior cause me 2 problems.
tensorboad is messing up, the 2 training run all start from step 0.
I need save some information into file during the training, the file name will depends on the train step, so I can save information for different steps, eg: weight_1000steps.h5, weight_2000steps.h5, etc.
But since step will restart if I start a new training, so some old file will be overwritten.
my question is:
How can I restore the training step/epoch from chekpoint file in keras?