Reshaping in custom loss causes error: "Incompatible shapes: [8] vs. [16]"