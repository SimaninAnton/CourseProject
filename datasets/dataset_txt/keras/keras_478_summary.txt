Output shape has Dimension() object after reshape, Flatten() produces (?,?)