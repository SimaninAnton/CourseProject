Contributor
rilut commented on 16 Apr 2016 â€¢
edited
Hi, I got an error while fitting a model on Keras 1.0 on Theano on Windows 10 x64. Previously, I can fit Keras models on Keras 0.6 with Theano 0.8-dev just fine. Here a simple Perceptron code to demonstrate the error while fitting:
model = Sequential()
model.add(Dense(64, input_dim=220, activation='relu'))
model.add(Dropout(0.5))
model.add(Dense(3, activation='softmax'))
model.compile(loss='categorical_crossentropy', optimizer='sgd')
# Fine

model.fit(X,y,nb_epoch=1)
# Error
---------------------------------------------------------------------------
ImportError                               Traceback (most recent call last)
<ipython-input-9-38fd95106b65> in <module>()
----> 1 model.fit(X, y, nb_epoch=1)

C:\Anaconda2\lib\site-packages\keras\models.pyc in fit(self, x, y, batch_size, nb_epoch, verbose, callbacks, validation_split, validation_data, shuffle, class_weight, sample_weight, **kwargs)
    400                               shuffle=shuffle,
    401                               class_weight=class_weight,
--> 402                               sample_weight=sample_weight)

...........
(truncated for brevity)
...........

C:\Anaconda2\lib\site-packages\theano\gof\cmodule.pyc in compile_str(module_name, src_code, location, include_dirs, lib_dirs, libs, preargs, py_module, hide_symbols)
   2211             open(os.path.join(location, "__init__.py"), 'w').close()
   2212             assert os.path.isfile(lib_filename)
-> 2213             return dlimport(lib_filename)

C:\Anaconda2\lib\site-packages\theano\gof\cmodule.pyc in dlimport(fullpath, suffix)
    297             warnings.filterwarnings("ignore",
    298                                     message="numpy.ndarray size changed")
--> 299             rval = __import__(module_name, {}, {}, [module_name])
    300         t1 = time.time()
    301         import_time += t1 - t0

ImportError: ('The following error happened while compiling the node', Dot22(dense_input_1, dense_2_W), '\n', 'DLL load failed: The specified module could not be found.', '[Dot22(dense_input_1, dense_2_W)]')
Is this a code regression in Keras or just another installation error? If so, any tips to debug it?
Thanks.
Additional Info:
Up-to-date with the master branch of Keras
Up-to-date with the master branch of Theano
OS: Windows 10 x64
Running on CPU
Backend: Theano
can import theano