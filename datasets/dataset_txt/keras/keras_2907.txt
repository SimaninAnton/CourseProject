apacha commented on 21 Mar 2017 â€¢
edited
When using model.fit_generator, the progress-bar does not work as expected.
As noted on StackOverflow, the following verbosity levels exist (which should be explained in the documentation):
0: No logging
1: Displaying a progress-bar for each batch
2: Displaying one line per epoch
Verbosity-Modes 0 and 2 work as expected, but mode 1 (the default mode) creates the following output:
Epoch 2/100
   64/50000 [..............................] - ETA: 323s - loss: 2.3547 - acc: 0.0625
  128/50000 [..............................] - ETA: 181s - loss: 2.3319 - acc: 0.0781
  192/50000 [..............................] - ETA: 133s - loss: 2.3233 - acc: 0.1042
  256/50000 [..............................] - ETA: 110s - loss: 2.3243 - acc: 0.1055
  384/50000 [..............................] - ETA: 86s - loss: 2.3267 - acc: 0.0990 
  512/50000 [..............................] - ETA: 73s - loss: 2.3213 - acc: 0.1094
  640/50000 [..............................] - ETA: 66s - loss: 2.3184 - acc: 0.1109
  704/50000 [..............................] - ETA: 63s - loss: 2.3188 - acc: 0.1080
  832/50000 [..............................] - ETA: 59s - loss: 2.3177 - acc: 0.1058
  960/50000 [..............................] - ETA: 56s - loss: 2.3176 - acc: 0.1031
 1088/50000 [..............................] - ETA: 53s - loss: 2.3146 - acc: 0.1048
I already identified the problem in the source-code. It uses \b and \r both, which does not work as expected on Windows and Ubuntu 16.04 with PyCharm 2016.3.3. I was able to fix this issue, by simply removing line 257 (sys.stdout.write('\b' * prev_total_width)) because \r is a carriage return to the start of the line anyway. I've also tested this on Linux and removing line 257 does not break existing functionality.
Is there a reason, why this additional \b exists? Is it required on Mac? If not, I would file a pull-request to remove that line and fix the progress-bar output on Windows.
12