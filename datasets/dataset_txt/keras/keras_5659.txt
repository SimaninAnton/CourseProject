ianni67 commented on 26 Mar 2016
Hi,
I'm trying to build a sequence of CNN and LSTM layers for 1D signal (sound) analysis.
In my network I have the following first layer:
model.add(TimeDistributed(Convolution1D(nb_filter=32, filter_length=3, border_mode='same', activation='relu', subsample_length=1, input_shape=( num_of_blocks, 1, num_hidden_dimensions))))
and the net is fed with an input tensor of shape:
(6, 4, 1024)
where 6 is the number of clips (samples), 4 the steps per sample and 1024 the dimension of each step.
According to the example: https://github.com/jamesmf/mnistCRNN/blob/master/scripts/addMNISTrnn.py
I pass the input_shape as (steps, channels, num_hidden_dimensions) where the third parameter is the number of elements for each step.
When I compile the model I get the following error message:
model.add(TimeDistributed(Convolution1D(nb_filter=32, filter_length=3, border_mode='same', activation='relu', subsample_length=1, input_shape=( 4, 1, num_hidden_dimensions))))
  File "/home/ianni/.local/lib/python2.7/site-packages/keras/layers/convolutional.py", line 104, in __init__
    super(Convolution1D, self).__init__(**kwargs)
  File "/home/ianni/.local/lib/python2.7/site-packages/keras/layers/core.py", line 60, in __init__
    self.set_input_shape((None,) + tuple(kwargs['input_shape']))
  File "/home/ianni/.local/lib/python2.7/site-packages/keras/layers/core.py", line 220, in set_input_shape
    ', was provided with input shape ' + str(input_shape))
Exception: Invalid input shape - Layer expects input ndim=3, was provided with input shape (None, 4, 1, 1024)
I cannot figure out how to solve the problem. Any hints?
Thank you very much for your help
Please make sure that the boxes below are checked before you submit your issue. Thank you!
Check that you are up-to-date with the master branch of Keras. You can update with:
pip install git+git://github.com/fchollet/keras.git --upgrade --no-deps
If running on Theano, check that you are up-to-date with the master branch of Theano. You can update with:
pip install git+git://github.com/Theano/Theano.git --upgrade --no-deps
Provide a link to a GitHub Gist of a Python script that can reproduce your issue (or just copy the script here if it is short).