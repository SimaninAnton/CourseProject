mtamburrano commented on 4 Jul 2016
I want to finetune a Keras Model (defined with the new functional API).
I can correctly finetune a sequential model using @joelthchao's code here but I'm not sure what's the best way to finetune the new Model type.
Actually I'm loading a model defined on a json file with model_from_json, so the result is the model already built and I cannot figure how to build an additionally layer, remove the last one (or two, with the activation) and substitute it with the new one.
I have a workaround, I added on this line the following code:
if layer.output_shape[1] != weight_values[1].shape[0]:
    print ("SKIPPING LOAD ON %s" % (layer.name))
    continue
and I manually changed the json adjusting the shapes as I want. So when the load_weights is called, essentially all the weights are loaded except those of the layers with a different shape than the original one.
Is there a cleaner way to do it without the need to manually modify the json?
3