bernardohenz commented on 11 Aug 2016
I am loading a pre-trained model and I want to remove the two last layers of it, I think the simple code would suffice:
model.layers.pop()
model.layers.pop()
but when calling model.output_shape, the model continues outputting the same as before. I already tried some answers of other posts ( #2371), testing also the following code:
model.layers.pop()
model.layers.pop()
model.outputs = [model.layers[-1].output]
model.layers[-1].outbound_nodes = []
But it is also not working (at least the model.output_shape continues the same.
Please make sure that the boxes below are checked before you submit your issue. Thank you!
Check that you are up-to-date with the master branch of Keras. You can update with:
pip install git+git://github.com/fchollet/keras.git --upgrade --no-deps
If running on Theano, check that you are up-to-date with the master branch of Theano. You can update with:
pip install git+git://github.com/Theano/Theano.git --upgrade --no-deps
Provide a link to a GitHub Gist of a Python script that can reproduce your issue (or just copy the script here if it is short).