albu5 commented on 27 Mar 2017
Layer (type) Output Shape Param #
input_2 (InputLayer) (None, 9, 150528) 0
reshape_1 (Reshape) (None, 9, 224, 224, 3) 0
time_distributed_1 (TimeDist (None, 9, 1, 1, 2048) 23587712
reshape_2 (Reshape) (None, 9, 2048) 0
lstm_1 (LSTM) (None, 9, 256) 2360320
dense_1 (Dense) (None, 9, 2) 514
W c:\tf_jenkins\home\workspace\release-win\device\gpu\os\windows\tensorflow\core\framework\op_kernel.cc:993] Invalid argument: You must feed a value for placeholder tensor 'input_1' with dtype float
[[Node: input_1 = Placeholderdtype=DT_FLOAT, shape=[], _device="/job:localhost/replica:0/task:0/gpu:0"]]
Traceback (most recent call last):
File "C:\lib\Anaconda3\envs\keras\lib\site-packages\tensorflow\python\client\session.py", line 1022, in _do_call
return fn(*args)
File "C:\lib\Anaconda3\envs\keras\lib\site-packages\tensorflow\python\client\session.py", line 1004, in _run_fn
status, run_metadata)
File "C:\lib\Anaconda3\envs\keras\lib\contextlib.py", line 66, in exit
next(self.gen)
File "C:\lib\Anaconda3\envs\keras\lib\site-packages\tensorflow\python\framework\errors_impl.py", line 466, in raise_exception_on_not_ok_status
pywrap_tensorflow.TF_GetCode(status))
tensorflow.python.framework.errors_impl.InvalidArgumentError: You must feed a value for placeholder tensor 'input_1' with dtype float
[[Node: input_1 = Placeholderdtype=DT_FLOAT, shape=[], _device="/job:localhost/replica:0/task:0/gpu:0"]]
[[Node: mul_1/_1527 = _Recvclient_terminated=false, recv_device="/job:localhost/replica:0/task:0/cpu:0", send_device="/job:localhost/replica:0/task:0/gpu:0", send_device_incarnation=1, tensor_name="edge_66_mul_1", tensor_type=DT_FLOAT, _device="/job:localhost/replica:0/task:0/cpu:0"]]
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
File "C:/Users/asd/Desktop/Ashish/BMVC/action_lstm_resnet.py", line 53, in
model.train_on_batch(X, Y)
File "C:\lib\Anaconda3\envs\keras\lib\site-packages\keras\engine\training.py", line 1620, in train_on_batch
outputs = self.train_function(ins)
File "C:\lib\Anaconda3\envs\keras\lib\site-packages\keras\backend\tensorflow_backend.py", line 2073, in call
feed_dict=feed_dict)
File "C:\lib\Anaconda3\envs\keras\lib\site-packages\tensorflow\python\client\session.py", line 767, in run
run_metadata_ptr)
File "C:\lib\Anaconda3\envs\keras\lib\site-packages\tensorflow\python\client\session.py", line 965, in _run
feed_dict_string, options, run_metadata)
File "C:\lib\Anaconda3\envs\keras\lib\site-packages\tensorflow\python\client\session.py", line 1015, in _do_run
target_list, options, run_metadata)
File "C:\lib\Anaconda3\envs\keras\lib\site-packages\tensorflow\python\client\session.py", line 1035, in _do_call
raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: You must feed a value for placeholder tensor 'input_1' with dtype float
[[Node: input_1 = Placeholderdtype=DT_FLOAT, shape=[], _device="/job:localhost/replica:0/task:0/gpu:0"]]
[[Node: mul_1/_1527 = _Recvclient_terminated=false, recv_device="/job:localhost/replica:0/task:0/cpu:0", send_device="/job:localhost/replica:0/task:0/gpu:0", send_device_incarnation=1, tensor_name="edge_66_mul_1", tensor_type=DT_FLOAT, _device="/job:localhost/replica:0/task:0/cpu:0"]]
Caused by op 'input_1', defined at:
File "C:/Users/asd/Desktop/Ashish/BMVC/action_lstm_resnet.py", line 27, in
resnet = ResNet50(weights='imagenet', include_top=False)
File "C:\lib\Anaconda3\envs\keras\lib\site-packages\keras\applications\resnet50.py", line 195, in ResNet50
img_input = Input(shape=input_shape)
File "C:\lib\Anaconda3\envs\keras\lib\site-packages\keras\engine\topology.py", line 1388, in Input
input_tensor=tensor)
File "C:\lib\Anaconda3\envs\keras\lib\site-packages\keras\engine\topology.py", line 1299, in init
name=self.name)
File "C:\lib\Anaconda3\envs\keras\lib\site-packages\keras\backend\tensorflow_backend.py", line 349, in placeholder
x = tf.placeholder(dtype, shape=shape, name=name)
File "C:\lib\Anaconda3\envs\keras\lib\site-packages\tensorflow\python\ops\array_ops.py", line 1502, in placeholder
name=name)
File "C:\lib\Anaconda3\envs\keras\lib\site-packages\tensorflow\python\ops\gen_array_ops.py", line 2149, in _placeholder
name=name)
File "C:\lib\Anaconda3\envs\keras\lib\site-packages\tensorflow\python\framework\op_def_library.py", line 763, in apply_op
op_def=op_def)
File "C:\lib\Anaconda3\envs\keras\lib\site-packages\tensorflow\python\framework\ops.py", line 2327, in create_op
original_op=self._default_original_op, op_def=op_def)
File "C:\lib\Anaconda3\envs\keras\lib\site-packages\tensorflow\python\framework\ops.py", line 1226, in init
self._traceback = _extract_stack()
InvalidArgumentError (see above for traceback): You must feed a value for placeholder tensor 'input_1' with dtype float
[[Node: input_1 = Placeholderdtype=DT_FLOAT, shape=[], _device="/job:localhost/replica:0/task:0/gpu:0"]]
[[Node: mul_1/_1527 = _Recvclient_terminated=false, recv_device="/job:localhost/replica:0/task:0/cpu:0", send_device="/job:localhost/replica:0/task:0/gpu:0", send_device_incarnation=1, tensor_name="edge_66_mul_1", tensor_type=DT_FLOAT, _device="/job:localhost/replica:0/task:0/cpu:0"]]
E c:\tf_jenkins\home\workspace\release-win\device\gpu\os\windows\tensorflow\stream_executor\cuda\cuda_gpu_executor.cc:637] Deallocating stream with pending work
I'm running following code:
resnet = ResNet50(weights='imagenet', include_top=False)
print(resnet.summary())
input_layer = Input(shape=(seq_len, 2242243))
curr_layer = Reshape(target_shape=(seq_len, 224, 224, 3))(input_layer)
curr_layer = TimeDistributed(resnet)(curr_layer)
curr_layer = Reshape(target_shape=(seq_len, 2048))(curr_layer)
lstm_out = LSTM(256, return_sequences=True,
activation='sigmoid', recurrent_activation='tanh',
use_bias=True, unit_forget_bias=True)(curr_layer)
prediction_layer = Dense(2, activation=kb.softmax)(lstm_out)
model = Model(inputs=input_layer, outputs=prediction_layer)
optimizer = adam(lr=0.00001)
model.compile(loss='binary_crossentropy', optimizer=optimizer, metrics=['accuracy'])
print(model.summary())
X, Y = get_batch_image(train_dir, batch_size, seq_len)
print(X.shape, Y.shape)
model.train_on_batch(X, Y)
shapes of X,Y = (2, 9, 150528) (2, 9, 2)