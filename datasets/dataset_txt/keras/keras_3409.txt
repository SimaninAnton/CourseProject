Mouatez commented on 21 Jan 2017
Hello everyone,
I tried multiple times to adapt imdb_cnn_lstm.py and imdb_cnn.py Keras examples for multi-class classification, but it did not work. In the following you find what I have changed in the code to do so:
model.add(Dense(3))
model.add(Activation('softmax'))
model.compile(loss='categorical_crossentropy', optimizer='adam', metrics=['accuracy'])
Also, I added the third class to the IMDB y_train and y_test:
y_train[22000:] = 2
y_test[22000:] = 2
In both Keras examples I got this error:
ValueError: Error when checking model target: expected activation_2 to have shape (None, 3) but got array with shape (25000, 1)
Any hints or a working code snippet.
Thank you,
My Setup:
Keras: 1.2.0
Tenserflow-gpu: 0.12.0