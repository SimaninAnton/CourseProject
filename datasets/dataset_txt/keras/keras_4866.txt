sariel85 commented on 1 Jul 2016
I am using deep nets to learn new features for a data set and then use them for a classification/regression task.
As an objective function for the feature learning stage I want to maximize similarity in the learnt feature space of data points which I know should be similar and distance points which I know should be distant.
So for example if I know that data points x1 and x2 are similar in some sense and the net represents the points as y1, y2 (via the output of some mid layer of the net, before the classifier) I would like to minimize (y1-y2)^2.
Is there a way to do this via Keras?
As far as I can see all objective functions in Keras involve one data point at a time. Can I write a objective function involving the relationship between the net outputs for two different data points?
P.S - I am aware that the division to mini-batches might cause a problem (for example if the two related point do not fall in the same batch the layer outputs might not be both available in the same batch) but I can overcome this issue in other ways or I can even work with non-stochastic/full-batch optimizer if needed