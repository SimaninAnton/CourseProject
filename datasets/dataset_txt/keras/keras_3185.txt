dplaniel commented on 17 Feb 2017
I'm getting some lengthy compilation errors from NVCC when I try to fit some simple networks using the Theano backend. These are not an issue when running on the CPU or with the Tensorflow backend. However I am using the latest stable release of Theano. I am using CUDA 7, though. Python 2.7.11 with GTX Titan X.
Curiously, as far as I can tell, I only get these issues when using the accuracy metric in combination with the binary_crossentropy loss function. I can build and run fine (on GPU with Theano) using e.g. categorical crossentropy with accuracy, or binary_crossentropy with different metrics such as MSE (even if nonsensical). Therefore maybe there is some Keras weirdness here.
Short example code with lengthy error output (including some cuda code.)
import keras
from keras.models import Sequential
from keras.layers import Dense, Activation
import numpy as np
import os
import theano
import sys



print(sys.version)
print(keras.__version__)
print(theano.__version__)

model = Sequential()
model.add(Dense(output_dim=64, input_dim=100))
model.add(Activation('relu'))
model.add(Dense(output_dim=1))
model.add(Activation('softmax'))
model.compile(loss='binary_crossentropy', optimizer='sgd', metrics=['accuracy'])

X_train = np.random.rand(100,100)
Y_train = np.ones([100])

model.fit(X_train, Y_train, nb_epoch=5, batch_size=32)
Outputs:
Verbose Error