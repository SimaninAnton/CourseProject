ologn13 commented on 12 Jan 2016
"return_sequences=True" in layer before TimeDistributedDense layer is giving this error.
model = Sequential()
model.add(Embedding(Vocab_size, Vocab_dim, input_length=max_sequence_length))
model.add(LSTM(output_dim=100, return_sequences=True, activation='tanh', inner_activation='hard_sigmoid'))
model.add(TimeDistributedDense(input_dim=100, output_dim=1))
model.add(Activation('sigmoid'))
model.compile(loss='binary_crossentropy', class_mode='binary',  optimizer='rmsprop')

checkpointer = ModelCheckpoint(filepath="weights.hdf5", monitor="val_acc", verbose=1, save_best_only=True)
earlystopping = EarlyStopping(monitor="val_acc", patience=3, verbose=1)
testHistory = TestScoresHistory()

model.fit(train_X, train_Y, validation_split=0.10, batch_size=16, nb_epoch=10, show_accuracy=True,
          callbacks=[testHistory, checkpointer, earlystopping])
Error Thrown:
File "/Users/vikrany/Desktop/test.py", line 146, in <module>
    callbacks=[testHistory, checkpointer, earlystopping])
  File "build/bdist.macosx-10.10-intel/egg/keras/models.py", line 581, in fit
  File "build/bdist.macosx-10.10-intel/egg/keras/models.py", line 239, in _fit
  File "build/bdist.macosx-10.10-intel/egg/keras/backend/theano_backend.py", line 365, in __call__
  File "/Library/Python/2.7/site-packages/theano/compile/function_module.py", line 786, in __call__
    allow_downcast=s.allow_downcast)
  File "/Library/Python/2.7/site-packages/theano/tensor/type.py", line 177, in filter
    data.shape))
TypeError: ('Bad input argument to theano function with name "build/bdist.macosx-10.10-intel/egg/keras/backend/theano_backend.py:362"  at index 1(0-based)', 'Wrong number of dimensions: expected 3, got 2 with shape (16, 1).')