Learning rate and momentum as shared scalars