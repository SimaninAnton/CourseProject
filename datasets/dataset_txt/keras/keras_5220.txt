cxfneo commented on 9 May 2016
Hi
I am learning the keras code example mnist_siamese_graph.py. The Lambda layer in this example accepts two inputs from below layers, so I think eucl_dist_output_shape function would also process a list of two corresponding input shapes. Assume input "processed_a" and processed_b have shapes with (nsamples,dim)., then the input shape will be like [(nsamples,dim),(nsamples,dim)]
According to function method "eucl_dist_output_shape(shapes)", it will give a result (nsampels,dim). But actually, the result of eucl_dist is (nsamples,1).
I am not sure whether I have a misunderstanding about Lambda layer's input.
1.distance = Lambda(euclidean_distance, output_shape=eucl_dist_output_shape)([processed_a, processed_b])
2.def eucl_dist_output_shape(shapes):
shape1, shape2 = shapes
return shape1
3.def euclidean_distance(vects):
x, y = vects
return K.sqrt(K.sum(K.square(x - y), axis=1, keepdims=True))