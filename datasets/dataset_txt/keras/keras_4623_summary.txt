Simultaneous training of shared layers with two data sets