duggalrahul commented on 18 Nov 2016 â€¢
edited
Hello,
I'm working with Keras 1.1.1 with python 2.7 on ubuntu 14.04.
According to the documentation here, the following snippet should instantiate a layer from its configuration.
from keras.models import Sequential
from keras.layers import Dense
from keras.utils.layer_utils import layer_from_config

model = Sequential()
model.add(Dense(output_dim=64, input_dim=100))

config = model.layers[0].get_config()
layer = layer_from_config(config)
However, I the following error
---------------------------------------------------------------------------
KeyError                                  Traceback (most recent call last)
<ipython-input-4-4a5a56c3cd16> in <module>()
      7 
      8 config = model.layers[0].get_config()
----> 9 layer = layer_from_config(config)
     10 
     11 # config_correct = {}

/home/rahul/anaconda2/lib/python2.7/site-packages/keras/utils/layer_utils.pyc in layer_from_config(config, custom_objects)
     23         globals()[cls_key] = custom_objects[cls_key]
     24 
---> 25     class_name = config['class_name']
     26 
     27     if class_name == 'Sequential':

KeyError: 'class_name'
After spending some hours debugging, here is how I got around this issue.
from keras.models import Sequential
from keras.layers import Dense
from keras.utils.layer_utils import layer_from_config

model = Sequential()
model.add(Dense(output_dim=64, input_dim=100))

config = model.layers[0].get_config()
config_correct = {}
config_correct['class_name'] = type(model.layers[0])
config_correct['config'] = config
layer_correct = layer_from_config(config_correct)
It would be easier to update this in the documentation meanwhile the get_config method is corrected for every layer type.
Thanks,
Rahul Duggal
1