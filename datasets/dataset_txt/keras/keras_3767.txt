Contributor
Shaofanl commented on 5 Dec 2016
I got ValueError: padding must be zero for average_exc_pad when training the inception network (predicting works). Here is a minimal script to cause that error:
import numpy as np
from keras.models import Model
from keras.utils.np_utils import to_categorical
from keras.layers import Flatten, Dense, Input, BatchNormalization, merge
from keras.layers import Convolution2D, MaxPooling2D, AveragePooling2D, ZeroPadding2D

if __name__ == '__main__':
    input_shape = (None, 3, 12, 12)

    bs, c, h, w = input_shape
    data = Input(shape=(c, h, w))

    conv1 = Convolution2D(32, 3, 3, subsample=(1, 1), border_mode='same')(data)

    pool = AveragePooling2D((3, 3), strides=(1, 1), border_mode='same')(conv1)

    flat = Flatten()(pool)

    fc = Dense(10, activation='softmax')(flat)

    m = Model(data, fc)
    m.compile('sgd', 'categorical_crossentropy')

    x = np.random.random((100,)+input_shape[1:])
    y = np.random.randint(10, size=(100,1))
    y = to_categorical(y, 10)
    m.predict(x)
    print 'predict done'
    m.fit(x, y)
    print 'fit done'
2