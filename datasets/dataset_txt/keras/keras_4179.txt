kuixu commented on 13 Oct 2016 â€¢
edited
I have 3 trained model file.
left_branch.h5
right_branch.h5
concat.h5
The model concat.h5 is fine-tuned by concatenating from the two pre-trained model as the initial model(left_branch.h5, right_branch.h5).
While left_branch.h5 and right_branch.h5 model file can be load by function keras.models.load_model(),
but I load the trained concat.h5 formatted model file, I get the error blew.
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/usr/local/lib/python2.7/dist-packages/keras/models.py", line 167, in load_model
    model.optimizer.set_weights(optimizer_weight_values)
  File "/usr/local/lib/python2.7/dist-packages/keras/optimizers.py", line 97, in set_weights
    'provided weight shape ' + str(w.shape))
Exception: Optimizer weight shape (256, 32) not compatible with provided weight shape (4,)
9