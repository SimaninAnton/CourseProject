Keras uses an exponential time algorithm for topological sorting.