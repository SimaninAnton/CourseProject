vsoto commented on 5 Feb 2017 â€¢
edited
I'd like to modify categorical accuracy to take into account non-padded values, the code I've come up with is:
def categorical_accuracy(y_true, y_pred):
y_true_label = K.argmax(y_true, axis=-1)
y_pred_label = K.argmax(y_pred, axis=-1)
n_e = K.not_equal(y_true_label, 0)
indices = tf.where(n_e)
return K.mean(K.equal(tf.gather_nd(y_true_label, indices), tf.gather_nd(y_pred_label, indices)))
But I keep getting the error message from below. I've tested the function with some made up examples and it seems to work just fine, but when I pass categorical_accuracy as a metric to my model, it doesn't. Any help?
Thanks so much in advance!
Traceback (most recent call last):
File "../codeswitch_pos_tagger/trainer.py", line 122, in <module>
run_cv_training(configs)
File "../codeswitch_pos_tagger/trainer.py", line 99, in run_cv_training
run_training(cfgs[i])
File "../codeswitch_pos_tagger/trainer.py", line 70, in run_training
metrics=[categorical_accuracy])
File "/rigel/home/vs2411/.local/lib/python2.7/site-packages/keras/models.py", line 594, in compile **kwargs)
File "/rigel/home/vs2411/.local/lib/python2.7/site-packages/keras/engine/training.py", line 716, in compile
metric_result = metric_fn(y_true, y_pred) File "../codeswitch_pos_tagger/trainer.py", line 27, in categorical_accuracy indices = tf.where(n_e)
TypeError: select() takes at least 3 arguments (1 given)