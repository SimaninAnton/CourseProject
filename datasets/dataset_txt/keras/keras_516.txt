gftd commented on 21 Dec 2018
I want to train keras model,
model.fit_generator(train_generator,                                                                                                                                                                                                      
                                epochs=200,
                                validation_data=valid_generator,
                                callbacks=[checkpoint,TensorBoard(log_dir='./log/')])
The above code work well，the model will converge.
But when i use the following code，the model will not converge.
  input = model.input
  y = model.output 

  y_ = tf.placeholder(tf.float32, [None,6], name='y_')  
  
  loss = tf.reduce_mean(categorical_crossentropy(y_, y))
  train_step = tf.train.AdamOptimizer(0.01).minimize(loss)
  correct_prediction = tf.equal(tf.argmax(y_,1), tf.argmax(y,1))
  accuracy = tf.reduce_mean(tf.cast(correct_prediction, "float"))
  sess.run(tf.global_variables_initializer())
 
  i = 0  
  for image, label in train_generator:
      sess.run([train_step],feed_dict={ input:image, y_:label })
      if i%100 == 0:
        train_accuracy =  sess.run([accuracy],feed_dict={ input:image, y_:label })
        print(train_accuracy)
      i = i+1
How can i train keras model use tensorflow？