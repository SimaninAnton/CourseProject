merge function with Lambda appears to produce wrong ndim