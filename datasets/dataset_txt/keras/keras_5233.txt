dakshvar22 commented on 7 May 2016
I am using the following code to add a TimeDistributed Convolution2D layer to my model -
model.add(TimeDistributed(Convolution2D(8, 4, 4, border_mode='valid'), input_shape=(2710,3,32,32)))
The full model building code is -
model.add(TimeDistributed(Convolution2D(8, 4, 4, border_mode='valid'), batch_input_shape=(2710,3,32,32))) model.add(TimeDistributed(MaxPooling2D(pool_size=(2, 2),border_mode='valid'))) model.add(Activation('relu')) model.add(TimeDistributed(Convolution2D(8, 3, 3, border_mode='valid'))) model.add(Activation('relu')) model.add(TimeDistributedFlatten()) model.add(Activation('relu')) model.add(GRU(output_dim=100,return_sequences=True)) model.add(GRU(output_dim=50,return_sequences=False)) model.add(Dropout(.2)) model.add(Dense(1))
I get the following error during the model building stage. I have not tried model.fit() yet. -
File "/home/toothless/daksh/ml/project/src/model/model2.py", line 133, in buildModel
model.add(TimeDistributed(Convolution2D(8, 4, 4, border_mode='valid'), input_shape=(2710,3,32,32)))
File "/usr/local/lib/python2.7/dist-packages/keras/models.py", line 110, in add
layer.create_input_layer(batch_input_shape, input_dtype)
File "/usr/local/lib/python2.7/dist-packages/keras/engine/topology.py", line 337, in create_input_layer
dtype=input_dtype, name=name)
File "/usr/local/lib/python2.7/dist-packages/keras/engine/topology.py", line 1026, in Input
name=name, input_dtype=dtype)
File "/usr/local/lib/python2.7/dist-packages/keras/engine/topology.py", line 957, in init
shape = input_tensor._keras_shape
AttributeError: 'TensorVariable' object has no attribute '_keras_shape'
@fchollet can you help me out with this please?