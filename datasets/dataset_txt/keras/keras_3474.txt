Mako18 commented on 13 Jan 2017 â€¢
edited
Hi, I'm trying to desing a net combining CNN layers with LSTM layer. I have three inputs that are gray-scale images. First I create a CNN layer to each input so it can learn spatial patrons and after that I merge the three inputs. Now I want my net to learn about time patrons, so I have 1730 samples (each sample is a different time) for each input.
The problem is that when I merge it and try to compute the LSTM layer, it gives me the next error:
ValueError: Input 0 is incompatible with layer lstm_6: expected ndim=3, found ndim=4
My inputs shape are (1,8,10) (80 pixels images). My code is:
Izd=Sequential()
Izd.add(Convolution2D(40,3,3, input_shape=(1,8,10),border_mode='same'))
Izd.add(Activation('relu'))
Izd.add(MaxPooling2D(pool_size=(2,2)))
Izd.add(Dropout(0.2))
Dcha=Sequential()
Dcha.add(Convolution2D(40,3,3, input_shape=(1,8,10),border_mode='same'))
Dcha.add(Activation('relu'))
Dcha.add(MaxPooling2D(pool_size=(2,2)))
Frt=Sequential()
Frt.add(Convolution2D(40,3,3,input_shape(1,8,10),border_mode='same'))
Frt.add(Activation('relu'))
Frt.add(MaxPooling2D(pool_size=(2,2)))
merged=merge([Izda, Dcha,Frt], mode='concat', concat_axis=1)
model=Sequential()
model.add(merged)
model.add(LSTM(240))
I would like to know if there is a way to create a network with convolutional layer and lstm layer with a 2D input. I have seen examples with words and sentences, but not with images and I don't know what kind of input LSTM expect.
Thanks.