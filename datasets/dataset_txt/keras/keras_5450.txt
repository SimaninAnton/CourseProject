penguin2121 commented on 17 Apr 2016
I'm using the ModelCheckpoint as described in keras.io with a sequential model. When I save the model using the code described in the FAQ and then try to reload it based on the weights saved by ModelCheckpoint, it tells me:
model.load_weights(os.path.join('checkpoints')+'//weights.hdf5')
Traceback (most recent call last):
File "", line 1, in
model.load_weights(os.path.join('checkpoints')+'//weights.hdf5')
File "C:\WinPython\WinPython-64bit-3.4.4.1\python-3.4.4.amd64\lib\site-packages\keras\engine\topology.py", line 2286, in load_weights
str(len(flattened_layers)) + ' layers.')
Exception: You are trying to load a weight file containing 31 layers into a model with 30 layers.
Is there an error in the way the ModelCheckpoint saves weights, for instance including input layer weights of 1?