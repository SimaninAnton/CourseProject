How to use a custom pooling function for a model?