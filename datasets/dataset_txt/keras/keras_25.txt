NaSed commented on 12 Nov 2019
I have just updated the tensorflow-gpu package from 1.13.0 to 2.0.0 and now I get this error:
return model._make_execution_function(mode) File "/project/6004228/sedaghat/DR_Project/Code/DNN_36/lib/python3.6/site-packages/tensorflow_core/python/keras/engine/training.py", line 2184, in _make_execution_function self._make_train_function() File "/project/6004228/sedaghat/DR_Project/Code/DNN_36/lib/python3.6/site-packages/tensorflow_core/python/keras/engine/training.py", line 2116, in _make_train_function params=self._collected_trainable_weights, loss=self.total_loss) File "/project/6004228/sedaghat/DR_Project/Code/DNN_36/lib/python3.6/site-packages/tensorflow_core/python/keras/optimizer_v2/optimizer_v2.py", line 506, in get_updates return [self.apply_gradients(grads_and_vars)] File "/project/6004228/sedaghat/DR_Project/Code/DNN_36/lib/python3.6/site-packages/tensorflow_core/python/keras/optimizer_v2/optimizer_v2.py", line 434, in apply_gradients self._create_hypers() File "/project/6004228/sedaghat/DR_Project/Code/DNN_36/lib/python3.6/site-packages/tensorflow_core/python/keras/optimizer_v2/optimizer_v2.py", line 643, in _create_hypers aggregation=tf_variables.VariableAggregation.ONLY_FIRST_REPLICA) File "/project/6004228/sedaghat/DR_Project/Code/DNN_36/lib/python3.6/site-packages/tensorflow_core/python/keras/optimizer_v2/optimizer_v2.py", line 805, in add_weight aggregation=aggregation) File "/project/6004228/sedaghat/DR_Project/Code/DNN_36/lib/python3.6/site-packages/tensorflow_core/python/training/tracking/base.py", line 744, in _add_variable_with_custom_getter **kwargs_for_getter) File "/project/6004228/sedaghat/DR_Project/Code/DNN_36/lib/python3.6/site-packages/tensorflow_core/python/keras/engine/base_layer_utils.py", line 139, in make_variable shape=variable_shape if variable_shape else None) File "/project/6004228/sedaghat/DR_Project/Code/DNN_36/lib/python3.6/site-packages/tensorflow_core/python/ops/variables.py", line 258, in __call__ return cls._variable_v1_call(*args, **kwargs) File "/project/6004228/sedaghat/DR_Project/Code/DNN_36/lib/python3.6/site-packages/tensorflow_core/python/ops/variables.py", line 219, in _variable_v1_call shape=shape) File "/project/6004228/sedaghat/DR_Project/Code/DNN_36/lib/python3.6/site-packages/tensorflow_core/python/ops/variables.py", line 197, in <lambda> previous_getter = lambda **kwargs: default_variable_creator(None, **kwargs) File "/project/6004228/sedaghat/DR_Project/Code/DNN_36/lib/python3.6/site-packages/tensorflow_core/python/ops/variable_scope.py", line 2507, in default_variable_creator shape=shape) File "/project/6004228/sedaghat/DR_Project/Code/DNN_36/lib/python3.6/site-packages/tensorflow_core/python/ops/variables.py", line 262, in __call__ return super(VariableMetaclass, cls).__call__(*args, **kwargs) File "/project/6004228/sedaghat/DR_Project/Code/DNN_36/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py", line 1406, in __init__ distribute_strategy=distribute_strategy) File "/project/6004228/sedaghat/DR_Project/Code/DNN_36/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py", line 1538, in _init_from_args name="initial_value", dtype=dtype) File "/project/6004228/sedaghat/DR_Project/Code/DNN_36/lib/python3.6/site-packages/tensorflow_core/python/framework/ops.py", line 1184, in convert_to_tensor return convert_to_tensor_v2(value, dtype, preferred_dtype, name) File "/project/6004228/sedaghat/DR_Project/Code/DNN_36/lib/python3.6/site-packages/tensorflow_core/python/framework/ops.py", line 1242, in convert_to_tensor_v2 as_ref=False) File "/project/6004228/sedaghat/DR_Project/Code/DNN_36/lib/python3.6/site-packages/tensorflow_core/python/framework/ops.py", line 1296, in internal_convert_to_tensor ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref) File "/project/6004228/sedaghat/DR_Project/Code/DNN_36/lib/python3.6/site-packages/tensorflow_core/python/framework/tensor_conversion_registry.py", line 52, in _default_conversion_function return constant_op.constant(value, dtype, name=name) File "/project/6004228/sedaghat/DR_Project/Code/DNN_36/lib/python3.6/site-packages/tensorflow_core/python/framework/constant_op.py", line 227, in constant allow_broadcast=True) File "/project/6004228/sedaghat/DR_Project/Code/DNN_36/lib/python3.6/site-packages/tensorflow_core/python/framework/constant_op.py", line 235, in _constant_impl t = convert_to_eager_tensor(value, ctx, dtype) File "/project/6004228/sedaghat/DR_Project/Code/DNN_36/lib/python3.6/site-packages/tensorflow_core/python/framework/constant_op.py", line 96, in convert_to_eager_tensor return ops.EagerTensor(value, ctx.device_name, dtype) ValueError: Failed to convert a NumPy array to a Tensor (Unsupported numpy type: NPY_LONGDOUBLE).
I should mention that the input data and labels are pandas data frame where type of values are float32. I cannot figure out where it finds np.longdouble to generate the error.
I would really appreciate any help.