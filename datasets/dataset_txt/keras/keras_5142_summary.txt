Masking and reshape (triplets input of different kinds)