vinayakumarr commented on 29 Sep 2016 â€¢
edited
I have data set train 10000_20 test 1000_20 19 features and 1 class label: 5 classes
reshape input to be [samples, time steps, features]
X_train = np.reshape(trainX, (trainX.shape[0], 1, trainX.shape[1])) // 10000,1,20
X_test = np.reshape(testT, (testT.shape[0], 1, testT.shape[1])) // 1000,1,20
set parameters:
max_features = 20
batch_size = 32
nb_filter = 64
filter_length = 3
hidden_dims = 5
nb_epoch = 2
model = Sequential()
model.add(Convolution1D(nb_filter=nb_filter, filter_length=filter_length, border_mode='valid', activation='relu', input_shape=(1,20)))
model.add(MaxPooling1D(pool_length=(10)))
model.add(Flatten())
model.add(Dense(hidden_dims))
model.add(Dropout(0.2))
model.add(Activation('relu'))
model.add(Dense(5))
model.add(Activation('softmax'))
model.compile(loss='categorical_crossentropy', optimizer='adam', metrics=['accuracy'])
model.fit(X_train, y_train, batch_size=batch_size, nb_epoch=nb_epoch)
showing an error ValueError: negative dimensions are not allowed