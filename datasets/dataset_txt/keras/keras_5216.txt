MarkVdBergh commented on 9 May 2016 â€¢
edited
I can't implement Dropout with the Funcional API on Keras (1.0.2) with Tensorflow 0.8 backend.
This minimal code works without x = Dropout(.3)(x)
inputs = Input(shape=(2,))
x = Dense(64, activation='relu')(inputs)
x = Dropout(.3)(x)
x = Dense(64, activation='relu')(x)
predictions = Dense(2, activation='softmax')(x)
model = Model(input=inputs, output=predictions)
model.compile(optimizer='rmsprop', loss='categorical_crossentropy', metrics=['accuracy'])
model.fit(data, labels,nb_epoch=10)
But with x = Dropout(.3)(x) it gives following error:
tensorflow.python.framework.errors.UnimplementedError:
Cast uint8 to bool is not supported [[Node: Cast = CastDstT=DT_BOOL, SrcT=DT_UINT8, _device="/job:localhost/replica:0/task:0/cpu:0"]]
What is the correct way to add dropout in the functional API?