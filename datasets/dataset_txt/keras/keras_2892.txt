lhyxcxy commented on 22 Mar 2017
save model:
json_string = model.to_json() #等价于 json_string = model.get_config()
open('my_model_architecture.json','w').write(json_string) #保存模型
model.save_weights('my_model_weights.h5')#保存权重
load model:
(x_train, y_train), (x_test, y_test) = mnist.load_data()
#model = Sequential()
model = model_from_json(open('my_model_architecture.json').read())
model.load_weights('my_model_weights.h5')
print (model.predict_classes(x_test[:10]))
ERROR
File "/home/lhy/PycharmProjects/keras_e/test/mnist_cnn_red.py", line 15, in
print (model.predict_classes(x_test[:10]))
File "/usr/lib64/python2.7/site-packages/keras/models.py", line 996, in predict_classes
proba = self.predict(x, batch_size=batch_size, verbose=verbose)
File "/usr/lib64/python2.7/site-packages/keras/models.py", line 891, in predict
return self.model.predict(x, batch_size=batch_size, verbose=verbose)
File "/usr/lib64/python2.7/site-packages/keras/engine/training.py", line 1554, in predict
check_batch_axis=False)
File "/usr/lib64/python2.7/site-packages/keras/engine/training.py", line 121, in _standardize_input_data
str(array.shape))
ValueError: Error when checking : expected conv2d_1_input to have 4 dimensions, but got array with shape (10, 28, 28)