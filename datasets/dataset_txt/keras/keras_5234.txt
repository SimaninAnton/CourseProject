wddabc commented on 7 May 2016 â€¢
edited
Hi,
I'm currently working on a weird paragraph summarization task, which requires a 4-D tensor input with shape (nb_samples, n_sentences, timesteps, input_dim). That is, each example is a paragraph with n_sentences sentences. The story here is I need to run an RNN for each sentence and then use the the last state of the sentence as a 'sentence embedding', then I have to do some pooling over the n_sentences ( for example, averaging the sentence embeddings) as the final embedding for each paragraph.
Looks like the Keras RNN only supports the 3-D input, which means I have two ways to go:
Implement a 4-D RNN that extends 3D-RNN, where I need to call a 3-RNN for each example.
Reshape the tensor to a 3-D tensor with shape (nb_samples, n_sentences*timesteps, input_dim). And still use the 3-D RNN. But I need to find some ways that reset the RNN every timesteps steps. I think this is a use case that on the opposite of stateful, where I have to reset within "sentence".
Any suggestions? I think the latter one probably easier to implement but It is slow as the RNN should explicitly go over a "sentence" with length n_sentences*timesteps without any parallelism.
3