encoder and decoder issue for keras