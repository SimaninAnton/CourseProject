mememimis commented on 19 Sep 2016 â€¢
edited
Hello , i want to ask your opinion why this is happening. To explain myself until yesterday, my models as simple as they were they were working until today. my code is as follows :`model = Sequential()
model.add(Embedding(max_features, 350, input_length=maxlen))
model.add(Bidirectional(LSTM(350)))
model.add(Dropout(0.5))
model.add(Dense(1, activation='sigmoid'))
model.compile('adam', 'binary_crossentropy', metrics=['accuracy'])
print('Train...')
model.fit(X_train, y_train,
batch_size=batch_size,
nb_epoch=10,
validation_data=[X_test, y_test])
score, acc = model.evaluate(X_test, y_test,
batch_size=batch_size)The above code words for 100 or 200 embedding size but not for the above setup. It produces the following error.Traceback (most recent call last):
File "C:/Users/usera/PycharmProjects/Diplomatiki/create.py", line 72, in
validation_data=[X_test, y_test])
File "C:\Users\usera\Anaconda2\lib\site-packages\keras\models.py", line 620, in fit
sample_weight=sample_weight)
File "C:\Users\usera\Anaconda2\lib\site-packages\keras\engine\training.py", line 1104, in fit
callback_metrics=callback_metrics)
File "C:\Users\usera\Anaconda2\lib\site-packages\keras\engine\training.py", line 822, in _fit_loop
outs = f(ins_batch)
File "C:\Users\usera\Anaconda2\lib\site-packages\keras\backend\theano_backend.py", line 672, in call
return self.function(*inputs)
File "C:\Users\usera\Anaconda2\lib\site-packages\theano\compile\function_module.py", line 871, in call
storage_map=getattr(self.fn, 'storage_map', None))
File "C:\Users\usera\Anaconda2\lib\site-packages\theano\gof\link.py", line 314, in raise_with_op
reraise(exc_type, exc_value, exc_trace)
File "C:\Users\usera\Anaconda2\lib\site-packages\theano\compile\function_module.py", line 859, in call
outputs = self.fn()
ValueError: Input dimension mis-match. (input[2].shape[0] = 64, input[3].shape[0] = 1003)
Apply node that caused the error: Elemwise{Composite{Switch(i0, (i1 * i2 * i3), i2)}}[(0, 2)](InplaceDimShuffle{x,x}.0, TensorConstant{%281L, 1L%29 of 2.0}, Join.0, Elemwise{Composite{Cast{float32}%28LT%28i0, i1%29%29}}[%280, 0%29].0)
Toposort index: 208
Inputs types: [TensorType(uint8, (True, True)), TensorType(float32, (True, True)), TensorType(float32, matrix), TensorType(float32, matrix)]
Inputs shapes: [(1L, 1L), (1L, 1L), (64L, 700L), (1003L, 700L)]
Inputs strides: [(1L, 1L), (4L, 4L), (2800L, 4L), (2800L, 4L)]
Inputs values: [array([[1]], dtype=uint8), array([[ 2.]], dtype=float32), 'not shown', 'not shown']
Outputs clients: [[Dot22(Elemwise{Composite{Switch(i0, (i1 * i2 * i3), i2)}}[(0, 2)].0, dense_1_W), InplaceDimShuffle{1,0}(Elemwise{Composite{Switch(i0, (i1 * i2 * i3), i2)}}[(0, 2)].0)]]
`
The same error is produced and when i use cnn-lstm with word2vec vectors. The weird part is that the models were working yesterday for any value i had test them.
thanks,
nick