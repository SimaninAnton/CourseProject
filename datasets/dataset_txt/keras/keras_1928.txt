slangenborg commented on 14 Jul 2017 â€¢
edited
I'm trying to train a basic CNN on the MNIST data, but having difficulty with the input_shape requirement.
def baseline_model_CNN():
 model = Sequential()
 model.add(Conv2D(32, (5, 5), input_shape=(1, 28, 28), activation='relu'))
 model.add(MaxPooling2D(pool_size=(2, 2)))
 model.add(Dropout(0.2))
 model.add(Flatten())
 model.add(Dense(128, activation='relu'))
 model.add(Dense(num_classes, activation='softmax'))
 model.compile(loss='categorical_crossentropy', optimizer='adam', metrics=['accuracy'])
 return model
model = baseline_model()
model.fit(trainMatrix, target, epochs=10, batch_size=200, `verbose=2)
This returns the error:
"ValueError: Error when checking input: expected dense_15_input to have 2 dimensions, but got array with shape (42000, 1, 28, 28)"
I don't understand what the issue is, my array should be the right shape to use as input.