moon5648 commented on 7 May 2016 â€¢
edited
From this page: https://www.cs.toronto.edu/~kriz/cifar.html
It says that I can read labels not as integers, but as meaningful names by reading the batches.meta file in the dataset.
But I just can't seem to find a way to read the file.
I tried by modifying the keras/datasets/cifar10.py at https://github.com/fchollet/keras/blob/master/keras/datasets/cifar10.py, like below:
from __future__ import absolute_import
from keras.datasets.cifar import load_batch
from keras.utils.data_utils import get_file
import numpy as np
import os


def load_data():
    dirname = "cifar-10-batches-py"
    origin = "http://www.cs.toronto.edu/~kriz/cifar-10-python.tar.gz"
    path = get_file(dirname, origin=origin, untar=True)

    nb_train_samples = 50000

    X_train = np.zeros((nb_train_samples, 3, 32, 32), dtype="uint8")
    y_train = np.zeros((nb_train_samples,), dtype="uint8")

    for i in range(1, 6):
        fpath = os.path.join(path, 'data_batch_' + str(i))
        bpath = os.path.join(path, 'batches.meta')
        data, labels = load_batch(fpath)
        label_names = load_batch(bpath)

    return data, labels, label_names

data, labels, label_names = load_data()

print(labels[10], label_names[7])
But I get an error message like below:
KeyError Traceback (most recent call last)
in ()
24 return data, labels, label_names
25
---> 26 data, labels, label_names = load_data()
27
28 print(labels[10], label_names[7])
in load_data()
20 bpath = os.path.join(path, 'batches.meta')
21 data, labels = load_batch(fpath)
---> 22 label_names = load_batch(bpath)
23
24 return data, labels, label_names
/home/robotics/anaconda3/lib/python3.5/site-packages/keras/datasets/cifar.py in load_batch(fpath, label_key)
17 d[k.decode("utf8")] = v
18 f.close()
---> 19 data = d["data"]
20 labels = d[label_key]
21
KeyError: 'data'
It doesn't look like I'm on the right track, so could anyone help me with this please??
In addition, I'm trying to display how my model does via displaying the target image and my model prediction with meaningful names.
How can I do those also??
Thank you very much in advance.