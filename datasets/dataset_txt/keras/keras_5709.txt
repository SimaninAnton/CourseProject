cxfneo commented on 22 Mar 2016
Hi all
When I try to merge multi-inputs to a shard basenetwork, it will give an error:"theano.compile.function_module.UnusedInputError: theano.function was asked to create a function computing outputs given certain inputs, but the provided input variable at index 1 is not part of the computational graph needed to compute the outputs: input_b "
g.add_shared_node(base_network, name='shared', inputs['input_a','input_b','input_c'],merge_mode='join')
The base_network is as follows:
def create_base_network(last_hidden_dims,hidden_units,vocabsize,timesteps,data_dim):
model.add_input(name='input0', input_shape=(timesteps,), dtype=int)
model.add_node(Embedding(vocabsize, data_dim, input_length=timesteps),
name='embedding', input='input0')
model.add_node(LSTM(hidden_units), name='forward', input='embedding')
model.add_node(Dense(last_hidden_dims, activation='sigmoid'), name='sigmoid', input='forward')
model.add_output(name='output', input='sigmoid')
return model