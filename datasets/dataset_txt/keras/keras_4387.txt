Contributor
matthiasplappert commented on 14 Sep 2016
Steps to reproduce:
Install TensorFlow 0.10.0
Run the image_ocr.py example
Notice that ctc_label_dense_to_sparse is broken under TensorFlow 0.10.0 whereas it works fine under 0.9.0
The problem appears that dense_mask has shape=None, which seems to be not (anymore?) supported by tf.boolean_mask. Unfortunately, I do not know enough about what ctc_label_dense_to_sparse does to fix it myself.
Here's the relevant part of the trace:
  File "/Users/matze/Labs/Handwriting/venv/lib/python2.7/site-packages/Keras-1.0.8-py2.7.egg/keras/backend/tensorflow_backend.py", line 1798, in ctc_batch_cost
    sparse_labels = tf.to_int32(ctc_label_dense_to_sparse(y_true, label_length))
  File "/Users/matze/Labs/Handwriting/venv/lib/python2.7/site-packages/Keras-1.0.8-py2.7.egg/keras/backend/tensorflow_backend.py", line 1767, in ctc_label_dense_to_sparse
    label_ind = tf.boolean_mask(label_array, dense_mask)
  File "/Users/matze/Labs/Handwriting/venv/lib/python2.7/site-packages/tensorflow/python/ops/array_ops.py", line 819, in boolean_mask
    "mask dimensions must be specified, even if some dimensions are None"
ValueError: mask dimensions must be specified, even if some dimensions are None.  E.g. shape=[None] is ok, but shape=None is not.