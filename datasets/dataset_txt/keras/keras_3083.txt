hengck23 commented on 3 Mar 2017
I am trying to convert my tensorflow code to keras. I have a problem about concatenation layer
In the construction of "dense-block2" of the diagram, my keras code gives the error " 'concat' mode can only merge layers with matching output shapes except for the concat axis. Layer shapes: [(None, 16, 16, 32), (None, 16, 16, 16)]". What is wrong?
(Note: I use the latest tensorflow 1.0 relase as backend. )
    #block1
    model.add(Convolution2D(32, 5, 5, subsample=(1, 1), border_mode='same', bias=False, W_regularizer=l2(decay)))
    model.add(BatchNormalization())
    model.add(Activation(relu))
    model.add(MaxPooling2D(pool_size=(2, 2), strides=(2,2), border_mode='same'))

    #block2
    for n in range(4):
        left  = model.output
        right = Convolution2D(16, 3, 3, subsample=(1, 1), border_mode='same', bias=False, W_regularizer=l2(decay))(left)
        right = BatchNormalization()(right)
        right = Activation(relu)(right)
        model.add(merge([left, right], mode='concat', concat_axis=1))
    model.add(MaxPooling2D(pool_size=(2, 2), strides=(2, 2), border_mode='same'))