How to get both loss and model output at once, on a batch of data ?