szcom commented on 10 Nov 2016
Using TimeDistributed on Lambda with >1 inputs is not working:
z_mean = TimeDistributed(Dense(encoding_dim))(encoded)
z_log_sigma = TimeDistributed(Dense(encoding_dim))(encoded)
def sampling(args):
z_mean, z_log_sigma = args
epsilon = K.random_normal(shape=K.shape(z_mean),
mean=0., std=epsilon_std)
return z_mean + K.exp(z_log_sigma) * epsilon
z = TimeDistributed(Lambda(sampling, output_shape=(encoding_dim,)))([z_mean, z_log_sigma]) # >>>>>> wrappers.py assert line 87, in build assert len(input_shape) >= 3
TimeDistributed.build does not expect list of shapes. It takes a single shape.