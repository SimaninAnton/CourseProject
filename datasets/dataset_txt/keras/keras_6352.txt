Contributor
ekerazha commented on 2 Dec 2015
After the fix for issue #1125, I'm trying
in_out_neurons = 1
hidden_neurons = 10
batch_size = 10

model = Sequential()
model.add(GRU(hidden_neurons, batch_input_shape=(batch_size, 5, in_out_neurons), return_sequences=True, stateful=True))
but I get this error
TypeError: data type not understood
This is the traceback:
model.add(GRU(hidden_neurons, batch_input_shape=(batch_size, 5, in_out_neurons), return_sequences=True, stateful=True))

recurrent.py", line 190, in __init__
super(GRU, self).__init__(**kwargs)

recurrent.py", line 25, in __init__
super(Recurrent, self).__init__(**kwargs)

core.py", line 30, in __init__
self.set_input_shape(tuple(kwargs['batch_input_shape']))

core.py", line 95, in set_input_shape
self.build()

recurrent.py", line 219, in build
self.states = [K.zeros(input_shape[0], self.output_dim)]

theano_backend.py", line 80, in zeros
return variable(np.zeros(shape), dtype, name)

theano_backend.py", line 33, in variable
value = np.asarray(value, dtype=dtype)

numeric.py", line 474, in asarray
return array(a, dtype, copy=False, order=order)
Theano is up-to-date. Am I missing anything?