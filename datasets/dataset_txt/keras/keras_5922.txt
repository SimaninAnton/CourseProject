thomasj02 commented on 18 Feb 2016
I'm sure this is something I'm doing wrong, but I can't figure out what it is.
I can train a simple MLP fine, but I'm having problems when I try to train a 1D CNN:
My data input shape is (1076273, 252), so 1076273 samples of dimension 252
model = Sequential()
model.add(Convolution1D(
        nb_filter=21, 
        filter_length=3, 
        input_dim=1,  # Should this be 1 or 252?
        input_length=input_size,
        activation='relu',
        init='uniform'))
model.add(MaxPooling1D(pool_length=2))
model.add(Dropout(0.2))

model.add(Flatten())
model.add(Dense(64, activation='relu'))

model.add(Dense(1, activation='sigmoid'))

model.compile(loss='binary_crossentropy',
              optimizer='adam',
              class_mode='binary')

history = model.fit(train_data, train_labels, batch_size=128, nb_epoch=1, 
                    validation_data=(validation_data, validation_labels))
This gives:
TypeError: ('Bad input argument to theano function with name "build/bdist.linux-x86_64/egg/keras/backend/theano_backend.py:380" at index 0(0-based)', 'Wrong number of dimensions: expected 3, got 2 with shape (128, 252).')
What am I doing wrong? Why is theano expecting 3 dimensions?
5