Tomtomgo commented on 22 Nov 2015
I tried to do something similar to the GRU image caption learning example when I ran into an issue. To verify that it's not an issue in my code I've tried the same as in the example:
from keras.models import Sequential
language_model = Sequential()
language_model.add(Embedding(10000, 256, input_length=16))
language_model.add(GRU(output_dim=128, return_sequences=True))
language_model.add(Dense(128))
When I run that I get the following error:
Traceback (most recent call last):
  File "test.py", line 63, in <module>
    language_model.add(Dense(128))
  File "/usr/local/lib/python3.4/dist-packages/keras/layers/containers.py", line 37, in add
    self.layers[-1].set_previous(self.layers[-2])
  File "/usr/local/lib/python3.4/dist-packages/keras/layers/core.py", line 33, in set_previous
    str(self.input_ndim) + " but previous layer has output_shape " + str(layer.output_shape)
AssertionError: Incompatible shapes: layer expected input with ndim=2 but previous layer has output_shape (None, 16, 128)
Version info via pipdeptree:
Keras==0.2.0
  - theano [installed: 0.7.0]
    - numpy [required: >=1.7.1, installed: 1.10.1]
    - scipy [required: >=0.11, installed: 0.16.1]
    - six [required: >=1.9.0, installed: 1.10.0]
  - pyyaml [installed: 3.11]