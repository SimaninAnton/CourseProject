ankit1997 commented on 23 Nov 2017 â€¢
edited
While saving a model to image file, I used the following code:
from keras.utils import plot_model
plot_model(model, to_file='movie_review_model.png')
model is a valid model. I can confirm this because it is predicting correctly.
But executing this raised an Error AttributeError: 'Sequential' object has no attribute 'container_nodes'.
Complete log from jupyter-notebook:
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
<ipython-input-19-0e1ab8e22913> in <module>()
----> 1 plot_model(model, to_file='movie_review_mode9l.png')

/usr/local/lib/python3.5/dist-packages/keras/utils/vis_utils.py in plot_model(model, to_file, show_shapes, show_layer_names, rankdir)
    129             'LR' creates a horizontal plot.
    130     """
--> 131     dot = model_to_dot(model, show_shapes, show_layer_names, rankdir)
    132     _, extension = os.path.splitext(to_file)
    133     if not extension:

/usr/local/lib/python3.5/dist-packages/keras/utils/vis_utils.py in model_to_dot(model, show_shapes, show_layer_names, rankdir)
    104         for i, node in enumerate(layer.inbound_nodes):
    105             node_key = layer.name + '_ib-' + str(i)
--> 106             if node_key in model.container_nodes:
    107                 for inbound_layer in node.inbound_layers:
    108                     inbound_layer_id = str(id(inbound_layer))

AttributeError: 'Sequential' object has no attribute 'container_nodes'
The problem is clear, but I have used this function before and it used to work properly. Is there something else wrong?
Thanks