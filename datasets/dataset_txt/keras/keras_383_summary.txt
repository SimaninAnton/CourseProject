Concurrent training of two models with shared weights