How to modify source code and add new function?