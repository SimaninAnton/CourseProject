phisad commented on 9 May 2019
System information
OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Windows 10
TensorFlow backend (yes / no): yes
TensorFlow version: 1.13.1
Keras version: 2.2.4-tf
Python version: 3.6
CUDA/cuDNN version: 9.0
GPU model and memory: GeForce 1060
Describe the current behavior
There is an MNIST sample how to use embeddings with the Tensorboad callback at https://keras.io/examples/tensorboard_embeddings_mnist
But when I run the code an error message is thrown:
Caused by op 'strided_slice/_assign', defined at:
  File "C:\Users\Philipp\.p2\pool\plugins\org.python.pydev.core_7.1.0.201902031515\pysrc\runfiles.py", line 273, in <module>
    main()
  File "C:\Users\Philipp\.p2\pool\plugins\org.python.pydev.core_7.1.0.201902031515\pysrc\runfiles.py", line 97, in main
    return pydev_runfiles.main(configuration)  # Note: still doesn't return a proper value.
  File "C:\Users\Philipp\.p2\pool\plugins\org.python.pydev.core_7.1.0.201902031515\pysrc\_pydev_runfiles\pydev_runfiles.py", line 874, in main
    PydevTestRunner(configuration).run_tests()
  File "C:\Users\Philipp\.p2\pool\plugins\org.python.pydev.core_7.1.0.201902031515\pysrc\_pydev_runfiles\pydev_runfiles.py", line 803, in run_tests
    run_tests()
  File "C:\Users\Philipp\.p2\pool\plugins\org.python.pydev.core_7.1.0.201902031515\pysrc\_pydev_runfiles\pydev_runfiles.py", line 798, in run_tests
    runner.run(test_suite)
  File "C:\Development\apps\Anaconda3\envs\tf113\lib\unittest\runner.py", line 176, in run
    test(result)
  File "C:\Development\apps\Anaconda3\envs\tf113\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\Development\apps\Anaconda3\envs\tf113\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\Development\apps\Anaconda3\envs\tf113\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\Development\apps\Anaconda3\envs\tf113\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\Development\apps\Anaconda3\envs\tf113\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\Development\apps\Anaconda3\envs\tf113\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\Development\apps\Anaconda3\envs\tf113\lib\unittest\case.py", line 653, in __call__
    return self.run(*args, **kwds)
  File "C:\Development\apps\Anaconda3\envs\tf113\lib\unittest\case.py", line 605, in run
    testMethod()
  File "F:\Development\git\thesis-captioning\tests\test_embedding_callback.py", line 179, in mnist
    validation_data=(x_test, y_test))
  File "C:\Development\apps\Anaconda3\envs\tf113\lib\site-packages\tensorflow\python\keras\engine\training.py", line 880, in fit
    validation_steps=validation_steps)
  File "C:\Development\apps\Anaconda3\envs\tf113\lib\site-packages\tensorflow\python\keras\engine\training_arrays.py", line 215, in model_iteration
    mode=mode)
  File "C:\Development\apps\Anaconda3\envs\tf113\lib\site-packages\tensorflow\python\keras\callbacks.py", line 106, in configure_callbacks
    callback_list.set_model(callback_model)
  File "C:\Development\apps\Anaconda3\envs\tf113\lib\site-packages\tensorflow\python\keras\callbacks.py", line 178, in set_model
    callback.set_model(model)
  File "C:\Development\apps\Anaconda3\envs\tf113\lib\site-packages\tensorflow\python\keras\callbacks.py", line 1051, in set_model
    embedding_input)
  File "C:\Development\apps\Anaconda3\envs\tf113\lib\site-packages\tensorflow\python\ops\state_ops.py", line 224, in assign
    return ref.assign(value, name=name)
  File "C:\Development\apps\Anaconda3\envs\tf113\lib\site-packages\tensorflow\python\ops\array_ops.py", line 844, in assign
    shrink_axis_mask=shrink_axis_mask)
  File "C:\Development\apps\Anaconda3\envs\tf113\lib\site-packages\tensorflow\python\ops\resource_variable_ops.py", line 1163, in _strided_slice_assign
    shrink_axis_mask=shrink_axis_mask))
  File "C:\Development\apps\Anaconda3\envs\tf113\lib\site-packages\tensorflow\python\ops\gen_array_ops.py", line 7288, in resource_strided_slice_assign
    name=name)
  File "C:\Development\apps\Anaconda3\envs\tf113\lib\site-packages\tensorflow\python\framework\op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "C:\Development\apps\Anaconda3\envs\tf113\lib\site-packages\tensorflow\python\util\deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "C:\Development\apps\Anaconda3\envs\tf113\lib\site-packages\tensorflow\python\framework\ops.py", line 3300, in create_op
    op_def=op_def)
  File "C:\Development\apps\Anaconda3\envs\tf113\lib\site-packages\tensorflow\python\framework\ops.py", line 1801, in __init__
    self._traceback = tf_stack.extract_stack()

NotFoundError (see above for traceback): Resource localhost/features/embeddings/class tensorflow::Var does not exist.
  [[node strided_slice/_assign (defined at F:\Development\git\thesis-captioning\tests\test_embedding_callback.py:179) ]]
  [[node ReadVariableOp_1 (defined at F:\Development\git\thesis-captioning\tests\test_embedding_callback.py:179) ]]
The error message looks for me, as when the node is not correctly added to the graph.
Describe the expected behavior
I expect that the sample runs without a problem and then shows me the correct projection in Tensorboad.
Code to reproduce the issue
See sample at https://keras.io/examples/tensorboard_embeddings_mnist
Other info / logs
Include any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.