pianoman4873 commented on 30 Mar 2017 â€¢
edited
I have the following code -
def BuildMatrixFactorizationModel(usersCount, qaPairsCount):
left = Sequential()
left.add(Embedding(usersCount, EMBEDDING_DIM, input_length=1))
left.add(Reshape((EMBEDDING_DIM,)))
right = Sequential()
right.add(Embedding(qaPairsCount, EMBEDDING_DIM, input_length=1))
right.add(Reshape((EMBEDDING_DIM,)))

model = Sequential()
model.add( Merge ([left, right], mode='dot'))
model.compile(loss='mse', optimizer='adamax' , metrics= ['acc'] )
return model
if name == 'main':
path = "e:/model.h5"
model = BuildMatrixFactorizationModel(100000,5000)
model.save(path)
del model
model = load_model(path)
However , load_model fails with the error message -
File "C:\Users\pianoman\AppData\Local\Programs\Python\Python35\lib\site-packages\keras\engine\topology.py", line 2877, in load_weights_from_hdf5_group
str(len(filtered_layers)) + ' layers.')
ValueError: You are trying to load a weight file containing 2 layers into a model with 0 layers.
Any idea what is wrong ?
Note that I was able to train the model -
only loading of the presisted model fails.