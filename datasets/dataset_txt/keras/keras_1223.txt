spate141 commented on 23 Feb 2018
Check that you are up-to-date with the master branch of Keras. You can update with:
pip install git+git://github.com/keras-team/keras.git --upgrade --no-deps
If running on TensorFlow, check that you are up-to-date with the latest version. The installation instructions can be found here.
I trained a Bidirectional CuDNNLSTM text classification model and model.evaluate(x_test, y_test, batch_size=BATCH_SIZE) give me [('loss', 0.39137715717178684), ('acc', 0.9012292817679558)]. Which is what I was expecting!
Now, when I load the same model weights in a new Bidirectional LSTM model (to run the model on CPU) by modifying CuDNNLSTM > LSTM in my model architecture, I'm getting [('loss', 8.747908523430075), ('acc', 0.006823506011315417)] on same test data.
Any suggestion on this behavior? Do I have to update anything else when loading CuDNNLSTM model weights in LSTM model? I did the same thing for my other model and it worked without any issues.
Also, parameters numbers seems to be different in CuDNNLSTM and LSTM layer, even though everything is same!
CuDNNLSTM:
LSTM:
1