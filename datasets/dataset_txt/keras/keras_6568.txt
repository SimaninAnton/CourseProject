trungnt13 commented on 12 Oct 2015
The following code given error when compile, input = (nb_samples,20,390):
m = keras.models.Sequential()
# ====== LSTM ====== #
m.add(keras.layers.recurrent.LSTM(250, input_dim=390, return_sequences=True))
m.add(keras.layers.recurrent.LSTM(250, input_dim=390, return_sequences=True, input_length=20))
m.add(keras.layers.core.Flatten())
m.add(keras.layers.core.Dense(1024))
This is the stack trace:
Traceback (most recent call last):
File "test.py", line 60, in
m.add(keras.layers.core.Dense(1024))
File "keras/keras/layers/containers.py", line 37, in add
self.layers[-1].set_previous(self.layers[-2])
File "keras/keras/layers/core.py", line 32, in set_previous
assert self.input_ndim == len(layer.output_shape), "Incompatible shapes: layer expected input with ndim=" +
File "keras/keras/layers/core.py", line 487, in output_shape
return (input_shape[0], np.prod(input_shape[1:]))
File "/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/numpy/core/fromnumeric.py", line 2481, in prod
out=out, keepdims=keepdims)
File "/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/numpy/core/_methods.py", line 35, in _prod
return umr_prod(a, axis, dtype, out, keepdims)
TypeError: unsupported operand type(s) for *: 'NoneType' and 'int'
However, this code work well:
m = keras.models.Sequential()
# ====== LSTM ====== #
m.add(keras.layers.recurrent.LSTM(250, input_dim=390, return_sequences=True, input_length_20))
m.add(keras.layers.core.Flatten())
m.add(keras.layers.core.Dense(1024))
I think there is problem of keep track input_dim to second layer of LSTM