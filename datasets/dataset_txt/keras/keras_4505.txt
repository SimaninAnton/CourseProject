Contributor
kuza55 commented on 27 Aug 2016
I don't really know what's causing this atm, but there is some sort of multithreading issue with generators in the master branch causing me to get exceptions in my generator.
Reverting to what is currently in pip solves the issue, so it's probably something that has changed wrt generators since a release.
Traceback (most recent call last):                                                                                                              
  File "/usr/lib/python2.7/threading.py", line 810, in __bootstrap_inner                                                                        
    self.run()                                                                                                                                  
  File "/usr/lib/python2.7/threading.py", line 763, in run                                                                                      
    self.__target(*self.__args, **self.__kwargs)                                                                                                
  File "/home/ubuntu/virtualenv/local/lib/python2.7/site-packages/keras/engine/training.py", line 425, in data_generator_task                   
    generator_output = next(generator)                                                                                                          
ValueError: generator already executing                                                                                                         

Traceback (most recent call last):                                                                                                              
  File "run.py", line 18, in <module>                                                                                                           
    validation_data=vgen, nb_val_samples=5120)                                                                                                  
  File "/home/ubuntu/virtualenv/local/lib/python2.7/site-packages/keras/engine/training.py", line 1469, in fit_generator                        
    max_q_size=max_q_size)                                                                                                                      
  File "/home/ubuntu/virtualenv/local/lib/python2.7/site-packages/keras/engine/training.py", line 1539, in evaluate_generator                   
    'or (x, y). Found: ' + str(generator_output))                                                                                               
Exception: output of generator should be a tuple (x, y, sample_weight) or (x, y). Found: None                                                   
Exception in thread Thread-36:                                                                                                                  
Traceback (most recent call last):                                                                                                              
  File "/usr/lib/python2.7/threading.py", line 810, in __bootstrap_inner                                                                        
    self.run()                                                                                                                                  
  File "/usr/lib/python2.7/threading.py", line 763, in run                                                                                      
    self.__target(*self.__args, **self.__kwargs)                                                                                                
  File "/home/ubuntu/virtualenv/local/lib/python2.7/site-packages/keras/engine/training.py", line 425, in data_generator_task                   
    generator_output = next(generator)                                                                                                          
  File "/mnt/bosch/data.py", line 135, in generate_batch                                                                                        
    (x_arr, y_arr) = next(gen)                                                                                                                  
  File "/mnt/bosch/data.py", line 206, in new_gen                                                                                               
    yield ([np.array(num_arr).reshape((968)), np.array(num_mask).reshape((968)),                                                                
AttributeError: 'NoneType' object has no attribute 'array'                                                                                      

Exception in thread Thread-37:                                                                                                                  
Traceback (most recent call last):                                                                                                              
  File "/usr/lib/python2.7/threading.py", line 810, in __bootstrap_inner                                                                        
    self.run()                                                                                                                                  
  File "/usr/lib/python2.7/threading.py", line 763, in run                                                                                      
    self.__target(*self.__args, **self.__kwargs)                                                                                                
  File "/home/ubuntu/virtualenv/local/lib/python2.7/site-packages/keras/engine/training.py", line 425, in data_generator_task                   
    generator_output = next(generator)                                                                                                          
  File "/mnt/bosch/data.py", line 135, in generate_batch                                                                                        
    (x_arr, y_arr) = next(gen)                                                                                                                  
  File "/mnt/bosch/data.py", line 206, in new_gen                                                                                               
    yield ([np.array(num_arr).reshape((968)), np.array(num_mask).reshape((968)),                                                                
AttributeError: 'NoneType' object has no attribute 'array'                              