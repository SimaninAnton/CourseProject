nateanl commented on 7 Dec 2016
I tried to build a LSTM model, attached the code:
model = Sequential()
model.add(BatchNormalization(batch_input_shape = (None,None,513),mode=0, axis=2))
model.add(LSTM(input_dim=513, input_length=None, output_dim=1026, return_sequences=True))
model.add(TimeDistributed(Dense(output_dim=1026)))
model.add(Activation("sigmoid"))
model.compile(optimizer='RMSprop', loss='binary_crossentropy')
The code works fine in CPU, when I turned to use GPU. It caused an error:
Failed precondition: Attempting to use un
initialized value batchnormalization_1_running_mean/biased
[[Node: batchnormalization_1_running_mean/biased/read = IdentityT=DT_FLOAT, _
class=["loc:@batchnormalization_1_running_mean"], _device="/job:localhost/replica:0/tas
k:0/gpu:0"]]
Traceback (most recent call last):
File "first_ideal_amplitude_binary_crossentropy.py", line 70, in
hist = model.fit(keras_inputs, keras_targets, nb_epoch=nb_epoch, batch_size= batch_
size, verbose=2, shuffle=True)
File "/usr/local/lib/python2.7/dist-packages/keras/models.py", line 620, in fit
sample_weight=sample_weight)
File "/usr/local/lib/python2.7/dist-packages/keras/engine/training.py", line 1106, in
fit
callback_metrics=callback_metrics)
File "/usr/local/lib/python2.7/dist-packages/keras/engine/training.py", line 824, in
_fit_loop
outs = f(ins_batch)
File "/usr/local/lib/python2.7/dist-packages/keras/backend/tensorflow_backend.py", li
ne 1013, in call
updated = session.run(self.outputs + [self.updates_op], feed_dict=feed_dict)
File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py", li
ne 766, in run
run_metadata_ptr)
File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py", line 964, in _run
feed_dict_string, options, run_metadata)
File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py", line 1014, in _do_run
target_list, options, run_metadata)
File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py", line 1034, in _do_call
raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.FailedPreconditionError: Attempting to use uninitialized value batchnormalization_1_running_mean/biased
[[Node: batchnormalization_1_running_mean/biased/read = IdentityT=DT_FLOAT, _class=["loc:@batchnormalization_1_running_mean"], _device="/job:localhost/replica:0/task:0/gpu:0"]]
Do any one meet this problem? Or do any one know how to use keras in CPU mode?
1