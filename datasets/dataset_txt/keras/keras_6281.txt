EpicWayne commented on 10 Dec 2015
Hi,
I'm trying to build a bi-directional GRU
to do gender recognition on text. My model is as follows
model = Graph()
model.add_input(name = 'input', input_shape = (None,max_features), dtype = 'float')
model.add_node(GRU(100, activation='sigmoid', inner_activation='hard_sigmoid'), name='forward', input='input')
#backwards in time direction
model.add_node(GRU(100, activation='sigmoid', inner_activation='hard_sigmoid', go_backwards = True), name='backward', input='input')
model.add_node(Dropout(0.5), name = 'first_dropout', inputs = ['forward','backward'])
model.add_node(Dense(1, activation='sigmoid'), name='sigmoid', input='first_dropout')
model.add_output(name='output', input='sigmoid')
model.compile('SGD', {'output': 'binary_crossentropy'})
My data is a 3D numpy array (x,y,z) where x is the number of samples, y is the time dimension (Words in the document example) and z is the word2vec encoding of this word (input dimension). The x and y are ints and the z are floats. The labels are binary.
Unfortunately, when I train, the cross entropy loss seems to jump all over the place, and I end up with a test accuracy of 0. Do you have any idea why this is?
Thank you very much!