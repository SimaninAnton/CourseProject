Contributor
amitbeka commented on 21 Sep 2015
As far as I understand, it seems that accuracy doesn't take into account possible timesteps masking (through sample_weight).
In Sequential model, categorical accuracy is computed as:
train_accuracy = T.mean(T.eq(T.argmax(self.y, axis=-1), T.argmax(self.y_train, axis=-1)))
while a more correct approach will take into account mask:
if mask is not None:
    train_accuracy = T.mean(T.eq(T.argmax(self.y, axis=-1)[mask.nonzero()], 
                       T.argmax(self.y_train, axis=-1)[mask.nonzero()]))
However, I see in theano documentation that it won't work, and indeed it doesn't :)
Any intention/idea how to fix it?