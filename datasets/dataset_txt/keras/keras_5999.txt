DanHenry4 commented on 4 Feb 2016
Hey everyone,
I'm trying to use custom data on the LSTM model, but it keeps giving shape errors. After reading some other issues along the same lines, I even tried reshaping the input data to size (nb_inputs, timestamps, 1) which looks approximately like (4200, 60, 1), but that returns an error that says a shape of (None, 4200, 60, 1) is no good. Any thoughts?
maxlen = 60
batch_size = 32

print('Loading data...')
(X_train, y_train), (X_test, y_test) = t.LoadData()
print(len(X_train), 'train sequences')
print(len(X_test), 'test sequences')

print('X_train shape:', X_train.shape)
print('X_test shape:', X_test.shape)

print('Build model...')
model = Sequential()
model.add(LSTM(128, input_shape=X_train.shape))

model.compile(loss='binary_crossentropy',
              optimizer='sgd',
              class_mode="categorical")

print("Train...")
model.fit(X_train, y_train, batch_size=batch_size, nb_epoch=3,
          validation_data=(X_test, y_test), show_accuracy=True)
score, acc = model.evaluate(X_test, y_test,
                            batch_size=batch_size,
                            show_accuracy=True)
print('Test score:', score)
print('Test accuracy:', acc)
Output:
Using Theano backend.
Loading data...
4130 train sequences
1016 test sequences
X_train shape: (4130L, 60L)
X_test shape: (1016L, 60L)
Build model...
Train...
Train on 4130 samples, validate on 1016 samples
Epoch 1/3
Traceback (most recent call last):
File "main.py", line 52, in
validation_data=(X_test, y_test), show_accuracy=True)
File "C:\Miniconda2\lib\site-packages\keras\models.py", line 507, in fit
shuffle=shuffle, metrics=metrics)
File "C:\Miniconda2\lib\site-packages\keras\models.py", line 226, in _fit
outs = f(ins_batch)
File "C:\Miniconda2\lib\site-packages\keras\backend\theano_backend.py", line 357, in call
return self.function(*inputs)
File "C:\Miniconda2\lib\site-packages\theano\compile\function_module.py", line 513, in call
allow_downcast=s.allow_downcast)
File "C:\Miniconda2\lib\site-packages\theano\tensor\type.py", line 169, in filter
data.shape))
TypeError: ('Bad input argument to theano function with name "C:\Miniconda2\lib\site-packages\keras\backend\theano_backend.py:354" at index 0(0-based)', 'Wrong number of dimensions: expected 3, got 2 with shape (32L, 60L).')