meetkumar commented on 9 Mar 2017 â€¢
edited
Hi,
I am trying to implement model which takes input shape (None,1,4) and I want to get just 2 class output. But i am facing an error. The code for the model is below:
model = Sequential()
layers = [4, 100, 150, 200, 300, 2]
model.add(Bidirectional(LSTM(output_dim=layers[1], input_dim=layers[0], return_sequences=True), input_shape=(1,4)))
model.add(Dropout(0.2))
model.add(Dense(output_dim=layers[2]))
model.add(Dropout(0.2))
model.add(Bidirectional(LSTM(layers[3],return_sequences = True, activation='sigmoid', inner_activation='hard_sigmoid')))
model.add(Dropout(0.2))
model.add(Flatten())
model.add(Dense(output_dim=layers[5]))
model.add(Activation("sigmoid"))
start = time.time()
Traceback (most recent call last):
File "Temp.py", line 424, in
run_network(model=None, data=None)
File "Temp.py", line 311, in run_network
batch_size=255, nb_epoch=epochs, validation_split= 0.2, shuffle=True, verbose=1, callbacks= [earlyStopping])
File "/home/anaconda3/lib/python3.6/site-packages/keras/models.py", line 672, in fit
initial_epoch=initial_epoch)
File "/home/anaconda3/lib/python3.6/site-packages/keras/engine/training.py", line 1116, in fit
batch_size=batch_size)
File "/home/anaconda3/lib/python3.6/site-packages/keras/engine/training.py", line 1033, in _standardize_user_data
exception_prefix='model target')
File "/home/anaconda3/lib/python3.6/site-packages/keras/engine/training.py", line 112, in standardize_input_data
str(array.shape))
ValueError: Error when checking model target: expected activation_1 to have 2 dimensions, but got array with shape (106431, 1, 4)
Any help will be appreciated.. Thanks in advance.