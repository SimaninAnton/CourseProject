Contributor
Russ09 commented on 9 Feb 2017
When attempting to build a ConvLSTM2D class, with stateful=True wrapped in a Bidirectional wrapper I get the error
"
Traceback (most recent call last):
File "/home/rb16/Documents/unet/tests/stateful_test.py", line 6, in
layer1 = Bidirectional(ConvLSTM2D(10, 3, 3, stateful=True))
File "/usr/local/lib/python2.7/dist-packages/keras/layers/wrappers.py", line 166, in init
self.backward_layer = layer.class.from_config(config)
File "/usr/local/lib/python2.7/dist-packages/keras/engine/topology.py", line 899, in from_config
return cls(**config)
File "/usr/local/lib/python2.7/dist-packages/keras/layers/convolutional_recurrent.py", line 299, in init
super(ConvLSTM2D, self).init(**kwargs)
File "/usr/local/lib/python2.7/dist-packages/keras/layers/convolutional_recurrent.py", line 91, in init
super(ConvRecurrent2D, self).init(**kwargs)
File "/usr/local/lib/python2.7/dist-packages/keras/engine/topology.py", line 326, in init
batch_input_shape = tuple(kwargs['batch_input_shape'])
TypeError: 'NoneType' object is not iterable
"
This issue was addressed in the standard Recurrent class here:
#4421
But ConvLSTM2D inherits from ConvRecurrent2D rather than Recurrent, and the implementation of get_config() in ConvRecurrent2D has not had this fix applied to it.
Minimum reproducing example:
from keras.layers import *
from keras.models import *


input = Input(batch_shape=(1, 10, 1, 20, 20))
layer1 = Bidirectional(ConvLSTM2D(10, 3, 3, stateful=True))

model = Model(input=input, output=layer1)
model.compile('adam','mean_squared_error')
[ x] Check that you are up-to-date with the master branch of Keras. You can update with:
pip install git+git://github.com/fchollet/keras.git --upgrade --no-deps
[n/a ] If running on TensorFlow, check that you are up-to-date with the latest version. The installation instructions can be found here.
[ x] If running on Theano, check that you are up-to-date with the master branch of Theano. You can update with:
pip install git+git://github.com/Theano/Theano.git --upgrade --no-deps
[ x] Provide a link to a GitHub Gist of a Python script that can reproduce your issue (or just copy the script here if it is short).