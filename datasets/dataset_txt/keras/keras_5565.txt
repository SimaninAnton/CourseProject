zhxiaoq9 commented on 7 Apr 2016
I am using Keras for my project, but my ANN's output should have a integer type, i want to know how can i constraint the output as integer?
Following is my code.
from keras.models import Sequential
from keras.layers import Dense, Activation, Dropout
from keras.optimizers import SGD
from sklearn import preprocessing
import numpy as np
af = open('X_train.txt', 'r')
X_train = np.loadtxt(af)
af.close()
bf = open('y_train.txt', 'r')
y_train = np.loadtxt(bf)
bf.close()
cf = open('X_test.txt', 'r')
X_test = np.loadtxt(cf)
cf.close()
df = open('y_test.txt', 'r')
y_test = np.loadtxt(df)
df.close()
XX_train = np.array(X_train)
XX_test = np.array(X_test)
min_max_scaler = preprocessing.MinMaxScaler()
X_train_scale = min_max_scaler.fit_transform(XX_train)
X_test_scale = min_max_scaler.transform(XX_test)
model = Sequential()
model.add(Dense(input_dim = 5, output_dim = 6))
model.add(Activation('softplus'))
model.add(Dense(input_dim = 6, output_dim = 6))
model.add(Activation('softmax'))
model.compile(loss='mean_squared_error', optimizer='sgd')
model.fit(X_train_scale, y_train,
nb_epoch=100,
batch_size=10,
shuffle='false')
score = model.evaluate(X_test_scale, y_test, batch_size=5)
result = model.predict(X_test_scale)