lschaupp commented on 21 Aug 2018 â€¢
edited
Hey,
Im using a customized siamese network but have some trouble witht the output shapes:
def euclidean_distance(vects):
    yaw_a, yaw_b, x, y = vects
    distance = K.sqrt(K.maximum(K.sum(K.square(x - y), axis=1, keepdims=True), K.epsilon()))
    a = tf.tuple([distance, distance])
    print (a)
    return a

def eucl_dist_output_shape(shapes):
    shape1, shape2, shape3, shape4 = shapes
    print (shapes)
    return (1,)
    #return (shape3[0], 2)

base_network = create_base_network(input_shape)
input_a = Input(shape=input_shape)
input_b = Input(shape=input_shape)
label = Input(shape=input_shape)

processed_a, loc_a = base_network(input_a)
processed_b, loc_b = base_network(input_b)

distance = Lambda(euclidean_distance,
                  output_shape=eucl_dist_output_shape)([processed_a, processed_b, loc_a, loc_b])


Output:
[<tf.Tensor 'lambda_43/tuple/control_dependency:0' shape=(?, 1) dtype=float32>, <tf.Tensor 'lambda_43/tuple/control_dependency_1:0' shape=(?, 1) dtype=float32>]
[(None, 1), (None, 1), (None, 128), (None, 128)]

IndexError: list index out of range