Contributor
lucasdavid commented on 25 Feb 2017
I found this issue while trying to implement the triplet loss from FaceNet: A Unified Embedding for Face Recognition and Clustering.
In the paper, input triplets (a, p, n) are selected from the batch s.t. they minimize ||f(n)-f(a)||, where f(x) is the network transformation of the sample x. Therefore, I need to call model.predict() inside the generator that feeds model.fit(), which throws the error:
ValueError: Tensor Tensor("Relu_1:0", shape=(?, 2048), dtype=float32) is not an element of this graph.
Link to gist that reproduces the error (you can also confirm this error goes away when not calling predict by commenting lines 59-60 and uncommenting 61-62): https://gist.github.com/lucasdavid/4cd49f68e5a4002a2611c18c876a1998