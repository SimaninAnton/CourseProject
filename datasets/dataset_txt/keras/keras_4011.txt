Contributor
PPACI commented on 2 Nov 2016 â€¢
edited
Hello everyone.
I use keras last version and tensorflow 0.10.
I encoutered an issue with model serialization on disk.
I defined a model like :
model.add(Deconvolution2D(64,3,3, output_shape=(32, 8, 8, 64),border_mode='same', activation='relu'))
model.add(Deconvolution2D(64,3,3, output_shape=(32, 8, 8, 64), border_mode='same', activation='relu'))
model.add(UpSampling2D(size=(2,2)))
(I couldn't use a viariable batch size in output_shape like (None, 8, 8,64) but that's another issue)
everything is fine, i could train, predict, etc.
but when i try to save on disk with model.save(...) and load with keras.models.load_model(...) i got the following :
TypeError: Expected binary or unicode string, got None
So i checked the saved config file and i got this for the layer previously described:
{
    "config": {
        "activity_regularizer": null,
        "W_regularizer": null,
        "b_constraint": null,
        "init": "glorot_uniform",
        "nb_filter": 64,
        "nb_row": 3,
        "border_mode": "same",
        "name": "deconvolution2d_1",
        "nb_col": 3,
        "W_constraint": null,
        "b_regularizer": null,
        "trainable": true,
        "output_shape": [
            null,
            8,
            8,
            64
        ],
        "bias": true,
        "activation": "relu",
        "subsample": [
            1,
            1
        ],
        "dim_ordering": "tf"
    }
}
Note the "output_shape": [null,...
Also, model.summary() gave me : deconvolution2d_2 (Deconvolution2(None, 8, 8, 64)
So i have two question :
Can i save the real fixed ouput_shape ?
Is there a way to use a dynamic batch number in output_shape with conv2d and tensorflow ? (using None gave me the same error in layer definition)
Thanks for all and for this wonderful framework
1