Jhhuangkay commented on 5 Nov 2016 â€¢
edited
Please make sure that the boxes below are checked before you submit your issue. Thank you!
Check that you are up-to-date with the master branch of Keras. You can update with:
pip install git+git://github.com/fchollet/keras.git --upgrade --no-deps
If running on Theano, check that you are up-to-date with the master branch of Theano. You can update with:
pip install git+git://github.com/Theano/Theano.git --upgrade --no-deps
Provide a link to a GitHub Gist of a Python script that can reproduce your issue (or just copy the script here if it is short).
Problem: I spent a lot of time to try the following code from your Visual Turing Test - Tutorial webpage :
(BOW section)
#== Model definition
First we define a model using keras/kraino
from keras.layers.core import Activation
from keras.layers.core import Dense
from keras.layers.core import Dropout
from keras.layers.core import TimeDistributedMerge
from keras.layers.embeddings import Embedding
from kraino.core.model_zoo import AbstractSequentialModel
from kraino.core.model_zoo import AbstractSingleAnswer
from kraino.core.model_zoo import AbstractSequentialMultiplewordAnswer
from kraino.core.model_zoo import Config
from kraino.core.keras_extensions import DropMask
from kraino.core.keras_extensions import LambdaWithMask
from kraino.core.keras_extensions import time_distributed_masked_ave
This model inherits from AbstractSingleAnswer, and so it produces single answer words
To use multiple answer words, you need to inherit from AbstractSequentialMultiplewordAnswer
class BlindBOW(AbstractSequentialModel, AbstractSingleAnswer):
"""
BOW Language only model that produces single word answers.
"""
def create(self):
self.add(Embedding(
self._config.input_dim,
self._config.textual_embedding_dim,
mask_zero=True))
self.add(LambdaWithMask(time_distributed_masked_ave, output_shape=[self.output_shape[2]]))
self.add(DropMask())
self.add(Dropout(0.5))
self.add(Dense(self._config.output_dim))
self.add(Activation('softmax'))
However, it always shows the following errors:
ImportError Traceback (most recent call last)
in ()
5 from keras.layers.core import Dense
6 from keras.layers.core import Dropout
----> 7 from keras.layers.core import TimeDistributedMerge
8 from keras.layers.embeddings import Embedding
9
ImportError: cannot import name TimeDistributedMerge
I am sure that I use the newest Theano and Keras. Hope you can try those code and help me fix it as soon as possible.
I guess in the keras/layers/core.py, the core.py file is really problematic.
Because I have tried to combine your 8 months ago core.py file version and the newest version, then it can work on the above code. However, it doesn't work on the Language Only-Keras part of the tutorial webpage. It shows that the " m.add(Dense(KERAS_NUM_HIDDEN, input_dim=1))" is problematic.
Is there any new "core.py" file which can work on the whole tutorial webpage code? I really need it.
Help me! Thanks.