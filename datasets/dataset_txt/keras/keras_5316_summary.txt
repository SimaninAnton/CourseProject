merge() with a lambda results in wrong shape for model.fit()