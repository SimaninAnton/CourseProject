Contributor
yaringal commented on 26 Apr 2017
Hi,
I was going over the source code to try to understand why changing a model's Trainable property failed to update the model parameters after calling fit() (even though they would appear in model.trainable_weights). I found that the property self._collected_trainable_weights is set only once in Model's compile:
https://github.com/fchollet/keras/blob/master/keras/engine/training.py#L995
and never updates afterwards, even if self.trainable_weights changes.
Then, when we call fit() for the first time, _make_train_function is called, which uses the old (and out of date) self._collected_trainable_weights.
This might be caused from a code addition of trainable_weights.sort in compile, which makes a local variable instead of setting self._collected_trainable_weights to be a reference to self.trainable_weights.
Is this intended behavior or a bug with updating model Trainable flag?
Many thanks,
Yarin